Whole k-fold eval mode
Source domain: 7, Target domain: 7, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.661)
30/33-(1.043)
12/33-(1.264)
27/33-(0.990)

=== Evaluating Model ===
accuracy on Valid 0.5578635014836796

Best accuracy on Valid 0.5578635014836796
Total valid loss 1.0133940062739633
accuracy on Test 0.5370919881305638
Best accuracy on Test 0.5370919881305638

**** Epoch 0/20 ****
9/33-(0.938)
24/33-(1.039)
6/33-(0.694)
21/33-(1.094)

=== Evaluating Model ===
accuracy on Valid 0.5370919881305638


**** Epoch 1/20 ****
3/33-(0.946)
18/33-(0.874)
0/33-(0.678)
15/33-(0.756)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Best accuracy on Valid 0.7002967359050445
Total valid loss 0.71563236144456
accuracy on Test 0.6498516320474778
Best accuracy on Test 0.6498516320474778

**** Epoch 2/20 ****
30/33-(0.933)
12/33-(0.705)
27/33-(0.743)
9/33-(0.736)

=== Evaluating Model ===
accuracy on Valid 0.6379821958456974


**** Epoch 3/20 ****
24/33-(0.544)
6/33-(1.013)
21/33-(0.480)
3/33-(0.822)
18/33-(0.622)

=== Evaluating Model ===
accuracy on Valid 0.7477744807121661

Best accuracy on Valid 0.7477744807121661
Total valid loss 0.7170612649484114
accuracy on Test 0.712166172106825
Best accuracy on Test 0.712166172106825

**** Epoch 4/20 ****
0/33-(0.835)
15/33-(0.921)
30/33-(0.798)
12/33-(0.475)

=== Evaluating Model ===
accuracy on Valid 0.7596439169139466

Best accuracy on Valid 0.7596439169139466
Total valid loss 0.7113042527979071
accuracy on Test 0.712166172106825
Best accuracy on Test 0.712166172106825

**** Epoch 5/20 ****
27/33-(0.713)
9/33-(1.232)
24/33-(0.640)
6/33-(0.732)

=== Evaluating Model ===
accuracy on Valid 0.6439169139465876


**** Epoch 6/20 ****
21/33-(0.457)
3/33-(0.618)
18/33-(0.659)
0/33-(0.484)

=== Evaluating Model ===
accuracy on Valid 0.7566765578635015


**** Epoch 7/20 ****
15/33-(0.626)
30/33-(0.732)
12/33-(0.814)
27/33-(0.436)

=== Evaluating Model ===
accuracy on Valid 0.7566765578635015


**** Epoch 8/20 ****
9/33-(0.582)
24/33-(0.712)
6/33-(0.834)
21/33-(0.686)
3/33-(0.376)

=== Evaluating Model ===
accuracy on Valid 0.7537091988130564


**** Epoch 9/20 ****
18/33-(0.667)
0/33-(0.745)
15/33-(0.743)
30/33-(0.577)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288


**** Epoch 10/20 ****
12/33-(0.390)
27/33-(0.689)
9/33-(0.468)
24/33-(0.301)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229


**** Epoch 11/20 ****
6/33-(0.728)
21/33-(0.643)
3/33-(0.437)
18/33-(0.236)

=== Evaluating Model ===
accuracy on Valid 0.7299703264094956


**** Epoch 12/20 ****
0/33-(0.653)
15/33-(0.173)
30/33-(0.464)
12/33-(0.517)

=== Evaluating Model ===
accuracy on Valid 0.744807121661721


**** Epoch 13/20 ****
27/33-(0.294)
9/33-(0.253)
24/33-(0.263)
6/33-(0.692)
21/33-(0.293)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347


**** Epoch 14/20 ****
3/33-(0.471)
18/33-(0.413)
0/33-(0.436)
15/33-(0.294)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347


**** Epoch 15/20 ****
30/33-(0.352)
12/33-(0.205)
27/33-(0.309)
9/33-(0.523)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308


**** Epoch 16/20 ****
24/33-(0.727)
6/33-(0.554)
21/33-(0.357)
3/33-(0.077)

=== Evaluating Model ===
accuracy on Valid 0.7359050445103857


**** Epoch 17/20 ****
18/33-(0.318)
0/33-(0.294)
15/33-(0.386)
30/33-(0.167)

=== Evaluating Model ===
accuracy on Valid 0.7210682492581603


**** Epoch 18/20 ****
12/33-(0.479)
27/33-(0.297)
9/33-(0.307)
24/33-(0.697)
6/33-(0.508)

=== Evaluating Model ===
accuracy on Valid 0.7299703264094956


**** Epoch 19/20 ****
21/33-(0.262)
Best accuracy on Test 0.712166172106825

Source domain: 7, Target domain: 7, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.540)
30/33-(1.209)
12/33-(1.141)
27/33-(1.156)

=== Evaluating Model ===
accuracy on Valid 0.543026706231454

Best accuracy on Valid 0.543026706231454
Total valid loss 0.8219613080674951
accuracy on Test 0.5578635014836796
Best accuracy on Test 0.5578635014836796

**** Epoch 0/20 ****
9/33-(0.985)
24/33-(0.957)
6/33-(1.014)
21/33-(0.958)

=== Evaluating Model ===
accuracy on Valid 0.5727002967359051

Best accuracy on Valid 0.5727002967359051
Total valid loss 0.7528423748233102
accuracy on Test 0.5875370919881305
Best accuracy on Test 0.5875370919881305

**** Epoch 1/20 ****
3/33-(1.292)
18/33-(1.059)
0/33-(0.676)
15/33-(0.975)

=== Evaluating Model ===
accuracy on Valid 0.658753709198813

Best accuracy on Valid 0.658753709198813
Total valid loss 0.7057365829294379
accuracy on Test 0.6528189910979229
Best accuracy on Test 0.6528189910979229

**** Epoch 2/20 ****
30/33-(0.791)
12/33-(0.937)
27/33-(0.938)
9/33-(0.550)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Best accuracy on Valid 0.7002967359050445
Total valid loss 0.6630206677046689
accuracy on Test 0.7270029673590505
Best accuracy on Test 0.7270029673590505

**** Epoch 3/20 ****
24/33-(0.741)
6/33-(1.119)
21/33-(0.814)
3/33-(1.136)
18/33-(0.927)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819


**** Epoch 4/20 ****
0/33-(0.599)
15/33-(0.699)
30/33-(0.841)
12/33-(0.895)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701

Best accuracy on Valid 0.7151335311572701
Total valid loss 0.6338765350255099
accuracy on Test 0.7566765578635015
Best accuracy on Test 0.7566765578635015

**** Epoch 5/20 ****
27/33-(0.976)
9/33-(0.821)
24/33-(0.578)
6/33-(0.447)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445


**** Epoch 6/20 ****
21/33-(0.754)
3/33-(0.580)
18/33-(0.400)
0/33-(0.644)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994


**** Epoch 7/20 ****
15/33-(0.968)
30/33-(1.158)
12/33-(0.584)
27/33-(0.469)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798


**** Epoch 8/20 ****
9/33-(0.647)
24/33-(0.329)
6/33-(0.658)
21/33-(0.639)
3/33-(0.525)

=== Evaluating Model ===
accuracy on Valid 0.7240356083086054

Best accuracy on Valid 0.7240356083086054
Total valid loss 0.6653769964521582
accuracy on Test 0.7596439169139466
Best accuracy on Test 0.7596439169139466

**** Epoch 9/20 ****
18/33-(0.461)
0/33-(0.882)
15/33-(0.591)
30/33-(0.486)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445


**** Epoch 10/20 ****
12/33-(0.721)
27/33-(0.592)
9/33-(0.545)
24/33-(0.785)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896


**** Epoch 11/20 ****
6/33-(0.382)
21/33-(0.576)
3/33-(0.456)
18/33-(0.462)

=== Evaluating Model ===
accuracy on Valid 0.7329376854599406

Best accuracy on Valid 0.7329376854599406
Total valid loss 0.7932643131776289
accuracy on Test 0.744807121661721
Best accuracy on Test 0.7596439169139466

**** Epoch 12/20 ****
0/33-(0.490)
15/33-(0.290)
30/33-(0.200)
12/33-(0.562)

=== Evaluating Model ===
accuracy on Valid 0.7181008902077152


**** Epoch 13/20 ****
27/33-(0.227)
9/33-(0.292)
24/33-(0.197)
6/33-(0.308)
21/33-(0.174)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994


**** Epoch 14/20 ****
3/33-(0.350)
18/33-(0.477)
0/33-(0.686)
15/33-(0.340)

=== Evaluating Model ===
accuracy on Valid 0.7299703264094956


**** Epoch 15/20 ****
30/33-(0.412)
12/33-(0.929)
27/33-(0.417)
9/33-(0.593)

=== Evaluating Model ===
accuracy on Valid 0.7299703264094956


**** Epoch 16/20 ****
24/33-(0.474)
6/33-(1.153)
21/33-(0.456)
3/33-(0.415)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347


**** Epoch 17/20 ****
18/33-(0.078)
0/33-(0.867)
15/33-(0.395)
30/33-(0.481)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445


**** Epoch 18/20 ****
12/33-(0.150)
27/33-(0.122)
9/33-(0.836)
24/33-(0.751)
6/33-(0.252)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819


**** Epoch 19/20 ****
21/33-(0.562)
Best accuracy on Test 0.7596439169139466

Source domain: 7, Target domain: 7, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.366)
30/33-(1.311)
12/33-(1.095)
27/33-(1.152)

=== Evaluating Model ===
accuracy on Valid 0.5608308605341247

Best accuracy on Valid 0.5608308605341247
Total valid loss 0.8191397799686952
accuracy on Test 0.5489614243323442
Best accuracy on Test 0.5489614243323442

**** Epoch 0/20 ****
9/33-(1.086)
24/33-(0.672)
6/33-(0.973)
21/33-(1.115)

=== Evaluating Model ===
accuracy on Valid 0.5727002967359051

Best accuracy on Valid 0.5727002967359051
Total valid loss 0.7604034096002579
accuracy on Test 0.6231454005934718
Best accuracy on Test 0.6231454005934718

**** Epoch 1/20 ****
3/33-(0.787)
18/33-(0.886)
0/33-(0.841)
15/33-(0.750)

=== Evaluating Model ===
accuracy on Valid 0.5133531157270029


**** Epoch 2/20 ****
30/33-(1.009)
12/33-(0.955)
27/33-(0.689)
9/33-(0.821)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Best accuracy on Valid 0.7032640949554896
Total valid loss 0.6290408386425539
accuracy on Test 0.7032640949554896
Best accuracy on Test 0.7032640949554896

**** Epoch 3/20 ****
24/33-(0.615)
6/33-(1.229)
21/33-(0.529)
3/33-(0.516)
18/33-(0.860)

=== Evaluating Model ===
accuracy on Valid 0.6379821958456974


**** Epoch 4/20 ****
0/33-(0.650)
15/33-(0.894)
30/33-(0.833)
12/33-(0.641)

=== Evaluating Model ===
accuracy on Valid 0.7329376854599406

Best accuracy on Valid 0.7329376854599406
Total valid loss 0.5936700403690338
accuracy on Test 0.7151335311572701
Best accuracy on Test 0.7151335311572701

**** Epoch 5/20 ****
27/33-(0.612)
9/33-(0.756)
24/33-(0.806)
6/33-(0.545)

=== Evaluating Model ===
accuracy on Valid 0.744807121661721

Best accuracy on Valid 0.744807121661721
Total valid loss 0.6320540146394209
accuracy on Test 0.7181008902077152
Best accuracy on Test 0.7181008902077152

**** Epoch 6/20 ****
21/33-(0.573)
3/33-(0.892)
18/33-(0.649)
0/33-(0.328)

=== Evaluating Model ===
accuracy on Valid 0.7774480712166172

Best accuracy on Valid 0.7774480712166172
Total valid loss 0.6070187769152902
accuracy on Test 0.7240356083086054
Best accuracy on Test 0.7240356083086054

**** Epoch 7/20 ****
15/33-(0.537)
30/33-(0.630)
12/33-(0.521)
27/33-(0.616)

=== Evaluating Model ===
accuracy on Valid 0.744807121661721


**** Epoch 8/20 ****
9/33-(0.561)
24/33-(0.388)
6/33-(0.621)
21/33-(0.789)
3/33-(0.303)

=== Evaluating Model ===
accuracy on Valid 0.7270029673590505


**** Epoch 9/20 ****
18/33-(0.471)
0/33-(0.659)
15/33-(0.296)
30/33-(0.546)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347


**** Epoch 10/20 ****
12/33-(0.395)
27/33-(1.013)
9/33-(0.456)
24/33-(0.567)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825


**** Epoch 11/20 ****
6/33-(0.565)
21/33-(0.489)
3/33-(0.319)
18/33-(0.356)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701


**** Epoch 12/20 ****
0/33-(0.591)
15/33-(0.415)
30/33-(0.160)
12/33-(0.374)

=== Evaluating Model ===
accuracy on Valid 0.7240356083086054


**** Epoch 13/20 ****
27/33-(0.487)
9/33-(0.211)
24/33-(0.901)
6/33-(0.395)
21/33-(0.380)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825


**** Epoch 14/20 ****
3/33-(0.563)
18/33-(0.566)
0/33-(0.172)
15/33-(0.509)

=== Evaluating Model ===
accuracy on Valid 0.7477744807121661


**** Epoch 15/20 ****
30/33-(0.290)
12/33-(0.452)
27/33-(0.127)
9/33-(0.302)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994


**** Epoch 16/20 ****
24/33-(0.199)
6/33-(0.153)
21/33-(0.381)
3/33-(0.124)

=== Evaluating Model ===
accuracy on Valid 0.7240356083086054


**** Epoch 17/20 ****
18/33-(0.454)
0/33-(0.550)
15/33-(0.675)
30/33-(0.236)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701


**** Epoch 18/20 ****
12/33-(0.136)
27/33-(0.364)
9/33-(0.095)
24/33-(0.093)
6/33-(0.553)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994


**** Epoch 19/20 ****
21/33-(0.292)
Best accuracy on Test 0.7240356083086054

Source domain: 7, Target domain: 7, Cur_fold 3
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.817)
30/33-(1.464)
12/33-(1.327)
27/33-(1.098)

=== Evaluating Model ===
accuracy on Valid 0.5680473372781065

Best accuracy on Valid 0.5680473372781065
Total valid loss 0.9098099199208346
accuracy on Test 0.5578635014836796
Best accuracy on Test 0.5578635014836796

**** Epoch 0/20 ****
9/33-(1.224)
24/33-(0.850)
6/33-(0.955)
21/33-(0.885)

=== Evaluating Model ===
accuracy on Valid 0.6331360946745562

Best accuracy on Valid 0.6331360946745562
Total valid loss 0.8360039375045083
accuracy on Test 0.6231454005934718
Best accuracy on Test 0.6231454005934718

**** Epoch 1/20 ****
3/33-(1.133)
18/33-(0.890)
0/33-(0.720)
15/33-(1.171)

=== Evaluating Model ===
accuracy on Valid 0.650887573964497

Best accuracy on Valid 0.650887573964497
Total valid loss 0.7959739620035345
accuracy on Test 0.6261127596439169
Best accuracy on Test 0.6261127596439169

**** Epoch 2/20 ****
30/33-(0.814)
12/33-(1.428)
27/33-(0.690)
9/33-(0.741)

=== Evaluating Model ===
accuracy on Valid 0.6863905325443787

Best accuracy on Valid 0.6863905325443787
Total valid loss 0.657966829159043
accuracy on Test 0.6706231454005934
Best accuracy on Test 0.6706231454005934

**** Epoch 3/20 ****
24/33-(0.893)
6/33-(0.689)
21/33-(0.637)
3/33-(0.693)
18/33-(1.072)

=== Evaluating Model ===
accuracy on Valid 0.7307692307692307

Best accuracy on Valid 0.7307692307692307
Total valid loss 0.6450135558843613
accuracy on Test 0.7032640949554896
Best accuracy on Test 0.7032640949554896

**** Epoch 4/20 ****
0/33-(0.750)
15/33-(0.668)
30/33-(1.209)
12/33-(0.657)

=== Evaluating Model ===
accuracy on Valid 0.6449704142011834


**** Epoch 5/20 ****
27/33-(0.842)
9/33-(0.887)
24/33-(0.676)
6/33-(0.709)

=== Evaluating Model ===
accuracy on Valid 0.7248520710059172


**** Epoch 6/20 ****
21/33-(0.942)
3/33-(0.469)
18/33-(0.567)
0/33-(0.689)

=== Evaluating Model ===
accuracy on Valid 0.7514792899408284

Best accuracy on Valid 0.7514792899408284
Total valid loss 0.5904432494531978
accuracy on Test 0.7418397626112759
Best accuracy on Test 0.7418397626112759

**** Epoch 7/20 ****
15/33-(0.797)
30/33-(0.384)
12/33-(0.582)
27/33-(0.494)

=== Evaluating Model ===
accuracy on Valid 0.742603550295858


**** Epoch 8/20 ****
9/33-(0.548)
24/33-(0.537)
6/33-(0.270)
21/33-(0.670)
3/33-(0.323)

=== Evaluating Model ===
accuracy on Valid 0.6952662721893491


**** Epoch 9/20 ****
18/33-(0.641)
0/33-(0.469)
15/33-(0.506)
30/33-(0.617)

=== Evaluating Model ===
accuracy on Valid 0.6715976331360947


**** Epoch 10/20 ****
12/33-(0.917)
27/33-(0.618)
9/33-(0.292)
24/33-(0.384)

=== Evaluating Model ===
accuracy on Valid 0.7159763313609467


**** Epoch 11/20 ****
6/33-(0.379)
21/33-(0.536)
3/33-(0.340)
18/33-(0.229)

=== Evaluating Model ===
accuracy on Valid 0.6390532544378699


**** Epoch 12/20 ****
0/33-(1.618)
15/33-(0.191)
30/33-(0.720)
12/33-(0.268)

=== Evaluating Model ===
accuracy on Valid 0.7159763313609467


**** Epoch 13/20 ****
27/33-(0.269)
9/33-(0.491)
24/33-(0.475)
6/33-(0.333)
21/33-(0.411)

=== Evaluating Model ===
accuracy on Valid 0.6982248520710059


**** Epoch 14/20 ****
3/33-(0.914)
18/33-(0.567)
0/33-(0.675)
15/33-(0.300)

=== Evaluating Model ===
accuracy on Valid 0.7130177514792899


**** Epoch 15/20 ****
30/33-(0.930)
12/33-(0.442)
27/33-(0.110)
9/33-(0.553)

=== Evaluating Model ===
accuracy on Valid 0.6923076923076923


**** Epoch 16/20 ****
24/33-(0.141)
6/33-(0.443)
21/33-(0.091)
3/33-(0.377)

=== Evaluating Model ===
accuracy on Valid 0.7396449704142012


**** Epoch 17/20 ****
18/33-(0.450)
0/33-(0.169)
15/33-(0.599)
30/33-(0.251)

=== Evaluating Model ===
accuracy on Valid 0.7248520710059172


**** Epoch 18/20 ****
12/33-(0.304)
27/33-(0.175)
9/33-(0.199)
24/33-(0.248)
6/33-(0.232)

=== Evaluating Model ===
accuracy on Valid 0.7011834319526628


**** Epoch 19/20 ****
21/33-(0.071)
Best accuracy on Test 0.7418397626112759

Source domain: 7, Target domain: 7, Cur_fold 4
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.798)
30/33-(1.259)
12/33-(1.369)
27/33-(1.069)

=== Evaluating Model ===
accuracy on Valid 0.629080118694362

Best accuracy on Valid 0.629080118694362
Total valid loss 0.8454846523024819
accuracy on Test 0.6331360946745562
Best accuracy on Test 0.6331360946745562

**** Epoch 0/20 ****
9/33-(1.204)
24/33-(0.856)
6/33-(1.527)
21/33-(1.038)

=== Evaluating Model ===
accuracy on Valid 0.4807121661721068


**** Epoch 1/20 ****
3/33-(0.904)
18/33-(0.990)
0/33-(0.845)
15/33-(0.739)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Best accuracy on Valid 0.6943620178041543
Total valid loss 0.6585283157500353
accuracy on Test 0.6745562130177515
Best accuracy on Test 0.6745562130177515

**** Epoch 2/20 ****
30/33-(0.782)
12/33-(0.782)
27/33-(0.617)
9/33-(0.561)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641


**** Epoch 3/20 ****
24/33-(0.860)
6/33-(0.544)
21/33-(0.628)
3/33-(0.543)
18/33-(0.934)

=== Evaluating Model ===
accuracy on Valid 0.5875370919881305


**** Epoch 4/20 ****
0/33-(0.476)
15/33-(0.591)
30/33-(0.552)
12/33-(0.776)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Best accuracy on Valid 0.7002967359050445
Total valid loss 0.6666120087558572
accuracy on Test 0.7011834319526628
Best accuracy on Test 0.7011834319526628

**** Epoch 5/20 ****
27/33-(0.445)
9/33-(0.671)
24/33-(0.792)
6/33-(0.872)

=== Evaluating Model ===
accuracy on Valid 0.6231454005934718


**** Epoch 6/20 ****
21/33-(0.668)
3/33-(0.831)
18/33-(0.526)
0/33-(0.446)

=== Evaluating Model ===
accuracy on Valid 0.6439169139465876


**** Epoch 7/20 ****
15/33-(0.466)
30/33-(1.142)
12/33-(0.387)
27/33-(0.428)

=== Evaluating Model ===
accuracy on Valid 0.7181008902077152

Best accuracy on Valid 0.7181008902077152
Total valid loss 0.6155393110080198
accuracy on Test 0.7337278106508875
Best accuracy on Test 0.7337278106508875

**** Epoch 8/20 ****
9/33-(0.417)
24/33-(0.469)
6/33-(0.673)
21/33-(0.294)
3/33-(1.498)

=== Evaluating Model ===
accuracy on Valid 0.6172106824925816


**** Epoch 9/20 ****
18/33-(0.498)
0/33-(0.958)
15/33-(0.576)
30/33-(0.531)

=== Evaluating Model ===
accuracy on Valid 0.6172106824925816


**** Epoch 10/20 ****
12/33-(0.346)
27/33-(0.524)
9/33-(0.156)
24/33-(0.375)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798


**** Epoch 11/20 ****
6/33-(0.415)
21/33-(0.615)
3/33-(0.294)
18/33-(0.243)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347


**** Epoch 12/20 ****
0/33-(0.356)
15/33-(0.455)
30/33-(0.275)
12/33-(0.364)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445


**** Epoch 13/20 ****
27/33-(0.453)
9/33-(0.155)
24/33-(0.560)
6/33-(0.387)
21/33-(0.599)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347


**** Epoch 14/20 ****
3/33-(0.092)
18/33-(0.348)
0/33-(0.173)
15/33-(0.736)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701


**** Epoch 15/20 ****
30/33-(0.223)
12/33-(0.553)
27/33-(0.166)
9/33-(0.089)

=== Evaluating Model ===
accuracy on Valid 0.6646884272997032


**** Epoch 16/20 ****
24/33-(0.467)
6/33-(0.110)
21/33-(0.173)
3/33-(0.057)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543


**** Epoch 17/20 ****
18/33-(0.249)
0/33-(0.049)
15/33-(0.186)
30/33-(0.091)

=== Evaluating Model ===
accuracy on Valid 0.6646884272997032


**** Epoch 18/20 ****
12/33-(0.454)
27/33-(0.068)
9/33-(0.251)
24/33-(0.106)
6/33-(0.337)

=== Evaluating Model ===
accuracy on Valid 0.6261127596439169


**** Epoch 19/20 ****
21/33-(0.060)
Best accuracy on Test 0.7337278106508875

Final k-fold valid 0.7437676680771865
[0.7477744807121661, 0.7240356083086054, 0.7774480712166172, 0.7514792899408284, 0.7181008902077152]
Final k-fold eval 0.7342826541183081
[0.712166172106825, 0.7596439169139466, 0.7240356083086054, 0.7418397626112759, 0.7337278106508875]
