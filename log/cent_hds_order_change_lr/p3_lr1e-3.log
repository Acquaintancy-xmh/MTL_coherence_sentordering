Whole k-fold eval mode
Source domain: 3, Target domain: 3, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.839)
30/33-(1.311)
12/33-(1.160)

=== Evaluating Model ===
accuracy on Valid 0.5232974910394266

Best accuracy on Valid 0.5232974910394266
Total valid loss 0.8528307014041476
accuracy on Test 0.5089605734767025
Best accuracy on Test 0.5089605734767025

**** Epoch 0/20 ****
27/33-(1.296)
9/33-(0.863)
24/33-(0.885)

=== Evaluating Model ===
accuracy on Valid 0.7526881720430108

Best accuracy on Valid 0.7526881720430108
Total valid loss 0.7469939192136129
accuracy on Test 0.6989247311827957
Best accuracy on Test 0.6989247311827957

**** Epoch 1/20 ****
6/33-(0.823)
21/33-(0.751)
3/33-(0.885)
18/33-(0.992)

=== Evaluating Model ===
accuracy on Valid 0.7849462365591398

Best accuracy on Valid 0.7849462365591398
Total valid loss 0.5974704076846441
accuracy on Test 0.7455197132616488
Best accuracy on Test 0.7455197132616488

**** Epoch 2/20 ****
0/33-(0.858)
15/33-(0.658)
30/33-(0.915)

=== Evaluating Model ===
accuracy on Valid 0.7956989247311828

Best accuracy on Valid 0.7956989247311828
Total valid loss 0.617092091176245
accuracy on Test 0.7455197132616488
Best accuracy on Test 0.7455197132616488

**** Epoch 3/20 ****
12/33-(0.669)
27/33-(0.856)
9/33-(0.683)
24/33-(0.509)

=== Evaluating Model ===
accuracy on Valid 0.7311827956989247


**** Epoch 4/20 ****
6/33-(0.518)
21/33-(0.705)
3/33-(0.639)

=== Evaluating Model ===
accuracy on Valid 0.8172043010752689

Best accuracy on Valid 0.8172043010752689
Total valid loss 0.5892216347985797
accuracy on Test 0.7526881720430108
Best accuracy on Test 0.7526881720430108

**** Epoch 5/20 ****
18/33-(0.426)
0/33-(0.825)
15/33-(0.813)
30/33-(0.776)

=== Evaluating Model ===
accuracy on Valid 0.7921146953405018


**** Epoch 6/20 ****
12/33-(0.417)
27/33-(0.834)
9/33-(0.603)

=== Evaluating Model ===
accuracy on Valid 0.6379928315412187


**** Epoch 7/20 ****
24/33-(0.621)
6/33-(0.724)
21/33-(0.924)
3/33-(1.123)

=== Evaluating Model ===
accuracy on Valid 0.7813620071684588


**** Epoch 8/20 ****
18/33-(0.357)
0/33-(0.746)
15/33-(0.419)

=== Evaluating Model ===
accuracy on Valid 0.7132616487455197


**** Epoch 9/20 ****
30/33-(0.577)
12/33-(0.765)
27/33-(0.450)
9/33-(0.456)

=== Evaluating Model ===
accuracy on Valid 0.6630824372759857


**** Epoch 10/20 ****
24/33-(0.386)
6/33-(0.599)
21/33-(0.345)

=== Evaluating Model ===
accuracy on Valid 0.7956989247311828


**** Epoch 11/20 ****
3/33-(0.418)
18/33-(0.281)
0/33-(0.207)
15/33-(0.109)

=== Evaluating Model ===
accuracy on Valid 0.7025089605734767


**** Epoch 12/20 ****
30/33-(0.106)
12/33-(0.429)
27/33-(0.143)

=== Evaluating Model ===
accuracy on Valid 0.7670250896057348


**** Epoch 13/20 ****
9/33-(1.106)
24/33-(0.642)
6/33-(0.103)
21/33-(0.658)

=== Evaluating Model ===
accuracy on Valid 0.7813620071684588


**** Epoch 14/20 ****
3/33-(0.421)
18/33-(0.123)
0/33-(0.087)

=== Evaluating Model ===
accuracy on Valid 0.6630824372759857


**** Epoch 15/20 ****
15/33-(0.677)
30/33-(0.202)
12/33-(0.206)

=== Evaluating Model ===
accuracy on Valid 0.7204301075268817


**** Epoch 16/20 ****
27/33-(0.876)
9/33-(1.038)
24/33-(0.145)
6/33-(0.238)

=== Evaluating Model ===
accuracy on Valid 0.7813620071684588


**** Epoch 17/20 ****
21/33-(0.230)
3/33-(0.269)
18/33-(0.179)

=== Evaluating Model ===
accuracy on Valid 0.6630824372759857


**** Epoch 18/20 ****
0/33-(0.422)
15/33-(0.088)
30/33-(0.319)
12/33-(0.050)

=== Evaluating Model ===
accuracy on Valid 0.7526881720430108


**** Epoch 19/20 ****
27/33-(0.175)
Best accuracy on Test 0.7526881720430108

Source domain: 3, Target domain: 3, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.489)
30/33-(1.266)
12/33-(1.353)

=== Evaluating Model ===
accuracy on Valid 0.5161290322580645

Best accuracy on Valid 0.5161290322580645
Total valid loss 0.9710005389319526
accuracy on Test 0.5197132616487455
Best accuracy on Test 0.5197132616487455

**** Epoch 0/20 ****
27/33-(1.067)
9/33-(1.220)
24/33-(0.947)

=== Evaluating Model ===
accuracy on Valid 0.5878136200716846

Best accuracy on Valid 0.5878136200716846
Total valid loss 0.7147821121745639
accuracy on Test 0.6559139784946236
Best accuracy on Test 0.6559139784946236

**** Epoch 1/20 ****
6/33-(0.882)
21/33-(0.810)
3/33-(0.752)
18/33-(0.569)

=== Evaluating Model ===
accuracy on Valid 0.6917562724014337

Best accuracy on Valid 0.6917562724014337
Total valid loss 0.5404073198636373
accuracy on Test 0.7383512544802867
Best accuracy on Test 0.7383512544802867

**** Epoch 2/20 ****
0/33-(0.605)
15/33-(0.849)
30/33-(0.701)

=== Evaluating Model ===
accuracy on Valid 0.6881720430107527


**** Epoch 3/20 ****
12/33-(0.776)
27/33-(1.004)
9/33-(0.957)
24/33-(0.592)

=== Evaluating Model ===
accuracy on Valid 0.6594982078853047


**** Epoch 4/20 ****
6/33-(0.663)
21/33-(0.763)
3/33-(0.440)

=== Evaluating Model ===
accuracy on Valid 0.6236559139784946


**** Epoch 5/20 ****
18/33-(0.480)
0/33-(0.650)
15/33-(0.510)
30/33-(1.110)

=== Evaluating Model ===
accuracy on Valid 0.6917562724014337

Best accuracy on Valid 0.6917562724014337
Total valid loss 0.49132425089677173
accuracy on Test 0.8243727598566308
Best accuracy on Test 0.8243727598566308

**** Epoch 6/20 ****
12/33-(0.950)
27/33-(0.964)
9/33-(0.422)

=== Evaluating Model ===
accuracy on Valid 0.7025089605734767

Best accuracy on Valid 0.7025089605734767
Total valid loss 0.42922861211829716
accuracy on Test 0.8207885304659498
Best accuracy on Test 0.8243727598566308

**** Epoch 7/20 ****
24/33-(0.374)
6/33-(1.250)
21/33-(0.469)
3/33-(0.416)

=== Evaluating Model ===
accuracy on Valid 0.6630824372759857


**** Epoch 8/20 ****
18/33-(0.395)
0/33-(0.660)
15/33-(0.256)

=== Evaluating Model ===
accuracy on Valid 0.6415770609318996


**** Epoch 9/20 ****
30/33-(0.325)
12/33-(0.395)
27/33-(0.513)
9/33-(0.496)

=== Evaluating Model ===
accuracy on Valid 0.6917562724014337


**** Epoch 10/20 ****
24/33-(0.682)
6/33-(0.585)
21/33-(1.043)

=== Evaluating Model ===
accuracy on Valid 0.6487455197132617


**** Epoch 11/20 ****
3/33-(0.197)
18/33-(0.753)
0/33-(0.419)
15/33-(0.173)

=== Evaluating Model ===
accuracy on Valid 0.6917562724014337


**** Epoch 12/20 ****
30/33-(0.332)
12/33-(0.789)
27/33-(0.514)

=== Evaluating Model ===
accuracy on Valid 0.6702508960573477


**** Epoch 13/20 ****
9/33-(0.212)
24/33-(0.231)
6/33-(1.077)
21/33-(0.504)

=== Evaluating Model ===
accuracy on Valid 0.7025089605734767

Best accuracy on Valid 0.7025089605734767
Total valid loss 0.6321749769979053
accuracy on Test 0.7741935483870968
Best accuracy on Test 0.8243727598566308

**** Epoch 14/20 ****
3/33-(0.114)
18/33-(0.323)
0/33-(0.548)

=== Evaluating Model ===
accuracy on Valid 0.6200716845878136


**** Epoch 15/20 ****
15/33-(0.277)
30/33-(0.477)
12/33-(0.258)

=== Evaluating Model ===
accuracy on Valid 0.6559139784946236


**** Epoch 16/20 ****
27/33-(0.387)
9/33-(0.167)
24/33-(0.243)
6/33-(0.585)

=== Evaluating Model ===
accuracy on Valid 0.6774193548387096


**** Epoch 17/20 ****
21/33-(0.300)
3/33-(0.157)
18/33-(1.010)

=== Evaluating Model ===
accuracy on Valid 0.6702508960573477


**** Epoch 18/20 ****
0/33-(0.195)
15/33-(0.538)
30/33-(0.190)
12/33-(0.038)

=== Evaluating Model ===
accuracy on Valid 0.6487455197132617


**** Epoch 19/20 ****
27/33-(0.054)
Best accuracy on Test 0.8243727598566308

Source domain: 3, Target domain: 3, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(2.161)
30/33-(1.325)
12/33-(1.074)

=== Evaluating Model ===
accuracy on Valid 0.5053763440860215

Best accuracy on Valid 0.5053763440860215
Total valid loss 0.8608318931526608
accuracy on Test 0.5412186379928315
Best accuracy on Test 0.5412186379928315

**** Epoch 0/20 ****
27/33-(1.195)
9/33-(0.865)
24/33-(0.611)

=== Evaluating Model ===
accuracy on Valid 0.6451612903225806

Best accuracy on Valid 0.6451612903225806
Total valid loss 0.733366933133867
accuracy on Test 0.6487455197132617
Best accuracy on Test 0.6487455197132617

**** Epoch 1/20 ****
6/33-(0.867)
21/33-(0.917)
3/33-(0.866)
18/33-(0.871)

=== Evaluating Model ===
accuracy on Valid 0.7562724014336918

Best accuracy on Valid 0.7562724014336918
Total valid loss 0.6025274677409066
accuracy on Test 0.6989247311827957
Best accuracy on Test 0.6989247311827957

**** Epoch 2/20 ****
0/33-(0.760)
15/33-(1.341)
30/33-(0.721)

=== Evaluating Model ===
accuracy on Valid 0.7240143369175627


**** Epoch 3/20 ****
12/33-(0.654)
27/33-(0.786)
9/33-(0.844)
24/33-(0.920)

=== Evaluating Model ===
accuracy on Valid 0.7347670250896058


**** Epoch 4/20 ****
6/33-(0.444)
21/33-(0.894)
3/33-(0.455)

=== Evaluating Model ===
accuracy on Valid 0.6487455197132617


**** Epoch 5/20 ****
18/33-(0.515)
0/33-(0.712)
15/33-(1.126)
30/33-(0.492)

=== Evaluating Model ===
accuracy on Valid 0.7275985663082437


**** Epoch 6/20 ****
12/33-(0.948)
27/33-(0.507)
9/33-(0.422)

=== Evaluating Model ===
accuracy on Valid 0.7598566308243727

Best accuracy on Valid 0.7598566308243727
Total valid loss 0.7024044104748302
accuracy on Test 0.7132616487455197
Best accuracy on Test 0.7132616487455197

**** Epoch 7/20 ****
24/33-(0.851)
6/33-(0.623)
21/33-(0.845)
3/33-(0.280)

=== Evaluating Model ===
accuracy on Valid 0.6845878136200717


**** Epoch 8/20 ****
18/33-(0.319)
0/33-(0.896)
15/33-(0.705)

=== Evaluating Model ===
accuracy on Valid 0.7491039426523297


**** Epoch 9/20 ****
30/33-(0.980)
12/33-(0.242)
27/33-(0.529)
9/33-(0.331)

=== Evaluating Model ===
accuracy on Valid 0.6774193548387096


**** Epoch 10/20 ****
24/33-(0.085)
6/33-(0.591)
21/33-(0.487)

=== Evaluating Model ===
accuracy on Valid 0.7275985663082437


**** Epoch 11/20 ****
3/33-(0.234)
18/33-(0.124)
0/33-(0.078)
15/33-(0.161)

=== Evaluating Model ===
accuracy on Valid 0.6953405017921147


**** Epoch 12/20 ****
30/33-(0.295)
12/33-(0.133)
27/33-(0.762)

=== Evaluating Model ===
accuracy on Valid 0.6989247311827957


**** Epoch 13/20 ****
9/33-(0.489)
24/33-(0.373)
6/33-(0.360)
21/33-(0.599)

=== Evaluating Model ===
accuracy on Valid 0.7419354838709677


**** Epoch 14/20 ****
3/33-(0.048)
18/33-(0.076)
0/33-(0.474)

=== Evaluating Model ===
accuracy on Valid 0.7096774193548387


**** Epoch 15/20 ****
15/33-(0.209)
30/33-(0.506)
12/33-(0.059)

=== Evaluating Model ===
accuracy on Valid 0.7311827956989247


**** Epoch 16/20 ****
27/33-(0.062)
9/33-(0.396)
24/33-(1.072)
6/33-(0.098)

=== Evaluating Model ===
accuracy on Valid 0.7025089605734767


**** Epoch 17/20 ****
21/33-(0.140)
