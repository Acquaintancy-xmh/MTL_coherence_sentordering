Whole k-fold eval mode
Source domain: 8, Target domain: 8, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.904)
30/33-(1.488)
12/33-(1.163)
27/33-(1.136)

=== Evaluating Model ===
accuracy on Valid 0.6666666666666666

Best accuracy on Valid 0.6666666666666666
Total valid loss 0.8799459877468291
accuracy on Test 0.6815476190476191
Best accuracy on Test 0.6815476190476191

**** Epoch 0/20 ****
9/33-(1.005)
24/33-(1.017)
6/33-(0.926)
21/33-(0.836)

=== Evaluating Model ===
accuracy on Valid 0.6160714285714286


**** Epoch 1/20 ****
3/33-(0.841)
18/33-(1.028)
0/33-(0.831)
15/33-(0.883)

=== Evaluating Model ===
accuracy on Valid 0.6964285714285714

Best accuracy on Valid 0.6964285714285714
Total valid loss 0.6458682999724433
accuracy on Test 0.7261904761904762
Best accuracy on Test 0.7261904761904762

**** Epoch 2/20 ****
30/33-(2.279)
12/33-(0.779)
27/33-(0.659)
9/33-(0.486)

=== Evaluating Model ===
accuracy on Valid 0.6785714285714286


**** Epoch 3/20 ****
24/33-(0.851)
6/33-(0.581)
21/33-(1.191)
3/33-(0.561)
18/33-(0.669)

=== Evaluating Model ===
accuracy on Valid 0.7142857142857143

Best accuracy on Valid 0.7142857142857143
Total valid loss 0.563048929685638
accuracy on Test 0.7321428571428571
Best accuracy on Test 0.7321428571428571

**** Epoch 4/20 ****
0/33-(1.483)
15/33-(0.961)
30/33-(0.775)
12/33-(0.573)

=== Evaluating Model ===
accuracy on Valid 0.7083333333333334


**** Epoch 5/20 ****
27/33-(0.648)
9/33-(0.576)
24/33-(0.615)
6/33-(0.778)

=== Evaluating Model ===
accuracy on Valid 0.6815476190476191


**** Epoch 6/20 ****
21/33-(0.409)
3/33-(0.853)
18/33-(0.702)
0/33-(0.523)

=== Evaluating Model ===
accuracy on Valid 0.7291666666666666

Best accuracy on Valid 0.7291666666666666
Total valid loss 0.5993077073778424
accuracy on Test 0.7202380952380952
Best accuracy on Test 0.7321428571428571

**** Epoch 7/20 ****
15/33-(0.277)
30/33-(0.516)
12/33-(0.593)
27/33-(0.753)

=== Evaluating Model ===
accuracy on Valid 0.7023809523809523


**** Epoch 8/20 ****
9/33-(0.466)
24/33-(0.673)
6/33-(0.526)
21/33-(0.656)
3/33-(0.750)

=== Evaluating Model ===
accuracy on Valid 0.6904761904761905


**** Epoch 9/20 ****
18/33-(0.455)
0/33-(0.136)
15/33-(0.487)
30/33-(0.646)

=== Evaluating Model ===
accuracy on Valid 0.7053571428571429


**** Epoch 10/20 ****
12/33-(0.621)
27/33-(0.490)
9/33-(0.445)
24/33-(0.804)

=== Evaluating Model ===
accuracy on Valid 0.6845238095238095


**** Epoch 11/20 ****
6/33-(0.501)
21/33-(0.495)
3/33-(0.518)
18/33-(0.513)

=== Evaluating Model ===
accuracy on Valid 0.6220238095238095


**** Epoch 12/20 ****
0/33-(0.325)
15/33-(0.489)
30/33-(0.422)
12/33-(0.514)

=== Evaluating Model ===
accuracy on Valid 0.6875


**** Epoch 13/20 ****
27/33-(0.950)
9/33-(0.316)
24/33-(0.127)
6/33-(1.077)
21/33-(0.184)

=== Evaluating Model ===
accuracy on Valid 0.6904761904761905


**** Epoch 14/20 ****
3/33-(0.099)
18/33-(0.402)
0/33-(0.353)
15/33-(0.163)

=== Evaluating Model ===
accuracy on Valid 0.6934523809523809


**** Epoch 15/20 ****
30/33-(0.296)
12/33-(0.630)
27/33-(0.464)
9/33-(0.416)

=== Evaluating Model ===
accuracy on Valid 0.6428571428571429


**** Epoch 16/20 ****
24/33-(0.204)
6/33-(0.313)
21/33-(0.358)
3/33-(0.084)

=== Evaluating Model ===
accuracy on Valid 0.6696428571428571


**** Epoch 17/20 ****
18/33-(0.192)
0/33-(1.062)
15/33-(0.365)
30/33-(0.099)

=== Evaluating Model ===
accuracy on Valid 0.6696428571428571


**** Epoch 18/20 ****
12/33-(0.090)
27/33-(0.421)
9/33-(0.978)
24/33-(0.405)
6/33-(0.595)

=== Evaluating Model ===
accuracy on Valid 0.6994047619047619


**** Epoch 19/20 ****
21/33-(0.359)
Best accuracy on Test 0.7321428571428571

Source domain: 8, Target domain: 8, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.968)
30/33-(1.716)
12/33-(1.206)
27/33-(1.248)

=== Evaluating Model ===
accuracy on Valid 0.5727002967359051

Best accuracy on Valid 0.5727002967359051
Total valid loss 0.9226550999141875
accuracy on Test 0.5863095238095238
Best accuracy on Test 0.5863095238095238

**** Epoch 0/20 ****
9/33-(1.209)
24/33-(1.112)
6/33-(1.025)
21/33-(0.985)

=== Evaluating Model ===
accuracy on Valid 0.6409495548961425

Best accuracy on Valid 0.6409495548961425
Total valid loss 0.8264896358762469
accuracy on Test 0.6428571428571429
Best accuracy on Test 0.6428571428571429

**** Epoch 1/20 ****
3/33-(0.924)
18/33-(1.068)
0/33-(0.730)
15/33-(0.734)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Best accuracy on Valid 0.6795252225519288
Total valid loss 0.7020912567774454
accuracy on Test 0.6577380952380952
Best accuracy on Test 0.6577380952380952

**** Epoch 2/20 ****
30/33-(0.806)
12/33-(0.854)
27/33-(0.823)
9/33-(0.742)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Best accuracy on Valid 0.6943620178041543
Total valid loss 0.6659993699618748
accuracy on Test 0.6815476190476191
Best accuracy on Test 0.6815476190476191

**** Epoch 3/20 ****
24/33-(0.596)
6/33-(0.561)
21/33-(1.113)
3/33-(0.516)
18/33-(0.366)

=== Evaluating Model ===
accuracy on Valid 0.7181008902077152

Best accuracy on Valid 0.7181008902077152
Total valid loss 0.6653027903465998
accuracy on Test 0.6964285714285714
Best accuracy on Test 0.6964285714285714

**** Epoch 4/20 ****
0/33-(0.663)
15/33-(0.980)
30/33-(1.218)
12/33-(0.758)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798


**** Epoch 5/20 ****
27/33-(0.658)
9/33-(0.828)
24/33-(0.383)
6/33-(1.044)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798


**** Epoch 6/20 ****
21/33-(0.623)
3/33-(0.703)
18/33-(0.721)
0/33-(0.785)

=== Evaluating Model ===
accuracy on Valid 0.6468842729970327


**** Epoch 7/20 ****
15/33-(0.367)
30/33-(0.873)
12/33-(1.158)
27/33-(0.470)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347


**** Epoch 8/20 ****
9/33-(0.437)
24/33-(0.445)
6/33-(0.931)
21/33-(0.481)
3/33-(0.415)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543


**** Epoch 9/20 ****
18/33-(0.516)
0/33-(0.478)
15/33-(0.555)
30/33-(0.956)

=== Evaluating Model ===
accuracy on Valid 0.744807121661721

Best accuracy on Valid 0.744807121661721
Total valid loss 0.6349093587625594
accuracy on Test 0.7142857142857143
Best accuracy on Test 0.7142857142857143

**** Epoch 10/20 ****
12/33-(0.315)
27/33-(0.594)
9/33-(0.526)
24/33-(0.455)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798


**** Epoch 11/20 ****
6/33-(0.351)
21/33-(0.500)
3/33-(0.229)
18/33-(0.182)

=== Evaluating Model ===
accuracy on Valid 0.6646884272997032


**** Epoch 12/20 ****
0/33-(0.382)
15/33-(0.290)
30/33-(0.134)
12/33-(0.465)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543


**** Epoch 13/20 ****
27/33-(0.385)
9/33-(0.844)
24/33-(0.287)
6/33-(0.741)
21/33-(0.506)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543


**** Epoch 14/20 ****
3/33-(1.512)
18/33-(0.978)
0/33-(0.216)
15/33-(0.474)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347


**** Epoch 15/20 ****
30/33-(0.486)
12/33-(0.189)
27/33-(0.855)
9/33-(0.589)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701


**** Epoch 16/20 ****
24/33-(0.419)
6/33-(0.240)
21/33-(0.185)
3/33-(0.118)

=== Evaluating Model ===
accuracy on Valid 0.56973293768546


**** Epoch 17/20 ****
18/33-(0.441)
0/33-(0.501)
15/33-(0.560)
30/33-(0.266)

=== Evaluating Model ===
accuracy on Valid 0.6646884272997032


**** Epoch 18/20 ****
12/33-(0.487)
27/33-(0.377)
9/33-(0.261)
24/33-(0.438)
6/33-(0.543)

=== Evaluating Model ===
accuracy on Valid 0.7181008902077152


**** Epoch 19/20 ****
21/33-(1.687)
Best accuracy on Test 0.7142857142857143

Source domain: 8, Target domain: 8, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.785)
30/33-(1.365)
12/33-(1.123)
27/33-(1.078)

=== Evaluating Model ===
accuracy on Valid 0.5311572700296736

Best accuracy on Valid 0.5311572700296736
Total valid loss 0.8820176124572754
accuracy on Test 0.5667655786350149
Best accuracy on Test 0.5667655786350149

**** Epoch 0/20 ****
9/33-(0.970)
24/33-(1.103)
6/33-(1.151)
21/33-(0.972)

=== Evaluating Model ===
accuracy on Valid 0.629080118694362

Best accuracy on Valid 0.629080118694362
Total valid loss 0.7914452850818634
accuracy on Test 0.6231454005934718
Best accuracy on Test 0.6231454005934718

**** Epoch 1/20 ****
3/33-(0.976)
18/33-(1.061)
0/33-(0.945)
15/33-(0.909)

=== Evaluating Model ===
accuracy on Valid 0.5608308605341247


**** Epoch 2/20 ****
30/33-(0.806)
12/33-(0.990)
27/33-(0.943)
9/33-(1.087)

=== Evaluating Model ===
accuracy on Valid 0.6468842729970327

Best accuracy on Valid 0.6468842729970327
Total valid loss 0.7181210572069342
accuracy on Test 0.6706231454005934
Best accuracy on Test 0.6706231454005934

**** Epoch 3/20 ****
24/33-(0.770)
6/33-(0.571)
21/33-(0.746)
3/33-(0.808)
18/33-(0.516)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641

Best accuracy on Valid 0.6884272997032641
Total valid loss 0.6103346781297163
accuracy on Test 0.7032640949554896
Best accuracy on Test 0.7032640949554896

**** Epoch 4/20 ****
0/33-(0.674)
15/33-(0.812)
30/33-(0.638)
12/33-(0.802)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Best accuracy on Valid 0.6913946587537092
Total valid loss 0.671891603957523
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.7032640949554896

**** Epoch 5/20 ****
27/33-(0.815)
9/33-(0.618)
24/33-(0.582)
6/33-(0.783)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Best accuracy on Valid 0.7091988130563798
Total valid loss 0.5990049540996552
accuracy on Test 0.7062314540059347
Best accuracy on Test 0.7062314540059347

**** Epoch 6/20 ****
21/33-(0.495)
3/33-(0.465)
18/33-(0.350)
0/33-(0.357)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445


**** Epoch 7/20 ****
15/33-(0.849)
30/33-(0.382)
12/33-(0.486)
27/33-(0.776)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092


**** Epoch 8/20 ****
9/33-(0.496)
24/33-(0.381)
6/33-(0.492)
21/33-(0.815)
3/33-(0.352)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819


**** Epoch 9/20 ****
18/33-(1.014)
0/33-(0.326)
15/33-(0.409)
30/33-(0.621)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994


**** Epoch 10/20 ****
12/33-(0.485)
27/33-(0.511)
9/33-(0.589)
24/33-(0.514)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Best accuracy on Valid 0.7091988130563798
Total valid loss 0.6853823094544086
accuracy on Test 0.7062314540059347
Best accuracy on Test 0.7062314540059347

**** Epoch 11/20 ****
6/33-(1.232)
21/33-(0.479)
3/33-(0.277)
18/33-(0.461)

=== Evaluating Model ===
accuracy on Valid 0.7240356083086054

Best accuracy on Valid 0.7240356083086054
Total valid loss 0.6458154933696444
accuracy on Test 0.7062314540059347
Best accuracy on Test 0.7062314540059347

**** Epoch 12/20 ****
0/33-(0.223)
15/33-(0.712)
30/33-(0.582)
12/33-(0.306)

=== Evaluating Model ===
accuracy on Valid 0.6646884272997032


**** Epoch 13/20 ****
27/33-(0.531)
9/33-(0.415)
24/33-(0.184)
6/33-(0.597)
21/33-(0.162)

=== Evaluating Model ===
accuracy on Valid 0.7270029673590505

Best accuracy on Valid 0.7270029673590505
Total valid loss 0.7317746645686302
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.7062314540059347

**** Epoch 14/20 ****
3/33-(0.004)
18/33-(0.175)
0/33-(0.296)
15/33-(0.261)

=== Evaluating Model ===
accuracy on Valid 0.6409495548961425


**** Epoch 15/20 ****
30/33-(0.287)
12/33-(0.193)
27/33-(0.139)
9/33-(0.271)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092


**** Epoch 16/20 ****
24/33-(0.426)
6/33-(0.315)
21/33-(0.392)
3/33-(0.497)

=== Evaluating Model ===
accuracy on Valid 0.7240356083086054


**** Epoch 17/20 ****
18/33-(0.401)
0/33-(0.246)
15/33-(0.561)
30/33-(0.335)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543


**** Epoch 18/20 ****
12/33-(0.226)
27/33-(0.274)
9/33-(0.103)
24/33-(0.480)
6/33-(0.665)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288


**** Epoch 19/20 ****
21/33-(0.355)
Best accuracy on Test 0.7062314540059347

Source domain: 8, Target domain: 8, Cur_fold 3
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.239)
30/33-(1.515)
12/33-(1.231)
27/33-(0.903)

=== Evaluating Model ===
accuracy on Valid 0.5578635014836796

Best accuracy on Valid 0.5578635014836796
Total valid loss 0.8933802111582323
accuracy on Test 0.5489614243323442
Best accuracy on Test 0.5489614243323442

**** Epoch 0/20 ****
9/33-(1.213)
24/33-(0.926)
6/33-(1.245)
21/33-(1.319)

=== Evaluating Model ===
accuracy on Valid 0.6824925816023739

Best accuracy on Valid 0.6824925816023739
Total valid loss 0.7653656087138436
accuracy on Test 0.6646884272997032
Best accuracy on Test 0.6646884272997032

**** Epoch 1/20 ****
3/33-(0.814)
18/33-(0.977)
0/33-(0.947)
15/33-(0.747)

=== Evaluating Model ===
accuracy on Valid 0.5548961424332344


**** Epoch 2/20 ****
30/33-(0.924)
12/33-(0.713)
27/33-(0.615)
9/33-(0.616)

=== Evaluating Model ===
accuracy on Valid 0.6112759643916914


**** Epoch 3/20 ****
24/33-(0.655)
6/33-(1.357)
21/33-(0.664)
3/33-(0.940)
18/33-(0.779)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347

Best accuracy on Valid 0.7062314540059347
Total valid loss 0.6983886889436028
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.6943620178041543

**** Epoch 4/20 ****
0/33-(0.668)
15/33-(0.806)
30/33-(0.790)
12/33-(0.830)

=== Evaluating Model ===
accuracy on Valid 0.744807121661721

Best accuracy on Valid 0.744807121661721
Total valid loss 0.6219865733926947
accuracy on Test 0.7359050445103857
Best accuracy on Test 0.7359050445103857

**** Epoch 5/20 ****
27/33-(0.464)
9/33-(0.473)
24/33-(0.489)
6/33-(0.564)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092


**** Epoch 6/20 ****
21/33-(0.795)
3/33-(0.793)
18/33-(0.502)
0/33-(0.560)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701


**** Epoch 7/20 ****
15/33-(0.803)
30/33-(0.798)
12/33-(0.412)
27/33-(0.584)

=== Evaluating Model ===
accuracy on Valid 0.7270029673590505


**** Epoch 8/20 ****
9/33-(0.745)
24/33-(0.471)
6/33-(0.502)
21/33-(0.675)
3/33-(0.467)

=== Evaluating Model ===
accuracy on Valid 0.6676557863501483


**** Epoch 9/20 ****
18/33-(0.458)
0/33-(0.612)
15/33-(0.589)
30/33-(0.596)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819


**** Epoch 10/20 ****
12/33-(0.920)
27/33-(0.525)
9/33-(0.599)
24/33-(0.452)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934


**** Epoch 11/20 ****
6/33-(0.554)
21/33-(0.576)
3/33-(0.578)
18/33-(0.476)

=== Evaluating Model ===
accuracy on Valid 0.6498516320474778


**** Epoch 12/20 ****
0/33-(1.655)
15/33-(0.500)
30/33-(0.279)
12/33-(0.386)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825


**** Epoch 13/20 ****
27/33-(0.480)
9/33-(0.325)
24/33-(0.483)
6/33-(0.212)
21/33-(0.367)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092


**** Epoch 14/20 ****
3/33-(1.463)
18/33-(0.355)
0/33-(0.341)
15/33-(0.187)

=== Evaluating Model ===
accuracy on Valid 0.6765578635014837


**** Epoch 15/20 ****
30/33-(0.315)
12/33-(0.240)
27/33-(0.475)
9/33-(0.151)

=== Evaluating Model ===
accuracy on Valid 0.7329376854599406


**** Epoch 16/20 ****
24/33-(0.595)
6/33-(0.183)
21/33-(0.624)
3/33-(0.160)

=== Evaluating Model ===
accuracy on Valid 0.6646884272997032


**** Epoch 17/20 ****
18/33-(0.123)
0/33-(0.102)
15/33-(0.535)
30/33-(0.517)

=== Evaluating Model ===
accuracy on Valid 0.7240356083086054


**** Epoch 18/20 ****
12/33-(0.144)
27/33-(0.490)
9/33-(0.115)
24/33-(0.254)
6/33-(0.114)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347


**** Epoch 19/20 ****
21/33-(0.687)
Best accuracy on Test 0.7359050445103857

Source domain: 8, Target domain: 8, Cur_fold 4
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.758)
30/33-(1.271)
12/33-(1.095)
27/33-(1.153)

=== Evaluating Model ===
accuracy on Valid 0.6815476190476191

Best accuracy on Valid 0.6815476190476191
Total valid loss 0.8999100002375516
accuracy on Test 0.6706231454005934
Best accuracy on Test 0.6706231454005934

**** Epoch 0/20 ****
9/33-(0.868)
24/33-(1.230)
6/33-(0.984)
21/33-(0.978)

=== Evaluating Model ===
accuracy on Valid 0.6785714285714286


**** Epoch 1/20 ****
3/33-(0.950)
18/33-(1.156)
0/33-(0.643)
15/33-(0.921)

=== Evaluating Model ===
accuracy on Valid 0.7053571428571429

Best accuracy on Valid 0.7053571428571429
Total valid loss 0.7477833926677704
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.6973293768545994

**** Epoch 2/20 ****
30/33-(1.035)
12/33-(0.627)
27/33-(0.811)
9/33-(0.658)

=== Evaluating Model ===
accuracy on Valid 0.6577380952380952


**** Epoch 3/20 ****
24/33-(0.553)
6/33-(0.827)
21/33-(0.945)
3/33-(0.645)
18/33-(0.718)

=== Evaluating Model ===
accuracy on Valid 0.6428571428571429


**** Epoch 4/20 ****
0/33-(0.659)
15/33-(0.710)
30/33-(1.066)
12/33-(0.844)

=== Evaluating Model ===
accuracy on Valid 0.6755952380952381


**** Epoch 5/20 ****
27/33-(0.619)
9/33-(0.626)
24/33-(0.506)
6/33-(0.470)

=== Evaluating Model ===
accuracy on Valid 0.6577380952380952


**** Epoch 6/20 ****
21/33-(0.784)
3/33-(0.602)
18/33-(0.835)
0/33-(0.596)

=== Evaluating Model ===
accuracy on Valid 0.6517857142857143


**** Epoch 7/20 ****
15/33-(0.441)
30/33-(0.693)
12/33-(0.564)
27/33-(0.876)

=== Evaluating Model ===
accuracy on Valid 0.7261904761904762

Best accuracy on Valid 0.7261904761904762
Total valid loss 0.7223768830299377
accuracy on Test 0.7151335311572701
Best accuracy on Test 0.7151335311572701

**** Epoch 8/20 ****
9/33-(0.353)
24/33-(0.714)
6/33-(0.434)
21/33-(0.704)
3/33-(0.456)

=== Evaluating Model ===
accuracy on Valid 0.7559523809523809

Best accuracy on Valid 0.7559523809523809
Total valid loss 0.7932664169506594
accuracy on Test 0.7151335311572701
Best accuracy on Test 0.7151335311572701

**** Epoch 9/20 ****
18/33-(0.546)
0/33-(0.645)
15/33-(0.452)
30/33-(0.996)

=== Evaluating Model ===
accuracy on Valid 0.7142857142857143


**** Epoch 10/20 ****
12/33-(0.444)
27/33-(0.704)
9/33-(0.339)
24/33-(0.655)

=== Evaluating Model ===
accuracy on Valid 0.6607142857142857


**** Epoch 11/20 ****
6/33-(0.217)
21/33-(0.229)
3/33-(0.133)
18/33-(0.740)

=== Evaluating Model ===
accuracy on Valid 0.6517857142857143


**** Epoch 12/20 ****
0/33-(0.322)
15/33-(0.382)
30/33-(0.215)
12/33-(0.879)

=== Evaluating Model ===
accuracy on Valid 0.6845238095238095


**** Epoch 13/20 ****
27/33-(0.454)
9/33-(0.204)
24/33-(0.329)
6/33-(0.389)
21/33-(1.330)

=== Evaluating Model ===
accuracy on Valid 0.7291666666666666


**** Epoch 14/20 ****
3/33-(0.102)
18/33-(0.110)
0/33-(0.543)
15/33-(0.507)

=== Evaluating Model ===
accuracy on Valid 0.7113095238095238


**** Epoch 15/20 ****
30/33-(0.565)
12/33-(0.551)
27/33-(0.647)
9/33-(0.752)

=== Evaluating Model ===
accuracy on Valid 0.7202380952380952


**** Epoch 16/20 ****
24/33-(0.546)
6/33-(0.315)
21/33-(0.511)
3/33-(0.272)

=== Evaluating Model ===
accuracy on Valid 0.7440476190476191


**** Epoch 17/20 ****
18/33-(0.266)
0/33-(0.423)
15/33-(0.360)
30/33-(0.313)

=== Evaluating Model ===
accuracy on Valid 0.7142857142857143


**** Epoch 18/20 ****
12/33-(0.524)
27/33-(0.290)
9/33-(0.199)
24/33-(0.293)
6/33-(0.499)

=== Evaluating Model ===
accuracy on Valid 0.7053571428571429


**** Epoch 19/20 ****
21/33-(0.160)
Best accuracy on Test 0.7151335311572701

Final k-fold valid 0.7278578493712025
[0.7142857142857143, 0.744807121661721, 0.7091988130563798, 0.744807121661721, 0.7261904761904762]
Final k-fold eval 0.7207397202204324
[0.7321428571428571, 0.7142857142857143, 0.7062314540059347, 0.7359050445103857, 0.7151335311572701]
