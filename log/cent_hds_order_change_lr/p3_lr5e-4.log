Whole k-fold eval mode
Source domain: 3, Target domain: 3, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.717)
30/33-(1.334)
12/33-(1.090)

=== Evaluating Model ===
accuracy on Valid 0.5448028673835126

Best accuracy on Valid 0.5448028673835126
Total valid loss 0.8673604329427084
accuracy on Test 0.5304659498207885
Best accuracy on Test 0.5304659498207885

**** Epoch 0/20 ****
27/33-(1.168)
9/33-(1.041)
24/33-(1.042)

=== Evaluating Model ===
accuracy on Valid 0.6415770609318996

Best accuracy on Valid 0.6415770609318996
Total valid loss 0.7464034888479445
accuracy on Test 0.6021505376344086
Best accuracy on Test 0.6021505376344086

**** Epoch 1/20 ****
6/33-(0.992)
21/33-(0.775)
3/33-(0.684)
18/33-(0.871)

=== Evaluating Model ===
accuracy on Valid 0.7670250896057348

Best accuracy on Valid 0.7670250896057348
Total valid loss 0.6518192009793388
accuracy on Test 0.6917562724014337
Best accuracy on Test 0.6917562724014337

**** Epoch 2/20 ****
0/33-(0.774)
15/33-(0.781)
30/33-(0.648)

=== Evaluating Model ===
accuracy on Valid 0.7275985663082437


**** Epoch 3/20 ****
12/33-(0.822)
27/33-(0.754)
9/33-(0.849)
24/33-(0.624)

=== Evaluating Model ===
accuracy on Valid 0.7275985663082437


**** Epoch 4/20 ****
6/33-(0.923)
21/33-(0.535)
3/33-(1.019)

=== Evaluating Model ===
accuracy on Valid 0.7634408602150538


**** Epoch 5/20 ****
18/33-(0.891)
0/33-(0.799)
15/33-(0.736)
30/33-(0.821)

=== Evaluating Model ===
accuracy on Valid 0.7526881720430108


**** Epoch 6/20 ****
12/33-(0.484)
27/33-(0.831)
9/33-(0.536)

=== Evaluating Model ===
accuracy on Valid 0.7562724014336918


**** Epoch 7/20 ****
24/33-(0.769)
6/33-(0.446)
21/33-(0.658)
3/33-(0.626)

=== Evaluating Model ===
accuracy on Valid 0.7706093189964157

Best accuracy on Valid 0.7706093189964157
Total valid loss 0.6385457068681717
accuracy on Test 0.7311827956989247
Best accuracy on Test 0.7311827956989247

**** Epoch 8/20 ****
18/33-(0.668)
0/33-(1.083)
15/33-(0.804)

=== Evaluating Model ===
accuracy on Valid 0.7240143369175627


**** Epoch 9/20 ****
30/33-(0.516)
12/33-(0.438)
27/33-(0.292)
9/33-(0.693)

=== Evaluating Model ===
accuracy on Valid 0.7455197132616488


**** Epoch 10/20 ****
24/33-(0.550)
6/33-(0.556)
21/33-(0.434)

=== Evaluating Model ===
accuracy on Valid 0.7562724014336918


**** Epoch 11/20 ****
3/33-(0.369)
18/33-(0.998)
0/33-(0.349)
15/33-(0.718)

=== Evaluating Model ===
accuracy on Valid 0.7992831541218638

Best accuracy on Valid 0.7992831541218638
Total valid loss 0.660501086877452
accuracy on Test 0.7311827956989247
Best accuracy on Test 0.7311827956989247

**** Epoch 12/20 ****
30/33-(0.234)
12/33-(0.250)
27/33-(0.499)

=== Evaluating Model ===
accuracy on Valid 0.7813620071684588


**** Epoch 13/20 ****
9/33-(0.257)
24/33-(0.844)
6/33-(0.434)
21/33-(0.359)

=== Evaluating Model ===
accuracy on Valid 0.7526881720430108


**** Epoch 14/20 ****
3/33-(0.196)
18/33-(0.292)
0/33-(0.509)

=== Evaluating Model ===
accuracy on Valid 0.7311827956989247


**** Epoch 15/20 ****
15/33-(0.161)
30/33-(0.558)
12/33-(0.291)

=== Evaluating Model ===
accuracy on Valid 0.7204301075268817


**** Epoch 16/20 ****
27/33-(0.457)
9/33-(0.588)
24/33-(0.907)
6/33-(0.090)

=== Evaluating Model ===
accuracy on Valid 0.7096774193548387


**** Epoch 17/20 ****
21/33-(0.333)
3/33-(0.580)
18/33-(0.136)

=== Evaluating Model ===
accuracy on Valid 0.7849462365591398


**** Epoch 18/20 ****
0/33-(0.086)
15/33-(0.339)
30/33-(0.164)
12/33-(0.564)

=== Evaluating Model ===
accuracy on Valid 0.7383512544802867


**** Epoch 19/20 ****
27/33-(0.417)
Best accuracy on Test 0.7311827956989247

Source domain: 3, Target domain: 3, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.530)
30/33-(1.155)
12/33-(1.108)

=== Evaluating Model ===
accuracy on Valid 0.33691756272401435

Best accuracy on Valid 0.33691756272401435
Total valid loss 1.0392137004269495
accuracy on Test 0.33691756272401435
Best accuracy on Test 0.33691756272401435

**** Epoch 0/20 ****
27/33-(1.153)
9/33-(1.054)
24/33-(1.101)

=== Evaluating Model ===
accuracy on Valid 0.6129032258064516

Best accuracy on Valid 0.6129032258064516
Total valid loss 0.767692099014918
accuracy on Test 0.7311827956989247
Best accuracy on Test 0.7311827956989247

**** Epoch 1/20 ****
6/33-(0.895)
21/33-(0.881)
3/33-(1.284)
18/33-(0.869)

=== Evaluating Model ===
accuracy on Valid 0.6308243727598566

Best accuracy on Valid 0.6308243727598566
Total valid loss 0.6106986138555739
accuracy on Test 0.7491039426523297
Best accuracy on Test 0.7491039426523297

**** Epoch 2/20 ****
0/33-(0.705)
15/33-(0.723)
30/33-(0.848)

=== Evaluating Model ===
accuracy on Valid 0.6200716845878136


**** Epoch 3/20 ****
12/33-(0.624)
27/33-(0.888)
9/33-(0.997)
24/33-(0.635)

=== Evaluating Model ===
accuracy on Valid 0.7168458781362007

Best accuracy on Valid 0.7168458781362007
Total valid loss 0.46759068800343406
accuracy on Test 0.8100358422939068
Best accuracy on Test 0.8100358422939068

**** Epoch 4/20 ****
6/33-(0.540)
21/33-(0.600)
3/33-(0.809)

=== Evaluating Model ===
accuracy on Valid 0.6953405017921147


**** Epoch 5/20 ****
18/33-(0.663)
0/33-(0.815)
15/33-(1.013)
30/33-(0.624)

=== Evaluating Model ===
accuracy on Valid 0.7240143369175627

Best accuracy on Valid 0.7240143369175627
Total valid loss 0.5143909578522047
accuracy on Test 0.8028673835125448
Best accuracy on Test 0.8100358422939068

**** Epoch 6/20 ****
12/33-(0.646)
27/33-(0.743)
9/33-(0.728)

=== Evaluating Model ===
accuracy on Valid 0.6487455197132617


**** Epoch 7/20 ****
24/33-(0.765)
6/33-(0.550)
21/33-(0.573)
3/33-(0.935)

=== Evaluating Model ===
accuracy on Valid 0.7240143369175627

Best accuracy on Valid 0.7240143369175627
Total valid loss 0.45134080698092777
accuracy on Test 0.8100358422939068
Best accuracy on Test 0.8100358422939068

**** Epoch 8/20 ****
18/33-(0.650)
0/33-(0.531)
15/33-(0.456)

=== Evaluating Model ===
accuracy on Valid 0.6666666666666666


**** Epoch 9/20 ****
30/33-(0.668)
12/33-(0.511)
27/33-(0.475)
9/33-(0.448)

=== Evaluating Model ===
accuracy on Valid 0.7096774193548387


**** Epoch 10/20 ****
24/33-(0.578)
6/33-(0.623)
21/33-(0.752)

=== Evaluating Model ===
accuracy on Valid 0.6594982078853047


**** Epoch 11/20 ****
3/33-(0.512)
18/33-(0.706)
0/33-(0.371)
15/33-(0.518)

=== Evaluating Model ===
accuracy on Valid 0.6164874551971327


**** Epoch 12/20 ****
30/33-(0.289)
12/33-(0.318)
27/33-(0.418)

=== Evaluating Model ===
accuracy on Valid 0.6523297491039427


**** Epoch 13/20 ****
9/33-(0.418)
24/33-(0.338)
6/33-(0.733)
21/33-(0.690)

=== Evaluating Model ===
accuracy on Valid 0.6487455197132617


**** Epoch 14/20 ****
3/33-(0.500)
18/33-(0.175)
0/33-(0.681)

=== Evaluating Model ===
accuracy on Valid 0.6666666666666666


**** Epoch 15/20 ****
15/33-(0.310)
30/33-(0.441)
12/33-(0.296)

=== Evaluating Model ===
accuracy on Valid 0.7275985663082437

Best accuracy on Valid 0.7275985663082437
Total valid loss 0.4702792221473323
accuracy on Test 0.8028673835125448
Best accuracy on Test 0.8100358422939068

**** Epoch 16/20 ****
27/33-(0.115)
9/33-(0.344)
24/33-(0.177)
6/33-(0.681)

=== Evaluating Model ===
accuracy on Valid 0.6379928315412187


**** Epoch 17/20 ****
21/33-(0.131)
3/33-(0.214)
18/33-(0.312)

=== Evaluating Model ===
accuracy on Valid 0.7096774193548387


**** Epoch 18/20 ****
0/33-(0.275)
15/33-(0.219)
30/33-(0.111)
12/33-(0.466)

=== Evaluating Model ===
accuracy on Valid 0.6021505376344086


**** Epoch 19/20 ****
27/33-(0.450)
Best accuracy on Test 0.8100358422939068

Source domain: 3, Target domain: 3, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.788)
30/33-(1.342)
12/33-(1.850)

=== Evaluating Model ===
accuracy on Valid 0.36917562724014336

Best accuracy on Valid 0.36917562724014336
Total valid loss 1.194669206937154
accuracy on Test 0.36917562724014336
Best accuracy on Test 0.36917562724014336

**** Epoch 0/20 ****
27/33-(1.073)
9/33-(0.876)
24/33-(1.162)

=== Evaluating Model ===
accuracy on Valid 0.6344086021505376

Best accuracy on Valid 0.6344086021505376
Total valid loss 0.7264827920330895
accuracy on Test 0.6702508960573477
Best accuracy on Test 0.6702508960573477

**** Epoch 1/20 ****
6/33-(0.951)
21/33-(1.107)
3/33-(0.889)
18/33-(0.884)

=== Evaluating Model ===
accuracy on Valid 0.6487455197132617

Best accuracy on Valid 0.6487455197132617
Total valid loss 0.7768109059996076
accuracy on Test 0.6308243727598566
Best accuracy on Test 0.6702508960573477

**** Epoch 2/20 ****
0/33-(0.638)
15/33-(0.966)
30/33-(1.514)

=== Evaluating Model ===
accuracy on Valid 0.5268817204301075


**** Epoch 3/20 ****
12/33-(0.840)
27/33-(0.785)
9/33-(0.763)
24/33-(0.530)

=== Evaluating Model ===
accuracy on Valid 0.6738351254480287

Best accuracy on Valid 0.6738351254480287
Total valid loss 0.7080275896522734
accuracy on Test 0.6379928315412187
Best accuracy on Test 0.6702508960573477

**** Epoch 4/20 ****
6/33-(0.533)
21/33-(0.737)
3/33-(0.567)

=== Evaluating Model ===
accuracy on Valid 0.6881720430107527

Best accuracy on Valid 0.6881720430107527
Total valid loss 0.7054069737593333
accuracy on Test 0.6630824372759857
Best accuracy on Test 0.6702508960573477

**** Epoch 5/20 ****
18/33-(0.778)
0/33-(0.666)
15/33-(1.208)
30/33-(0.318)

=== Evaluating Model ===
accuracy on Valid 0.7419354838709677

Best accuracy on Valid 0.7419354838709677
Total valid loss 0.623330705695682
accuracy on Test 0.7060931899641577
Best accuracy on Test 0.7060931899641577

**** Epoch 6/20 ****
12/33-(0.721)
27/33-(0.768)
9/33-(0.675)

=== Evaluating Model ===
accuracy on Valid 0.7491039426523297

Best accuracy on Valid 0.7491039426523297
Total valid loss 0.6257276253567802
accuracy on Test 0.7096774193548387
Best accuracy on Test 0.7096774193548387

**** Epoch 7/20 ****
24/33-(0.605)
6/33-(0.609)
21/33-(0.344)
3/33-(0.904)

=== Evaluating Model ===
accuracy on Valid 0.7526881720430108

Best accuracy on Valid 0.7526881720430108
Total valid loss 0.6650292674700419
accuracy on Test 0.6810035842293907
Best accuracy on Test 0.7096774193548387

**** Epoch 8/20 ****
18/33-(1.184)
0/33-(0.337)
15/33-(0.513)

=== Evaluating Model ===
accuracy on Valid 0.6845878136200717


**** Epoch 9/20 ****
30/33-(0.336)
12/33-(1.279)
27/33-(0.634)
9/33-(0.318)

=== Evaluating Model ===
accuracy on Valid 0.6989247311827957


**** Epoch 10/20 ****
24/33-(0.561)
6/33-(0.432)
21/33-(0.201)

=== Evaluating Model ===
accuracy on Valid 0.7060931899641577


**** Epoch 11/20 ****
3/33-(0.349)
18/33-(0.492)
0/33-(0.240)
15/33-(0.933)

=== Evaluating Model ===
accuracy on Valid 0.7204301075268817


**** Epoch 12/20 ****
30/33-(0.541)
12/33-(0.312)
27/33-(0.593)

=== Evaluating Model ===
accuracy on Valid 0.7491039426523297


**** Epoch 13/20 ****
9/33-(0.152)
24/33-(0.713)
6/33-(0.896)
21/33-(0.332)

=== Evaluating Model ===
accuracy on Valid 0.7275985663082437


**** Epoch 14/20 ****
3/33-(1.151)
18/33-(0.580)
0/33-(0.372)

=== Evaluating Model ===
accuracy on Valid 0.7204301075268817


**** Epoch 15/20 ****
15/33-(0.143)
30/33-(0.555)
12/33-(0.239)

=== Evaluating Model ===
accuracy on Valid 0.7419354838709677


**** Epoch 16/20 ****
27/33-(0.143)
9/33-(0.591)
24/33-(0.926)
6/33-(0.309)

=== Evaluating Model ===
accuracy on Valid 0.6917562724014337


**** Epoch 17/20 ****
21/33-(0.299)
3/33-(0.276)
18/33-(0.197)

=== Evaluating Model ===
accuracy on Valid 0.7275985663082437


**** Epoch 18/20 ****
0/33-(0.093)
15/33-(0.160)
30/33-(0.081)
12/33-(0.426)

=== Evaluating Model ===
accuracy on Valid 0.7096774193548387


**** Epoch 19/20 ****
27/33-(0.368)
Best accuracy on Test 0.7096774193548387

Source domain: 3, Target domain: 3, Cur_fold 3
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.993)
30/33-(1.386)
12/33-(1.131)

=== Evaluating Model ===
accuracy on Valid 0.5321428571428571

Best accuracy on Valid 0.5321428571428571
Total valid loss 0.9358066320419312
accuracy on Test 0.5698924731182796
Best accuracy on Test 0.5698924731182796

**** Epoch 0/20 ****
27/33-(1.143)
9/33-(1.103)
24/33-(0.875)

=== Evaluating Model ===
accuracy on Valid 0.6714285714285714

Best accuracy on Valid 0.6714285714285714
Total valid loss 0.7254868994156519
accuracy on Test 0.6953405017921147
Best accuracy on Test 0.6953405017921147

**** Epoch 1/20 ****
6/33-(0.813)
21/33-(0.769)
3/33-(0.662)
18/33-(0.860)

=== Evaluating Model ===
accuracy on Valid 0.6678571428571428


**** Epoch 2/20 ****
0/33-(1.625)
15/33-(0.592)
30/33-(0.447)

=== Evaluating Model ===
accuracy on Valid 0.6892857142857143

Best accuracy on Valid 0.6892857142857143
Total valid loss 0.6321360170841217
accuracy on Test 0.6881720430107527
Best accuracy on Test 0.6953405017921147

**** Epoch 3/20 ****
12/33-(0.755)
27/33-(0.482)
9/33-(0.799)
24/33-(0.488)

=== Evaluating Model ===
accuracy on Valid 0.6714285714285714


**** Epoch 4/20 ****
6/33-(0.604)
21/33-(0.798)
3/33-(0.818)

=== Evaluating Model ===
accuracy on Valid 0.675


**** Epoch 5/20 ****
18/33-(0.590)
0/33-(0.770)
15/33-(1.385)
30/33-(0.557)

=== Evaluating Model ===
accuracy on Valid 0.6642857142857143


**** Epoch 6/20 ****
12/33-(0.639)
27/33-(0.841)
9/33-(0.612)

=== Evaluating Model ===
accuracy on Valid 0.6


**** Epoch 7/20 ****
24/33-(0.353)
6/33-(0.371)
21/33-(0.449)
3/33-(0.731)

=== Evaluating Model ===
accuracy on Valid 0.6964285714285714

Best accuracy on Valid 0.6964285714285714
Total valid loss 0.6787665635347366
accuracy on Test 0.7132616487455197
Best accuracy on Test 0.7132616487455197

**** Epoch 8/20 ****
18/33-(0.416)
0/33-(0.451)
15/33-(0.540)

=== Evaluating Model ===
accuracy on Valid 0.6892857142857143


**** Epoch 9/20 ****
30/33-(0.387)
12/33-(0.472)
27/33-(0.376)
9/33-(0.762)

=== Evaluating Model ===
accuracy on Valid 0.6964285714285714

Best accuracy on Valid 0.6964285714285714
Total valid loss 0.6776051190164354
accuracy on Test 0.7598566308243727
Best accuracy on Test 0.7598566308243727

**** Epoch 10/20 ****
24/33-(0.467)
6/33-(0.628)
21/33-(0.995)

=== Evaluating Model ===
accuracy on Valid 0.6928571428571428


**** Epoch 11/20 ****
3/33-(0.608)
18/33-(0.150)
0/33-(0.446)
15/33-(0.228)

=== Evaluating Model ===
accuracy on Valid 0.6857142857142857


**** Epoch 12/20 ****
30/33-(0.562)
12/33-(0.236)
27/33-(0.212)

=== Evaluating Model ===
accuracy on Valid 0.6107142857142858


**** Epoch 13/20 ****
9/33-(0.753)
24/33-(0.287)
6/33-(0.257)
21/33-(1.149)

=== Evaluating Model ===
accuracy on Valid 0.5892857142857143


**** Epoch 14/20 ****
3/33-(0.207)
18/33-(0.116)
0/33-(0.612)

=== Evaluating Model ===
accuracy on Valid 0.6428571428571429


**** Epoch 15/20 ****
15/33-(1.422)
30/33-(0.410)
12/33-(0.347)

=== Evaluating Model ===
accuracy on Valid 0.6785714285714286


**** Epoch 16/20 ****
27/33-(0.319)
9/33-(0.641)
24/33-(0.339)
6/33-(0.484)

=== Evaluating Model ===
accuracy on Valid 0.6714285714285714


**** Epoch 17/20 ****
21/33-(0.190)
3/33-(0.114)
18/33-(0.218)

=== Evaluating Model ===
accuracy on Valid 0.7

Best accuracy on Valid 0.7
Total valid loss 0.9679257261256377
accuracy on Test 0.7060931899641577
Best accuracy on Test 0.7598566308243727

**** Epoch 18/20 ****
0/33-(0.582)
15/33-(0.258)
30/33-(0.238)
12/33-(0.181)

=== Evaluating Model ===
accuracy on Valid 0.7035714285714286

Best accuracy on Valid 0.7035714285714286
Total valid loss 0.9848972774214215
accuracy on Test 0.7240143369175627
Best accuracy on Test 0.7598566308243727

**** Epoch 19/20 ****
27/33-(0.481)
Best accuracy on Test 0.7598566308243727

Source domain: 3, Target domain: 3, Cur_fold 4
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.633)
30/33-(1.135)
12/33-(1.070)

=== Evaluating Model ===
accuracy on Valid 0.6594982078853047

Best accuracy on Valid 0.6594982078853047
Total valid loss 0.884127269188563
accuracy on Test 0.6035714285714285
Best accuracy on Test 0.6035714285714285

**** Epoch 0/20 ****
27/33-(1.159)
9/33-(0.803)
24/33-(0.904)

=== Evaluating Model ===
accuracy on Valid 0.6738351254480287

Best accuracy on Valid 0.6738351254480287
Total valid loss 0.725681044989162
accuracy on Test 0.6285714285714286
Best accuracy on Test 0.6285714285714286

**** Epoch 1/20 ****
6/33-(0.884)
21/33-(1.127)
3/33-(0.699)
18/33-(0.800)

=== Evaluating Model ===
accuracy on Valid 0.7275985663082437

Best accuracy on Valid 0.7275985663082437
Total valid loss 0.6620575487613678
accuracy on Test 0.6714285714285714
Best accuracy on Test 0.6714285714285714

**** Epoch 2/20 ****
0/33-(0.575)
15/33-(0.864)
30/33-(0.867)

=== Evaluating Model ===
accuracy on Valid 0.6953405017921147


**** Epoch 3/20 ****
12/33-(0.940)
27/33-(0.432)
9/33-(0.483)
24/33-(0.669)

=== Evaluating Model ===
accuracy on Valid 0.7168458781362007


**** Epoch 4/20 ****
6/33-(0.571)
21/33-(0.748)
3/33-(0.919)

=== Evaluating Model ===
accuracy on Valid 0.7455197132616488

Best accuracy on Valid 0.7455197132616488
Total valid loss 0.678656076391538
accuracy on Test 0.675
Best accuracy on Test 0.675

**** Epoch 5/20 ****
18/33-(1.025)
0/33-(0.714)
15/33-(0.555)
30/33-(0.517)

=== Evaluating Model ===
accuracy on Valid 0.7455197132616488

Best accuracy on Valid 0.7455197132616488
Total valid loss 0.6940590788920721
accuracy on Test 0.6821428571428572
Best accuracy on Test 0.6821428571428572

**** Epoch 6/20 ****
12/33-(0.528)
27/33-(0.465)
9/33-(0.638)

=== Evaluating Model ===
accuracy on Valid 0.6594982078853047


**** Epoch 7/20 ****
24/33-(0.649)
6/33-(0.597)
21/33-(0.590)
3/33-(0.738)

=== Evaluating Model ===
accuracy on Valid 0.7132616487455197


**** Epoch 8/20 ****
18/33-(0.542)
0/33-(0.320)
15/33-(0.697)

=== Evaluating Model ===
accuracy on Valid 0.7455197132616488

Best accuracy on Valid 0.7455197132616488
Total valid loss 0.7257619980308745
accuracy on Test 0.6714285714285714
Best accuracy on Test 0.6821428571428572

**** Epoch 9/20 ****
30/33-(0.467)
12/33-(0.708)
27/33-(0.446)
9/33-(0.709)

=== Evaluating Model ===
accuracy on Valid 0.7598566308243727

Best accuracy on Valid 0.7598566308243727
Total valid loss 0.691837266087532
accuracy on Test 0.6928571428571428
Best accuracy on Test 0.6928571428571428

**** Epoch 10/20 ****
24/33-(0.372)
6/33-(0.544)
21/33-(0.205)

=== Evaluating Model ===
accuracy on Valid 0.6917562724014337


**** Epoch 11/20 ****
3/33-(0.995)
18/33-(0.433)
0/33-(0.601)
15/33-(1.082)

=== Evaluating Model ===
accuracy on Valid 0.6272401433691757


**** Epoch 12/20 ****
30/33-(0.583)
12/33-(0.331)
27/33-(0.318)

=== Evaluating Model ===
accuracy on Valid 0.7347670250896058


**** Epoch 13/20 ****
9/33-(0.468)
24/33-(0.294)
6/33-(1.479)
21/33-(0.424)

=== Evaluating Model ===
accuracy on Valid 0.7562724014336918


**** Epoch 14/20 ****
3/33-(0.541)
18/33-(0.484)
0/33-(0.730)

=== Evaluating Model ===
accuracy on Valid 0.6164874551971327


**** Epoch 15/20 ****
15/33-(0.501)
30/33-(0.406)
12/33-(0.355)

=== Evaluating Model ===
accuracy on Valid 0.7491039426523297


**** Epoch 16/20 ****
27/33-(0.265)
9/33-(1.146)
24/33-(0.351)
6/33-(0.105)

=== Evaluating Model ===
accuracy on Valid 0.7419354838709677


**** Epoch 17/20 ****
21/33-(0.149)
3/33-(0.340)
18/33-(0.225)

=== Evaluating Model ===
accuracy on Valid 0.6738351254480287


**** Epoch 18/20 ****
0/33-(0.590)
15/33-(0.266)
30/33-(0.346)
12/33-(0.253)

=== Evaluating Model ===
accuracy on Valid 0.7491039426523297


**** Epoch 19/20 ****
27/33-(0.235)
Best accuracy on Test 0.6928571428571428

Final k-fold valid 0.738568868407578
[0.7706093189964157, 0.7168458781362007, 0.7491039426523297, 0.6964285714285714, 0.7598566308243727]
Final k-fold eval 0.7407219662058372
[0.7311827956989247, 0.8100358422939068, 0.7096774193548387, 0.7598566308243727, 0.6928571428571428]
