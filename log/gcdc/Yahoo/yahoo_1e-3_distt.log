Whole k-fold eval mode
Source domain: Yahoo, Target domain: Yahoo, Cur_fold 0
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/30 ****
Use CrossEntropyLoss
15/33-(1.210)
30/33-(1.461)
12/33-(1.001)

=== Evaluating Model ===
Total valid loss 1.0375085820754368
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.46111111111111114

**** Epoch 0/30 ****
27/33-(0.989)
9/33-(1.026)
24/33-(1.166)
6/33-(1.012)

=== Evaluating Model ===
Total valid loss 1.19268299639225
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.46111111111111114

**** Epoch 1/30 ****
21/33-(1.003)
3/33-(1.027)
18/33-(1.382)
0/33-(1.129)

=== Evaluating Model ===
Total valid loss 1.2318712770938873
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.46111111111111114

**** Epoch 2/30 ****
15/33-(1.422)
30/33-(1.030)
12/33-(0.973)

=== Evaluating Model ===
Total valid loss 1.0805921057860057
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.46111111111111114

**** Epoch 3/30 ****
27/33-(1.150)
9/33-(1.079)
24/33-(1.278)
6/33-(1.142)

=== Evaluating Model ===
Total valid loss 0.9585293928782145
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5166666666666667

**** Epoch 4/30 ****
21/33-(0.573)
3/33-(1.170)
18/33-(0.992)
0/33-(0.953)

=== Evaluating Model ===
Total valid loss 1.0495798240105312
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5277777777777778

**** Epoch 5/30 ****
15/33-(0.926)
30/33-(0.911)
12/33-(0.882)
27/33-(0.942)

=== Evaluating Model ===
Total valid loss 1.0762963394323986
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5277777777777778

**** Epoch 6/30 ****
9/33-(0.793)
24/33-(0.880)
6/33-(0.526)

=== Evaluating Model ===
Total valid loss 0.979918951789538
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 7/30 ****
21/33-(0.690)
3/33-(0.846)
18/33-(0.658)
0/33-(0.493)

=== Evaluating Model ===
Total valid loss 0.9767338335514069
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 8/30 ****
15/33-(0.764)
30/33-(0.574)
12/33-(0.617)
27/33-(1.206)

=== Evaluating Model ===
Total valid loss 1.2774902979532878
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 9/30 ****
9/33-(0.732)
24/33-(0.326)
6/33-(0.686)
21/33-(1.202)

=== Evaluating Model ===
Total valid loss 1.4297024607658386
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 10/30 ****
3/33-(0.690)
18/33-(0.606)
0/33-(0.865)

=== Evaluating Model ===
Total valid loss 1.2494877129793167
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 11/30 ****
15/33-(0.828)
30/33-(0.345)
12/33-(0.550)
27/33-(0.455)

=== Evaluating Model ===
Total valid loss 1.5788075936337311
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5611111111111111

**** Epoch 12/30 ****
9/33-(0.673)
24/33-(0.760)
6/33-(0.149)
21/33-(0.627)

=== Evaluating Model ===
Total valid loss 1.2850511148571968
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5611111111111111

**** Epoch 13/30 ****
3/33-(0.410)
18/33-(0.589)
0/33-(0.580)
15/33-(0.644)

=== Evaluating Model ===
Total valid loss 1.6064595878124237
accuracy on Test 0.45
Best accuracy on Test 0.5611111111111111

**** Epoch 14/30 ****
30/33-(0.961)
12/33-(0.470)
27/33-(0.426)

=== Evaluating Model ===
Total valid loss 2.1056079963843026
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5611111111111111

**** Epoch 15/30 ****
9/33-(0.266)
24/33-(0.289)
6/33-(1.316)
21/33-(0.207)

=== Evaluating Model ===
Total valid loss 2.19109358638525
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5611111111111111

**** Epoch 16/30 ****
3/33-(0.588)
18/33-(0.390)
0/33-(0.213)
15/33-(1.023)

=== Evaluating Model ===
Total valid loss 2.0446659525235495
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 17/30 ****
30/33-(0.604)
12/33-(0.218)
27/33-(0.073)

=== Evaluating Model ===
Total valid loss 2.641878585020701
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5611111111111111

**** Epoch 18/30 ****
9/33-(0.542)
24/33-(0.325)
6/33-(0.269)
21/33-(0.188)

=== Evaluating Model ===
Total valid loss 1.9672667520741622
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5611111111111111

**** Epoch 19/30 ****
3/33-(0.194)
18/33-(1.408)
0/33-(0.114)
15/33-(0.840)

=== Evaluating Model ===
Total valid loss 2.116801301638285
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5611111111111111

**** Epoch 20/30 ****
30/33-(0.135)
12/33-(0.295)
27/33-(0.540)
9/33-(0.441)

=== Evaluating Model ===
Total valid loss 2.3324232697486877
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5611111111111111

**** Epoch 21/30 ****
24/33-(0.242)
6/33-(0.029)
21/33-(0.073)

=== Evaluating Model ===
Total valid loss 2.619715064764023
accuracy on Test 0.4222222222222222
Best accuracy on Test 0.5611111111111111

**** Epoch 22/30 ****
3/33-(0.426)
18/33-(0.541)
0/33-(0.322)
15/33-(0.024)

=== Evaluating Model ===
Total valid loss 2.6298350592454276
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.5611111111111111

**** Epoch 23/30 ****
30/33-(0.187)
12/33-(0.487)
27/33-(0.019)
9/33-(0.065)

=== Evaluating Model ===
Total valid loss 3.4570561150709787
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 24/30 ****
24/33-(0.221)
6/33-(0.205)
21/33-(0.457)
3/33-(0.257)

=== Evaluating Model ===
Total valid loss 3.662290488680204
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5611111111111111

**** Epoch 25/30 ****
18/33-(0.069)
0/33-(0.215)
15/33-(0.013)

=== Evaluating Model ===
Total valid loss 3.1993002792199454
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5611111111111111

**** Epoch 26/30 ****
30/33-(0.266)
12/33-(0.012)
27/33-(0.676)
9/33-(0.277)

=== Evaluating Model ===
Total valid loss 3.0922154982884726
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 27/30 ****
24/33-(0.150)
6/33-(0.003)
21/33-(0.018)
3/33-(0.055)

=== Evaluating Model ===
Total valid loss 2.9848597745100656
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5611111111111111

**** Epoch 28/30 ****
18/33-(0.405)
0/33-(0.168)
15/33-(0.033)
30/33-(0.429)

=== Evaluating Model ===
Total valid loss 2.5373382767041526
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5611111111111111

**** Epoch 29/30 ****
12/33-(0.368)
27/33-(0.013)
Best accuracy on Test 0.5611111111111111

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 1
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/30 ****
Use CrossEntropyLoss
15/33-(1.409)
30/33-(1.230)
12/33-(1.021)

=== Evaluating Model ===
Total valid loss 1.181207334001859
accuracy on Test 0.4
Best accuracy on Test 0.4

**** Epoch 0/30 ****
27/33-(1.264)
9/33-(0.923)
24/33-(1.007)
6/33-(0.907)

=== Evaluating Model ===
Total valid loss 1.0395488142967224
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.42777777777777776

**** Epoch 1/30 ****
21/33-(1.096)
3/33-(0.825)
18/33-(0.991)
0/33-(0.965)

=== Evaluating Model ===
Total valid loss 1.1464645862579346
accuracy on Test 0.4
Best accuracy on Test 0.42777777777777776

**** Epoch 2/30 ****
15/33-(0.772)
30/33-(0.892)
12/33-(0.716)

=== Evaluating Model ===
Total valid loss 1.215242053071658
accuracy on Test 0.45
Best accuracy on Test 0.45

**** Epoch 3/30 ****
27/33-(1.036)
9/33-(1.358)
24/33-(1.190)
6/33-(1.356)

=== Evaluating Model ===
Total valid loss 1.0424635807673137
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.49444444444444446

**** Epoch 4/30 ****
21/33-(1.140)
3/33-(0.954)
18/33-(0.665)
0/33-(0.839)

=== Evaluating Model ===
Total valid loss 1.0785175065199535
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5222222222222223

**** Epoch 5/30 ****
15/33-(0.572)
30/33-(0.893)
12/33-(0.662)
27/33-(0.740)

=== Evaluating Model ===
Total valid loss 1.2160462488730748
accuracy on Test 0.5
Best accuracy on Test 0.5222222222222223

**** Epoch 6/30 ****
9/33-(0.780)
24/33-(0.496)
6/33-(0.755)

=== Evaluating Model ===
Total valid loss 1.3314954837163289
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 7/30 ****
21/33-(1.214)
3/33-(0.866)
18/33-(0.993)
0/33-(0.839)

=== Evaluating Model ===
Total valid loss 1.4295141647259395
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5333333333333333

**** Epoch 8/30 ****
15/33-(0.557)
30/33-(0.347)
12/33-(0.754)
27/33-(0.751)

=== Evaluating Model ===
Total valid loss 1.2533219903707504
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 9/30 ****
9/33-(0.311)
24/33-(0.318)
6/33-(1.015)
21/33-(1.099)

=== Evaluating Model ===
Total valid loss 1.4718789905309677
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5555555555555556

**** Epoch 10/30 ****
3/33-(0.643)
18/33-(0.647)
0/33-(0.293)

=== Evaluating Model ===
Total valid loss 2.173500488201777
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5555555555555556

**** Epoch 11/30 ****
15/33-(0.577)
30/33-(0.221)
12/33-(0.395)
27/33-(0.224)

=== Evaluating Model ===
Total valid loss 2.2831512093544006
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5555555555555556

**** Epoch 12/30 ****
9/33-(0.317)
24/33-(0.354)
6/33-(0.600)
21/33-(0.122)

=== Evaluating Model ===
Total valid loss 2.705835282802582
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5555555555555556

**** Epoch 13/30 ****
3/33-(0.675)
18/33-(0.671)
0/33-(0.420)
15/33-(0.351)

=== Evaluating Model ===
Total valid loss 1.9480897635221481
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5555555555555556

**** Epoch 14/30 ****
30/33-(0.325)
12/33-(0.264)
27/33-(0.739)

=== Evaluating Model ===
Total valid loss 2.510230471690496
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5555555555555556

**** Epoch 15/30 ****
9/33-(0.456)
24/33-(0.384)
6/33-(0.166)
21/33-(0.179)

=== Evaluating Model ===
Total valid loss 2.1881899933020272
accuracy on Test 0.37777777777777777
Best accuracy on Test 0.5555555555555556

**** Epoch 16/30 ****
3/33-(0.176)
18/33-(0.251)
0/33-(0.279)
15/33-(0.576)

=== Evaluating Model ===
Total valid loss 4.415462116400401
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5555555555555556

**** Epoch 17/30 ****
30/33-(0.123)
12/33-(0.612)
27/33-(0.216)

=== Evaluating Model ===
Total valid loss 3.176703304052353
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5555555555555556

**** Epoch 18/30 ****
9/33-(0.103)
24/33-(0.991)
6/33-(0.052)
21/33-(0.537)

=== Evaluating Model ===
Total valid loss 5.080509344736735
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5555555555555556

**** Epoch 19/30 ****
3/33-(0.398)
18/33-(0.110)
0/33-(0.150)
15/33-(0.748)

=== Evaluating Model ===
Total valid loss 3.372387925783793
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5555555555555556

**** Epoch 20/30 ****
30/33-(0.269)
12/33-(0.220)
27/33-(0.159)
9/33-(0.103)

=== Evaluating Model ===
Total valid loss 3.237791041533152
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5555555555555556

**** Epoch 21/30 ****
24/33-(0.126)
6/33-(0.122)
21/33-(0.290)

=== Evaluating Model ===
Total valid loss 3.5477698147296906
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5555555555555556

**** Epoch 22/30 ****
3/33-(0.033)
18/33-(0.001)
0/33-(0.221)
15/33-(0.430)

=== Evaluating Model ===
Total valid loss 3.6871939301490784
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5555555555555556

**** Epoch 23/30 ****
30/33-(0.040)
12/33-(0.263)
27/33-(0.349)
9/33-(0.742)

=== Evaluating Model ===
Total valid loss 3.3374831775824227
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5555555555555556

**** Epoch 24/30 ****
24/33-(0.137)
6/33-(0.019)
21/33-(0.409)
3/33-(0.332)

=== Evaluating Model ===
Total valid loss 3.6748996575673423
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5555555555555556

**** Epoch 25/30 ****
18/33-(0.018)
0/33-(0.009)
15/33-(0.452)

=== Evaluating Model ===
Total valid loss 3.6030959288279214
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.5555555555555556

**** Epoch 26/30 ****
30/33-(0.005)
12/33-(0.010)
27/33-(0.123)
9/33-(0.035)

=== Evaluating Model ===
Total valid loss 3.7804156641165414
accuracy on Test 0.5
Best accuracy on Test 0.5555555555555556

**** Epoch 27/30 ****
24/33-(0.118)
6/33-(0.034)
21/33-(0.528)
3/33-(0.194)

=== Evaluating Model ===
Total valid loss 4.329667349656423
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5555555555555556

**** Epoch 28/30 ****
18/33-(0.002)
0/33-(0.002)
15/33-(0.098)
30/33-(0.772)

=== Evaluating Model ===
Total valid loss 3.4591896732648215
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.5555555555555556

**** Epoch 29/30 ****
12/33-(0.704)
27/33-(0.104)
Best accuracy on Test 0.5555555555555556

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 2
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/30 ****
Use CrossEntropyLoss
15/33-(1.404)
30/33-(0.957)
12/33-(1.122)

=== Evaluating Model ===
Total valid loss 1.1164998610814412
accuracy on Test 0.37777777777777777
Best accuracy on Test 0.37777777777777777

**** Epoch 0/30 ****
27/33-(1.164)
9/33-(1.088)
24/33-(1.124)
6/33-(1.076)

=== Evaluating Model ===
Total valid loss 1.0833868086338043
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.4111111111111111

**** Epoch 1/30 ****
21/33-(1.177)
3/33-(1.089)
18/33-(1.032)
0/33-(0.991)

=== Evaluating Model ===
Total valid loss 1.0921394973993301
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.4111111111111111

**** Epoch 2/30 ****
15/33-(1.430)
30/33-(0.960)
12/33-(0.986)

=== Evaluating Model ===
Total valid loss 1.029576708873113
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.4388888888888889

**** Epoch 3/30 ****
27/33-(0.903)
9/33-(1.071)
24/33-(0.740)
6/33-(0.719)

=== Evaluating Model ===
Total valid loss 1.1693921188513439
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.45555555555555555

**** Epoch 4/30 ****
21/33-(1.180)
3/33-(0.937)
18/33-(0.964)
0/33-(1.365)

=== Evaluating Model ===
Total valid loss 1.1581227978070576
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.4666666666666667

**** Epoch 5/30 ****
15/33-(1.210)
30/33-(0.879)
12/33-(0.950)
27/33-(0.604)

=== Evaluating Model ===
Total valid loss 1.2507972717285156
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5222222222222223

**** Epoch 6/30 ****
9/33-(0.785)
24/33-(0.912)
6/33-(1.304)

=== Evaluating Model ===
Total valid loss 1.0020049512386322
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 7/30 ****
21/33-(0.696)
3/33-(1.140)
18/33-(0.873)
0/33-(0.706)

=== Evaluating Model ===
Total valid loss 1.2108341256777446
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 8/30 ****
15/33-(0.773)
30/33-(0.768)
12/33-(0.576)
27/33-(0.870)

=== Evaluating Model ===
Total valid loss 1.243291661143303
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5611111111111111

**** Epoch 9/30 ****
9/33-(1.440)
24/33-(1.160)
6/33-(0.618)
21/33-(0.892)

=== Evaluating Model ===
Total valid loss 1.5885651111602783
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5611111111111111

**** Epoch 10/30 ****
3/33-(0.418)
18/33-(1.068)
0/33-(0.537)

=== Evaluating Model ===
Total valid loss 1.6690798203150432
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 11/30 ****
15/33-(0.491)
30/33-(0.409)
12/33-(0.821)
27/33-(0.810)

=== Evaluating Model ===
Total valid loss 2.169853230317434
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5611111111111111

**** Epoch 12/30 ****
9/33-(0.401)
24/33-(0.531)
6/33-(0.531)
21/33-(0.299)

=== Evaluating Model ===
Total valid loss 1.897083342075348
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5611111111111111

**** Epoch 13/30 ****
3/33-(0.187)
18/33-(0.247)
0/33-(0.379)
15/33-(0.646)

=== Evaluating Model ===
Total valid loss 2.395033856232961
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5611111111111111

**** Epoch 14/30 ****
30/33-(0.347)
12/33-(0.303)
27/33-(0.190)

=== Evaluating Model ===
Total valid loss 2.0229136049747467
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5611111111111111

**** Epoch 15/30 ****
9/33-(1.217)
24/33-(0.277)
6/33-(0.191)
21/33-(0.283)

=== Evaluating Model ===
Total valid loss 2.0336168905099234
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5611111111111111

**** Epoch 16/30 ****
3/33-(0.521)
18/33-(0.324)
0/33-(0.452)
15/33-(0.656)

=== Evaluating Model ===
Total valid loss 1.9918627937634785
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5611111111111111

**** Epoch 17/30 ****
30/33-(0.694)
12/33-(0.171)
27/33-(0.263)

=== Evaluating Model ===
Total valid loss 2.46487158536911
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5611111111111111

**** Epoch 18/30 ****
9/33-(0.284)
24/33-(0.326)
6/33-(0.148)
21/33-(0.080)

=== Evaluating Model ===
Total valid loss 3.341344177722931
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 19/30 ****
3/33-(0.075)
18/33-(1.458)
0/33-(0.260)
15/33-(0.136)

=== Evaluating Model ===
Total valid loss 2.814961940050125
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5611111111111111

**** Epoch 20/30 ****
30/33-(0.181)
12/33-(0.096)
27/33-(0.004)
9/33-(0.295)

=== Evaluating Model ===
Total valid loss 4.3320344885190325
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5611111111111111

**** Epoch 21/30 ****
24/33-(0.128)
6/33-(0.376)
21/33-(0.362)

=== Evaluating Model ===
Total valid loss 2.907780279715856
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 22/30 ****
3/33-(0.086)
18/33-(0.016)
0/33-(0.161)
15/33-(0.396)

=== Evaluating Model ===
Total valid loss 2.6710455119609833
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5611111111111111

**** Epoch 23/30 ****
30/33-(0.044)
12/33-(0.386)
27/33-(0.247)
9/33-(0.582)

=== Evaluating Model ===
Total valid loss 2.9266887505849204
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 24/30 ****
24/33-(0.077)
6/33-(0.041)
21/33-(0.114)
3/33-(0.155)

=== Evaluating Model ===
Total valid loss 3.3136844833691916
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5611111111111111

**** Epoch 25/30 ****
18/33-(0.217)
0/33-(0.155)
15/33-(0.443)

=== Evaluating Model ===
Total valid loss 3.28203879793485
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 26/30 ****
30/33-(0.058)
12/33-(0.016)
27/33-(0.008)
9/33-(0.377)

=== Evaluating Model ===
Total valid loss 2.7808581590652466
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5611111111111111

**** Epoch 27/30 ****
24/33-(0.171)
6/33-(0.229)
21/33-(0.004)
3/33-(0.007)

=== Evaluating Model ===
Total valid loss 3.6021387179692588
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 28/30 ****
18/33-(1.134)
0/33-(0.016)
15/33-(0.003)
30/33-(0.977)

=== Evaluating Model ===
Total valid loss 5.013300776481628
accuracy on Test 0.3611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 29/30 ****
12/33-(0.003)
27/33-(0.000)
Best accuracy on Test 0.5611111111111111

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 3
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/30 ****
Use CrossEntropyLoss
15/33-(0.921)
30/33-(0.949)
12/33-(1.042)

=== Evaluating Model ===
Total valid loss 1.0593529095252354
accuracy on Test 0.3888888888888889
Best accuracy on Test 0.3888888888888889

**** Epoch 0/30 ****
27/33-(0.982)
9/33-(1.098)
24/33-(1.169)
6/33-(1.020)

=== Evaluating Model ===
Total valid loss 1.0771682610114415
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.4111111111111111

**** Epoch 1/30 ****
21/33-(1.138)
3/33-(0.630)
18/33-(1.063)
0/33-(1.023)

=== Evaluating Model ===
Total valid loss 1.3437763005495071
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.4111111111111111

**** Epoch 2/30 ****
15/33-(0.692)
30/33-(1.015)
12/33-(1.114)

=== Evaluating Model ===
Total valid loss 1.0587458163499832
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 3/30 ****
27/33-(1.143)
9/33-(0.782)
24/33-(0.960)
6/33-(0.872)

=== Evaluating Model ===
Total valid loss 1.1787352164586384
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 4/30 ****
21/33-(1.268)
3/33-(0.701)
18/33-(0.745)
0/33-(0.947)

=== Evaluating Model ===
Total valid loss 1.0069285084803898
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5444444444444444

**** Epoch 5/30 ****
15/33-(1.003)
30/33-(0.600)
12/33-(1.250)
27/33-(1.130)

=== Evaluating Model ===
Total valid loss 1.1798926045497258
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5444444444444444

**** Epoch 6/30 ****
9/33-(0.671)
24/33-(0.458)
6/33-(0.639)

=== Evaluating Model ===
Total valid loss 1.0797038873036702
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5444444444444444

**** Epoch 7/30 ****
21/33-(0.903)
3/33-(0.615)
18/33-(1.004)
0/33-(0.696)

=== Evaluating Model ===
Total valid loss 1.4186569700638454
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 8/30 ****
15/33-(0.516)
30/33-(0.781)
12/33-(0.506)
27/33-(0.562)

=== Evaluating Model ===
Total valid loss 1.5818647543589275
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.55

**** Epoch 9/30 ****
9/33-(0.138)
24/33-(0.293)
6/33-(0.664)
21/33-(0.435)

=== Evaluating Model ===
Total valid loss 1.4315880636374156
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.55

**** Epoch 10/30 ****
3/33-(0.854)
18/33-(0.641)
0/33-(0.825)

=== Evaluating Model ===
Total valid loss 1.7259056170781453
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.55

**** Epoch 11/30 ****
15/33-(0.466)
30/33-(0.614)
12/33-(0.963)
27/33-(0.569)

=== Evaluating Model ===
Total valid loss 2.2608693540096283
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.55

**** Epoch 12/30 ****
9/33-(0.873)
24/33-(1.054)
6/33-(0.365)
21/33-(0.712)

=== Evaluating Model ===
Total valid loss 2.5374554991722107
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.55

**** Epoch 13/30 ****
3/33-(0.182)
18/33-(0.527)
0/33-(0.183)
15/33-(0.706)

=== Evaluating Model ===
Total valid loss 3.3510880966981254
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.55

**** Epoch 14/30 ****
30/33-(0.563)
12/33-(0.259)
27/33-(0.464)

=== Evaluating Model ===
Total valid loss 3.1232942740122476
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.55

**** Epoch 15/30 ****
9/33-(0.272)
24/33-(0.374)
6/33-(0.136)
21/33-(0.384)

=== Evaluating Model ===
Total valid loss 3.115070273478826
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.55

**** Epoch 16/30 ****
3/33-(0.255)
18/33-(0.370)
0/33-(0.043)
15/33-(0.336)

=== Evaluating Model ===
Total valid loss 2.652031828959783
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.55

**** Epoch 17/30 ****
30/33-(0.466)
12/33-(0.190)
27/33-(0.089)

=== Evaluating Model ===
Total valid loss 4.172227293252945
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.55

**** Epoch 18/30 ****
9/33-(0.647)
24/33-(0.169)
6/33-(0.112)
21/33-(0.188)

=== Evaluating Model ===
Total valid loss 4.944210370381673
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 19/30 ****
3/33-(0.127)
18/33-(0.012)
0/33-(0.323)
15/33-(0.036)

=== Evaluating Model ===
Total valid loss 4.333469450473785
accuracy on Test 0.5
Best accuracy on Test 0.55

**** Epoch 20/30 ****
30/33-(0.032)
12/33-(0.019)
27/33-(0.013)
9/33-(0.057)

=== Evaluating Model ===
Total valid loss 3.2519858380158744
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 21/30 ****
24/33-(0.382)
6/33-(0.036)
21/33-(0.574)

=== Evaluating Model ===
Total valid loss 4.106259663899739
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5555555555555556

**** Epoch 22/30 ****
3/33-(0.026)
18/33-(0.174)
0/33-(0.155)
15/33-(0.524)

=== Evaluating Model ===
Total valid loss 3.5061436692873635
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5555555555555556

**** Epoch 23/30 ****
30/33-(0.374)
12/33-(0.041)
27/33-(1.179)
9/33-(0.240)

=== Evaluating Model ===
Total valid loss 3.6928652922312417
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5555555555555556

**** Epoch 24/30 ****
24/33-(0.378)
6/33-(0.022)
21/33-(0.063)
3/33-(0.074)

=== Evaluating Model ===
Total valid loss 3.178413510322571
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.5555555555555556

**** Epoch 25/30 ****
18/33-(0.147)
0/33-(0.108)
15/33-(0.038)

=== Evaluating Model ===
Total valid loss 3.831577867269516
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5555555555555556

**** Epoch 26/30 ****
30/33-(0.158)
12/33-(0.756)
27/33-(0.363)
9/33-(0.013)

=== Evaluating Model ===
Total valid loss 3.9161084294319153
accuracy on Test 0.5
Best accuracy on Test 0.5555555555555556

**** Epoch 27/30 ****
24/33-(0.090)
6/33-(0.084)
21/33-(0.008)
3/33-(0.006)

=== Evaluating Model ===
Total valid loss 5.1452568372090655
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5555555555555556

**** Epoch 28/30 ****
18/33-(0.009)
0/33-(0.230)
15/33-(0.006)
30/33-(0.031)

=== Evaluating Model ===
Total valid loss 4.128431707620621
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5555555555555556

**** Epoch 29/30 ****
12/33-(0.360)
27/33-(0.010)
Best accuracy on Test 0.5555555555555556

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 4
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/30 ****
Use CrossEntropyLoss
15/33-(0.778)
30/33-(0.912)
12/33-(0.891)

=== Evaluating Model ===
Total valid loss 1.0791424016157787
accuracy on Test 0.39444444444444443
Best accuracy on Test 0.39444444444444443

**** Epoch 0/30 ****
27/33-(1.034)
9/33-(1.234)
24/33-(1.141)
6/33-(1.109)

=== Evaluating Model ===
Total valid loss 1.0882568657398224
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.4111111111111111

**** Epoch 1/30 ****
21/33-(1.020)
3/33-(1.032)
18/33-(1.027)
0/33-(1.005)

=== Evaluating Model ===
Total valid loss 1.0802421818176906
accuracy on Test 0.39444444444444443
Best accuracy on Test 0.4111111111111111

**** Epoch 2/30 ****
15/33-(1.315)
30/33-(0.947)
12/33-(0.709)

=== Evaluating Model ===
Total valid loss 1.1540254006783168
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5222222222222223

**** Epoch 3/30 ****
27/33-(1.324)
9/33-(0.936)
24/33-(0.963)
6/33-(0.939)

=== Evaluating Model ===
Total valid loss 1.0616176823774974
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 4/30 ****
21/33-(0.829)
3/33-(1.194)
18/33-(1.035)
0/33-(0.626)

=== Evaluating Model ===
Total valid loss 1.0314072370529175
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5444444444444444

**** Epoch 5/30 ****
15/33-(0.643)
30/33-(0.682)
12/33-(0.956)
27/33-(2.080)

=== Evaluating Model ===
Total valid loss 1.0178807824850082
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 6/30 ****
9/33-(0.248)
24/33-(0.663)
6/33-(0.442)

=== Evaluating Model ===
Total valid loss 1.5358148713906605
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.55

**** Epoch 7/30 ****
21/33-(0.611)
3/33-(0.912)
18/33-(1.182)
0/33-(0.769)

=== Evaluating Model ===
Total valid loss 1.2301694750785828
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 8/30 ****
15/33-(0.695)
30/33-(0.796)
12/33-(0.469)
27/33-(0.862)

=== Evaluating Model ===
Total valid loss 1.29718982676665
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5666666666666667

**** Epoch 9/30 ****
9/33-(0.923)
24/33-(0.443)
6/33-(0.901)
21/33-(0.781)

=== Evaluating Model ===
Total valid loss 1.7876911560694377
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5666666666666667

**** Epoch 10/30 ****
3/33-(0.462)
18/33-(0.323)
0/33-(0.340)

=== Evaluating Model ===
Total valid loss 1.8172110170125961
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5666666666666667

**** Epoch 11/30 ****
15/33-(1.166)
30/33-(0.435)
12/33-(0.838)
27/33-(0.418)

=== Evaluating Model ===
Total valid loss 2.390947461128235
accuracy on Test 0.45
Best accuracy on Test 0.5666666666666667

**** Epoch 12/30 ****
9/33-(1.102)
24/33-(0.298)
6/33-(0.383)
21/33-(0.518)

=== Evaluating Model ===
Total valid loss 1.6703457683324814
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 13/30 ****
3/33-(0.854)
18/33-(0.411)
0/33-(0.058)
15/33-(0.683)

=== Evaluating Model ===
Total valid loss 2.001805623372396
accuracy on Test 0.4222222222222222
Best accuracy on Test 0.5666666666666667

**** Epoch 14/30 ****
30/33-(1.952)
12/33-(0.256)
27/33-(0.264)

=== Evaluating Model ===
Total valid loss 3.31150820851326
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5666666666666667

**** Epoch 15/30 ****
9/33-(0.230)
24/33-(0.233)
6/33-(0.396)
21/33-(0.265)

=== Evaluating Model ===
Total valid loss 2.390513430039088
accuracy on Test 0.45
Best accuracy on Test 0.5666666666666667

**** Epoch 16/30 ****
3/33-(0.350)
18/33-(1.405)
0/33-(0.562)
15/33-(0.469)

=== Evaluating Model ===
Total valid loss 1.8027522216240566
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5666666666666667

**** Epoch 17/30 ****
30/33-(0.251)
12/33-(0.707)
27/33-(0.029)

=== Evaluating Model ===
Total valid loss 1.7287764698266983
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5666666666666667

**** Epoch 18/30 ****
9/33-(0.411)
24/33-(0.227)
6/33-(0.036)
21/33-(0.091)

=== Evaluating Model ===
Total valid loss 3.3386725982030234
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5666666666666667

**** Epoch 19/30 ****
3/33-(0.236)
18/33-(0.009)
0/33-(0.030)
15/33-(0.030)

=== Evaluating Model ===
Total valid loss 3.399770180384318
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5666666666666667

**** Epoch 20/30 ****
30/33-(0.425)
12/33-(1.208)
27/33-(0.286)
9/33-(0.342)

=== Evaluating Model ===
Total valid loss 3.2803744077682495
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 21/30 ****
24/33-(0.019)
6/33-(0.039)
21/33-(1.247)

=== Evaluating Model ===
Total valid loss 3.738870998223623
accuracy on Test 0.40555555555555556
Best accuracy on Test 0.5666666666666667

**** Epoch 22/30 ****
3/33-(0.121)
18/33-(0.074)
0/33-(0.312)
15/33-(0.309)

=== Evaluating Model ===
Total valid loss 3.7338990569114685
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5666666666666667

**** Epoch 23/30 ****
30/33-(0.244)
12/33-(0.078)
27/33-(0.096)
9/33-(0.082)

=== Evaluating Model ===
Total valid loss 3.997503320376078
accuracy on Test 0.4166666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 24/30 ****
24/33-(0.258)
6/33-(0.000)
21/33-(0.087)
3/33-(0.033)

=== Evaluating Model ===
Total valid loss 2.990729341904322
accuracy on Test 0.4222222222222222
Best accuracy on Test 0.5666666666666667

**** Epoch 25/30 ****
18/33-(0.212)
0/33-(0.812)
15/33-(0.255)

=== Evaluating Model ===
Total valid loss 4.234001000722249
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5666666666666667

**** Epoch 26/30 ****
30/33-(0.013)
12/33-(0.772)
27/33-(0.133)
9/33-(0.915)

=== Evaluating Model ===
Total valid loss 2.9822987417380014
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.5666666666666667

**** Epoch 27/30 ****
24/33-(0.178)
6/33-(0.136)
21/33-(0.009)
3/33-(0.006)

=== Evaluating Model ===
Total valid loss 4.048253317674001
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5666666666666667

**** Epoch 28/30 ****
18/33-(0.139)
0/33-(0.695)
15/33-(0.102)
30/33-(0.387)

=== Evaluating Model ===
Total valid loss 3.933094302813212
accuracy on Test 0.4166666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 29/30 ****
12/33-(0.011)
27/33-(0.017)
Best accuracy on Test 0.5666666666666667

Final k-fold valid -1.0
[-1, -1, -1, -1, -1]
Final k-fold eval 0.5599999999999999
[0.5611111111111111, 0.5555555555555556, 0.5611111111111111, 0.5555555555555556, 0.5666666666666667]

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 5
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(0.966)
30/33-(1.251)
12/33-(1.206)

=== Evaluating Model ===
Total valid loss 1.074215163787206
accuracy on Test 0.39444444444444443
Best accuracy on Test 0.39444444444444443

**** Epoch 0/20 ****
27/33-(1.181)
9/33-(1.014)
24/33-(1.217)
6/33-(1.008)

=== Evaluating Model ===
Total valid loss 1.1779686609903972
accuracy on Test 0.39444444444444443
Best accuracy on Test 0.39444444444444443

**** Epoch 1/20 ****
21/33-(1.099)
3/33-(1.053)
18/33-(1.083)
0/33-(1.058)

=== Evaluating Model ===
Total valid loss 1.118561565876007
accuracy on Test 0.39444444444444443
Best accuracy on Test 0.39444444444444443

**** Epoch 2/20 ****
15/33-(0.950)
30/33-(1.121)
12/33-(1.360)

=== Evaluating Model ===
Total valid loss 1.0438984682162602
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5055555555555555

**** Epoch 3/20 ****
27/33-(0.785)
9/33-(0.800)
24/33-(0.693)
6/33-(1.348)

=== Evaluating Model ===
Total valid loss 1.0432729572057724
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 4/20 ****
21/33-(1.580)
3/33-(0.844)
18/33-(0.844)
0/33-(0.895)

=== Evaluating Model ===
Total valid loss 1.1243551075458527
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5444444444444444

**** Epoch 5/20 ****
15/33-(0.550)
30/33-(0.843)
12/33-(0.903)
27/33-(0.813)

=== Evaluating Model ===
Total valid loss 1.0924477130174637
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5444444444444444

**** Epoch 6/20 ****
9/33-(0.814)
24/33-(0.704)
6/33-(1.048)

=== Evaluating Model ===
Total valid loss 1.171006292104721
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5444444444444444

**** Epoch 7/20 ****
21/33-(0.875)
3/33-(0.566)
18/33-(0.682)
0/33-(1.005)

=== Evaluating Model ===
Total valid loss 1.3579961111148198
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5444444444444444

**** Epoch 8/20 ****
15/33-(0.861)
30/33-(0.687)
12/33-(0.508)
27/33-(0.459)

=== Evaluating Model ===
Total valid loss 1.2220893800258636
accuracy on Test 0.5
Best accuracy on Test 0.5444444444444444

**** Epoch 9/20 ****
9/33-(0.289)
24/33-(0.357)
6/33-(0.468)
21/33-(0.662)

=== Evaluating Model ===
Total valid loss 1.7722100764513016
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5444444444444444

**** Epoch 10/20 ****
3/33-(0.321)
18/33-(0.419)
0/33-(0.816)

=== Evaluating Model ===
Total valid loss 1.8008084644873936
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5444444444444444

**** Epoch 11/20 ****
15/33-(0.517)
30/33-(0.084)
12/33-(0.513)
27/33-(0.342)

=== Evaluating Model ===
Total valid loss 1.7439787834882736
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5444444444444444

**** Epoch 12/20 ****
9/33-(0.264)
24/33-(0.746)
6/33-(0.243)
21/33-(0.430)

=== Evaluating Model ===
Total valid loss 1.6312841524680455
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5444444444444444

**** Epoch 13/20 ****
3/33-(0.510)
18/33-(0.203)
0/33-(0.794)
15/33-(0.506)

=== Evaluating Model ===
Total valid loss 2.505489081144333
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5444444444444444

**** Epoch 14/20 ****
30/33-(0.393)
12/33-(0.176)
27/33-(0.538)

=== Evaluating Model ===
Total valid loss 2.1147083242734275
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.5444444444444444

**** Epoch 15/20 ****
9/33-(0.484)
24/33-(0.218)
6/33-(0.545)
21/33-(0.488)

=== Evaluating Model ===
Total valid loss 2.4355036318302155
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5444444444444444

**** Epoch 16/20 ****
3/33-(0.872)
18/33-(0.136)
0/33-(0.541)
15/33-(0.379)

=== Evaluating Model ===
Total valid loss 3.174586613972982
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5444444444444444

**** Epoch 17/20 ****
30/33-(0.425)
12/33-(0.381)
27/33-(0.315)

=== Evaluating Model ===
Total valid loss 2.5064508418242135
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5444444444444444

**** Epoch 18/20 ****
9/33-(0.324)
24/33-(0.168)
6/33-(0.680)
21/33-(0.059)

=== Evaluating Model ===
Total valid loss 3.769646147886912
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5444444444444444

**** Epoch 19/20 ****
3/33-(0.142)
18/33-(0.026)
Best accuracy on Test 0.5444444444444444

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 6
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(0.890)
30/33-(1.145)
12/33-(1.154)

=== Evaluating Model ===
Total valid loss 1.0594384372234344
accuracy on Test 0.39444444444444443
Best accuracy on Test 0.39444444444444443

**** Epoch 0/20 ****
27/33-(1.045)
9/33-(1.021)
24/33-(0.934)
6/33-(0.924)

=== Evaluating Model ===
Total valid loss 1.1037392169237137
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5055555555555555

**** Epoch 1/20 ****
21/33-(1.279)
3/33-(1.074)
18/33-(0.967)
0/33-(0.972)

=== Evaluating Model ===
Total valid loss 1.0205206374327342
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5222222222222223

**** Epoch 2/20 ****
15/33-(0.965)
30/33-(0.816)
12/33-(0.873)

=== Evaluating Model ===
Total valid loss 1.1140388598044713
accuracy on Test 0.5
Best accuracy on Test 0.5222222222222223

**** Epoch 3/20 ****
27/33-(1.071)
9/33-(0.807)
24/33-(0.861)
6/33-(0.800)

=== Evaluating Model ===
Total valid loss 1.035592128833135
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 4/20 ****
21/33-(1.084)
3/33-(0.718)
18/33-(1.031)
0/33-(0.845)

=== Evaluating Model ===
Total valid loss 1.0184789697329204
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 5/20 ****
15/33-(1.077)
30/33-(1.309)
12/33-(0.880)
27/33-(0.739)

=== Evaluating Model ===
Total valid loss 1.0480084319909413
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 6/20 ****
9/33-(0.662)
24/33-(0.557)
6/33-(0.737)

=== Evaluating Model ===
Total valid loss 1.2979446252187092
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5722222222222222

**** Epoch 7/20 ****
21/33-(0.749)
3/33-(0.309)
18/33-(1.046)
0/33-(0.553)

=== Evaluating Model ===
Total valid loss 1.415771911541621
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5722222222222222

**** Epoch 8/20 ****
15/33-(0.777)
30/33-(0.567)
12/33-(0.525)
27/33-(0.576)

=== Evaluating Model ===
Total valid loss 1.4062409152587254
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5722222222222222

**** Epoch 9/20 ****
9/33-(0.287)
24/33-(0.472)
6/33-(0.493)
21/33-(0.811)

=== Evaluating Model ===
Total valid loss 1.3286710133155186
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5722222222222222

**** Epoch 10/20 ****
3/33-(0.723)
18/33-(0.516)
0/33-(0.245)

=== Evaluating Model ===
Total valid loss 1.4502106457948685
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5722222222222222

**** Epoch 11/20 ****
15/33-(0.348)
30/33-(0.256)
12/33-(0.444)
27/33-(0.662)

=== Evaluating Model ===
Total valid loss 1.4777596592903137
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5722222222222222

**** Epoch 12/20 ****
9/33-(0.452)
24/33-(0.448)
6/33-(0.168)
21/33-(0.358)

=== Evaluating Model ===
Total valid loss 1.6676993171374004
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5722222222222222

**** Epoch 13/20 ****
3/33-(0.356)
18/33-(0.309)
0/33-(0.108)
15/33-(0.155)

=== Evaluating Model ===
Total valid loss 2.039805849393209
accuracy on Test 0.5
Best accuracy on Test 0.5722222222222222

**** Epoch 14/20 ****
30/33-(0.004)
12/33-(0.131)
27/33-(0.362)

=== Evaluating Model ===
Total valid loss 2.0151600738366446
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5722222222222222

**** Epoch 15/20 ****
9/33-(0.593)
24/33-(0.076)
6/33-(0.607)
21/33-(0.427)

=== Evaluating Model ===
Total valid loss 2.466644455989202
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5722222222222222

**** Epoch 16/20 ****
3/33-(0.276)
18/33-(0.387)
0/33-(0.258)
15/33-(1.023)

=== Evaluating Model ===
Total valid loss 2.29730823636055
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5722222222222222

**** Epoch 17/20 ****
30/33-(0.937)
12/33-(0.797)
27/33-(0.081)

=== Evaluating Model ===
Total valid loss 2.307441492875417
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5722222222222222

**** Epoch 18/20 ****
9/33-(0.852)
24/33-(0.008)
6/33-(0.405)
21/33-(0.212)

=== Evaluating Model ===
Total valid loss 1.9872960845629375
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.5722222222222222

**** Epoch 19/20 ****
3/33-(0.346)
18/33-(0.439)
Best accuracy on Test 0.5722222222222222

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 7
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.681)
30/33-(1.320)
12/33-(1.049)

=== Evaluating Model ===
Total valid loss 1.0475177069505055
accuracy on Test 0.4222222222222222
Best accuracy on Test 0.4222222222222222

**** Epoch 0/20 ****
27/33-(0.964)
9/33-(1.218)
24/33-(0.788)
6/33-(1.000)

=== Evaluating Model ===
Total valid loss 1.0445130169391632
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.4722222222222222

**** Epoch 1/20 ****
21/33-(1.103)
3/33-(1.013)
18/33-(1.015)
0/33-(0.819)

=== Evaluating Model ===
Total valid loss 1.0467604100704193
accuracy on Test 0.4222222222222222
Best accuracy on Test 0.4722222222222222

**** Epoch 2/20 ****
15/33-(0.998)
30/33-(1.147)
12/33-(0.872)

=== Evaluating Model ===
Total valid loss 1.0192512820164363
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 3/20 ****
27/33-(0.841)
9/33-(0.889)
24/33-(0.881)
6/33-(1.062)

=== Evaluating Model ===
Total valid loss 1.3586575090885162
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5666666666666667

**** Epoch 4/20 ****
21/33-(1.238)
3/33-(0.889)
18/33-(1.136)
0/33-(0.850)

=== Evaluating Model ===
Total valid loss 1.1055506716171901
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5666666666666667

**** Epoch 5/20 ****
15/33-(0.729)
30/33-(1.113)
12/33-(1.288)
27/33-(0.779)

=== Evaluating Model ===
Total valid loss 1.1802268425623577
accuracy on Test 0.55
Best accuracy on Test 0.5666666666666667

**** Epoch 6/20 ****
9/33-(0.508)
24/33-(0.888)
6/33-(0.748)

=== Evaluating Model ===
Total valid loss 2.1694754461447396
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5666666666666667

**** Epoch 7/20 ****
21/33-(0.619)
3/33-(0.600)
18/33-(0.490)
0/33-(0.480)

=== Evaluating Model ===
Total valid loss 1.6627240230639775
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5666666666666667

**** Epoch 8/20 ****
15/33-(1.143)
30/33-(1.939)
12/33-(0.503)
27/33-(0.633)

=== Evaluating Model ===
Total valid loss 1.3521833419799805
accuracy on Test 0.5
Best accuracy on Test 0.5666666666666667

**** Epoch 9/20 ****
9/33-(0.453)
24/33-(0.620)
6/33-(0.384)
21/33-(0.526)

=== Evaluating Model ===
Total valid loss 1.8861872106790543
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 10/20 ****
3/33-(0.995)
18/33-(0.997)
0/33-(0.388)

=== Evaluating Model ===
Total valid loss 2.239647795756658
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5666666666666667

**** Epoch 11/20 ****
15/33-(0.676)
30/33-(0.224)
12/33-(0.401)
27/33-(0.303)

=== Evaluating Model ===
Total valid loss 2.2261420090993247
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5666666666666667

**** Epoch 12/20 ****
9/33-(0.194)
24/33-(0.670)
6/33-(0.663)
21/33-(0.793)

=== Evaluating Model ===
Total valid loss 1.484813968340556
accuracy on Test 0.45
Best accuracy on Test 0.5666666666666667

**** Epoch 13/20 ****
3/33-(0.242)
18/33-(0.284)
0/33-(1.273)
15/33-(0.259)

=== Evaluating Model ===
Total valid loss 2.3313625951608024
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5666666666666667

**** Epoch 14/20 ****
30/33-(0.037)
12/33-(0.749)
27/33-(0.490)

=== Evaluating Model ===
Total valid loss 2.302076588074366
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 15/20 ****
9/33-(0.741)
24/33-(0.213)
6/33-(0.463)
21/33-(0.578)

=== Evaluating Model ===
Total valid loss 2.2760538160800934
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 16/20 ****
3/33-(0.342)
18/33-(0.329)
0/33-(0.722)
15/33-(0.239)

=== Evaluating Model ===
Total valid loss 2.180778662363688
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 17/20 ****
30/33-(0.081)
12/33-(0.036)
27/33-(0.159)

=== Evaluating Model ===
Total valid loss 2.699984143177668
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.5666666666666667

**** Epoch 18/20 ****
9/33-(0.184)
24/33-(0.570)
6/33-(0.248)
21/33-(0.045)

=== Evaluating Model ===
Total valid loss 2.798869123061498
accuracy on Test 0.4166666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 19/20 ****
3/33-(0.817)
18/33-(0.035)
Best accuracy on Test 0.5666666666666667

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 8
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(0.833)
30/33-(0.907)
12/33-(1.105)

=== Evaluating Model ===
Total valid loss 1.0493728717168171
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.42777777777777776

**** Epoch 0/20 ****
27/33-(0.958)
9/33-(1.285)
24/33-(0.989)
6/33-(1.027)

=== Evaluating Model ===
Total valid loss 1.0419342418511708
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.42777777777777776

**** Epoch 1/20 ****
21/33-(1.040)
3/33-(1.007)
18/33-(1.596)
0/33-(1.035)

=== Evaluating Model ===
Total valid loss 1.0591582854588826
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.46111111111111114

**** Epoch 2/20 ****
15/33-(1.093)
30/33-(1.243)
12/33-(1.082)

=== Evaluating Model ===
Total valid loss 1.0861199299494426
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.46111111111111114

**** Epoch 3/20 ****
27/33-(1.166)
9/33-(1.070)
24/33-(1.011)
6/33-(1.471)

=== Evaluating Model ===
Total valid loss 1.0406534522771835
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 4/20 ****
21/33-(1.141)
3/33-(1.118)
18/33-(1.170)
0/33-(1.018)

=== Evaluating Model ===
Total valid loss 1.2299694766600926
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5333333333333333

**** Epoch 5/20 ****
15/33-(0.929)
30/33-(0.562)
12/33-(0.932)
27/33-(1.074)

=== Evaluating Model ===
Total valid loss 1.1254985332489014
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5333333333333333

**** Epoch 6/20 ****
9/33-(0.729)
24/33-(0.810)
6/33-(0.683)

=== Evaluating Model ===
Total valid loss 1.0400674839814503
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 7/20 ****
21/33-(0.852)
3/33-(0.311)
18/33-(0.650)
0/33-(0.743)

=== Evaluating Model ===
Total valid loss 1.1523329466581345
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5444444444444444

**** Epoch 8/20 ****
15/33-(0.531)
30/33-(0.774)
12/33-(0.564)
27/33-(0.522)

=== Evaluating Model ===
Total valid loss 1.4375411073366802
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5444444444444444

**** Epoch 9/20 ****
9/33-(0.464)
24/33-(0.558)
6/33-(0.806)
21/33-(0.904)

=== Evaluating Model ===
Total valid loss 1.3570336153109868
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 10/20 ****
3/33-(0.831)
18/33-(0.732)
0/33-(0.630)

=== Evaluating Model ===
Total valid loss 1.5951823790868123
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.55

**** Epoch 11/20 ****
15/33-(0.213)
30/33-(1.724)
12/33-(0.353)
27/33-(0.402)

=== Evaluating Model ===
Total valid loss 1.4519529541333516
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.55

**** Epoch 12/20 ****
9/33-(0.797)
24/33-(0.319)
6/33-(0.659)
21/33-(0.228)

=== Evaluating Model ===
Total valid loss 1.9611016511917114
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.55

**** Epoch 13/20 ****
3/33-(0.237)
18/33-(0.145)
0/33-(0.108)
15/33-(1.151)

=== Evaluating Model ===
Total valid loss 2.5875245332717896
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.55

**** Epoch 14/20 ****
30/33-(1.598)
12/33-(0.086)
27/33-(0.524)

=== Evaluating Model ===
Total valid loss 2.295669903357824
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.55

**** Epoch 15/20 ****
9/33-(0.145)
24/33-(0.211)
6/33-(0.334)
21/33-(0.181)

=== Evaluating Model ===
Total valid loss 2.165844072898229
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.55

**** Epoch 16/20 ****
3/33-(0.081)
18/33-(1.669)
0/33-(0.754)
15/33-(0.338)

=== Evaluating Model ===
Total valid loss 2.3006093303362527
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.55

**** Epoch 17/20 ****
30/33-(0.313)
12/33-(0.249)
27/33-(0.338)

=== Evaluating Model ===
Total valid loss 3.0030501584211984
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.55

**** Epoch 18/20 ****
9/33-(0.212)
24/33-(0.461)
6/33-(0.256)
21/33-(0.530)

=== Evaluating Model ===
Total valid loss 2.4889804224173226
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.55

**** Epoch 19/20 ****
3/33-(0.144)
18/33-(1.010)
Best accuracy on Test 0.55

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 9
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
232
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.296)
30/33-(0.965)
12/33-(1.206)

=== Evaluating Model ===
Total valid loss 1.0846811185280483
accuracy on Test 0.3888888888888889
Best accuracy on Test 0.3888888888888889

**** Epoch 0/20 ****
27/33-(0.999)
9/33-(1.019)
24/33-(0.976)
6/33-(1.034)

=== Evaluating Model ===
Total valid loss 1.0863833377758663
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.4111111111111111

**** Epoch 1/20 ****
21/33-(1.163)
3/33-(0.970)
18/33-(1.170)
0/33-(1.060)

=== Evaluating Model ===
Total valid loss 1.0360241383314133
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.4888888888888889

**** Epoch 2/20 ****
15/33-(1.069)
30/33-(1.252)
12/33-(1.024)

=== Evaluating Model ===
Total valid loss 1.4724816878636677
accuracy on Test 0.39444444444444443
Best accuracy on Test 0.4888888888888889

**** Epoch 3/20 ****
27/33-(1.462)
9/33-(1.205)
24/33-(0.858)
6/33-(1.059)

=== Evaluating Model ===
Total valid loss 1.0228245904048283
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 4/20 ****
21/33-(1.326)
3/33-(0.710)
18/33-(1.023)
0/33-(1.012)

=== Evaluating Model ===
Total valid loss 1.0947337597608566
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5555555555555556

**** Epoch 5/20 ****
15/33-(0.903)
30/33-(0.823)
12/33-(0.683)
27/33-(0.939)

=== Evaluating Model ===
Total valid loss 1.0961867372194927
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5555555555555556

**** Epoch 6/20 ****
9/33-(1.085)
24/33-(0.718)
6/33-(0.529)

=== Evaluating Model ===
Total valid loss 1.319178616007169
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5555555555555556

**** Epoch 7/20 ****
21/33-(0.748)
3/33-(0.924)
18/33-(0.393)
0/33-(1.122)

=== Evaluating Model ===
Total valid loss 1.2503536691268284
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5555555555555556

**** Epoch 8/20 ****
15/33-(1.122)
30/33-(0.870)
12/33-(0.821)
27/33-(0.672)

=== Evaluating Model ===
Total valid loss 1.5031347125768661
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5555555555555556

**** Epoch 9/20 ****
9/33-(0.115)
24/33-(0.683)
6/33-(0.700)
21/33-(0.477)

=== Evaluating Model ===
Total valid loss 1.5748967776695888
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5555555555555556

**** Epoch 10/20 ****
3/33-(1.073)
18/33-(0.572)
0/33-(0.740)

=== Evaluating Model ===
Total valid loss 1.856248363852501
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5555555555555556

**** Epoch 11/20 ****
15/33-(0.537)
30/33-(0.291)
12/33-(1.355)
27/33-(0.385)

=== Evaluating Model ===
Total valid loss 2.0689432322978973
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5555555555555556

**** Epoch 12/20 ****
9/33-(0.476)
24/33-(0.198)
6/33-(0.407)
21/33-(0.743)

=== Evaluating Model ===
Total valid loss 2.3570048610369363
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.5555555555555556

**** Epoch 13/20 ****
3/33-(0.490)
18/33-(0.370)
0/33-(0.570)
15/33-(0.629)

=== Evaluating Model ===
Total valid loss 2.0745029350121817
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5555555555555556

**** Epoch 14/20 ****
30/33-(0.017)
12/33-(0.346)
27/33-(1.060)

=== Evaluating Model ===
Total valid loss 2.690926472345988
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5555555555555556

**** Epoch 15/20 ****
9/33-(0.326)
24/33-(0.144)
6/33-(0.121)
21/33-(0.105)

=== Evaluating Model ===
Total valid loss 3.397957851489385
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.5555555555555556

**** Epoch 16/20 ****
3/33-(0.598)
18/33-(0.533)
0/33-(0.450)
15/33-(0.267)

=== Evaluating Model ===
Total valid loss 2.5131733119487762
accuracy on Test 0.4222222222222222
Best accuracy on Test 0.5555555555555556

**** Epoch 17/20 ****
30/33-(0.109)
12/33-(0.177)
27/33-(0.083)

=== Evaluating Model ===
Total valid loss 3.3351074159145355
accuracy on Test 0.40555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 18/20 ****
9/33-(0.098)
24/33-(0.225)
6/33-(0.707)
21/33-(0.384)

=== Evaluating Model ===
Total valid loss 3.0021810233592987
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.5555555555555556

**** Epoch 19/20 ****
3/33-(0.275)
18/33-(0.535)
Best accuracy on Test 0.5555555555555556

Final k-fold valid -1.0
[-1, -1, -1, -1]
Final k-fold eval 0.5611111111111111
[0.5722222222222222, 0.5666666666666667, 0.55, 0.5555555555555556]
