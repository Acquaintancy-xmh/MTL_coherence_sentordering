Whole k-fold eval mode
Source domain: Yahoo, Target domain: Yahoo, Cur_fold 0
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(2.382)
30/33-(1.329)
12/33-(1.178)

=== Evaluating Model ===
Total valid loss 1.0795527795950572
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.43333333333333335

**** Epoch 0/20 ****
27/33-(1.337)
9/33-(1.300)
24/33-(0.947)
6/33-(1.176)

=== Evaluating Model ===
Total valid loss 1.016427939136823
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.45555555555555555

**** Epoch 1/20 ****
21/33-(1.157)
3/33-(1.346)
18/33-(1.201)
0/33-(1.350)

=== Evaluating Model ===
Total valid loss 1.0325356672207515
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5222222222222223

**** Epoch 2/20 ****
15/33-(1.497)
30/33-(0.831)
12/33-(0.943)

=== Evaluating Model ===
Total valid loss 0.9821131577094396
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 3/20 ****
27/33-(0.941)
9/33-(1.067)
24/33-(0.846)
6/33-(1.137)

=== Evaluating Model ===
Total valid loss 0.9863183423876762
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 4/20 ****
21/33-(0.117)
3/33-(1.174)
18/33-(1.403)
0/33-(0.992)

=== Evaluating Model ===
Total valid loss 1.1561141312122345
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.55

**** Epoch 5/20 ****
15/33-(0.964)
30/33-(1.483)
12/33-(0.911)
27/33-(1.062)

=== Evaluating Model ===
Total valid loss 1.0956088602542877
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.55

**** Epoch 6/20 ****
9/33-(1.410)
24/33-(1.199)
6/33-(0.914)

=== Evaluating Model ===
Total valid loss 0.9959059109290441
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.55

**** Epoch 7/20 ****
21/33-(1.049)
3/33-(0.691)
18/33-(0.930)
0/33-(0.936)

=== Evaluating Model ===
Total valid loss 1.0118484745423
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.55

**** Epoch 8/20 ****
15/33-(0.862)
30/33-(0.817)
12/33-(0.950)
27/33-(1.001)

=== Evaluating Model ===
Total valid loss 1.1128637393315632
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 9/20 ****
9/33-(1.022)
24/33-(1.138)
6/33-(0.894)
21/33-(0.679)

=== Evaluating Model ===
Total valid loss 1.0255888005097706
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5666666666666667

**** Epoch 10/20 ****
3/33-(0.690)
18/33-(0.914)
0/33-(0.681)

=== Evaluating Model ===
Total valid loss 0.9699980417887369
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5666666666666667

**** Epoch 11/20 ****
15/33-(0.915)
30/33-(1.104)
12/33-(0.991)
27/33-(0.611)

=== Evaluating Model ===
Total valid loss 1.1789640349646409
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5666666666666667

**** Epoch 12/20 ****
9/33-(1.564)
24/33-(0.782)
6/33-(1.014)
21/33-(0.682)

=== Evaluating Model ===
Total valid loss 1.5226162150502205
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 13/20 ****
3/33-(1.376)
18/33-(0.829)
0/33-(0.781)
15/33-(0.759)

=== Evaluating Model ===
Total valid loss 1.1155982961257298
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 14/20 ****
30/33-(0.469)
12/33-(0.591)
27/33-(0.641)

=== Evaluating Model ===
Total valid loss 1.1506015559037526
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 15/20 ****
9/33-(0.990)
24/33-(0.715)
6/33-(0.427)
21/33-(0.632)

=== Evaluating Model ===
Total valid loss 1.2313242852687836
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5666666666666667

**** Epoch 16/20 ****
3/33-(0.588)
18/33-(1.189)
0/33-(0.672)
15/33-(0.443)

=== Evaluating Model ===
Total valid loss 1.2333364511529605
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 17/20 ****
30/33-(0.805)
12/33-(0.397)
27/33-(0.505)

=== Evaluating Model ===
Total valid loss 1.383837215602398
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 18/20 ****
9/33-(0.730)
24/33-(0.342)
6/33-(0.433)
21/33-(0.393)

=== Evaluating Model ===
Total valid loss 1.585313469171524
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5722222222222222

**** Epoch 19/20 ****
3/33-(0.465)
18/33-(0.569)
Best accuracy on Test 0.5722222222222222

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 1
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(2.214)
30/33-(1.612)
12/33-(1.381)

=== Evaluating Model ===
Total valid loss 1.0674028148253758
accuracy on Test 0.4166666666666667
Best accuracy on Test 0.4166666666666667

**** Epoch 0/20 ****
27/33-(1.361)
9/33-(1.304)
24/33-(1.181)
6/33-(1.346)

=== Evaluating Model ===
Total valid loss 1.1247078130642574
accuracy on Test 0.39444444444444443
Best accuracy on Test 0.4166666666666667

**** Epoch 1/20 ****
21/33-(1.234)
3/33-(1.030)
18/33-(0.978)
0/33-(1.024)

=== Evaluating Model ===
Total valid loss 1.266317903995514
accuracy on Test 0.4166666666666667
Best accuracy on Test 0.4166666666666667

**** Epoch 2/20 ****
15/33-(1.370)
30/33-(0.990)
12/33-(1.025)

=== Evaluating Model ===
Total valid loss 1.0245283544063568
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.4888888888888889

**** Epoch 3/20 ****
27/33-(0.852)
9/33-(1.177)
24/33-(1.117)
6/33-(0.925)

=== Evaluating Model ===
Total valid loss 1.1270469725131989
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.49444444444444446

**** Epoch 4/20 ****
21/33-(1.379)
3/33-(1.173)
18/33-(1.012)
0/33-(1.076)

=== Evaluating Model ===
Total valid loss 1.0251464247703552
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5277777777777778

**** Epoch 5/20 ****
15/33-(0.996)
30/33-(0.903)
12/33-(0.686)
27/33-(0.897)

=== Evaluating Model ===
Total valid loss 1.0794456551472347
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 6/20 ****
9/33-(0.826)
24/33-(0.988)
6/33-(1.268)

=== Evaluating Model ===
Total valid loss 1.1820930689573288
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.5333333333333333

**** Epoch 7/20 ****
21/33-(1.006)
3/33-(0.749)
18/33-(1.026)
0/33-(1.804)

=== Evaluating Model ===
Total valid loss 1.1807555158933003
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5333333333333333

**** Epoch 8/20 ****
15/33-(0.925)
30/33-(0.842)
12/33-(0.774)
27/33-(0.616)

=== Evaluating Model ===
Total valid loss 1.1608796765406926
accuracy on Test 0.5
Best accuracy on Test 0.5333333333333333

**** Epoch 9/20 ****
9/33-(1.379)
24/33-(0.574)
6/33-(0.741)
21/33-(0.524)

=== Evaluating Model ===
Total valid loss 1.4343333045641582
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5333333333333333

**** Epoch 10/20 ****
3/33-(0.553)
18/33-(1.197)
0/33-(0.692)

=== Evaluating Model ===
Total valid loss 1.3437422066926956
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5333333333333333

**** Epoch 11/20 ****
15/33-(0.459)
30/33-(0.574)
12/33-(0.617)
27/33-(0.397)

=== Evaluating Model ===
Total valid loss 1.4314023107290268
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 12/20 ****
9/33-(0.595)
24/33-(0.727)
6/33-(0.422)
21/33-(0.551)

=== Evaluating Model ===
Total valid loss 1.797835851709048
accuracy on Test 0.5
Best accuracy on Test 0.5388888888888889

**** Epoch 13/20 ****
3/33-(0.488)
18/33-(0.603)
0/33-(0.353)
15/33-(0.689)

=== Evaluating Model ===
Total valid loss 2.231404850880305
accuracy on Test 0.5
Best accuracy on Test 0.5388888888888889

**** Epoch 14/20 ****
30/33-(0.179)
12/33-(0.195)
27/33-(0.575)

=== Evaluating Model ===
Total valid loss 1.9823364814122517
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5388888888888889

**** Epoch 15/20 ****
9/33-(0.468)
24/33-(0.454)
6/33-(0.168)
21/33-(0.550)

=== Evaluating Model ===
Total valid loss 2.3266851206620536
accuracy on Test 0.45
Best accuracy on Test 0.5388888888888889

**** Epoch 16/20 ****
3/33-(0.710)
18/33-(0.236)
0/33-(0.356)
15/33-(0.663)

=== Evaluating Model ===
Total valid loss 2.4040998816490173
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.5388888888888889

**** Epoch 17/20 ****
30/33-(0.465)
12/33-(0.161)
27/33-(0.165)

=== Evaluating Model ===
Total valid loss 2.3155858715375266
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5388888888888889

**** Epoch 18/20 ****
9/33-(0.162)
24/33-(0.324)
6/33-(0.236)
21/33-(0.469)

=== Evaluating Model ===
Total valid loss 3.4961014688014984
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 19/20 ****
3/33-(0.202)
18/33-(0.229)
Best accuracy on Test 0.5388888888888889

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 2
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.808)
30/33-(1.113)
12/33-(1.295)

=== Evaluating Model ===
Total valid loss 1.1668859124183655
accuracy on Test 0.3388888888888889
Best accuracy on Test 0.3388888888888889

**** Epoch 0/20 ****
27/33-(1.281)
9/33-(1.065)
24/33-(1.292)
6/33-(1.091)

=== Evaluating Model ===
Total valid loss 1.0737625658512115
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.4722222222222222

**** Epoch 1/20 ****
21/33-(1.038)
3/33-(0.990)
18/33-(0.907)
0/33-(0.980)

=== Evaluating Model ===
Total valid loss 1.0487396121025085
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.4888888888888889

**** Epoch 2/20 ****
15/33-(1.225)
30/33-(1.276)
12/33-(1.461)

=== Evaluating Model ===
Total valid loss 1.1096925288438797
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.4888888888888889

**** Epoch 3/20 ****
27/33-(1.411)
9/33-(1.044)
24/33-(0.842)
6/33-(1.261)

=== Evaluating Model ===
Total valid loss 1.018969714641571
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.49444444444444446

**** Epoch 4/20 ****
21/33-(0.702)
3/33-(1.207)
18/33-(1.342)
0/33-(1.052)

=== Evaluating Model ===
Total valid loss 1.1571068912744522
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 5/20 ****
15/33-(1.739)
30/33-(0.764)
12/33-(1.040)
27/33-(0.907)

=== Evaluating Model ===
Total valid loss 1.1552221427361171
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 6/20 ****
9/33-(0.750)
24/33-(0.626)
6/33-(0.554)

=== Evaluating Model ===
Total valid loss 1.1510101358095806
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5333333333333333

**** Epoch 7/20 ****
21/33-(0.724)
3/33-(1.227)
18/33-(0.639)
0/33-(0.437)

=== Evaluating Model ===
Total valid loss 1.2405096540848415
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 8/20 ****
15/33-(0.992)
30/33-(0.651)
12/33-(1.033)
27/33-(0.693)

=== Evaluating Model ===
Total valid loss 1.3264153003692627
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 9/20 ****
9/33-(1.135)
24/33-(0.777)
6/33-(0.640)
21/33-(0.526)

=== Evaluating Model ===
Total valid loss 1.4930482655763626
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5333333333333333

**** Epoch 10/20 ****
3/33-(1.160)
18/33-(0.650)
0/33-(0.684)

=== Evaluating Model ===
Total valid loss 1.5674749215443928
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 11/20 ****
15/33-(0.475)
30/33-(0.331)
12/33-(0.455)
27/33-(0.853)

=== Evaluating Model ===
Total valid loss 1.9517703205347061
accuracy on Test 0.45
Best accuracy on Test 0.5444444444444444

**** Epoch 12/20 ****
9/33-(0.855)
24/33-(0.634)
6/33-(0.815)
21/33-(0.328)

=== Evaluating Model ===
Total valid loss 1.9283128480116527
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5444444444444444

**** Epoch 13/20 ****
3/33-(0.768)
18/33-(0.691)
0/33-(0.628)
15/33-(0.688)

=== Evaluating Model ===
Total valid loss 1.9528312881787617
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5444444444444444

**** Epoch 14/20 ****
30/33-(0.540)
12/33-(0.415)
27/33-(0.658)

=== Evaluating Model ===
Total valid loss 1.8186694085597992
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5444444444444444

**** Epoch 15/20 ****
9/33-(0.318)
24/33-(0.379)
6/33-(1.358)
21/33-(0.578)

=== Evaluating Model ===
Total valid loss 2.2364597221215567
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5444444444444444

**** Epoch 16/20 ****
3/33-(0.430)
18/33-(0.191)
0/33-(0.250)
15/33-(0.224)

=== Evaluating Model ===
Total valid loss 2.0688030620416007
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5444444444444444

**** Epoch 17/20 ****
30/33-(0.480)
12/33-(0.103)
27/33-(0.761)

=== Evaluating Model ===
Total valid loss 2.7267733017603555
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5444444444444444

**** Epoch 18/20 ****
9/33-(0.193)
24/33-(0.226)
6/33-(0.190)
21/33-(0.087)

=== Evaluating Model ===
Total valid loss 2.949837177991867
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5444444444444444

**** Epoch 19/20 ****
3/33-(0.103)
18/33-(0.297)
Best accuracy on Test 0.5444444444444444

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 3
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.878)
30/33-(1.543)
12/33-(1.186)

=== Evaluating Model ===
Total valid loss 1.07264177997907
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.4111111111111111

**** Epoch 0/20 ****
27/33-(1.427)
9/33-(1.422)
24/33-(1.062)
6/33-(1.163)

=== Evaluating Model ===
Total valid loss 1.075202946861585
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.43333333333333335

**** Epoch 1/20 ****
21/33-(1.172)
3/33-(1.849)
18/33-(1.228)
0/33-(1.171)

=== Evaluating Model ===
Total valid loss 1.030952403942744
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.4722222222222222

**** Epoch 2/20 ****
15/33-(1.117)
30/33-(1.214)
12/33-(1.067)

=== Evaluating Model ===
Total valid loss 1.0297167698542278
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5111111111111111

**** Epoch 3/20 ****
27/33-(1.147)
9/33-(1.103)
24/33-(0.937)
6/33-(1.333)

=== Evaluating Model ===
Total valid loss 1.1860230167706807
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5111111111111111

**** Epoch 4/20 ****
21/33-(0.784)
3/33-(1.097)
18/33-(0.861)
0/33-(0.907)

=== Evaluating Model ===
Total valid loss 1.176554262638092
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5111111111111111

**** Epoch 5/20 ****
15/33-(1.348)
30/33-(0.852)
12/33-(1.096)
27/33-(0.805)

=== Evaluating Model ===
Total valid loss 1.0221042881409328
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 6/20 ****
9/33-(0.766)
24/33-(0.775)
6/33-(0.884)

=== Evaluating Model ===
Total valid loss 1.0134487251440685
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 7/20 ****
21/33-(1.004)
3/33-(1.190)
18/33-(0.640)
0/33-(0.857)

=== Evaluating Model ===
Total valid loss 1.1157226463158925
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5611111111111111

**** Epoch 8/20 ****
15/33-(1.075)
30/33-(0.748)
12/33-(1.018)
27/33-(0.988)

=== Evaluating Model ===
Total valid loss 1.1260614693164825
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5611111111111111

**** Epoch 9/20 ****
9/33-(0.849)
24/33-(0.541)
6/33-(1.091)
21/33-(0.578)

=== Evaluating Model ===
Total valid loss 1.315076877673467
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 10/20 ****
3/33-(0.680)
18/33-(1.000)
0/33-(0.922)

=== Evaluating Model ===
Total valid loss 1.013638213276863
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5611111111111111

**** Epoch 11/20 ****
15/33-(0.750)
30/33-(0.630)
12/33-(0.573)
27/33-(0.816)

=== Evaluating Model ===
Total valid loss 1.7104135950406392
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5611111111111111

**** Epoch 12/20 ****
9/33-(0.515)
24/33-(0.666)
6/33-(0.952)
21/33-(0.715)

=== Evaluating Model ===
Total valid loss 1.322755788763364
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 13/20 ****
3/33-(0.703)
18/33-(0.593)
0/33-(0.845)
15/33-(0.578)

=== Evaluating Model ===
Total valid loss 1.478181277712186
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 14/20 ****
30/33-(0.650)
12/33-(0.557)
27/33-(0.619)

=== Evaluating Model ===
Total valid loss 1.6945889939864476
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 15/20 ****
9/33-(0.748)
24/33-(1.042)
6/33-(0.532)
21/33-(0.844)

=== Evaluating Model ===
Total valid loss 1.279102881749471
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5611111111111111

**** Epoch 16/20 ****
3/33-(0.658)
18/33-(0.467)
0/33-(0.668)
15/33-(0.480)

=== Evaluating Model ===
Total valid loss 1.8576568961143494
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 17/20 ****
30/33-(0.384)
12/33-(0.784)
27/33-(0.140)

=== Evaluating Model ===
Total valid loss 2.0046062618494034
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5611111111111111

**** Epoch 18/20 ****
9/33-(1.012)
24/33-(0.436)
6/33-(0.587)
21/33-(0.396)

=== Evaluating Model ===
Total valid loss 2.295362263917923
accuracy on Test 0.5
Best accuracy on Test 0.5611111111111111

**** Epoch 19/20 ****
3/33-(0.642)
18/33-(1.169)
Best accuracy on Test 0.5611111111111111

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 4
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.848)
30/33-(1.659)
12/33-(1.274)

=== Evaluating Model ===
Total valid loss 1.2273660252491634
accuracy on Test 0.39444444444444443
Best accuracy on Test 0.39444444444444443

**** Epoch 0/20 ****
27/33-(1.427)
9/33-(1.425)
24/33-(1.049)
6/33-(1.660)

=== Evaluating Model ===
Total valid loss 1.1245527565479279
accuracy on Test 0.3277777777777778
Best accuracy on Test 0.39444444444444443

**** Epoch 1/20 ****
21/33-(1.246)
3/33-(1.052)
18/33-(1.112)
0/33-(1.157)

=== Evaluating Model ===
Total valid loss 1.2342098206281662
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.4666666666666667

**** Epoch 2/20 ****
15/33-(0.961)
30/33-(0.937)
12/33-(0.901)

=== Evaluating Model ===
Total valid loss 1.0569348533948262
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.4666666666666667

**** Epoch 3/20 ****
27/33-(1.080)
9/33-(1.110)
24/33-(0.887)
6/33-(1.313)

=== Evaluating Model ===
Total valid loss 1.0669289728005726
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5111111111111111

**** Epoch 4/20 ****
21/33-(2.736)
3/33-(0.811)
18/33-(0.801)
0/33-(0.952)

=== Evaluating Model ===
Total valid loss 1.1154259343942006
accuracy on Test 0.5
Best accuracy on Test 0.5111111111111111

**** Epoch 5/20 ****
15/33-(0.851)
30/33-(0.661)
12/33-(1.144)
27/33-(0.784)

=== Evaluating Model ===
Total valid loss 1.0967457940181096
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 6/20 ****
9/33-(0.585)
24/33-(0.986)
6/33-(1.082)

=== Evaluating Model ===
Total valid loss 0.9895656406879425
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 7/20 ****
21/33-(0.855)
3/33-(1.101)
18/33-(0.582)
0/33-(0.768)

=== Evaluating Model ===
Total valid loss 1.1365578919649124
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 8/20 ****
15/33-(0.991)
30/33-(0.721)
12/33-(0.649)
27/33-(0.729)

=== Evaluating Model ===
Total valid loss 1.0382546335458755
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 9/20 ****
9/33-(0.476)
24/33-(0.541)
6/33-(0.439)
21/33-(0.855)

=== Evaluating Model ===
Total valid loss 1.5126900176207225
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5611111111111111

**** Epoch 10/20 ****
3/33-(0.728)
18/33-(0.652)
0/33-(0.385)

=== Evaluating Model ===
Total valid loss 1.4449453850587208
accuracy on Test 0.5
Best accuracy on Test 0.5611111111111111

**** Epoch 11/20 ****
15/33-(1.166)
30/33-(0.987)
12/33-(0.426)
27/33-(0.540)

=== Evaluating Model ===
Total valid loss 1.5669427414735158
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 12/20 ****
9/33-(0.710)
24/33-(0.631)
6/33-(0.718)
21/33-(0.351)

=== Evaluating Model ===
Total valid loss 2.327838212251663
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 13/20 ****
3/33-(0.276)
18/33-(0.310)
0/33-(0.787)
15/33-(0.594)

=== Evaluating Model ===
Total valid loss 2.1866460740566254
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 14/20 ****
30/33-(0.828)
12/33-(0.552)
27/33-(0.343)

=== Evaluating Model ===
Total valid loss 1.948508749405543
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 15/20 ****
9/33-(0.420)
24/33-(0.352)
6/33-(0.083)
21/33-(0.179)

=== Evaluating Model ===
Total valid loss 3.013304809729258
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 16/20 ****
3/33-(0.566)
18/33-(1.068)
0/33-(0.128)
15/33-(0.254)

=== Evaluating Model ===
Total valid loss 2.5282542606194816
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 17/20 ****
30/33-(0.217)
12/33-(0.368)
27/33-(0.270)

=== Evaluating Model ===
Total valid loss 3.421218583981196
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5611111111111111

**** Epoch 18/20 ****
9/33-(0.372)
24/33-(0.472)
6/33-(0.604)
21/33-(0.606)

=== Evaluating Model ===
Total valid loss 2.162054548660914
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 19/20 ****
3/33-(0.346)
18/33-(0.315)
Best accuracy on Test 0.5611111111111111

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 5
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.873)
30/33-(1.328)
12/33-(1.402)

=== Evaluating Model ===
Total valid loss 1.1458717733621597
accuracy on Test 0.4
Best accuracy on Test 0.4

**** Epoch 0/20 ****
27/33-(1.312)
9/33-(1.616)
24/33-(1.338)
6/33-(1.039)

=== Evaluating Model ===
Total valid loss 1.0458530137936275
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.4444444444444444

**** Epoch 1/20 ****
21/33-(1.185)
3/33-(0.954)
18/33-(1.465)
0/33-(1.279)

=== Evaluating Model ===
Total valid loss 1.2812858074903488
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.4444444444444444

**** Epoch 2/20 ****
15/33-(0.855)
30/33-(0.802)
12/33-(1.096)

=== Evaluating Model ===
Total valid loss 1.0266201943159103
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5222222222222223

**** Epoch 3/20 ****
27/33-(0.967)
9/33-(0.875)
24/33-(0.939)
6/33-(0.951)

=== Evaluating Model ===
Total valid loss 1.2546545167764027
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5222222222222223

**** Epoch 4/20 ****
21/33-(1.631)
3/33-(0.628)
18/33-(0.883)
0/33-(0.970)

=== Evaluating Model ===
Total valid loss 1.2142592469851177
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5222222222222223

**** Epoch 5/20 ****
15/33-(0.707)
30/33-(1.319)
12/33-(0.877)
27/33-(1.023)

=== Evaluating Model ===
Total valid loss 1.037288432319959
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 6/20 ****
9/33-(0.738)
24/33-(1.081)
6/33-(0.947)

=== Evaluating Model ===
Total valid loss 1.3284871677557628
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5388888888888889

**** Epoch 7/20 ****
21/33-(1.367)
3/33-(0.863)
18/33-(0.685)
0/33-(0.819)

=== Evaluating Model ===
Total valid loss 1.1994159022967021
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5388888888888889

**** Epoch 8/20 ****
15/33-(0.750)
30/33-(1.102)
12/33-(0.717)
27/33-(0.711)

=== Evaluating Model ===
Total valid loss 1.4213166286547978
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5388888888888889

**** Epoch 9/20 ****
9/33-(1.581)
24/33-(0.630)
6/33-(0.961)
21/33-(0.763)

=== Evaluating Model ===
Total valid loss 1.3240378697713215
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5388888888888889

**** Epoch 10/20 ****
3/33-(0.811)
18/33-(1.340)
0/33-(0.488)

=== Evaluating Model ===
Total valid loss 1.3705063660939534
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5388888888888889

**** Epoch 11/20 ****
15/33-(0.872)
30/33-(0.660)
12/33-(0.653)
27/33-(0.841)

=== Evaluating Model ===
Total valid loss 1.4126569281021755
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5388888888888889

**** Epoch 12/20 ****
9/33-(0.734)
24/33-(1.318)
6/33-(0.555)
21/33-(0.637)

=== Evaluating Model ===
Total valid loss 1.2960341771443684
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5388888888888889

**** Epoch 13/20 ****
3/33-(0.687)
18/33-(0.840)
0/33-(0.749)
15/33-(0.493)

=== Evaluating Model ===
Total valid loss 1.4537514448165894
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5388888888888889

**** Epoch 14/20 ****
30/33-(0.071)
12/33-(0.284)
27/33-(0.920)

=== Evaluating Model ===
Total valid loss 1.8119177917639415
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5388888888888889

**** Epoch 15/20 ****
9/33-(0.627)
24/33-(0.650)
6/33-(0.547)
21/33-(0.517)

=== Evaluating Model ===
Total valid loss 1.9729788998762767
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5388888888888889

**** Epoch 16/20 ****
3/33-(1.253)
18/33-(0.555)
0/33-(0.317)
15/33-(0.827)

=== Evaluating Model ===
Total valid loss 1.8355817993481953
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5388888888888889

**** Epoch 17/20 ****
30/33-(0.734)
12/33-(0.525)
27/33-(0.603)

=== Evaluating Model ===
Total valid loss 2.5622642834981284
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5388888888888889

**** Epoch 18/20 ****
9/33-(0.516)
24/33-(0.899)
6/33-(0.369)
21/33-(1.444)

=== Evaluating Model ===
Total valid loss 1.5082881202300389
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.5388888888888889

**** Epoch 19/20 ****
3/33-(0.353)
18/33-(0.555)
Best accuracy on Test 0.5388888888888889

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 6
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.583)
30/33-(1.521)
12/33-(1.318)

=== Evaluating Model ===
Total valid loss 1.0550585836172104
accuracy on Test 0.4166666666666667
Best accuracy on Test 0.4166666666666667

**** Epoch 0/20 ****
27/33-(1.461)
9/33-(1.000)
24/33-(1.399)
6/33-(1.312)

=== Evaluating Model ===
Total valid loss 1.1134530901908875
accuracy on Test 0.4222222222222222
Best accuracy on Test 0.4222222222222222

**** Epoch 1/20 ****
21/33-(1.140)
3/33-(1.147)
18/33-(1.196)
0/33-(1.112)

=== Evaluating Model ===
Total valid loss 1.0285345315933228
accuracy on Test 0.5
Best accuracy on Test 0.5

**** Epoch 2/20 ****
15/33-(1.299)
30/33-(0.920)
12/33-(1.455)

=== Evaluating Model ===
Total valid loss 1.060401201248169
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5

**** Epoch 3/20 ****
27/33-(1.384)
9/33-(1.350)
24/33-(0.884)
6/33-(0.957)

=== Evaluating Model ===
Total valid loss 1.1086515386899312
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5

**** Epoch 4/20 ****
21/33-(0.829)
3/33-(1.150)
18/33-(0.902)
0/33-(0.886)

=== Evaluating Model ===
Total valid loss 1.1076539556185405
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 5/20 ****
15/33-(0.933)
30/33-(1.161)
12/33-(0.714)
27/33-(0.944)

=== Evaluating Model ===
Total valid loss 1.0862472901741664
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5388888888888889

**** Epoch 6/20 ****
9/33-(0.817)
24/33-(0.717)
6/33-(0.983)

=== Evaluating Model ===
Total valid loss 1.3707539588212967
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 7/20 ****
21/33-(0.938)
3/33-(0.565)
18/33-(0.356)
0/33-(0.698)

=== Evaluating Model ===
Total valid loss 1.3741234143575032
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 8/20 ****
15/33-(0.908)
30/33-(0.626)
12/33-(0.765)
27/33-(0.710)

=== Evaluating Model ===
Total valid loss 2.003103787700335
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 9/20 ****
9/33-(0.880)
24/33-(0.932)
6/33-(0.558)
21/33-(0.877)

=== Evaluating Model ===
Total valid loss 1.4151962598164876
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5666666666666667

**** Epoch 10/20 ****
3/33-(0.477)
18/33-(0.526)
0/33-(0.881)

=== Evaluating Model ===
Total valid loss 1.6606566856304805
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 11/20 ****
15/33-(0.842)
30/33-(0.324)
12/33-(0.417)
27/33-(0.582)

=== Evaluating Model ===
Total valid loss 1.9097105065981548
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 12/20 ****
9/33-(0.302)
24/33-(0.224)
6/33-(0.791)
21/33-(0.314)

=== Evaluating Model ===
Total valid loss 1.682233562072118
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.5666666666666667

**** Epoch 13/20 ****
3/33-(0.514)
18/33-(0.319)
0/33-(0.786)
15/33-(0.251)

=== Evaluating Model ===
Total valid loss 1.6881474206844966
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5666666666666667

**** Epoch 14/20 ****
30/33-(0.992)
12/33-(0.272)
27/33-(0.158)

=== Evaluating Model ===
Total valid loss 3.076280723015467
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5666666666666667

**** Epoch 15/20 ****
9/33-(0.366)
24/33-(0.466)
6/33-(0.522)
21/33-(0.405)

=== Evaluating Model ===
Total valid loss 2.296580741802851
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5666666666666667

**** Epoch 16/20 ****
3/33-(0.450)
18/33-(0.155)
0/33-(0.351)
15/33-(0.095)

=== Evaluating Model ===
Total valid loss 3.1214772860209146
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5666666666666667

**** Epoch 17/20 ****
30/33-(0.333)
12/33-(0.216)
27/33-(0.492)

=== Evaluating Model ===
Total valid loss 2.342238316933314
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5666666666666667

**** Epoch 18/20 ****
9/33-(0.656)
24/33-(0.255)
6/33-(0.416)
21/33-(0.089)

=== Evaluating Model ===
Total valid loss 2.145293007294337
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.5666666666666667

**** Epoch 19/20 ****
3/33-(0.249)
18/33-(0.832)
Best accuracy on Test 0.5666666666666667

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 7
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(2.082)
30/33-(1.226)
12/33-(1.666)

=== Evaluating Model ===
Total valid loss 1.1481307744979858
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.43333333333333335

**** Epoch 0/20 ****
27/33-(1.394)
9/33-(1.179)
24/33-(1.079)
6/33-(1.009)

=== Evaluating Model ===
Total valid loss 1.0401337146759033
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.43333333333333335

**** Epoch 1/20 ****
21/33-(1.013)
3/33-(1.037)
18/33-(0.773)
0/33-(0.999)

=== Evaluating Model ===
Total valid loss 1.0340556651353836
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5222222222222223

**** Epoch 2/20 ****
15/33-(1.156)
30/33-(1.435)
12/33-(1.042)

=== Evaluating Model ===
Total valid loss 1.5381133755048115
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5222222222222223

**** Epoch 3/20 ****
27/33-(1.047)
9/33-(0.763)
24/33-(0.861)
6/33-(0.977)

=== Evaluating Model ===
Total valid loss 1.0542056908210118
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5222222222222223

**** Epoch 4/20 ****
21/33-(0.476)
3/33-(0.819)
18/33-(0.926)
0/33-(0.967)

=== Evaluating Model ===
Total valid loss 1.0356837660074234
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5222222222222223

**** Epoch 5/20 ****
15/33-(0.970)
30/33-(0.864)
12/33-(0.968)
27/33-(0.627)

=== Evaluating Model ===
Total valid loss 1.2861447483301163
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 6/20 ****
9/33-(0.944)
24/33-(0.998)
6/33-(1.243)

=== Evaluating Model ===
Total valid loss 1.2867116332054138
accuracy on Test 0.5
Best accuracy on Test 0.5388888888888889

**** Epoch 7/20 ****
21/33-(0.765)
3/33-(1.309)
18/33-(0.848)
0/33-(0.924)

=== Evaluating Model ===
Total valid loss 1.0779959311087925
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5388888888888889

**** Epoch 8/20 ****
15/33-(1.099)
30/33-(0.778)
12/33-(1.310)
27/33-(0.790)

=== Evaluating Model ===
Total valid loss 1.2643668154875438
accuracy on Test 0.5
Best accuracy on Test 0.5388888888888889

**** Epoch 9/20 ****
9/33-(0.797)
24/33-(0.308)
6/33-(0.822)
21/33-(0.478)

=== Evaluating Model ===
Total valid loss 1.3225068400303523
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5388888888888889

**** Epoch 10/20 ****
3/33-(0.747)
18/33-(0.582)
0/33-(0.693)

=== Evaluating Model ===
Total valid loss 1.155294954776764
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 11/20 ****
15/33-(1.205)
30/33-(0.917)
12/33-(0.939)
27/33-(0.671)

=== Evaluating Model ===
Total valid loss 1.1791457831859589
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 12/20 ****
9/33-(0.980)
24/33-(0.602)
6/33-(1.053)
21/33-(0.640)

=== Evaluating Model ===
Total valid loss 1.2806072334448497
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5611111111111111

**** Epoch 13/20 ****
3/33-(0.752)
18/33-(1.232)
0/33-(0.617)
15/33-(0.672)

=== Evaluating Model ===
Total valid loss 1.5086500644683838
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 14/20 ****
30/33-(1.062)
12/33-(0.870)
27/33-(0.596)

=== Evaluating Model ===
Total valid loss 1.9237224211295445
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5611111111111111

**** Epoch 15/20 ****
9/33-(0.722)
24/33-(0.736)
6/33-(0.336)
21/33-(0.973)

=== Evaluating Model ===
Total valid loss 2.219410161177317
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 16/20 ****
3/33-(1.035)
18/33-(0.587)
0/33-(1.191)
15/33-(0.752)

=== Evaluating Model ===
Total valid loss 1.4637652337551117
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5611111111111111

**** Epoch 17/20 ****
30/33-(0.797)
12/33-(0.642)
27/33-(0.617)

=== Evaluating Model ===
Total valid loss 1.9625207483768463
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 18/20 ****
9/33-(0.668)
24/33-(0.406)
6/33-(0.851)
21/33-(1.013)

=== Evaluating Model ===
Total valid loss 3.1814406414826712
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5611111111111111

**** Epoch 19/20 ****
3/33-(0.421)
18/33-(0.953)
Best accuracy on Test 0.5611111111111111

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 8
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
172.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.806)
30/33-(1.933)
12/33-(1.389)

=== Evaluating Model ===
Total valid loss 1.0503400911887486
accuracy on Test 0.4222222222222222
Best accuracy on Test 0.4222222222222222

**** Epoch 0/20 ****
27/33-(1.088)
9/33-(1.413)
24/33-(0.995)
6/33-(1.057)

=== Evaluating Model ===
Total valid loss 1.0627505381902058
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.4222222222222222

**** Epoch 1/20 ****
21/33-(1.111)
3/33-(1.013)
18/33-(1.389)
0/33-(1.038)

=== Evaluating Model ===
Total valid loss 1.2521803677082062
accuracy on Test 0.45
Best accuracy on Test 0.45

**** Epoch 2/20 ****
15/33-(0.929)
30/33-(1.668)
12/33-(1.047)

=== Evaluating Model ===
Total valid loss 1.043418029944102
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5166666666666667

**** Epoch 3/20 ****
27/33-(0.905)
9/33-(0.741)
24/33-(1.018)
6/33-(1.342)

=== Evaluating Model ===
Total valid loss 1.1774044533570607
accuracy on Test 0.5
Best accuracy on Test 0.5166666666666667

**** Epoch 4/20 ****
21/33-(0.943)
3/33-(0.829)
18/33-(1.173)
0/33-(1.296)

=== Evaluating Model ===
Total valid loss 1.0874790499607723
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 5/20 ****
15/33-(1.076)
30/33-(0.707)
12/33-(0.872)
27/33-(0.746)

=== Evaluating Model ===
Total valid loss 1.108121986190478
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5388888888888889

**** Epoch 6/20 ****
9/33-(0.545)
24/33-(1.387)
6/33-(1.267)

=== Evaluating Model ===
Total valid loss 1.2823865463336308
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5388888888888889

**** Epoch 7/20 ****
21/33-(0.819)
3/33-(0.691)
18/33-(1.932)
0/33-(0.854)

=== Evaluating Model ===
Total valid loss 1.1858884940544765
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 8/20 ****
15/33-(2.248)
30/33-(1.140)
12/33-(1.617)
27/33-(0.687)

=== Evaluating Model ===
Total valid loss 1.1545666257540386
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.55

**** Epoch 9/20 ****
9/33-(0.742)
24/33-(1.164)
6/33-(0.600)
21/33-(0.662)

=== Evaluating Model ===
Total valid loss 1.1727515161037445
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.55

**** Epoch 10/20 ****
3/33-(0.934)
18/33-(1.040)
0/33-(0.661)

=== Evaluating Model ===
Total valid loss 1.8895514160394669
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.55

**** Epoch 11/20 ****
15/33-(2.102)
30/33-(1.199)
12/33-(0.682)
27/33-(0.706)

=== Evaluating Model ===
Total valid loss 1.2530358185370762
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.55

**** Epoch 12/20 ****
9/33-(1.137)
24/33-(0.436)
6/33-(0.601)
21/33-(0.831)

=== Evaluating Model ===
Total valid loss 1.8369258046150208
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.55

**** Epoch 13/20 ****
3/33-(0.986)
18/33-(0.838)
0/33-(0.649)
15/33-(0.484)

=== Evaluating Model ===
Total valid loss 1.9811581720908482
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.55

**** Epoch 14/20 ****
30/33-(0.597)
12/33-(0.634)
27/33-(0.425)

=== Evaluating Model ===
Total valid loss 2.569409489631653
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.55

**** Epoch 15/20 ****
9/33-(1.368)
24/33-(1.216)
6/33-(0.658)
21/33-(0.919)

=== Evaluating Model ===
Total valid loss 1.9630091687043507
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.55

**** Epoch 16/20 ****
3/33-(0.603)
18/33-(0.684)
0/33-(0.215)
15/33-(0.176)

=== Evaluating Model ===
Total valid loss 2.304610421260198
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.55

**** Epoch 17/20 ****
30/33-(0.809)
12/33-(0.121)
27/33-(1.142)

=== Evaluating Model ===
Total valid loss 2.5585283736387887
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.55

**** Epoch 18/20 ****
9/33-(0.214)
24/33-(0.736)
6/33-(0.147)
21/33-(0.666)

=== Evaluating Model ===
Total valid loss 2.3020544399817786
accuracy on Test 0.5
Best accuracy on Test 0.55

**** Epoch 19/20 ****
3/33-(0.276)
18/33-(0.362)
Best accuracy on Test 0.55

Source domain: Yahoo, Target domain: Yahoo, Cur_fold 9
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
232
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.996)
30/33-(1.201)
12/33-(1.024)

=== Evaluating Model ===
Total valid loss 1.1120933542648952
accuracy on Test 0.37777777777777777
Best accuracy on Test 0.37777777777777777

**** Epoch 0/20 ****
27/33-(1.322)
9/33-(1.179)
24/33-(1.058)
6/33-(1.057)

=== Evaluating Model ===
Total valid loss 1.2088401814301808
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.4111111111111111

**** Epoch 1/20 ****
21/33-(1.157)
3/33-(1.426)
18/33-(1.375)
0/33-(1.056)

=== Evaluating Model ===
Total valid loss 1.2350138773520787
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.4111111111111111

**** Epoch 2/20 ****
15/33-(0.862)
30/33-(1.067)
12/33-(1.004)

=== Evaluating Model ===
Total valid loss 1.066929002602895
accuracy on Test 0.4
Best accuracy on Test 0.4111111111111111

**** Epoch 3/20 ****
27/33-(1.041)
9/33-(1.584)
24/33-(0.868)
6/33-(1.423)

=== Evaluating Model ===
Total valid loss 1.0421574860811234
accuracy on Test 0.5
Best accuracy on Test 0.5

**** Epoch 4/20 ****
21/33-(0.649)
3/33-(1.100)
18/33-(0.997)
0/33-(0.887)

=== Evaluating Model ===
Total valid loss 1.3957639634609222
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5

**** Epoch 5/20 ****
15/33-(0.676)
30/33-(0.607)
12/33-(0.961)
27/33-(0.654)

=== Evaluating Model ===
Total valid loss 1.1536218523979187
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5

**** Epoch 6/20 ****
9/33-(1.014)
24/33-(0.842)
6/33-(0.730)

=== Evaluating Model ===
Total valid loss 1.3198412905136745
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5

**** Epoch 7/20 ****
21/33-(1.323)
3/33-(0.906)
18/33-(0.562)
0/33-(0.815)

=== Evaluating Model ===
Total valid loss 1.2192840923865635
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5

**** Epoch 8/20 ****
15/33-(0.612)
30/33-(0.739)
12/33-(0.921)
27/33-(0.984)

=== Evaluating Model ===
Total valid loss 1.4105805580814679
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 9/20 ****
9/33-(0.934)
24/33-(0.769)
6/33-(0.385)
21/33-(0.712)

=== Evaluating Model ===
Total valid loss 1.869202733039856
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5388888888888889

**** Epoch 10/20 ****
3/33-(0.593)
18/33-(0.404)
0/33-(0.245)

=== Evaluating Model ===
Total valid loss 1.8969132403532665
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5388888888888889

**** Epoch 11/20 ****
15/33-(0.489)
30/33-(0.748)
12/33-(0.874)
27/33-(0.606)

=== Evaluating Model ===
Total valid loss 1.4294298738241196
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5388888888888889

**** Epoch 12/20 ****
9/33-(0.556)
24/33-(0.458)
6/33-(0.393)
21/33-(0.403)

=== Evaluating Model ===
Total valid loss 1.5959765414396923
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5388888888888889

**** Epoch 13/20 ****
3/33-(0.785)
18/33-(0.408)
0/33-(0.236)
15/33-(0.299)

=== Evaluating Model ===
Total valid loss 2.5862634976704917
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5388888888888889

**** Epoch 14/20 ****
30/33-(0.635)
12/33-(0.330)
27/33-(0.553)

=== Evaluating Model ===
Total valid loss 2.313118666410446
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5388888888888889

**** Epoch 15/20 ****
9/33-(0.585)
24/33-(0.185)
6/33-(0.423)
21/33-(0.809)

=== Evaluating Model ===
Total valid loss 2.506862153609594
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.5388888888888889

**** Epoch 16/20 ****
3/33-(0.698)
18/33-(0.188)
0/33-(0.688)
15/33-(0.553)

=== Evaluating Model ===
Total valid loss 2.77842785914739
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5388888888888889

**** Epoch 17/20 ****
30/33-(0.287)
12/33-(0.958)
27/33-(0.079)

=== Evaluating Model ===
Total valid loss 2.6951185315847397
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5388888888888889

**** Epoch 18/20 ****
9/33-(0.228)
24/33-(0.426)
6/33-(0.206)
21/33-(0.230)

=== Evaluating Model ===
Total valid loss 3.086843599875768
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 19/20 ****
3/33-(0.440)
18/33-(0.148)
Best accuracy on Test 0.5388888888888889

Final k-fold valid -1.0
[-1, -1, -1, -1, -1, -1, -1, -1, -1, -1]
Final k-fold eval 0.5533333333333332
[0.5722222222222222, 0.5388888888888889, 0.5444444444444444, 0.5611111111111111, 0.5611111111111111, 0.5388888888888889, 0.5666666666666667, 0.5611111111111111, 0.55, 0.5388888888888889]
