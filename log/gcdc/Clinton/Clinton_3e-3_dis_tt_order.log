Whole k-fold eval mode
Source domain: Clinton, Target domain: Clinton, Cur_fold 0
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
315.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(2.080)
30/33-(1.557)
12/33-(1.745)

=== Evaluating Model ===
Total valid loss 1.0544644246498744
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 0/20 ****
27/33-(1.459)
9/33-(1.382)
24/33-(1.219)
6/33-(1.093)

=== Evaluating Model ===
Total valid loss 1.1516472299893696
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 1/20 ****
21/33-(1.211)
3/33-(0.918)
18/33-(1.158)
0/33-(1.278)

=== Evaluating Model ===
Total valid loss 1.0118553290764492
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 2/20 ****
15/33-(1.168)
30/33-(1.405)
12/33-(1.160)

=== Evaluating Model ===
Total valid loss 1.0832442343235016
accuracy on Test 0.39444444444444443
Best accuracy on Test 0.5555555555555556

**** Epoch 3/20 ****
27/33-(1.230)
9/33-(1.250)
24/33-(1.162)
6/33-(0.984)

=== Evaluating Model ===
Total valid loss 0.9982728610436121
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 4/20 ****
21/33-(1.234)
3/33-(0.840)
18/33-(1.020)
0/33-(1.051)

=== Evaluating Model ===
Total valid loss 1.0144797662893932
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 5/20 ****
15/33-(1.047)
30/33-(0.978)
12/33-(0.990)
27/33-(0.958)

=== Evaluating Model ===
Total valid loss 0.9942672997713089
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 6/20 ****
9/33-(1.008)
24/33-(1.305)
6/33-(1.147)

=== Evaluating Model ===
Total valid loss 1.0116993337869644
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 7/20 ****
21/33-(1.083)
3/33-(1.018)
18/33-(1.054)
0/33-(1.178)

=== Evaluating Model ===
Total valid loss 0.9948151757319769
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 8/20 ****
15/33-(0.873)
30/33-(1.033)
12/33-(0.906)
27/33-(1.045)

=== Evaluating Model ===
Total valid loss 1.016308878858884
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 9/20 ****
9/33-(0.847)
24/33-(0.898)
6/33-(0.875)
21/33-(0.907)

=== Evaluating Model ===
Total valid loss 1.0445639093716939
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5611111111111111

**** Epoch 10/20 ****
3/33-(0.924)
18/33-(1.089)
0/33-(0.891)

=== Evaluating Model ===
Total valid loss 0.9512170652548472
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5611111111111111

**** Epoch 11/20 ****
15/33-(1.302)
30/33-(1.324)
12/33-(1.020)
27/33-(0.999)

=== Evaluating Model ===
Total valid loss 0.9384828060865402
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5611111111111111

**** Epoch 12/20 ****
9/33-(0.965)
24/33-(0.752)
6/33-(1.025)
21/33-(0.937)

=== Evaluating Model ===
Total valid loss 0.9841649085283279
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 13/20 ****
3/33-(1.078)
18/33-(0.978)
0/33-(1.222)
15/33-(1.208)

=== Evaluating Model ===
Total valid loss 1.024184654156367
accuracy on Test 0.55
Best accuracy on Test 0.5666666666666667

**** Epoch 14/20 ****
30/33-(0.872)
12/33-(0.827)
27/33-(0.971)

=== Evaluating Model ===
Total valid loss 1.0154627213875453
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 15/20 ****
9/33-(1.009)
24/33-(0.881)
6/33-(1.290)
21/33-(1.141)

=== Evaluating Model ===
Total valid loss 0.9677466005086899
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 16/20 ****
3/33-(0.649)
18/33-(0.880)
0/33-(1.014)
15/33-(0.889)

=== Evaluating Model ===
Total valid loss 0.9661547094583511
accuracy on Test 0.5777777777777777
Best accuracy on Test 0.5777777777777777

**** Epoch 17/20 ****
30/33-(1.121)
12/33-(0.924)
27/33-(0.852)

=== Evaluating Model ===
Total valid loss 0.9651012122631073
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5777777777777777

**** Epoch 18/20 ****
9/33-(0.921)
24/33-(0.816)
6/33-(0.924)
21/33-(0.779)

=== Evaluating Model ===
Total valid loss 1.0106237928072612
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5777777777777777

**** Epoch 19/20 ****
3/33-(0.995)
18/33-(0.670)
Best accuracy on Test 0.5777777777777777

Source domain: Clinton, Target domain: Clinton, Cur_fold 1
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
315.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(2.684)
30/33-(1.756)
12/33-(1.477)

=== Evaluating Model ===
Total valid loss 0.9555804034074148
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 0/20 ****
27/33-(1.140)
9/33-(1.285)
24/33-(1.150)
6/33-(1.306)

=== Evaluating Model ===
Total valid loss 1.0084062119325001
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 1/20 ****
21/33-(1.150)
3/33-(1.130)
18/33-(0.995)
0/33-(1.154)

=== Evaluating Model ===
Total valid loss 0.9705525288979212
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 2/20 ****
15/33-(1.103)
30/33-(1.095)
12/33-(1.122)

=== Evaluating Model ===
Total valid loss 0.9723078856865565
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 3/20 ****
27/33-(1.190)
9/33-(0.940)
24/33-(1.066)
6/33-(1.079)

=== Evaluating Model ===
Total valid loss 1.0097457021474838
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 4/20 ****
21/33-(1.541)
3/33-(1.204)
18/33-(1.025)
0/33-(1.429)

=== Evaluating Model ===
Total valid loss 0.9917676448822021
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 5/20 ****
15/33-(1.034)
30/33-(1.164)
12/33-(1.482)
27/33-(1.200)

=== Evaluating Model ===
Total valid loss 0.97825026512146
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 6/20 ****
9/33-(0.945)
24/33-(1.333)
6/33-(1.000)

=== Evaluating Model ===
Total valid loss 0.9581229339043299
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 7/20 ****
21/33-(1.025)
3/33-(1.011)
18/33-(1.056)
0/33-(1.004)

=== Evaluating Model ===
Total valid loss 0.9719106455643972
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 8/20 ****
15/33-(1.055)
30/33-(1.167)
12/33-(1.106)
27/33-(0.979)

=== Evaluating Model ===
Total valid loss 0.9664699683586756
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 9/20 ****
9/33-(0.991)
24/33-(1.003)
6/33-(1.007)
21/33-(1.247)

=== Evaluating Model ===
Total valid loss 0.973426342010498
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 10/20 ****
3/33-(0.964)
18/33-(0.944)
0/33-(1.177)

=== Evaluating Model ===
Total valid loss 0.9572687149047852
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 11/20 ****
15/33-(1.042)
30/33-(1.093)
12/33-(1.306)
27/33-(1.144)

=== Evaluating Model ===
Total valid loss 0.9900066182017326
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 12/20 ****
9/33-(1.159)
24/33-(1.272)
6/33-(1.244)
21/33-(1.038)

=== Evaluating Model ===
Total valid loss 0.9854744523763657
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 13/20 ****
3/33-(1.277)
18/33-(1.137)
0/33-(1.082)
15/33-(0.939)

=== Evaluating Model ===
Total valid loss 0.9231118261814117
accuracy on Test 0.5833333333333334
Best accuracy on Test 0.5833333333333334

**** Epoch 14/20 ****
30/33-(0.950)
12/33-(1.208)
27/33-(1.515)

=== Evaluating Model ===
Total valid loss 0.8906165262063345
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5833333333333334

**** Epoch 15/20 ****
9/33-(1.334)
24/33-(0.953)
6/33-(1.056)
21/33-(1.013)

=== Evaluating Model ===
Total valid loss 1.0502109279235203
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5833333333333334

**** Epoch 16/20 ****
3/33-(1.209)
18/33-(0.945)
0/33-(0.779)
15/33-(0.646)

=== Evaluating Model ===
Total valid loss 0.8720142394304276
accuracy on Test 0.5777777777777777
Best accuracy on Test 0.5833333333333334

**** Epoch 17/20 ****
30/33-(1.092)
12/33-(0.778)
27/33-(0.980)

=== Evaluating Model ===
Total valid loss 0.8838255430261294
accuracy on Test 0.6
Best accuracy on Test 0.6

**** Epoch 18/20 ****
9/33-(0.954)
24/33-(1.211)
6/33-(0.746)
21/33-(0.687)

=== Evaluating Model ===
Total valid loss 0.9281316300233206
accuracy on Test 0.5777777777777777
Best accuracy on Test 0.6

**** Epoch 19/20 ****
3/33-(0.759)
18/33-(1.044)
Best accuracy on Test 0.6

Source domain: Clinton, Target domain: Clinton, Cur_fold 2
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
315.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.787)
30/33-(1.666)
12/33-(1.286)

=== Evaluating Model ===
Total valid loss 0.9709928979476293
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 0/20 ****
27/33-(1.182)
9/33-(1.303)
24/33-(0.882)
6/33-(1.167)

=== Evaluating Model ===
Total valid loss 1.0477960805098216
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 1/20 ****
21/33-(1.407)
3/33-(1.054)
18/33-(1.163)
0/33-(1.229)

=== Evaluating Model ===
Total valid loss 1.0871221423149109
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 2/20 ****
15/33-(1.009)
30/33-(1.039)
12/33-(1.039)

=== Evaluating Model ===
Total valid loss 0.9985900372266769
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 3/20 ****
27/33-(1.260)
9/33-(0.988)
24/33-(1.087)
6/33-(1.109)

=== Evaluating Model ===
Total valid loss 0.9884760876496633
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 4/20 ****
21/33-(0.946)
3/33-(1.033)
18/33-(1.493)
0/33-(1.229)

=== Evaluating Model ===
Total valid loss 1.0053805311520894
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.55

**** Epoch 5/20 ****
15/33-(1.006)
30/33-(0.952)
12/33-(1.146)
27/33-(1.014)

=== Evaluating Model ===
Total valid loss 0.9715351164340973
accuracy on Test 0.6111111111111112
Best accuracy on Test 0.6111111111111112

**** Epoch 6/20 ****
9/33-(0.992)
24/33-(0.930)
6/33-(1.053)

=== Evaluating Model ===
Total valid loss 0.9582623640696207
accuracy on Test 0.55
Best accuracy on Test 0.6111111111111112

**** Epoch 7/20 ****
21/33-(0.861)
3/33-(0.942)
18/33-(1.110)
0/33-(1.360)

=== Evaluating Model ===
Total valid loss 0.9040135939915975
accuracy on Test 0.55
Best accuracy on Test 0.6111111111111112

**** Epoch 8/20 ****
15/33-(1.086)
30/33-(0.856)
12/33-(1.128)
27/33-(0.875)

=== Evaluating Model ===
Total valid loss 0.9018161470691363
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.6111111111111112

**** Epoch 9/20 ****
9/33-(1.314)
24/33-(1.095)
6/33-(1.114)
21/33-(1.070)

=== Evaluating Model ===
Total valid loss 0.8850784152746201
accuracy on Test 0.5944444444444444
Best accuracy on Test 0.6111111111111112

**** Epoch 10/20 ****
3/33-(1.062)
18/33-(1.019)
0/33-(0.692)

=== Evaluating Model ===
Total valid loss 0.8889578431844711
accuracy on Test 0.6166666666666667
Best accuracy on Test 0.6166666666666667

**** Epoch 11/20 ****
15/33-(0.895)
30/33-(0.859)
12/33-(0.971)
27/33-(1.140)

=== Evaluating Model ===
Total valid loss 1.0738417953252792
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.6166666666666667

**** Epoch 12/20 ****
9/33-(0.759)
24/33-(0.935)
6/33-(0.832)
21/33-(1.494)

=== Evaluating Model ===
Total valid loss 0.9996398985385895
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.6166666666666667

**** Epoch 13/20 ****
3/33-(1.124)
18/33-(0.775)
0/33-(1.228)
15/33-(1.199)

=== Evaluating Model ===
Total valid loss 0.9379070848226547
accuracy on Test 0.55
Best accuracy on Test 0.6166666666666667

**** Epoch 14/20 ****
30/33-(1.309)
12/33-(0.844)
27/33-(1.032)

=== Evaluating Model ===
Total valid loss 1.0387733827034633
accuracy on Test 0.5833333333333334
Best accuracy on Test 0.6166666666666667

**** Epoch 15/20 ****
9/33-(1.302)
24/33-(1.148)
6/33-(0.949)
21/33-(1.288)

=== Evaluating Model ===
Total valid loss 1.0374391227960587
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.6166666666666667

**** Epoch 16/20 ****
3/33-(0.879)
18/33-(1.085)
0/33-(1.276)
15/33-(1.245)

=== Evaluating Model ===
Total valid loss 0.9423490365346273
accuracy on Test 0.6111111111111112
Best accuracy on Test 0.6166666666666667

**** Epoch 17/20 ****
30/33-(0.936)
12/33-(1.156)
27/33-(1.792)

=== Evaluating Model ===
Total valid loss 0.9662380466858546
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.6166666666666667

**** Epoch 18/20 ****
9/33-(1.016)
24/33-(1.220)
6/33-(1.243)
21/33-(0.986)

=== Evaluating Model ===
Total valid loss 0.9515660057465235
accuracy on Test 0.5833333333333334
Best accuracy on Test 0.6166666666666667

**** Epoch 19/20 ****
3/33-(0.953)
18/33-(1.431)
Best accuracy on Test 0.6166666666666667

Source domain: Clinton, Target domain: Clinton, Cur_fold 3
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
315.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(2.038)
30/33-(1.832)
12/33-(1.626)

=== Evaluating Model ===
Total valid loss 1.0186552653710048
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 0/20 ****
27/33-(1.294)
9/33-(1.178)
24/33-(1.123)
6/33-(1.252)

=== Evaluating Model ===
Total valid loss 0.961720660328865
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 1/20 ****
21/33-(1.130)
3/33-(0.967)
18/33-(1.120)
0/33-(1.284)

=== Evaluating Model ===
Total valid loss 0.9902948041756948
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 2/20 ****
15/33-(1.371)
30/33-(1.086)
12/33-(1.084)

=== Evaluating Model ===
Total valid loss 0.9986162334680557
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5722222222222222

**** Epoch 3/20 ****
27/33-(1.271)
9/33-(1.028)
24/33-(1.089)
6/33-(1.327)

=== Evaluating Model ===
Total valid loss 0.9929566184679667
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 4/20 ****
21/33-(1.003)
3/33-(1.145)
18/33-(1.181)
0/33-(1.254)

=== Evaluating Model ===
Total valid loss 0.9656608800093333
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 5/20 ****
15/33-(0.932)
30/33-(1.182)
12/33-(1.083)
27/33-(1.028)

=== Evaluating Model ===
Total valid loss 0.961609423160553
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 6/20 ****
9/33-(0.974)
24/33-(1.064)
6/33-(0.965)

=== Evaluating Model ===
Total valid loss 0.9697354237238566
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 7/20 ****
21/33-(1.252)
3/33-(1.105)
18/33-(1.186)
0/33-(1.093)

=== Evaluating Model ===
Total valid loss 0.9708191454410553
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 8/20 ****
15/33-(1.064)
30/33-(0.950)
12/33-(0.966)
27/33-(1.034)

=== Evaluating Model ===
Total valid loss 0.9783530831336975
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 9/20 ****
9/33-(1.023)
24/33-(0.949)
6/33-(1.106)
21/33-(1.057)

=== Evaluating Model ===
Total valid loss 0.9587258547544479
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 10/20 ****
3/33-(1.056)
18/33-(1.118)
0/33-(0.901)

=== Evaluating Model ===
Total valid loss 0.9861995428800583
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 11/20 ****
15/33-(1.000)
30/33-(1.088)
12/33-(0.964)
27/33-(1.080)

=== Evaluating Model ===
Total valid loss 1.0439634323120117
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 12/20 ****
9/33-(1.259)
24/33-(1.138)
6/33-(1.283)
21/33-(1.228)

=== Evaluating Model ===
Total valid loss 0.964156299829483
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 13/20 ****
3/33-(1.246)
18/33-(1.111)
0/33-(1.138)
15/33-(1.265)

=== Evaluating Model ===
Total valid loss 0.9617781887451807
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 14/20 ****
30/33-(0.884)
12/33-(1.207)
27/33-(1.295)

=== Evaluating Model ===
Total valid loss 0.9772965361674627
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5722222222222222

**** Epoch 15/20 ****
9/33-(1.052)
24/33-(1.275)
6/33-(1.070)
21/33-(0.930)

=== Evaluating Model ===
Total valid loss 0.951642910639445
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 16/20 ****
3/33-(1.326)
18/33-(1.060)
0/33-(0.896)
15/33-(1.136)

=== Evaluating Model ===
Total valid loss 0.9524864355723063
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 17/20 ****
30/33-(1.268)
12/33-(1.088)
27/33-(1.035)

=== Evaluating Model ===
Total valid loss 0.9627114633719126
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 18/20 ****
9/33-(1.192)
24/33-(1.314)
6/33-(1.083)
21/33-(1.151)

=== Evaluating Model ===
Total valid loss 0.9562355081240336
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 19/20 ****
3/33-(1.094)
18/33-(1.257)
Best accuracy on Test 0.5722222222222222

Source domain: Clinton, Target domain: Clinton, Cur_fold 4
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
315.5
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(2.779)
30/33-(1.595)
12/33-(1.812)

=== Evaluating Model ===
Total valid loss 1.0449718832969666
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 0/20 ****
27/33-(1.222)
9/33-(1.386)
24/33-(1.264)
6/33-(1.166)

=== Evaluating Model ===
Total valid loss 0.9811012347539266
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5388888888888889

**** Epoch 1/20 ****
21/33-(1.026)
3/33-(1.235)
18/33-(0.935)
0/33-(1.095)

=== Evaluating Model ===
Total valid loss 1.0260385125875473
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5388888888888889

**** Epoch 2/20 ****
15/33-(1.099)
30/33-(0.991)
12/33-(0.880)

=== Evaluating Model ===
Total valid loss 1.0203110575675964
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5388888888888889

**** Epoch 3/20 ****
27/33-(1.064)
9/33-(1.152)
24/33-(1.053)
6/33-(1.100)

=== Evaluating Model ===
Total valid loss 0.9884385913610458
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5388888888888889

**** Epoch 4/20 ****
21/33-(0.843)
3/33-(1.236)
18/33-(1.090)
0/33-(1.111)

=== Evaluating Model ===
Total valid loss 0.9510212987661362
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5388888888888889

**** Epoch 5/20 ****
15/33-(1.208)
30/33-(1.456)
12/33-(0.893)
27/33-(0.959)

=== Evaluating Model ===
Total valid loss 1.2839808861414592
accuracy on Test 0.38333333333333336
Best accuracy on Test 0.5388888888888889

**** Epoch 6/20 ****
9/33-(0.942)
24/33-(1.069)
6/33-(1.194)

=== Evaluating Model ===
Total valid loss 0.9130825648705164
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 7/20 ****
21/33-(1.000)
3/33-(1.412)
18/33-(0.783)
0/33-(0.944)

=== Evaluating Model ===
Total valid loss 0.9444479197263718
accuracy on Test 0.5833333333333334
Best accuracy on Test 0.5833333333333334

**** Epoch 8/20 ****
15/33-(1.060)
30/33-(0.813)
12/33-(1.127)
27/33-(0.777)

=== Evaluating Model ===
Total valid loss 0.893740197022756
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5833333333333334

**** Epoch 9/20 ****
9/33-(0.511)
24/33-(0.857)
6/33-(0.733)
21/33-(1.256)

=== Evaluating Model ===
Total valid loss 0.9634450674057007
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5833333333333334

**** Epoch 10/20 ****
3/33-(0.941)
18/33-(0.900)
0/33-(1.214)

=== Evaluating Model ===
Total valid loss 1.023672382036845
accuracy on Test 0.55
Best accuracy on Test 0.5833333333333334

**** Epoch 11/20 ****
15/33-(1.034)
30/33-(0.965)
12/33-(0.702)
27/33-(1.212)

=== Evaluating Model ===
Total valid loss 1.0582214271028836
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5833333333333334

**** Epoch 12/20 ****
9/33-(1.409)
24/33-(0.857)
6/33-(1.179)
21/33-(0.963)

=== Evaluating Model ===
Total valid loss 0.9291909337043762
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5833333333333334

**** Epoch 13/20 ****
3/33-(1.145)
18/33-(0.943)
0/33-(0.881)
15/33-(0.771)

=== Evaluating Model ===
Total valid loss 1.0642825067043304
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5833333333333334

**** Epoch 14/20 ****
30/33-(1.724)
12/33-(0.985)
27/33-(0.845)

=== Evaluating Model ===
Total valid loss 0.9579440106948217
accuracy on Test 0.5
Best accuracy on Test 0.5833333333333334

**** Epoch 15/20 ****
9/33-(0.960)
24/33-(0.874)
6/33-(0.877)
21/33-(0.653)

=== Evaluating Model ===
Total valid loss 1.134507417678833
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5833333333333334

**** Epoch 16/20 ****
3/33-(0.667)
18/33-(2.304)
0/33-(0.604)
15/33-(0.852)

=== Evaluating Model ===
Total valid loss 1.4356096039215724
accuracy on Test 0.5
Best accuracy on Test 0.5833333333333334

**** Epoch 17/20 ****
30/33-(0.852)
