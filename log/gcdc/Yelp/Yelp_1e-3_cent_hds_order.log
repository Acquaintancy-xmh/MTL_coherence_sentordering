Whole k-fold eval mode
Source domain: Yelp, Target domain: Yelp, Cur_fold 0
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
261
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.899)
30/33-(1.765)
12/33-(1.543)

=== Evaluating Model ===
Total valid loss 1.1496022442976634
accuracy on Test 0.25
Best accuracy on Test 0.25

**** Epoch 0/20 ****
27/33-(1.369)
9/33-(1.378)
24/33-(1.272)
6/33-(1.317)

=== Evaluating Model ===
Total valid loss 1.0068779488404591
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 1/20 ****
21/33-(1.241)
3/33-(1.145)
18/33-(1.026)
0/33-(1.018)

=== Evaluating Model ===
Total valid loss 0.9937139203151067
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 2/20 ****
15/33-(1.100)
30/33-(1.115)
12/33-(1.269)

=== Evaluating Model ===
Total valid loss 1.0082779328028362
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5555555555555556

**** Epoch 3/20 ****
27/33-(1.170)
9/33-(1.007)
24/33-(1.159)
6/33-(1.034)

=== Evaluating Model ===
Total valid loss 1.0410929570595424
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.5555555555555556

**** Epoch 4/20 ****
21/33-(0.920)
3/33-(0.955)
18/33-(1.001)
0/33-(1.006)

=== Evaluating Model ===
Total valid loss 0.9759854674339294
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5555555555555556

**** Epoch 5/20 ****
15/33-(1.465)
30/33-(1.471)
12/33-(0.838)
27/33-(1.051)

=== Evaluating Model ===
Total valid loss 0.9965615272521973
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5555555555555556

**** Epoch 6/20 ****
9/33-(0.938)
24/33-(0.821)
6/33-(0.877)

=== Evaluating Model ===
Total valid loss 1.304555505514145
accuracy on Test 0.32222222222222224
Best accuracy on Test 0.5555555555555556

**** Epoch 7/20 ****
21/33-(1.300)
3/33-(0.972)
18/33-(0.733)
0/33-(0.932)

=== Evaluating Model ===
Total valid loss 1.0942438592513402
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5555555555555556

**** Epoch 8/20 ****
15/33-(1.177)
30/33-(1.613)
12/33-(0.951)
27/33-(1.404)

=== Evaluating Model ===
Total valid loss 1.1166846652825673
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 9/20 ****
9/33-(1.189)
24/33-(0.663)
6/33-(0.506)
21/33-(0.594)

=== Evaluating Model ===
Total valid loss 1.0556614895661671
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.5555555555555556

**** Epoch 10/20 ****
3/33-(0.595)
18/33-(1.265)
0/33-(0.651)

=== Evaluating Model ===
Total valid loss 1.1817640314499538
accuracy on Test 0.40555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 11/20 ****
15/33-(0.881)
30/33-(0.656)
12/33-(0.499)
27/33-(1.149)

=== Evaluating Model ===
Total valid loss 1.1994084219137828
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5555555555555556

**** Epoch 12/20 ****
9/33-(0.562)
24/33-(0.636)
6/33-(0.384)
21/33-(0.819)

=== Evaluating Model ===
Total valid loss 1.5103304783503215
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5555555555555556

**** Epoch 13/20 ****
3/33-(0.502)
18/33-(0.719)
0/33-(1.129)
15/33-(0.504)

=== Evaluating Model ===
Total valid loss 1.3968927040696144
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.5555555555555556

**** Epoch 14/20 ****
30/33-(0.814)
12/33-(0.471)
27/33-(0.423)

=== Evaluating Model ===
Total valid loss 1.663906102379163
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5555555555555556

**** Epoch 15/20 ****
9/33-(0.829)
24/33-(0.632)
6/33-(0.875)
21/33-(0.130)

=== Evaluating Model ===
Total valid loss 1.7021062473456066
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5555555555555556

**** Epoch 16/20 ****
3/33-(0.642)
18/33-(0.501)
0/33-(1.764)
15/33-(0.199)

=== Evaluating Model ===
Total valid loss 1.7062651266654332
accuracy on Test 0.3888888888888889
Best accuracy on Test 0.5555555555555556

**** Epoch 17/20 ****
30/33-(0.480)
12/33-(0.594)
27/33-(0.744)

=== Evaluating Model ===
Total valid loss 2.3229256346821785
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5555555555555556

**** Epoch 18/20 ****
9/33-(0.261)
24/33-(0.353)
6/33-(0.524)
21/33-(0.508)

=== Evaluating Model ===
Total valid loss 2.2103749780605235
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5555555555555556

**** Epoch 19/20 ****
3/33-(0.370)
18/33-(0.043)
Best accuracy on Test 0.5555555555555556

Source domain: Yelp, Target domain: Yelp, Cur_fold 1
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
261
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.886)
30/33-(1.733)
12/33-(1.363)

=== Evaluating Model ===
Total valid loss 1.0595275660355885
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 0/20 ****
27/33-(1.367)
9/33-(1.208)
24/33-(1.189)
6/33-(1.191)

=== Evaluating Model ===
Total valid loss 1.0359745572010677
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 1/20 ****
21/33-(1.149)
3/33-(0.876)
18/33-(1.189)
0/33-(1.070)

=== Evaluating Model ===
Total valid loss 1.019901379942894
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5444444444444444

**** Epoch 2/20 ****
15/33-(0.839)
30/33-(1.063)
12/33-(1.063)

=== Evaluating Model ===
Total valid loss 1.0210238546133041
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 3/20 ****
27/33-(1.140)
9/33-(0.885)
24/33-(1.200)
6/33-(0.916)

=== Evaluating Model ===
Total valid loss 1.00910950700442
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 4/20 ****
21/33-(1.089)
3/33-(1.060)
18/33-(0.916)
0/33-(1.108)

=== Evaluating Model ===
Total valid loss 1.0372583170731862
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 5/20 ****
15/33-(0.880)
30/33-(1.141)
12/33-(0.967)
27/33-(0.839)

=== Evaluating Model ===
Total valid loss 1.1320613771677017
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 6/20 ****
9/33-(0.773)
24/33-(0.751)
6/33-(0.811)

=== Evaluating Model ===
Total valid loss 1.0933667073647182
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 7/20 ****
21/33-(0.894)
3/33-(0.863)
18/33-(0.650)
0/33-(0.854)

=== Evaluating Model ===
Total valid loss 1.330504874388377
accuracy on Test 0.39444444444444443
Best accuracy on Test 0.5666666666666667

**** Epoch 8/20 ****
15/33-(1.164)
30/33-(0.858)
12/33-(0.784)
27/33-(0.714)

=== Evaluating Model ===
Total valid loss 1.3170027981201808
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 9/20 ****
9/33-(1.755)
24/33-(0.827)
6/33-(0.741)
21/33-(0.771)

=== Evaluating Model ===
Total valid loss 1.165110856294632
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5666666666666667

**** Epoch 10/20 ****
3/33-(1.033)
18/33-(0.400)
0/33-(0.704)

=== Evaluating Model ===
Total valid loss 1.22965307533741
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5666666666666667

**** Epoch 11/20 ****
15/33-(0.858)
30/33-(0.369)
12/33-(0.592)
27/33-(0.691)

=== Evaluating Model ===
Total valid loss 1.509903644522031
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 12/20 ****
9/33-(0.623)
24/33-(0.352)
6/33-(0.704)
21/33-(0.681)

=== Evaluating Model ===
Total valid loss 1.5776368876298268
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.5666666666666667

**** Epoch 13/20 ****
3/33-(0.518)
18/33-(0.469)
0/33-(0.597)
15/33-(0.435)

=== Evaluating Model ===
Total valid loss 1.8736062347888947
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5666666666666667

**** Epoch 14/20 ****
30/33-(0.121)
12/33-(0.485)
27/33-(0.480)

=== Evaluating Model ===
Total valid loss 2.040151665608088
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.5666666666666667

**** Epoch 15/20 ****
9/33-(0.769)
24/33-(0.172)
6/33-(0.683)
21/33-(0.222)

=== Evaluating Model ===
Total valid loss 2.0474203328291574
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5666666666666667

**** Epoch 16/20 ****
3/33-(0.402)
18/33-(0.213)
0/33-(0.278)
15/33-(0.398)

=== Evaluating Model ===
Total valid loss 2.005916545788447
accuracy on Test 0.4
Best accuracy on Test 0.5666666666666667

**** Epoch 17/20 ****
30/33-(0.509)
12/33-(0.288)
27/33-(0.569)

=== Evaluating Model ===
Total valid loss 2.478680968284607
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.5666666666666667

**** Epoch 18/20 ****
9/33-(0.243)
24/33-(0.299)
6/33-(0.316)
21/33-(0.183)

=== Evaluating Model ===
Total valid loss 2.615305016438166
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5666666666666667

**** Epoch 19/20 ****
3/33-(0.284)
18/33-(0.171)
Best accuracy on Test 0.5666666666666667

Source domain: Yelp, Target domain: Yelp, Cur_fold 2
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
261
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.833)
30/33-(1.600)
12/33-(1.130)

=== Evaluating Model ===
Total valid loss 1.0053812712430954
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 0/20 ****
27/33-(1.200)
9/33-(1.016)
24/33-(1.113)
6/33-(1.390)

=== Evaluating Model ===
Total valid loss 1.0419140011072159
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 1/20 ****
21/33-(1.191)
3/33-(1.252)
18/33-(1.040)
0/33-(1.289)

=== Evaluating Model ===
Total valid loss 1.0573859910170238
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5555555555555556

**** Epoch 2/20 ****
15/33-(1.106)
30/33-(0.885)
12/33-(0.845)

=== Evaluating Model ===
Total valid loss 1.020827849706014
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 3/20 ****
27/33-(1.056)
9/33-(0.859)
24/33-(0.845)
6/33-(1.111)

=== Evaluating Model ===
Total valid loss 1.0018792301416397
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 4/20 ****
21/33-(1.112)
3/33-(0.621)
18/33-(0.904)
0/33-(1.040)

=== Evaluating Model ===
Total valid loss 1.3394293189048767
accuracy on Test 0.35
Best accuracy on Test 0.5611111111111111

**** Epoch 5/20 ****
15/33-(0.978)
30/33-(1.149)
12/33-(1.008)
27/33-(1.114)

=== Evaluating Model ===
Total valid loss 1.014174814025561
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5611111111111111

**** Epoch 6/20 ****
9/33-(1.004)
24/33-(0.805)
6/33-(1.325)

=== Evaluating Model ===
Total valid loss 1.0252223312854767
accuracy on Test 0.5
Best accuracy on Test 0.5611111111111111

**** Epoch 7/20 ****
21/33-(0.835)
3/33-(0.719)
18/33-(0.648)
0/33-(1.160)

=== Evaluating Model ===
Total valid loss 1.0851580301920574
accuracy on Test 0.55
Best accuracy on Test 0.5611111111111111

**** Epoch 8/20 ****
15/33-(1.077)
30/33-(0.455)
12/33-(0.712)
27/33-(1.141)

=== Evaluating Model ===
Total valid loss 1.2755355834960938
accuracy on Test 0.45
Best accuracy on Test 0.5611111111111111

**** Epoch 9/20 ****
9/33-(1.231)
24/33-(0.406)
6/33-(0.657)
21/33-(1.001)

=== Evaluating Model ===
Total valid loss 1.5769554674625397
accuracy on Test 0.3611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 10/20 ****
3/33-(0.759)
18/33-(0.791)
0/33-(0.592)

=== Evaluating Model ===
Total valid loss 1.480332429210345
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5611111111111111

**** Epoch 11/20 ****
15/33-(0.665)
30/33-(0.481)
12/33-(0.691)
27/33-(1.129)

=== Evaluating Model ===
Total valid loss 1.657911812265714
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 12/20 ****
9/33-(0.575)
24/33-(0.450)
6/33-(0.550)
21/33-(0.786)

=== Evaluating Model ===
Total valid loss 2.4287952880064645
accuracy on Test 0.35
Best accuracy on Test 0.5611111111111111

**** Epoch 13/20 ****
3/33-(0.547)
18/33-(0.521)
0/33-(0.279)
15/33-(0.623)

=== Evaluating Model ===
Total valid loss 2.575089693069458
accuracy on Test 0.32222222222222224
Best accuracy on Test 0.5611111111111111

**** Epoch 14/20 ****
30/33-(0.986)
12/33-(0.435)
27/33-(0.432)

=== Evaluating Model ===
Total valid loss 1.9263599167267482
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5611111111111111

**** Epoch 15/20 ****
9/33-(0.057)
24/33-(0.490)
6/33-(0.508)
21/33-(0.406)

=== Evaluating Model ===
Total valid loss 2.086739440759023
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5611111111111111

**** Epoch 16/20 ****
3/33-(1.075)
18/33-(0.071)
0/33-(0.101)
15/33-(1.222)

=== Evaluating Model ===
Total valid loss 2.218294387062391
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.5611111111111111

**** Epoch 17/20 ****
30/33-(0.146)
12/33-(0.249)
27/33-(0.340)

=== Evaluating Model ===
Total valid loss 2.2598015467325845
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 18/20 ****
9/33-(0.286)
24/33-(0.256)
6/33-(0.257)
21/33-(0.071)

=== Evaluating Model ===
Total valid loss 2.66502837340037
accuracy on Test 0.40555555555555556
Best accuracy on Test 0.5611111111111111

**** Epoch 19/20 ****
3/33-(0.146)
18/33-(0.372)
Best accuracy on Test 0.5611111111111111

Source domain: Yelp, Target domain: Yelp, Cur_fold 3
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
261
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.852)
30/33-(1.417)
12/33-(1.115)

=== Evaluating Model ===
Total valid loss 1.056919887661934
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5222222222222223

**** Epoch 0/20 ****
27/33-(1.490)
9/33-(1.202)
24/33-(1.334)
6/33-(1.168)

=== Evaluating Model ===
Total valid loss 1.0207884709040325
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5222222222222223

**** Epoch 1/20 ****
21/33-(1.124)
3/33-(1.278)
18/33-(1.471)
0/33-(1.172)

=== Evaluating Model ===
Total valid loss 1.0439732124408085
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5222222222222223

**** Epoch 2/20 ****
15/33-(1.138)
30/33-(0.861)
12/33-(1.358)

=== Evaluating Model ===
Total valid loss 1.0521146953105927
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 3/20 ****
27/33-(1.213)
9/33-(0.978)
24/33-(1.032)
6/33-(1.048)

=== Evaluating Model ===
Total valid loss 1.0203415552775066
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 4/20 ****
21/33-(1.106)
3/33-(1.083)
18/33-(0.794)
0/33-(1.058)

=== Evaluating Model ===
Total valid loss 1.065073291460673
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.55

**** Epoch 5/20 ****
15/33-(1.139)
30/33-(1.102)
12/33-(0.904)
27/33-(1.204)

=== Evaluating Model ===
Total valid loss 1.0212869892517726
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.55

**** Epoch 6/20 ****
9/33-(0.708)
24/33-(0.851)
6/33-(0.833)

=== Evaluating Model ===
Total valid loss 1.0919988205035527
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 7/20 ****
21/33-(0.825)
3/33-(0.784)
18/33-(0.735)
0/33-(1.302)

=== Evaluating Model ===
Total valid loss 1.299422527352969
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 8/20 ****
15/33-(0.708)
30/33-(0.652)
12/33-(0.687)
27/33-(0.792)

=== Evaluating Model ===
Total valid loss 1.4173212051391602
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 9/20 ****
9/33-(0.879)
24/33-(0.450)
6/33-(0.735)
21/33-(0.863)

=== Evaluating Model ===
Total valid loss 1.4303636054197948
accuracy on Test 0.4166666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 10/20 ****
3/33-(0.582)
18/33-(0.893)
0/33-(0.820)

=== Evaluating Model ===
Total valid loss 1.580765724182129
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5666666666666667

**** Epoch 11/20 ****
15/33-(0.658)
30/33-(0.656)
12/33-(0.435)
27/33-(0.545)

=== Evaluating Model ===
Total valid loss 1.6201497117678325
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 12/20 ****
9/33-(0.654)
24/33-(0.341)
6/33-(0.253)
21/33-(0.529)

=== Evaluating Model ===
Total valid loss 1.6625022391478221
accuracy on Test 0.35555555555555557
Best accuracy on Test 0.5666666666666667

**** Epoch 13/20 ****
3/33-(0.363)
18/33-(0.424)
0/33-(0.289)
15/33-(0.354)

=== Evaluating Model ===
Total valid loss 2.1324035078287125
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 14/20 ****
30/33-(0.517)
12/33-(0.614)
27/33-(0.479)

=== Evaluating Model ===
Total valid loss 1.992256964246432
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 15/20 ****
9/33-(0.492)
24/33-(0.493)
6/33-(0.077)
21/33-(0.447)

=== Evaluating Model ===
Total valid loss 2.2732695738474527
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5666666666666667

**** Epoch 16/20 ****
3/33-(0.220)
18/33-(0.293)
0/33-(0.306)
15/33-(0.647)

=== Evaluating Model ===
Total valid loss 2.6629645427068076
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 17/20 ****
30/33-(0.157)
12/33-(1.061)
27/33-(0.129)

=== Evaluating Model ===
Total valid loss 2.1807990223169327
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5666666666666667

**** Epoch 18/20 ****
9/33-(0.485)
24/33-(0.746)
6/33-(0.203)
21/33-(0.620)

=== Evaluating Model ===
Total valid loss 2.903823504845301
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5666666666666667

**** Epoch 19/20 ****
3/33-(0.150)
18/33-(0.220)
Best accuracy on Test 0.5666666666666667

Source domain: Yelp, Target domain: Yelp, Cur_fold 4
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
261
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.815)
30/33-(1.619)
12/33-(1.415)

=== Evaluating Model ===
Total valid loss 1.069770077864329
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 0/20 ****
27/33-(1.293)
9/33-(1.273)
24/33-(1.112)
6/33-(1.148)

=== Evaluating Model ===
Total valid loss 1.037500227491061
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 1/20 ****
21/33-(1.138)
3/33-(1.153)
18/33-(1.078)
0/33-(1.103)

=== Evaluating Model ===
Total valid loss 1.0489156792561214
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 2/20 ****
15/33-(0.911)
30/33-(1.119)
12/33-(0.656)

=== Evaluating Model ===
Total valid loss 1.0213507215181987
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 3/20 ****
27/33-(1.046)
9/33-(1.036)
24/33-(0.893)
6/33-(1.095)

=== Evaluating Model ===
Total valid loss 1.0383383582035701
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 4/20 ****
21/33-(1.588)
3/33-(0.957)
18/33-(1.147)
0/33-(0.602)

=== Evaluating Model ===
Total valid loss 1.1144611686468124
accuracy on Test 0.4
Best accuracy on Test 0.5666666666666667

**** Epoch 5/20 ****
15/33-(1.035)
30/33-(0.957)
12/33-(1.022)
27/33-(1.063)

=== Evaluating Model ===
Total valid loss 1.2409565647443135
accuracy on Test 0.35
Best accuracy on Test 0.5666666666666667

**** Epoch 6/20 ****
9/33-(1.143)
24/33-(1.220)
6/33-(0.923)

=== Evaluating Model ===
Total valid loss 1.163797731200854
accuracy on Test 0.45
Best accuracy on Test 0.5666666666666667

**** Epoch 7/20 ****
21/33-(0.841)
3/33-(0.789)
18/33-(0.515)
0/33-(0.687)

=== Evaluating Model ===
Total valid loss 1.1515838851531346
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5666666666666667

**** Epoch 8/20 ****
15/33-(0.850)
30/33-(0.823)
12/33-(0.778)
27/33-(0.823)

=== Evaluating Model ===
Total valid loss 1.3281930188337963
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5666666666666667

**** Epoch 9/20 ****
9/33-(0.967)
24/33-(0.661)
6/33-(0.658)
21/33-(0.944)

=== Evaluating Model ===
Total valid loss 1.4045444677273433
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5666666666666667

**** Epoch 10/20 ****
3/33-(0.742)
18/33-(0.487)
0/33-(1.656)

=== Evaluating Model ===
Total valid loss 1.182298521200816
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 11/20 ****
15/33-(0.391)
30/33-(0.659)
12/33-(0.305)
27/33-(0.715)

=== Evaluating Model ===
Total valid loss 1.331610490878423
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 12/20 ****
9/33-(0.400)
24/33-(0.548)
6/33-(0.347)
21/33-(0.547)

=== Evaluating Model ===
Total valid loss 1.555576001604398
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5666666666666667

**** Epoch 13/20 ****
3/33-(0.298)
18/33-(0.650)
0/33-(0.505)
15/33-(0.582)

=== Evaluating Model ===
Total valid loss 2.2045644422372184
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.5666666666666667

**** Epoch 14/20 ****
30/33-(0.027)
12/33-(0.359)
27/33-(0.506)

=== Evaluating Model ===
Total valid loss 2.048381874958674
accuracy on Test 0.37777777777777777
Best accuracy on Test 0.5666666666666667

**** Epoch 15/20 ****
9/33-(0.899)
24/33-(0.176)
6/33-(0.279)
21/33-(0.166)

=== Evaluating Model ===
Total valid loss 2.1334996422131858
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5666666666666667

**** Epoch 16/20 ****
3/33-(0.322)
18/33-(0.404)
0/33-(1.027)
15/33-(0.401)

=== Evaluating Model ===
Total valid loss 2.246287375688553
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5666666666666667

**** Epoch 17/20 ****
30/33-(0.320)
12/33-(0.350)
27/33-(0.410)

=== Evaluating Model ===
Total valid loss 2.446185886859894
accuracy on Test 0.4222222222222222
Best accuracy on Test 0.5666666666666667

**** Epoch 18/20 ****
9/33-(0.682)
24/33-(0.119)
6/33-(0.446)
21/33-(0.156)

=== Evaluating Model ===
Total valid loss 2.3378022611141205
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5666666666666667

**** Epoch 19/20 ****
3/33-(1.369)
18/33-(0.298)
Best accuracy on Test 0.5666666666666667

Source domain: Yelp, Target domain: Yelp, Cur_fold 5
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
261
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.993)
30/33-(1.270)
12/33-(1.601)

=== Evaluating Model ===
Total valid loss 1.027636095881462
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 0/20 ****
27/33-(1.332)
9/33-(1.186)
24/33-(1.095)
6/33-(1.120)

=== Evaluating Model ===
Total valid loss 1.019713009397189
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 1/20 ****
21/33-(1.180)
3/33-(1.074)
18/33-(1.214)
0/33-(1.496)

=== Evaluating Model ===
Total valid loss 1.0109597742557526
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 2/20 ****
15/33-(1.130)
30/33-(1.020)
12/33-(0.962)

=== Evaluating Model ===
Total valid loss 1.0795646061499913
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 3/20 ****
27/33-(1.272)
9/33-(1.049)
24/33-(0.984)
6/33-(0.950)

=== Evaluating Model ===
Total valid loss 1.004478429754575
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 4/20 ****
21/33-(0.979)
3/33-(1.245)
18/33-(1.322)
0/33-(0.947)

=== Evaluating Model ===
Total valid loss 1.0409752577543259
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5666666666666667

**** Epoch 5/20 ****
15/33-(1.259)
30/33-(0.855)
12/33-(1.508)
27/33-(0.684)

=== Evaluating Model ===
Total valid loss 1.2592153549194336
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5666666666666667

**** Epoch 6/20 ****
9/33-(1.025)
24/33-(1.038)
6/33-(1.042)

=== Evaluating Model ===
Total valid loss 1.292731727162997
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5666666666666667

**** Epoch 7/20 ****
21/33-(0.688)
3/33-(0.931)
18/33-(0.754)
0/33-(0.681)

=== Evaluating Model ===
Total valid loss 1.2646237413088481
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.5666666666666667

**** Epoch 8/20 ****
15/33-(1.074)
30/33-(1.097)
12/33-(1.020)
27/33-(0.820)

=== Evaluating Model ===
Total valid loss 1.3665942301352818
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 9/20 ****
9/33-(1.074)
24/33-(0.709)
6/33-(0.519)
21/33-(0.760)

=== Evaluating Model ===
Total valid loss 1.4157125254472096
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 10/20 ****
3/33-(0.341)
18/33-(0.672)
0/33-(0.948)

=== Evaluating Model ===
Total valid loss 1.2898043245077133
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5666666666666667

**** Epoch 11/20 ****
15/33-(0.768)
30/33-(0.371)
12/33-(0.580)
27/33-(1.131)

=== Evaluating Model ===
Total valid loss 1.5957864324251811
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5666666666666667

**** Epoch 12/20 ****
9/33-(0.432)
24/33-(0.313)
6/33-(0.652)
21/33-(0.531)

=== Evaluating Model ===
Total valid loss 1.7483698626359303
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5666666666666667

**** Epoch 13/20 ****
3/33-(0.999)
18/33-(0.503)
0/33-(0.401)
15/33-(0.206)

=== Evaluating Model ===
Total valid loss 1.8114742537339528
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5666666666666667

**** Epoch 14/20 ****
30/33-(0.772)
12/33-(0.286)
27/33-(0.298)

=== Evaluating Model ===
Total valid loss 2.1455192267894745
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 15/20 ****
9/33-(0.409)
24/33-(0.428)
6/33-(0.226)
21/33-(0.452)

=== Evaluating Model ===
Total valid loss 1.7939584751923878
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5666666666666667

**** Epoch 16/20 ****
3/33-(0.239)
18/33-(0.217)
0/33-(0.484)
15/33-(0.057)

=== Evaluating Model ===
Total valid loss 2.603593190511068
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.5666666666666667

**** Epoch 17/20 ****
30/33-(0.270)
12/33-(0.797)
27/33-(0.183)

=== Evaluating Model ===
Total valid loss 2.4709398647149405
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 18/20 ****
9/33-(0.275)
24/33-(0.212)
6/33-(0.128)
21/33-(0.552)

=== Evaluating Model ===
Total valid loss 2.5463859140872955
accuracy on Test 0.35555555555555557
Best accuracy on Test 0.5666666666666667

**** Epoch 19/20 ****
3/33-(0.565)
18/33-(0.752)
Best accuracy on Test 0.5666666666666667

Source domain: Yelp, Target domain: Yelp, Cur_fold 6
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
261
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.630)
30/33-(1.607)
12/33-(1.651)

=== Evaluating Model ===
Total valid loss 1.0410427153110504
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 0/20 ****
27/33-(1.119)
9/33-(0.921)
24/33-(1.115)
6/33-(1.407)

=== Evaluating Model ===
Total valid loss 1.014096920688947
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.55

**** Epoch 1/20 ****
21/33-(1.076)
3/33-(1.106)
18/33-(1.029)
0/33-(1.116)

=== Evaluating Model ===
Total valid loss 0.9981037775675455
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 2/20 ****
15/33-(0.971)
30/33-(1.197)
12/33-(0.994)

=== Evaluating Model ===
Total valid loss 1.010700802008311
accuracy on Test 0.5722222222222222
Best accuracy on Test 0.5722222222222222

**** Epoch 3/20 ****
27/33-(1.073)
9/33-(1.069)
24/33-(0.940)
6/33-(0.787)

=== Evaluating Model ===
Total valid loss 1.3035189708073933
accuracy on Test 0.31666666666666665
Best accuracy on Test 0.5722222222222222

**** Epoch 4/20 ****
21/33-(1.094)
3/33-(1.253)
18/33-(1.029)
0/33-(1.110)

=== Evaluating Model ===
Total valid loss 1.0310854613780975
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5722222222222222

**** Epoch 5/20 ****
15/33-(0.826)
30/33-(1.143)
12/33-(1.056)
27/33-(0.717)

=== Evaluating Model ===
Total valid loss 1.2658737550179164
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5722222222222222

**** Epoch 6/20 ****
9/33-(0.934)
24/33-(0.718)
6/33-(0.804)

=== Evaluating Model ===
Total valid loss 1.1488788773616154
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5722222222222222

**** Epoch 7/20 ****
21/33-(0.917)
3/33-(1.154)
18/33-(1.019)
0/33-(0.785)

=== Evaluating Model ===
Total valid loss 1.1795770327250164
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5722222222222222

**** Epoch 8/20 ****
15/33-(1.136)
30/33-(0.826)
12/33-(0.820)
27/33-(1.110)

=== Evaluating Model ===
Total valid loss 1.1848614662885666
accuracy on Test 0.3888888888888889
Best accuracy on Test 0.5722222222222222

**** Epoch 9/20 ****
9/33-(1.367)
24/33-(0.733)
6/33-(0.734)
21/33-(0.791)

=== Evaluating Model ===
Total valid loss 1.2142623712619145
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5722222222222222

**** Epoch 10/20 ****
3/33-(1.037)
18/33-(0.367)
0/33-(1.195)

=== Evaluating Model ===
Total valid loss 1.4289118200540543
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5722222222222222

**** Epoch 11/20 ****
15/33-(0.662)
30/33-(0.609)
12/33-(0.389)
27/33-(0.705)

=== Evaluating Model ===
Total valid loss 1.5178364465634029
accuracy on Test 0.3888888888888889
Best accuracy on Test 0.5722222222222222

**** Epoch 12/20 ****
9/33-(0.569)
24/33-(0.624)
6/33-(0.800)
21/33-(0.694)

=== Evaluating Model ===
Total valid loss 1.94030299782753
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.5722222222222222

**** Epoch 13/20 ****
3/33-(0.325)
18/33-(0.376)
0/33-(0.536)
15/33-(0.625)

=== Evaluating Model ===
Total valid loss 2.1240643163522086
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5722222222222222

**** Epoch 14/20 ****
30/33-(0.859)
12/33-(0.403)
27/33-(0.729)

=== Evaluating Model ===
Total valid loss 2.5980909566084542
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5722222222222222

**** Epoch 15/20 ****
9/33-(0.338)
24/33-(0.408)
6/33-(0.541)
21/33-(0.395)

=== Evaluating Model ===
Total valid loss 2.288848062356313
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.5722222222222222

**** Epoch 16/20 ****
3/33-(0.219)
18/33-(0.665)
0/33-(0.331)
15/33-(0.808)

=== Evaluating Model ===
Total valid loss 3.054767459630966
accuracy on Test 0.39444444444444443
Best accuracy on Test 0.5722222222222222

**** Epoch 17/20 ****
30/33-(0.245)
12/33-(0.915)
27/33-(0.314)

=== Evaluating Model ===
Total valid loss 2.2492073824008307
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5722222222222222

**** Epoch 18/20 ****
9/33-(0.309)
24/33-(0.512)
6/33-(0.135)
21/33-(0.631)

=== Evaluating Model ===
Total valid loss 2.937623679637909
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.5722222222222222

**** Epoch 19/20 ****
3/33-(0.633)
18/33-(1.109)
Best accuracy on Test 0.5722222222222222

Source domain: Yelp, Target domain: Yelp, Cur_fold 7
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
261
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.865)
30/33-(1.349)
12/33-(1.404)

=== Evaluating Model ===
Total valid loss 1.0454853624105453
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 0/20 ****
27/33-(1.437)
9/33-(1.252)
24/33-(1.263)
6/33-(1.283)

=== Evaluating Model ===
Total valid loss 1.1154448042313259
accuracy on Test 0.28888888888888886
Best accuracy on Test 0.55

**** Epoch 1/20 ****
21/33-(1.192)
3/33-(1.237)
18/33-(1.228)
0/33-(1.168)

=== Evaluating Model ===
Total valid loss 1.0390694588422775
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.55

**** Epoch 2/20 ****
15/33-(1.024)
30/33-(1.161)
12/33-(1.042)

=== Evaluating Model ===
Total valid loss 1.0263555198907852
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.55

**** Epoch 3/20 ****
27/33-(1.031)
9/33-(1.093)
24/33-(1.019)
6/33-(1.081)

=== Evaluating Model ===
Total valid loss 1.0347224871317546
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 4/20 ****
21/33-(1.439)
3/33-(1.095)
18/33-(1.023)
0/33-(1.025)

=== Evaluating Model ===
Total valid loss 1.0092518279949825
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5555555555555556

**** Epoch 5/20 ****
15/33-(0.915)
30/33-(0.782)
12/33-(0.887)
27/33-(1.000)

=== Evaluating Model ===
Total valid loss 0.9971955170234045
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 6/20 ****
9/33-(1.132)
24/33-(0.879)
6/33-(0.753)

=== Evaluating Model ===
Total valid loss 1.052134171128273
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5611111111111111

**** Epoch 7/20 ****
21/33-(0.986)
3/33-(0.814)
18/33-(0.551)
0/33-(1.459)

=== Evaluating Model ===
Total valid loss 1.0891392330328624
accuracy on Test 0.55
Best accuracy on Test 0.5611111111111111

**** Epoch 8/20 ****
15/33-(0.781)
30/33-(0.697)
12/33-(0.694)
27/33-(0.696)

=== Evaluating Model ===
Total valid loss 1.468109558025996
accuracy on Test 0.40555555555555556
Best accuracy on Test 0.5611111111111111

**** Epoch 9/20 ****
9/33-(0.706)
24/33-(0.765)
6/33-(0.902)
21/33-(0.495)

=== Evaluating Model ===
Total valid loss 1.6775392989317577
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 10/20 ****
3/33-(0.484)
18/33-(0.801)
0/33-(0.324)

=== Evaluating Model ===
Total valid loss 1.4372302542130153
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5611111111111111

**** Epoch 11/20 ****
15/33-(1.076)
30/33-(0.607)
12/33-(0.620)
27/33-(0.510)

=== Evaluating Model ===
Total valid loss 1.6221363792816799
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5611111111111111

**** Epoch 12/20 ****
9/33-(0.750)
24/33-(0.380)
6/33-(0.689)
21/33-(1.055)

=== Evaluating Model ===
Total valid loss 2.278848042090734
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 13/20 ****
3/33-(0.986)
18/33-(0.450)
0/33-(0.805)
15/33-(0.568)

=== Evaluating Model ===
Total valid loss 1.9616124828656514
accuracy on Test 0.5
Best accuracy on Test 0.5611111111111111

**** Epoch 14/20 ****
30/33-(0.455)
12/33-(0.503)
27/33-(0.617)

=== Evaluating Model ===
Total valid loss 2.1764263113339744
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 15/20 ****
9/33-(0.561)
24/33-(0.766)
6/33-(0.829)
21/33-(0.715)

=== Evaluating Model ===
Total valid loss 2.901910056670507
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5611111111111111

**** Epoch 16/20 ****
3/33-(0.495)
18/33-(0.690)
0/33-(0.679)
15/33-(0.408)

=== Evaluating Model ===
Total valid loss 2.4064316948254905
accuracy on Test 0.4222222222222222
Best accuracy on Test 0.5611111111111111

**** Epoch 17/20 ****
30/33-(1.007)
12/33-(0.160)
27/33-(0.219)

=== Evaluating Model ===
Total valid loss 2.4537466665109
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 18/20 ****
9/33-(0.409)
24/33-(0.416)
6/33-(0.194)
21/33-(0.379)

=== Evaluating Model ===
Total valid loss 3.114765147368113
accuracy on Test 0.4222222222222222
Best accuracy on Test 0.5611111111111111

**** Epoch 19/20 ****
3/33-(0.129)
18/33-(0.654)
Best accuracy on Test 0.5611111111111111

Source domain: Yelp, Target domain: Yelp, Cur_fold 8
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
261
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(2.018)
30/33-(1.709)
12/33-(1.259)

=== Evaluating Model ===
Total valid loss 1.1548548638820648
accuracy on Test 0.24444444444444444
Best accuracy on Test 0.24444444444444444

**** Epoch 0/20 ****
27/33-(1.236)
9/33-(1.162)
24/33-(1.123)
6/33-(1.200)

=== Evaluating Model ===
Total valid loss 1.0280449738105137
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5166666666666667

**** Epoch 1/20 ****
21/33-(1.001)
3/33-(0.870)
18/33-(1.167)
0/33-(1.098)

=== Evaluating Model ===
Total valid loss 1.0210271527369816
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5277777777777778

**** Epoch 2/20 ****
15/33-(0.926)
30/33-(1.061)
12/33-(1.177)

=== Evaluating Model ===
Total valid loss 1.035596802830696
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5277777777777778

**** Epoch 3/20 ****
27/33-(1.042)
9/33-(0.965)
24/33-(0.979)
6/33-(1.046)

=== Evaluating Model ===
Total valid loss 1.0387552678585052
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5277777777777778

**** Epoch 4/20 ****
21/33-(1.382)
3/33-(1.129)
18/33-(0.998)
0/33-(0.820)

=== Evaluating Model ===
Total valid loss 1.0701306809981663
accuracy on Test 0.5
Best accuracy on Test 0.5277777777777778

**** Epoch 5/20 ****
15/33-(0.759)
30/33-(0.937)
12/33-(0.949)
27/33-(1.138)

=== Evaluating Model ===
Total valid loss 1.1681227783362071
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5277777777777778

**** Epoch 6/20 ****
9/33-(1.555)
24/33-(1.090)
6/33-(1.165)

=== Evaluating Model ===
Total valid loss 1.1681967129309971
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5277777777777778

**** Epoch 7/20 ****
21/33-(0.951)
3/33-(0.812)
18/33-(1.309)
0/33-(0.741)

=== Evaluating Model ===
Total valid loss 1.0948180307944615
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 8/20 ****
15/33-(0.580)
30/33-(0.641)
12/33-(0.654)
27/33-(0.723)

=== Evaluating Model ===
Total valid loss 1.0876682351032894
accuracy on Test 0.5
Best accuracy on Test 0.55

**** Epoch 9/20 ****
9/33-(0.542)
24/33-(0.702)
6/33-(0.901)
21/33-(0.912)

=== Evaluating Model ===
Total valid loss 1.2782915184895198
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.55

**** Epoch 10/20 ****
3/33-(0.724)
18/33-(0.450)
0/33-(0.417)

=== Evaluating Model ===
Total valid loss 1.5715576708316803
accuracy on Test 0.4
Best accuracy on Test 0.55

**** Epoch 11/20 ****
15/33-(0.896)
30/33-(0.617)
12/33-(0.808)
27/33-(1.035)

=== Evaluating Model ===
Total valid loss 1.4520717561244965
accuracy on Test 0.39444444444444443
Best accuracy on Test 0.55

**** Epoch 12/20 ****
9/33-(0.716)
24/33-(0.476)
6/33-(0.322)
21/33-(1.175)

=== Evaluating Model ===
Total valid loss 1.4139994631210964
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.55

**** Epoch 13/20 ****
3/33-(0.754)
18/33-(0.343)
0/33-(0.522)
15/33-(0.397)

=== Evaluating Model ===
Total valid loss 1.795113667845726
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.55

**** Epoch 14/20 ****
30/33-(0.342)
12/33-(0.784)
27/33-(0.588)

=== Evaluating Model ===
Total valid loss 1.7621053755283356
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.55

**** Epoch 15/20 ****
9/33-(0.169)
24/33-(0.359)
6/33-(0.502)
21/33-(0.717)

=== Evaluating Model ===
Total valid loss 2.0960673292477927
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.55

**** Epoch 16/20 ****
3/33-(0.224)
18/33-(0.098)
0/33-(0.431)
15/33-(1.250)

=== Evaluating Model ===
Total valid loss 2.5723237146933875
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.55

**** Epoch 17/20 ****
30/33-(0.508)
12/33-(0.139)
27/33-(0.105)

=== Evaluating Model ===
Total valid loss 2.648440102736155
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.55

**** Epoch 18/20 ****
9/33-(0.260)
24/33-(0.383)
6/33-(0.313)
21/33-(0.224)

=== Evaluating Model ===
Total valid loss 2.989717294772466
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.55

**** Epoch 19/20 ****
3/33-(0.577)
18/33-(0.075)
Best accuracy on Test 0.55

Source domain: Yelp, Target domain: Yelp, Cur_fold 9
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
303
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.648)
30/33-(1.294)
12/33-(1.603)

=== Evaluating Model ===
Total valid loss 1.0708876848220825
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.4111111111111111

**** Epoch 0/20 ****
27/33-(1.064)
9/33-(1.195)
24/33-(1.287)
6/33-(1.142)

=== Evaluating Model ===
Total valid loss 1.055341104666392
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 1/20 ****
21/33-(1.113)
3/33-(1.291)
18/33-(1.085)
0/33-(1.134)

=== Evaluating Model ===
Total valid loss 1.0323778092861176
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 2/20 ****
15/33-(1.084)
30/33-(1.134)
12/33-(1.220)

=== Evaluating Model ===
Total valid loss 1.0003769745429356
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 3/20 ****
27/33-(1.010)
9/33-(1.023)
24/33-(1.310)
6/33-(0.820)

=== Evaluating Model ===
Total valid loss 1.0158059298992157
accuracy on Test 0.55
Best accuracy on Test 0.5611111111111111

**** Epoch 4/20 ****
21/33-(1.175)
3/33-(1.099)
18/33-(1.040)
0/33-(1.014)

=== Evaluating Model ===
Total valid loss 1.176312228043874
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5611111111111111

**** Epoch 5/20 ****
15/33-(1.026)
30/33-(1.046)
12/33-(0.897)
27/33-(1.184)

=== Evaluating Model ===
Total valid loss 1.1038367648919423
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 6/20 ****
9/33-(0.809)
24/33-(0.589)
6/33-(0.889)

=== Evaluating Model ===
Total valid loss 1.188705638051033
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5611111111111111

**** Epoch 7/20 ****
21/33-(0.921)
3/33-(1.076)
18/33-(1.090)
0/33-(0.847)

=== Evaluating Model ===
Total valid loss 1.130348727107048
accuracy on Test 0.5777777777777777
Best accuracy on Test 0.5777777777777777

**** Epoch 8/20 ****
15/33-(0.871)
30/33-(1.052)
12/33-(0.945)
27/33-(0.775)

=== Evaluating Model ===
Total valid loss 1.2385631601015727
accuracy on Test 0.5777777777777777
Best accuracy on Test 0.5777777777777777

**** Epoch 9/20 ****
9/33-(0.528)
24/33-(1.001)
6/33-(0.639)
21/33-(0.691)

=== Evaluating Model ===
Total valid loss 1.3086145669221878
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.5777777777777777

**** Epoch 10/20 ****
3/33-(0.575)
18/33-(0.610)
0/33-(0.813)

=== Evaluating Model ===
Total valid loss 1.3512228429317474
accuracy on Test 0.37222222222222223
Best accuracy on Test 0.5777777777777777

**** Epoch 11/20 ****
15/33-(0.715)
30/33-(0.729)
12/33-(0.480)
27/33-(0.571)

=== Evaluating Model ===
Total valid loss 1.6772592663764954
accuracy on Test 0.4222222222222222
Best accuracy on Test 0.5777777777777777

**** Epoch 12/20 ****
9/33-(0.585)
24/33-(0.476)
6/33-(1.016)
21/33-(0.525)

=== Evaluating Model ===
Total valid loss 1.4342926392952602
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5777777777777777

**** Epoch 13/20 ****
3/33-(0.831)
18/33-(0.504)
0/33-(0.604)
15/33-(0.644)

=== Evaluating Model ===
Total valid loss 1.6462277273337047
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5777777777777777

**** Epoch 14/20 ****
30/33-(0.296)
12/33-(0.346)
27/33-(0.646)

=== Evaluating Model ===
Total valid loss 1.8523792922496796
accuracy on Test 0.40555555555555556
Best accuracy on Test 0.5777777777777777

**** Epoch 15/20 ****
9/33-(0.384)
24/33-(0.317)
6/33-(0.731)
21/33-(1.360)

=== Evaluating Model ===
Total valid loss 1.6591425836086273
accuracy on Test 0.4111111111111111
Best accuracy on Test 0.5777777777777777

**** Epoch 16/20 ****
3/33-(0.274)
18/33-(0.531)
0/33-(0.406)
15/33-(0.291)

=== Evaluating Model ===
Total valid loss 1.9091356297334034
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5777777777777777

**** Epoch 17/20 ****
30/33-(0.400)
12/33-(1.261)
27/33-(0.260)

=== Evaluating Model ===
Total valid loss 2.1946444312731423
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5777777777777777

**** Epoch 18/20 ****
9/33-(0.380)
24/33-(0.264)
6/33-(0.537)
21/33-(0.592)

=== Evaluating Model ===
Total valid loss 2.5088956356048584
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5777777777777777

**** Epoch 19/20 ****
3/33-(0.341)
18/33-(0.509)
Best accuracy on Test 0.5777777777777777

Final k-fold valid -1.0
[-1, -1, -1, -1, -1, -1, -1, -1, -1, -1]
Final k-fold eval 0.5644444444444443
[0.5555555555555556, 0.5666666666666667, 0.5611111111111111, 0.5666666666666667, 0.5666666666666667, 0.5666666666666667, 0.5722222222222222, 0.5611111111111111, 0.55, 0.5777777777777777]
