Whole k-fold eval mode
Source domain: Enron, Target domain: Enron, Cur_fold 0
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
170
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: Centering Structure
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.278)
30/33-(1.045)
12/33-(0.961)

=== Evaluating Model ===
Total valid loss 1.1334766099850337
accuracy on Test 0.2722222222222222
Best accuracy on Test 0.2722222222222222

**** Epoch 0/20 ****
27/33-(0.874)
9/33-(0.975)
24/33-(0.986)
6/33-(1.302)

=== Evaluating Model ===
Total valid loss 1.2480422755082448
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.43333333333333335

**** Epoch 1/20 ****
21/33-(1.094)
3/33-(0.912)
18/33-(1.012)
0/33-(1.251)

=== Evaluating Model ===
Total valid loss 1.072335198521614
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.48333333333333334

**** Epoch 2/20 ****
15/33-(0.715)
30/33-(1.006)
12/33-(1.036)

=== Evaluating Model ===
Total valid loss 1.0970881929000218
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5166666666666667

**** Epoch 3/20 ****
27/33-(1.022)
9/33-(0.737)
24/33-(0.646)
6/33-(1.105)

=== Evaluating Model ===
Total valid loss 1.0648706058661144
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5166666666666667

**** Epoch 4/20 ****
21/33-(0.163)
3/33-(0.870)
18/33-(0.514)
0/33-(0.559)

=== Evaluating Model ===
Total valid loss 1.1428206513325374
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5166666666666667

**** Epoch 5/20 ****
15/33-(0.615)
30/33-(0.690)
12/33-(0.711)
27/33-(0.829)

=== Evaluating Model ===
Total valid loss 1.1021112600962322
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5166666666666667

**** Epoch 6/20 ****
9/33-(0.609)
24/33-(0.599)
6/33-(0.636)

=== Evaluating Model ===
Total valid loss 1.211130862434705
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 7/20 ****
21/33-(0.967)
3/33-(0.564)
18/33-(0.684)
0/33-(0.988)

=== Evaluating Model ===
Total valid loss 1.2108270823955536
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5333333333333333

**** Epoch 8/20 ****
15/33-(0.574)
30/33-(0.438)
12/33-(0.455)
27/33-(0.344)

=== Evaluating Model ===
Total valid loss 1.346156969666481
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5333333333333333

**** Epoch 9/20 ****
9/33-(0.422)
24/33-(0.740)
6/33-(0.920)
21/33-(0.765)

=== Evaluating Model ===
Total valid loss 1.483003983894984
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5333333333333333

**** Epoch 10/20 ****
3/33-(0.459)
18/33-(0.471)
0/33-(0.641)

=== Evaluating Model ===
Total valid loss 1.2642054706811905
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5333333333333333

**** Epoch 11/20 ****
15/33-(0.783)
30/33-(0.556)
12/33-(0.804)
27/33-(0.543)

=== Evaluating Model ===
Total valid loss 1.5260223497947056
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5333333333333333

**** Epoch 12/20 ****
9/33-(0.757)
24/33-(0.496)
6/33-(0.763)
21/33-(1.056)

=== Evaluating Model ===
Total valid loss 1.4343949059645336
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5333333333333333

**** Epoch 13/20 ****
3/33-(0.571)
18/33-(0.625)
0/33-(0.588)
15/33-(0.611)

=== Evaluating Model ===
Total valid loss 1.3694791843493779
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5333333333333333

**** Epoch 14/20 ****
30/33-(0.348)
12/33-(0.371)
27/33-(0.110)

=== Evaluating Model ===
Total valid loss 2.0298078507184982
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.5333333333333333

**** Epoch 15/20 ****
9/33-(0.696)
24/33-(0.339)
6/33-(0.523)
21/33-(0.391)

=== Evaluating Model ===
Total valid loss 1.7490750700235367
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5333333333333333

**** Epoch 16/20 ****
3/33-(0.124)
18/33-(0.172)
0/33-(0.704)
15/33-(0.422)

=== Evaluating Model ===
Total valid loss 2.9708690643310547
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5333333333333333

**** Epoch 17/20 ****
30/33-(0.144)
12/33-(0.304)
27/33-(0.245)

=== Evaluating Model ===
Total valid loss 2.028219555815061
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5333333333333333

**** Epoch 18/20 ****
9/33-(0.439)
24/33-(0.304)
6/33-(0.180)
21/33-(0.320)

=== Evaluating Model ===
Total valid loss 1.967694640159607
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5333333333333333

**** Epoch 19/20 ****
3/33-(0.321)
18/33-(0.279)
Best accuracy on Test 0.5333333333333333

Source domain: Enron, Target domain: Enron, Cur_fold 1
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
170
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: Centering Structure
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.039)
30/33-(1.380)
12/33-(1.093)

=== Evaluating Model ===
Total valid loss 1.1212016493082047
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 0/20 ****
27/33-(1.537)
9/33-(0.986)
24/33-(1.054)
6/33-(0.857)

=== Evaluating Model ===
Total valid loss 1.0359830260276794
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5444444444444444

**** Epoch 1/20 ****
21/33-(1.013)
3/33-(1.234)
18/33-(1.000)
0/33-(0.843)

=== Evaluating Model ===
Total valid loss 0.9537370850642523
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 2/20 ****
15/33-(0.769)
30/33-(0.657)
12/33-(1.166)

=== Evaluating Model ===
Total valid loss 0.9858416616916656
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5611111111111111

**** Epoch 3/20 ****
27/33-(0.685)
9/33-(0.742)
24/33-(0.671)
6/33-(0.918)

=== Evaluating Model ===
Total valid loss 1.0123479465643566
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5611111111111111

**** Epoch 4/20 ****
21/33-(0.698)
3/33-(0.544)
18/33-(0.770)
0/33-(0.763)

=== Evaluating Model ===
Total valid loss 0.9429343094428381
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 5/20 ****
15/33-(0.948)
30/33-(0.538)
12/33-(1.099)
27/33-(0.647)

=== Evaluating Model ===
Total valid loss 1.0705829709768295
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.5611111111111111

**** Epoch 6/20 ****
9/33-(0.842)
24/33-(0.812)
6/33-(0.804)

=== Evaluating Model ===
Total valid loss 1.0108847618103027
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5611111111111111

**** Epoch 7/20 ****
21/33-(0.953)
3/33-(0.426)
18/33-(0.557)
0/33-(0.726)

=== Evaluating Model ===
Total valid loss 0.9941669702529907
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 8/20 ****
15/33-(0.932)
30/33-(0.849)
12/33-(0.837)
27/33-(0.590)

=== Evaluating Model ===
Total valid loss 1.0387861529986064
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5611111111111111

**** Epoch 9/20 ****
9/33-(0.583)
24/33-(0.520)
6/33-(0.647)
21/33-(0.414)

=== Evaluating Model ===
Total valid loss 1.2029119282960892
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5611111111111111

**** Epoch 10/20 ****
3/33-(0.378)
18/33-(0.691)
0/33-(0.728)

=== Evaluating Model ===
Total valid loss 1.060847595334053
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 11/20 ****
15/33-(0.757)
30/33-(0.581)
12/33-(0.898)
27/33-(0.590)

=== Evaluating Model ===
Total valid loss 1.1743070979913075
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 12/20 ****
9/33-(0.691)
24/33-(0.814)
6/33-(1.009)
21/33-(0.617)

=== Evaluating Model ===
Total valid loss 1.3847046097119649
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 13/20 ****
3/33-(0.569)
18/33-(0.948)
0/33-(0.539)
15/33-(0.443)

=== Evaluating Model ===
Total valid loss 1.119320477048556
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 14/20 ****
30/33-(0.207)
12/33-(0.623)
27/33-(0.249)

=== Evaluating Model ===
Total valid loss 1.6369403650363286
accuracy on Test 0.4166666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 15/20 ****
9/33-(0.486)
24/33-(1.019)
6/33-(0.315)
21/33-(0.281)

=== Evaluating Model ===
Total valid loss 1.9789423197507858
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5611111111111111

**** Epoch 16/20 ****
3/33-(0.292)
18/33-(0.218)
0/33-(0.210)
15/33-(0.342)

=== Evaluating Model ===
Total valid loss 1.8521121442317963
accuracy on Test 0.42777777777777776
Best accuracy on Test 0.5611111111111111

**** Epoch 17/20 ****
30/33-(0.528)
12/33-(0.818)
27/33-(0.296)

=== Evaluating Model ===
Total valid loss 2.440667892495791
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5611111111111111

**** Epoch 18/20 ****
9/33-(0.645)
24/33-(0.448)
6/33-(0.575)
21/33-(0.146)

=== Evaluating Model ===
Total valid loss 1.7591558595498402
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5611111111111111

**** Epoch 19/20 ****
3/33-(0.986)
18/33-(0.163)
Best accuracy on Test 0.5611111111111111

Source domain: Enron, Target domain: Enron, Cur_fold 2
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
170
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: Centering Structure
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.174)
30/33-(1.328)
12/33-(0.984)

=== Evaluating Model ===
Total valid loss 1.0541972815990448
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.4777777777777778

**** Epoch 0/20 ****
27/33-(1.159)
9/33-(1.048)
24/33-(0.806)
6/33-(1.182)

=== Evaluating Model ===
Total valid loss 1.0872383763392766
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5333333333333333

**** Epoch 1/20 ****
21/33-(1.200)
3/33-(0.597)
18/33-(0.822)
0/33-(0.808)

=== Evaluating Model ===
Total valid loss 1.0583604375521343
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5333333333333333

**** Epoch 2/20 ****
15/33-(0.638)
30/33-(1.107)
12/33-(1.151)

=== Evaluating Model ===
Total valid loss 1.0158730894327164
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.5333333333333333

**** Epoch 3/20 ****
27/33-(1.143)
9/33-(0.757)
24/33-(0.846)
6/33-(1.186)

=== Evaluating Model ===
Total valid loss 1.0384789953629177
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5333333333333333

**** Epoch 4/20 ****
21/33-(1.481)
3/33-(0.823)
18/33-(0.859)
0/33-(0.786)

=== Evaluating Model ===
Total valid loss 1.068406566977501
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5333333333333333

**** Epoch 5/20 ****
15/33-(1.196)
30/33-(0.930)
12/33-(0.782)
27/33-(0.974)

=== Evaluating Model ===
Total valid loss 1.0899334698915482
accuracy on Test 0.4
Best accuracy on Test 0.5333333333333333

**** Epoch 6/20 ****
9/33-(0.643)
24/33-(1.003)
6/33-(1.061)

=== Evaluating Model ===
Total valid loss 1.418516293168068
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5333333333333333

**** Epoch 7/20 ****
21/33-(1.041)
3/33-(0.608)
18/33-(0.690)
0/33-(1.170)

=== Evaluating Model ===
Total valid loss 1.2051365425189335
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5333333333333333

**** Epoch 8/20 ****
15/33-(0.800)
30/33-(0.740)
12/33-(0.814)
27/33-(0.989)

=== Evaluating Model ===
Total valid loss 1.295495480298996
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5333333333333333

**** Epoch 9/20 ****
9/33-(0.424)
24/33-(0.867)
6/33-(0.598)
21/33-(0.492)

=== Evaluating Model ===
Total valid loss 1.2501291409134865
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5333333333333333

**** Epoch 10/20 ****
3/33-(0.417)
18/33-(0.404)
0/33-(0.642)

=== Evaluating Model ===
Total valid loss 1.4041017045577366
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.5333333333333333

**** Epoch 11/20 ****
15/33-(0.374)
30/33-(0.741)
12/33-(0.513)
27/33-(0.465)

=== Evaluating Model ===
Total valid loss 1.5061833411455154
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5333333333333333

**** Epoch 12/20 ****
9/33-(0.981)
24/33-(0.466)
6/33-(0.524)
21/33-(0.193)

=== Evaluating Model ===
Total valid loss 1.939166394372781
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5333333333333333

**** Epoch 13/20 ****
3/33-(0.649)
18/33-(0.315)
0/33-(0.644)
15/33-(0.649)

=== Evaluating Model ===
Total valid loss 1.507603570818901
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5333333333333333

**** Epoch 14/20 ****
30/33-(0.973)
12/33-(0.257)
27/33-(0.499)

=== Evaluating Model ===
Total valid loss 1.3742579966783524
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5333333333333333

**** Epoch 15/20 ****
9/33-(0.442)
24/33-(0.644)
6/33-(0.278)
21/33-(0.130)

=== Evaluating Model ===
Total valid loss 1.6858036170403163
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5333333333333333

**** Epoch 16/20 ****
3/33-(0.474)
18/33-(0.482)
0/33-(0.301)
15/33-(0.152)

=== Evaluating Model ===
Total valid loss 1.818834401667118
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5333333333333333

**** Epoch 17/20 ****
30/33-(0.805)
12/33-(0.375)
27/33-(0.102)

=== Evaluating Model ===
Total valid loss 2.3418484330177307
accuracy on Test 0.4777777777777778
Best accuracy on Test 0.5333333333333333

**** Epoch 18/20 ****
9/33-(0.693)
24/33-(0.422)
6/33-(0.513)
21/33-(0.064)

=== Evaluating Model ===
Total valid loss 2.5353447248538337
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5333333333333333

**** Epoch 19/20 ****
3/33-(0.249)
18/33-(0.004)
Best accuracy on Test 0.5333333333333333

Source domain: Enron, Target domain: Enron, Cur_fold 3
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
170
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: Centering Structure
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-ca