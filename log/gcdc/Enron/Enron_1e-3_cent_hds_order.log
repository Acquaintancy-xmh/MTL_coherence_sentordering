Whole k-fold eval mode
Source domain: Enron, Target domain: Enron, Cur_fold 0
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
170
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.463)
30/33-(1.816)
12/33-(1.538)

=== Evaluating Model ===
Total valid loss 1.1446000238259633
accuracy on Test 0.31666666666666665
Best accuracy on Test 0.31666666666666665

**** Epoch 0/20 ****
27/33-(1.174)
9/33-(1.657)
24/33-(1.311)
6/33-(1.513)

=== Evaluating Model ===
Total valid loss 1.1839118252197902
accuracy on Test 0.43333333333333335
Best accuracy on Test 0.43333333333333335

**** Epoch 1/20 ****
21/33-(1.130)
3/33-(1.048)
18/33-(1.026)
0/33-(0.816)

=== Evaluating Model ===
Total valid loss 1.1880464156468709
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5055555555555555

**** Epoch 2/20 ****
15/33-(0.749)
30/33-(1.188)
12/33-(1.036)

=== Evaluating Model ===
Total valid loss 1.1069898356993992
accuracy on Test 0.5
Best accuracy on Test 0.5055555555555555

**** Epoch 3/20 ****
27/33-(0.994)
9/33-(0.826)
24/33-(0.765)
6/33-(0.962)

=== Evaluating Model ===
Total valid loss 1.2126240134239197
accuracy on Test 0.4388888888888889
Best accuracy on Test 0.5055555555555555

**** Epoch 4/20 ****
21/33-(0.560)
3/33-(1.104)
18/33-(1.017)
0/33-(1.566)

=== Evaluating Model ===
Total valid loss 1.1746221135059993
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5055555555555555

**** Epoch 5/20 ****
15/33-(0.788)
30/33-(1.236)
12/33-(0.711)
27/33-(0.871)

=== Evaluating Model ===
Total valid loss 1.1810163855552673
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5166666666666667

**** Epoch 6/20 ****
9/33-(0.583)
24/33-(0.827)
6/33-(0.858)

=== Evaluating Model ===
Total valid loss 1.2933317323525746
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5166666666666667

**** Epoch 7/20 ****
21/33-(0.640)
3/33-(0.661)
18/33-(0.376)
0/33-(0.887)

=== Evaluating Model ===
Total valid loss 1.1453783065080643
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5166666666666667

**** Epoch 8/20 ****
15/33-(0.818)
30/33-(0.515)
12/33-(0.725)
27/33-(0.718)

=== Evaluating Model ===
Total valid loss 1.4531355102856953
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5166666666666667

**** Epoch 9/20 ****
9/33-(0.650)
24/33-(0.641)
6/33-(0.314)
21/33-(0.589)

=== Evaluating Model ===
Total valid loss 1.2801354279120762
accuracy on Test 0.45
Best accuracy on Test 0.5166666666666667

**** Epoch 10/20 ****
3/33-(0.449)
18/33-(0.378)
0/33-(0.155)

=== Evaluating Model ===
Total valid loss 1.768641675511996
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5166666666666667

**** Epoch 11/20 ****
15/33-(0.629)
30/33-(0.383)
12/33-(0.520)
27/33-(0.878)

=== Evaluating Model ===
Total valid loss 1.9476831207672756
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.5166666666666667

**** Epoch 12/20 ****
9/33-(2.167)
24/33-(0.138)
6/33-(0.510)
21/33-(0.652)

=== Evaluating Model ===
Total valid loss 1.3854067275921504
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5166666666666667

**** Epoch 13/20 ****
3/33-(0.752)
18/33-(0.327)
0/33-(0.428)
15/33-(0.360)

=== Evaluating Model ===
Total valid loss 2.25821519891421
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5166666666666667

**** Epoch 14/20 ****
30/33-(0.704)
12/33-(0.545)
27/33-(0.415)

=== Evaluating Model ===
Total valid loss 1.5116622696320217
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5166666666666667

**** Epoch 15/20 ****
9/33-(0.467)
24/33-(0.572)
6/33-(0.970)
21/33-(0.730)

=== Evaluating Model ===
Total valid loss 2.426696330308914
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.5166666666666667

**** Epoch 16/20 ****
3/33-(0.238)
18/33-(0.655)
0/33-(0.266)
15/33-(0.462)

=== Evaluating Model ===
Total valid loss 2.714437852303187
accuracy on Test 0.5
Best accuracy on Test 0.5166666666666667

**** Epoch 17/20 ****
30/33-(0.945)
12/33-(0.443)
27/33-(0.291)

=== Evaluating Model ===
Total valid loss 3.0380856891473136
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5166666666666667

**** Epoch 18/20 ****
9/33-(0.382)
24/33-(0.507)
6/33-(0.678)
21/33-(0.258)

=== Evaluating Model ===
Total valid loss 2.5702027479807534
accuracy on Test 0.45555555555555555
Best accuracy on Test 0.5166666666666667

**** Epoch 19/20 ****
3/33-(0.148)
18/33-(0.235)
Best accuracy on Test 0.5166666666666667

Source domain: Enron, Target domain: Enron, Cur_fold 1
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
170
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.756)
30/33-(1.496)
12/33-(1.110)

=== Evaluating Model ===
Total valid loss 1.0895732541879017
accuracy on Test 0.46111111111111114
Best accuracy on Test 0.46111111111111114

**** Epoch 0/20 ****
27/33-(1.540)
9/33-(1.132)
24/33-(1.409)
6/33-(1.101)

=== Evaluating Model ===
Total valid loss 1.1132635672887166
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.48333333333333334

**** Epoch 1/20 ****
21/33-(1.050)
3/33-(1.112)
18/33-(0.828)
0/33-(0.929)

=== Evaluating Model ===
Total valid loss 1.0997485468784969
accuracy on Test 0.4722222222222222
Best accuracy on Test 0.48333333333333334

**** Epoch 2/20 ****
15/33-(0.938)
30/33-(1.305)
12/33-(0.923)

=== Evaluating Model ===
Total valid loss 1.0783603737751644
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5388888888888889

**** Epoch 3/20 ****
27/33-(0.773)
9/33-(1.189)
24/33-(0.809)
6/33-(0.952)

=== Evaluating Model ===
Total valid loss 0.9683117618163427
accuracy on Test 0.55
Best accuracy on Test 0.55

**** Epoch 4/20 ****
21/33-(1.835)
3/33-(0.674)
18/33-(0.583)
0/33-(1.394)

=== Evaluating Model ===
Total valid loss 0.9376720537741979
accuracy on Test 0.5555555555555556
Best accuracy on Test 0.5555555555555556

**** Epoch 5/20 ****
15/33-(0.805)
30/33-(1.107)
12/33-(0.871)
27/33-(0.684)

=== Evaluating Model ===
Total valid loss 0.9619007209936777
accuracy on Test 0.5666666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 6/20 ****
9/33-(1.002)
24/33-(0.572)
6/33-(0.967)

=== Evaluating Model ===
Total valid loss 0.9720584054787954
accuracy on Test 0.5388888888888889
Best accuracy on Test 0.5666666666666667

**** Epoch 7/20 ****
21/33-(0.849)
3/33-(0.729)
18/33-(0.969)
0/33-(0.996)

=== Evaluating Model ===
Total valid loss 0.9336105833450953
accuracy on Test 0.5444444444444444
Best accuracy on Test 0.5666666666666667

**** Epoch 8/20 ****
15/33-(0.594)
30/33-(1.283)
12/33-(0.624)
27/33-(1.058)

=== Evaluating Model ===
Total valid loss 1.0569822390874226
accuracy on Test 0.55
Best accuracy on Test 0.5666666666666667

**** Epoch 9/20 ****
9/33-(0.543)
24/33-(1.242)
6/33-(0.733)
21/33-(0.449)

=== Evaluating Model ===
Total valid loss 1.1645941610137622
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 10/20 ****
3/33-(0.482)
18/33-(1.392)
0/33-(0.809)

=== Evaluating Model ===
Total valid loss 1.173305759827296
accuracy on Test 0.5111111111111111
Best accuracy on Test 0.5666666666666667

**** Epoch 11/20 ****
15/33-(1.072)
30/33-(0.446)
12/33-(0.749)
27/33-(0.563)

=== Evaluating Model ===
Total valid loss 1.5171779890855153
accuracy on Test 0.5055555555555555
Best accuracy on Test 0.5666666666666667

**** Epoch 12/20 ****
9/33-(0.744)
24/33-(0.750)
6/33-(0.331)
21/33-(0.539)

=== Evaluating Model ===
Total valid loss 1.5239057789246242
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5666666666666667

**** Epoch 13/20 ****
3/33-(0.613)
18/33-(0.586)
0/33-(0.280)
15/33-(0.828)

=== Evaluating Model ===
Total valid loss 1.5784408847490947
accuracy on Test 0.55
Best accuracy on Test 0.5666666666666667

**** Epoch 14/20 ****
30/33-(0.120)
12/33-(0.440)
27/33-(0.522)

=== Evaluating Model ===
Total valid loss 1.3591852933168411
accuracy on Test 0.5
Best accuracy on Test 0.5666666666666667

**** Epoch 15/20 ****
9/33-(0.240)
24/33-(0.366)
6/33-(0.075)
21/33-(0.331)

=== Evaluating Model ===
Total valid loss 1.8406145324309666
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5666666666666667

**** Epoch 16/20 ****
3/33-(0.298)
18/33-(0.254)
0/33-(0.265)
15/33-(0.546)

=== Evaluating Model ===
Total valid loss 1.7517055074373882
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5666666666666667

**** Epoch 17/20 ****
30/33-(0.443)
12/33-(0.233)
27/33-(0.603)

=== Evaluating Model ===
Total valid loss 1.9714321717619896
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5666666666666667

**** Epoch 18/20 ****
9/33-(0.284)
24/33-(0.387)
6/33-(0.452)
21/33-(0.188)

=== Evaluating Model ===
Total valid loss 1.88403615852197
accuracy on Test 0.48333333333333334
Best accuracy on Test 0.5666666666666667

**** Epoch 19/20 ****
3/33-(0.511)
18/33-(0.005)
Best accuracy on Test 0.5666666666666667

Source domain: Enron, Target domain: Enron, Cur_fold 2
Corpus: GCDC
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
170
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.585)
30/33-(1.452)
12/33-(1.321)

=== Evaluating Model ===
Total valid loss 1.1505939960479736
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.4444444444444444

**** Epoch 0/20 ****
27/33-(1.005)
9/33-(1.837)
24/33-(1.104)
6/33-(1.159)

=== Evaluating Model ===
Total valid loss 1.0581899682680767
accuracy on Test 0.49444444444444446
Best accuracy on Test 0.49444444444444446

**** Epoch 1/20 ****
21/33-(1.149)
3/33-(1.331)
18/33-(1.065)
0/33-(1.252)

=== Evaluating Model ===
Total valid loss 1.051479458808899
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.49444444444444446

**** Epoch 2/20 ****
15/33-(1.239)
30/33-(0.957)
12/33-(1.022)

=== Evaluating Model ===
Total valid loss 1.060060828924179
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.49444444444444446

**** Epoch 3/20 ****
27/33-(0.758)
9/33-(1.212)
24/33-(1.013)
6/33-(1.125)

=== Evaluating Model ===
Total valid loss 0.9941089202960333
accuracy on Test 0.4888888888888889
Best accuracy on Test 0.49444444444444446

**** Epoch 4/20 ****
21/33-(0.857)
3/33-(1.062)
18/33-(0.803)
0/33-(1.228)

=== Evaluating Model ===
Total valid loss 0.9579265266656876
accuracy on Test 0.5277777777777778
Best accuracy on Test 0.5277777777777778

**** Epoch 5/20 ****
15/33-(1.047)
30/33-(0.794)
12/33-(0.796)
27/33-(1.197)

=== Evaluating Model ===
Total valid loss 1.0061019112666447
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5277777777777778

**** Epoch 6/20 ****
9/33-(0.798)
24/33-(0.956)
6/33-(0.779)

=== Evaluating Model ===
Total valid loss 1.1958829363187153
accuracy on Test 0.5
Best accuracy on Test 0.5277777777777778

**** Epoch 7/20 ****
21/33-(1.008)
3/33-(1.065)
18/33-(0.808)
0/33-(0.910)

=== Evaluating Model ===
Total valid loss 1.0055585900942485
accuracy on Test 0.5222222222222223
Best accuracy on Test 0.5277777777777778

**** Epoch 8/20 ****
15/33-(0.823)
30/33-(0.844)
12/33-(0.841)
27/33-(1.405)

=== Evaluating Model ===
Total valid loss 1.6702396472295125
accuracy on Test 0.34444444444444444
Best accuracy on Test 0.5277777777777778

**** Epoch 9/20 ****
9/33-(1.486)
24/33-(0.407)
6/33-(0.890)
21/33-(0.965)

=== Evaluating Model ===
Total valid loss 1.108395795027415
accuracy on Test 0.5611111111111111
Best accuracy on Test 0.5611111111111111

**** Epoch 10/20 ****
3/33-(0.916)
18/33-(0.553)
0/33-(0.727)

=== Evaluating Model ===
Total valid loss 1.2156779964764912
accuracy on Test 0.5333333333333333
Best accuracy on Test 0.5611111111111111

**** Epoch 11/20 ****
15/33-(0.640)
30/33-(0.732)
12/33-(0.577)
27/33-(0.803)

=== Evaluating Model ===
Total valid loss 1.4982020258903503
accuracy on Test 0.4
Best accuracy on Test 0.5611111111111111

**** Epoch 12/20 ****
9/33-(0.634)
24/33-(1.031)
6/33-(0.623)
21/33-(0.822)

=== Evaluating Model ===
Total valid loss 1.1318220620354016
accuracy on Test 0.5166666666666667
Best accuracy on Test 0.5611111111111111

**** Epoch 13/20 ****
3/33-(0.382)
18/33-(0.406)
0/33-(0.770)
15/33-(0.220)

=== Evaluating Model ===
Total valid loss 1.422860046227773
accuracy on Test 0.4666666666666667
Best accuracy on Test 0.5611111111111111

**** Epo