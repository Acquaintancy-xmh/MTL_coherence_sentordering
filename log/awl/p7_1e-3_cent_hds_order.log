Whole k-fold eval mode
Source domain: 7, Target domain: 7, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(2.305)
30/33-(2.088)
12/33-(2.026)
27/33-(1.984)

=== Evaluating Model ===
accuracy on Valid 0.5756676557863502

Best accuracy on Valid 0.5756676557863502
Total valid loss 0.9212406494400718
accuracy on Test 0.5578635014836796
Best accuracy on Test 0.5578635014836796

**** Epoch 0/25 ****
9/33-(1.896)
24/33-(1.929)
6/33-(1.919)
21/33-(1.860)

=== Evaluating Model ===
accuracy on Valid 0.6617210682492581

Best accuracy on Valid 0.6617210682492581
Total valid loss 0.75368117202412
accuracy on Test 0.6409495548961425
Best accuracy on Test 0.6409495548961425

**** Epoch 1/25 ****
3/33-(1.701)
18/33-(1.896)
0/33-(1.890)
15/33-(1.730)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701

Best accuracy on Valid 0.7151335311572701
Total valid loss 0.6796705749901858
accuracy on Test 0.6795252225519288
Best accuracy on Test 0.6795252225519288

**** Epoch 2/25 ****
30/33-(1.636)
12/33-(2.041)
27/33-(2.102)
9/33-(1.753)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229

Total valid loss 0.7472971190105785
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.6824925816023739

**** Epoch 3/25 ****
24/33-(1.665)
6/33-(1.682)
21/33-(1.647)
3/33-(1.658)
18/33-(1.860)

=== Evaluating Model ===
accuracy on Valid 0.5845697329376854

Total valid loss 0.840255158868703
accuracy on Test 0.5934718100890207
Best accuracy on Test 0.6824925816023739

**** Epoch 4/25 ****
0/33-(1.742)
15/33-(1.674)
30/33-(1.590)
12/33-(1.684)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934

Total valid loss 0.9586335163224827
accuracy on Test 0.6409495548961425
Best accuracy on Test 0.6824925816023739

**** Epoch 5/25 ****
27/33-(1.728)
9/33-(1.827)
24/33-(1.971)
6/33-(1.661)

=== Evaluating Model ===
accuracy on Valid 0.6765578635014837

Total valid loss 0.9130844311280684
accuracy on Test 0.6231454005934718
Best accuracy on Test 0.6824925816023739

**** Epoch 6/25 ****
21/33-(1.747)
3/33-(1.600)
18/33-(1.763)
0/33-(1.831)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308

Best accuracy on Valid 0.7388724035608308
Total valid loss 0.7014348926869306
accuracy on Test 0.6735905044510386
Best accuracy on Test 0.6824925816023739

**** Epoch 7/25 ****
15/33-(1.742)
30/33-(1.719)
12/33-(1.657)
27/33-(1.521)

=== Evaluating Model ===
accuracy on Valid 0.6320474777448071

Total valid loss 1.3241917490959167
accuracy on Test 0.5845697329376854
Best accuracy on Test 0.6824925816023739

**** Epoch 8/25 ****
9/33-(1.735)
24/33-(1.724)
6/33-(1.688)
21/33-(1.635)
3/33-(1.761)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Total valid loss 0.7610830786553296
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.6824925816023739

**** Epoch 9/25 ****
18/33-(1.537)
0/33-(1.608)
15/33-(1.903)
30/33-(1.803)

=== Evaluating Model ===
accuracy on Valid 0.6468842729970327

Total valid loss 1.028240366415544
accuracy on Test 0.599406528189911
Best accuracy on Test 0.6824925816023739

**** Epoch 10/25 ****
12/33-(1.837)
27/33-(1.571)
9/33-(1.885)
24/33-(1.774)

=== Evaluating Model ===
accuracy on Valid 0.7359050445103857

Total valid loss 0.7860621227459474
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.6824925816023739

**** Epoch 11/25 ****
6/33-(1.683)
21/33-(1.587)
3/33-(1.476)
18/33-(1.583)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Total valid loss 1.1485592397776516
accuracy on Test 0.6646884272997032
Best accuracy on Test 0.6824925816023739

**** Epoch 12/25 ****
0/33-(1.608)
15/33-(1.474)
30/33-(1.496)
12/33-(1.849)

=== Evaluating Model ===
accuracy on Valid 0.7537091988130564

Best accuracy on Valid 0.7537091988130564
Total valid loss 1.057553344829516
accuracy on Test 0.7032640949554896
Best accuracy on Test 0.7032640949554896

**** Epoch 13/25 ****
27/33-(1.655)
9/33-(1.496)
24/33-(1.448)
6/33-(1.417)
21/33-(1.738)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Total valid loss 1.0597571500323035
accuracy on Test 0.6617210682492581
Best accuracy on Test 0.7032640949554896

**** Epoch 14/25 ****
3/33-(1.495)
18/33-(1.475)
0/33-(1.477)
15/33-(1.468)

=== Evaluating Model ===
accuracy on Valid 0.7537091988130564

Best accuracy on Valid 0.7537091988130564
Total valid loss 1.156694015318697
accuracy on Test 0.6884272997032641
Best accuracy on Test 0.7032640949554896

**** Epoch 15/25 ****
30/33-(1.578)
12/33-(1.498)
27/33-(1.470)
9/33-(1.906)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Total valid loss 1.4949501556428997
accuracy on Test 0.6646884272997032
Best accuracy on Test 0.7032640949554896

**** Epoch 16/25 ****
24/33-(1.685)
6/33-(1.425)
21/33-(1.508)
3/33-(1.499)

=== Evaluating Model ===
accuracy on Valid 0.6201780415430267

Total valid loss 1.759569222276861
accuracy on Test 0.6379821958456974
Best accuracy on Test 0.7032640949554896

**** Epoch 17/25 ****
18/33-(1.664)
0/33-(1.447)
15/33-(1.489)
30/33-(1.557)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347

Total valid loss 1.3576349873434415
accuracy on Test 0.6884272997032641
Best accuracy on Test 0.7032640949554896

**** Epoch 18/25 ****
12/33-(1.437)
27/33-(1.550)
9/33-(1.460)
24/33-(1.414)
6/33-(1.695)

=== Evaluating Model ===
accuracy on Valid 0.6824925816023739

Total valid loss 1.5797029449181124
accuracy on Test 0.6528189910979229
Best accuracy on Test 0.7032640949554896

**** Epoch 19/25 ****
21/33-(1.429)
3/33-(1.500)
18/33-(1.409)
0/33-(1.737)

=== Evaluating Model ===
accuracy on Valid 0.6409495548961425

Total valid loss 1.7192144631831483
accuracy on Test 0.6528189910979229
Best accuracy on Test 0.7032640949554896

**** Epoch 20/25 ****
15/33-(1.664)
30/33-(1.418)
12/33-(1.455)
27/33-(1.419)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934

Total valid loss 1.9209165302189914
accuracy on Test 0.6231454005934718
Best accuracy on Test 0.7032640949554896

**** Epoch 21/25 ****
9/33-(1.439)
24/33-(1.398)
6/33-(1.441)
21/33-(1.411)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308

Total valid loss 1.5685990087010644
accuracy on Test 0.7032640949554896
Best accuracy on Test 0.7032640949554896

**** Epoch 22/25 ****
3/33-(1.443)
18/33-(1.405)
0/33-(1.403)
15/33-(1.454)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Total valid loss 1.9524055461991916
accuracy on Test 0.6676557863501483
Best accuracy on Test 0.7032640949554896

**** Epoch 23/25 ****
30/33-(1.432)
12/33-(1.401)
27/33-(1.410)
9/33-(1.828)
24/33-(1.417)

=== Evaluating Model ===
accuracy on Valid 0.7270029673590505

Total valid loss 1.7229207876053723
accuracy on Test 0.6735905044510386
Best accuracy on Test 0.7032640949554896

**** Epoch 24/25 ****
6/33-(1.506)
Best accuracy on Test 0.7032640949554896

Source domain: 7, Target domain: 7, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(2.138)
30/33-(2.212)
12/33-(1.896)
27/33-(1.999)

=== Evaluating Model ===
accuracy on Valid 0.6142433234421365

Best accuracy on Valid 0.6142433234421365
Total valid loss 0.9095252860676158
accuracy on Test 0.6172106824925816
Best accuracy on Test 0.6172106824925816

**** Epoch 0/25 ****
9/33-(1.939)
24/33-(2.081)
6/33-(1.873)
21/33-(2.046)

=== Evaluating Model ===
accuracy on Valid 0.5311572700296736

Total valid loss 0.843894898891449
accuracy on Test 0.543026706231454
Best accuracy on Test 0.6172106824925816

**** Epoch 1/25 ****
3/33-(1.867)
18/33-(1.748)
0/33-(1.995)
15/33-(1.798)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641

Best accuracy on Valid 0.6884272997032641
Total valid loss 0.6948692730881951
accuracy on Test 0.6617210682492581
Best accuracy on Test 0.6617210682492581

**** Epoch 2/25 ****
30/33-(1.732)
12/33-(1.812)
27/33-(1.694)
9/33-(1.833)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994

Best accuracy on Valid 0.6973293768545994
Total valid loss 0.767034415494312
accuracy on Test 0.7507418397626113
Best accuracy on Test 0.7507418397626113

**** Epoch 3/25 ****
24/33-(1.749)
6/33-(1.825)
21/33-(1.780)
3/33-(1.667)
18/33-(1.919)

=== Evaluating Model ===
accuracy on Valid 0.5341246290801187

Total valid loss 1.2233409041708165
accuracy on Test 0.516320474777448
Best accuracy on Test 0.7507418397626113

**** Epoch 4/25 ****
0/33-(1.771)
15/33-(1.703)
30/33-(1.668)
12/33-(1.497)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994

Best accuracy on Valid 0.6973293768545994
Total valid loss 0.8846224573525515
accuracy on Test 0.7151335311572701
Best accuracy on Test 0.7507418397626113

**** Epoch 5/25 ****
27/33-(1.621)
9/33-(1.774)
24/33-(1.621)
6/33-(1.644)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Best accuracy on Valid 0.7032640949554896
Total valid loss 0.7209876558997415
accuracy on Test 0.7537091988130564
Best accuracy on Test 0.7537091988130564

**** Epoch 6/25 ****
21/33-(1.666)
3/33-(1.778)
18/33-(1.868)
0/33-(1.484)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Total valid loss 0.8612758408893239
accuracy on Test 0.7329376854599406
Best accuracy on Test 0.7537091988130564

**** Epoch 7/25 ****
15/33-(1.704)
30/33-(1.983)
12/33-(1.534)
27/33-(1.701)

=== Evaluating Model ===
accuracy on Valid 0.658753709198813

Total valid loss 0.8442103618925269
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.7537091988130564

**** Epoch 8/25 ****
9/33-(1.684)
24/33-(1.829)
6/33-(1.689)
21/33-(1.795)
3/33-(1.641)

=== Evaluating Model ===
accuracy on Valid 0.7329376854599406

Best accuracy on Valid 0.7329376854599406
Total valid loss 0.6836172586137598
accuracy on Test 0.7537091988130564
Best accuracy on Test 0.7537091988130564

**** Epoch 9/25 ****
18/33-(1.756)
0/33-(1.674)
15/33-(1.533)
30/33-(1.451)

=== Evaluating Model ===
accuracy on Valid 0.7181008902077152

Total valid loss 0.87967455082319
accuracy on Test 0.712166172106825
Best accuracy on Test 0.7537091988130564

**** Epoch 10/25 ****
12/33-(1.462)
27/33-(1.579)
9/33-(1.501)
24/33-(1.525)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641

Total valid loss 0.9615443396297368
accuracy on Test 0.7091988130563798
Best accuracy on Test 0.7537091988130564

**** Epoch 11/25 ****
6/33-(1.562)
21/33-(1.630)
3/33-(2.034)
18/33-(1.655)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Total valid loss 1.0092735520818017
accuracy on Test 0.7091988130563798
Best accuracy on Test 0.7537091988130564

**** Epoch 12/25 ****
0/33-(1.509)
15/33-(1.549)
30/33-(1.763)
12/33-(1.601)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Total valid loss 1.0979524498636073
accuracy on Test 0.685459940652819
Best accuracy on Test 0.7537091988130564

**** Epoch 13/25 ****
27/33-(1.506)
9/33-(1.504)
24/33-(1.540)
6/33-(1.497)
21/33-(1.593)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994

Total valid loss 1.0880630754611709
accuracy on Test 0.6913946587537092
Best accuracy on Test 0.7537091988130564

**** Epoch 14/25 ****
3/33-(1.581)
18/33-(1.555)
0/33-(1.468)
15/33-(1.510)

=== Evaluating Model ===
accuracy on Valid 0.6735905044510386

Total valid loss 1.2872847406701609
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.7537091988130564

**** Epoch 15/25 ****
30/33-(1.460)
12/33-(1.503)
27/33-(1.706)
9/33-(1.456)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229

Total valid loss 1.2978019497611306
accuracy on Test 0.6795252225519288
Best accuracy on Test 0.7537091988130564

**** Epoch 16/25 ****
24/33-(1.515)
6/33-(1.444)
21/33-(1.612)
3/33-(1.453)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Total valid loss 1.15647800673138
accuracy on Test 0.7210682492581603
Best accuracy on Test 0.7537091988130564

**** Epoch 17/25 ****
18/33-(1.459)
0/33-(1.627)
15/33-(1.479)
30/33-(1.502)

=== Evaluating Model ===
accuracy on Valid 0.6735905044510386

Total valid loss 1.5256271010095424
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.7537091988130564

**** Epoch 18/25 ****
12/33-(1.652)
27/33-(1.451)
9/33-(1.584)
24/33-(1.658)
6/33-(1.456)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819

Total valid loss 1.5001132461157711
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.7537091988130564

**** Epoch 19/25 ****
21/33-(1.546)
3/33-(1.499)
18/33-(1.694)
0/33-(1.574)

=== Evaluating Model ===
accuracy on Valid 0.5934718100890207

Total valid loss 2.300144910812378
accuracy on Test 0.6142433234421365
Best accuracy on Test 0.7537091988130564

**** Epoch 20/25 ****
15/33-(1.470)
30/33-(1.433)
12/33-(1.440)
27/33-(1.415)

=== Evaluating Model ===
accuracy on Valid 0.6765578635014837

Total valid loss 1.8824813657186248
accuracy on Test 0.6320474777448071
Best accuracy on Test 0.7537091988130564

**** Epoch 21/25 ****
9/33-(1.707)
24/33-(1.406)
6/33-(1.450)
21/33-(1.442)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Total valid loss 1.7952824085950851
accuracy on Test 0.7210682492581603
Best accuracy on Test 0.7537091988130564

**** Epoch 22/25 ****
3/33-(1.428)
18/33-(1.827)
0/33-(1.420)
15/33-(1.418)

=== Evaluating Model ===
accuracy on Valid 0.6231454005934718

Total valid loss 2.9664223167029293
accuracy on Test 0.5756676557863502
Best accuracy on Test 0.7537091988130564

**** Epoch 23/25 ****
30/33-(1.700)
12/33-(1.627)
27/33-(1.397)
9/33-(1.646)
24/33-(1.504)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934

Total valid loss 1.9106224802407352
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.7537091988130564

**** Epoch 24/25 ****
6/33-(1.411)
Best accuracy on Test 0.7537091988130564

Source domain: 7, Target domain: 7, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(2.221)
30/33-(2.022)
12/33-(1.933)
27/33-(1.927)

=== Evaluating Model ===
accuracy on Valid 0.41543026706231456

Best accuracy on Valid 0.41543026706231456
Total valid loss 0.8890300718220797
accuracy on Test 0.4540059347181009
Best accuracy on Test 0.4540059347181009

**** Epoch 0/25 ****
9/33-(1.919)
24/33-(1.791)
6/33-(1.959)
21/33-(1.906)

=== Evaluating Model ===
accuracy on Valid 0.5964391691394659

Best accuracy on Valid 0.5964391691394659
Total valid loss 0.7863610684871674
accuracy on Test 0.5964391691394659
Best accuracy on Test 0.5964391691394659

**** Epoch 1/25 ****
