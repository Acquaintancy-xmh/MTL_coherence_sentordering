Whole k-fold eval mode
Source domain: 8, Target domain: 8, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(2.904)
30/33-(1.870)
12/33-(3.077)
27/33-(2.465)

=== Evaluating Model ===
accuracy on Valid 0.6011904761904762

Best accuracy on Valid 0.6011904761904762
Total valid loss 0.8493007847240993
accuracy on Test 0.6279761904761905
Best accuracy on Test 0.6279761904761905

**** Epoch 0/25 ****
9/33-(2.381)
24/33-(1.511)
6/33-(1.627)
21/33-(2.567)

=== Evaluating Model ===
accuracy on Valid 0.33630952380952384

Total valid loss 1.3257646674201602
accuracy on Test 0.3541666666666667
Best accuracy on Test 0.6279761904761905

**** Epoch 1/25 ****
3/33-(2.073)
18/33-(2.598)
0/33-(2.155)
15/33-(2.115)

=== Evaluating Model ===
accuracy on Valid 0.6815476190476191

Best accuracy on Valid 0.6815476190476191
Total valid loss 0.611781739053272
accuracy on Test 0.7321428571428571
Best accuracy on Test 0.7321428571428571

**** Epoch 2/25 ****
30/33-(1.550)
12/33-(2.282)
27/33-(1.860)
9/33-(2.234)

=== Evaluating Model ===
accuracy on Valid 0.6845238095238095

Best accuracy on Valid 0.6845238095238095
Total valid loss 0.6367907112553006
accuracy on Test 0.6904761904761905
Best accuracy on Test 0.7321428571428571

**** Epoch 3/25 ****
24/33-(1.301)
6/33-(1.078)
21/33-(1.342)
3/33-(1.892)
18/33-(1.854)

=== Evaluating Model ===
accuracy on Valid 0.6041666666666666

Total valid loss 0.9000976965540931
accuracy on Test 0.5684523809523809
Best accuracy on Test 0.7321428571428571

**** Epoch 4/25 ****
0/33-(1.839)
15/33-(1.608)
30/33-(1.032)
12/33-(1.055)

=== Evaluating Model ===
accuracy on Valid 0.7023809523809523

Best accuracy on Valid 0.7023809523809523
Total valid loss 0.6277633295172736
accuracy on Test 0.7142857142857143
Best accuracy on Test 0.7321428571428571

**** Epoch 5/25 ****
27/33-(1.101)
9/33-(1.682)
24/33-(2.106)
6/33-(0.961)

=== Evaluating Model ===
accuracy on Valid 0.6815476190476191

Total valid loss 0.724428117275238
accuracy on Test 0.6964285714285714
Best accuracy on Test 0.7321428571428571

**** Epoch 6/25 ****
21/33-(2.189)
3/33-(1.154)
18/33-(1.464)
0/33-(1.394)

=== Evaluating Model ===
accuracy on Valid 0.6726190476190477

Total valid loss 0.7077562099411374
accuracy on Test 0.7053571428571429
Best accuracy on Test 0.7321428571428571

**** Epoch 7/25 ****
15/33-(2.061)
30/33-(1.260)
12/33-(1.129)
27/33-(1.245)

=== Evaluating Model ===
accuracy on Valid 0.7113095238095238

Best accuracy on Valid 0.7113095238095238
Total valid loss 0.6381841585749671
accuracy on Test 0.6994047619047619
Best accuracy on Test 0.7321428571428571

**** Epoch 8/25 ****
9/33-(1.299)
24/33-(0.421)
6/33-(1.886)
21/33-(1.408)
3/33-(0.986)

=== Evaluating Model ===
accuracy on Valid 0.6428571428571429

Total valid loss 0.7958789758739018
accuracy on Test 0.7142857142857143
Best accuracy on Test 0.7321428571428571

**** Epoch 9/25 ****
18/33-(0.882)
0/33-(1.309)
15/33-(0.595)
30/33-(1.307)

=== Evaluating Model ===
accuracy on Valid 0.7142857142857143

Best accuracy on Valid 0.7142857142857143
Total valid loss 0.7463404976186299
accuracy on Test 0.7053571428571429
Best accuracy on Test 0.7321428571428571

**** Epoch 10/25 ****
12/33-(0.732)
27/33-(0.680)
9/33-(1.371)
24/33-(0.871)

=== Evaluating Model ===
accuracy on Valid 0.7023809523809523

Total valid loss 0.8939586381117502
accuracy on Test 0.7380952380952381
Best accuracy on Test 0.7380952380952381

**** Epoch 11/25 ****
6/33-(1.022)
21/33-(0.925)
3/33-(0.669)
18/33-(0.772)

=== Evaluating Model ===
accuracy on Valid 0.6875

Total valid loss 0.9602951975095839
accuracy on Test 0.6785714285714286
Best accuracy on Test 0.7380952380952381

**** Epoch 12/25 ****
0/33-(1.281)
15/33-(0.870)
30/33-(0.886)
12/33-(0.645)

=== Evaluating Model ===
accuracy on Valid 0.6666666666666666

Total valid loss 0.7738045688186374
accuracy on Test 0.7202380952380952
Best accuracy on Test 0.7380952380952381

**** Epoch 13/25 ****
27/33-(1.396)
9/33-(2.174)
24/33-(1.659)
6/33-(0.597)
21/33-(0.991)

=== Evaluating Model ===
accuracy on Valid 0.6875

Total valid loss 0.8946645041661603
accuracy on Test 0.7232142857142857
Best accuracy on Test 0.7380952380952381

**** Epoch 14/25 ****
3/33-(1.172)
18/33-(1.460)
0/33-(1.185)
15/33-(1.510)

=== Evaluating Model ===
accuracy on Valid 0.6666666666666666

Total valid loss 0.9271745944306964
accuracy on Test 0.7172619047619048
Best accuracy on Test 0.7380952380952381

**** Epoch 15/25 ****
30/33-(1.110)
12/33-(0.985)
27/33-(1.000)
9/33-(0.592)

=== Evaluating Model ===
accuracy on Valid 0.7023809523809523

Total valid loss 0.9087258314802533
accuracy on Test 0.7232142857142857
Best accuracy on Test 0.7380952380952381

**** Epoch 16/25 ****
24/33-(1.204)
6/33-(0.700)
21/33-(0.516)
3/33-(0.942)

=== Evaluating Model ===
accuracy on Valid 0.6577380952380952

Total valid loss 0.9242065634046283
accuracy on Test 0.7291666666666666
Best accuracy on Test 0.7380952380952381

**** Epoch 17/25 ****
18/33-(1.115)
0/33-(0.804)
15/33-(0.390)
30/33-(0.723)

=== Evaluating Model ===
accuracy on Valid 0.6011904761904762

Total valid loss 1.15943696527254
accuracy on Test 0.7172619047619048
Best accuracy on Test 0.7380952380952381

**** Epoch 18/25 ****
12/33-(0.344)
27/33-(0.833)
9/33-(0.829)
24/33-(1.465)
6/33-(0.720)

=== Evaluating Model ===
accuracy on Valid 0.6994047619047619

Total valid loss 1.368874253261657
accuracy on Test 0.7053571428571429
Best accuracy on Test 0.7380952380952381

**** Epoch 19/25 ****
21/33-(1.360)
3/33-(1.014)
18/33-(0.593)
0/33-(0.787)

=== Evaluating Model ===
accuracy on Valid 0.5773809523809523

Total valid loss 1.523182641892206
accuracy on Test 0.6488095238095238
Best accuracy on Test 0.7380952380952381

**** Epoch 20/25 ****
15/33-(0.233)
30/33-(0.829)
12/33-(0.489)
27/33-(0.182)

=== Evaluating Model ===
accuracy on Valid 0.6845238095238095

Total valid loss 1.1625049951530637
accuracy on Test 0.7232142857142857
Best accuracy on Test 0.7380952380952381

**** Epoch 21/25 ****
9/33-(0.456)
24/33-(0.661)
6/33-(0.545)
21/33-(0.690)

=== Evaluating Model ===
accuracy on Valid 0.6339285714285714

Total valid loss 1.6643227395557223
accuracy on Test 0.7321428571428571
Best accuracy on Test 0.7380952380952381

**** Epoch 22/25 ****
3/33-(2.116)
18/33-(0.575)
0/33-(0.664)
15/33-(0.292)

=== Evaluating Model ===
accuracy on Valid 0.6845238095238095

Total valid loss 1.3771870661349523
accuracy on Test 0.7053571428571429
Best accuracy on Test 0.7380952380952381

**** Epoch 23/25 ****
30/33-(1.027)
12/33-(0.523)
27/33-(0.790)
9/33-(0.540)
24/33-(0.667)

=== Evaluating Model ===
accuracy on Valid 0.6964285714285714

Total valid loss 1.697008532427606
accuracy on Test 0.7083333333333334
Best accuracy on Test 0.7380952380952381

**** Epoch 24/25 ****
6/33-(0.533)
Best accuracy on Test 0.7380952380952381

Source domain: 8, Target domain: 8, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(3.249)
30/33-(2.789)
12/33-(2.663)
27/33-(1.801)

=== Evaluating Model ===
accuracy on Valid 0.56973293768546

Best accuracy on Valid 0.56973293768546
Total valid loss 0.8504720344429925
accuracy on Test 0.5803571428571429
Best accuracy on Test 0.5803571428571429

**** Epoch 0/25 ****
9/33-(2.276)
24/33-(2.339)
6/33-(1.991)
21/33-(1.777)

=== Evaluating Model ===
accuracy on Valid 0.7210682492581603

Best accuracy on Valid 0.7210682492581603
Total valid loss 0.6682882351534707
accuracy on Test 0.6904761904761905
Best accuracy on Test 0.6904761904761905

**** Epoch 1/25 ****
3/33-(1.364)
18/33-(1.725)
0/33-(2.284)
15/33-(2.043)

=== Evaluating Model ===
accuracy on Valid 0.7240356083086054

Best accuracy on Valid 0.7240356083086054
Total valid loss 0.6609684356621334
accuracy on Test 0.7142857142857143
Best accuracy on Test 0.7142857142857143

**** Epoch 2/25 ****
30/33-(1.313)
12/33-(1.588)
27/33-(1.835)
9/33-(1.850)

=== Evaluating Model ===
accuracy on Valid 0.6350148367952523

Total valid loss 0.8213257959910801
accuracy on Test 0.5892857142857143
Best accuracy on Test 0.7142857142857143

**** Epoch 3/25 ****
24/33-(1.432)
6/33-(1.760)
21/33-(1.885)
3/33-(2.392)
18/33-(1.330)

=== Evaluating Model ===
accuracy on Valid 0.7210682492581603

Total valid loss 0.6440017720063528
accuracy on Test 0.6934523809523809
Best accuracy on Test 0.7142857142857143

**** Epoch 4/25 ****
0/33-(2.258)
15/33-(1.523)
30/33-(1.830)
12/33-(2.767)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Total valid loss 0.619498149270103
accuracy on Test 0.7023809523809523
Best accuracy on Test 0.7142857142857143

**** Epoch 5/25 ****
27/33-(1.591)
9/33-(1.237)
24/33-(0.814)
6/33-(2.426)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229

Total valid loss 0.8396946702684674
accuracy on Test 0.6130952380952381
Best accuracy on Test 0.7142857142857143

**** Epoch 6/25 ****
21/33-(1.606)
3/33-(1.889)
18/33-(1.703)
0/33-(1.945)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Total valid loss 0.8311939537525177
accuracy on Test 0.6279761904761905
Best accuracy on Test 0.7142857142857143

**** Epoch 7/25 ****
15/33-(1.112)
30/33-(2.251)
12/33-(1.040)
27/33-(1.174)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825

Total valid loss 0.663743060259592
accuracy on Test 0.7172619047619048
Best accuracy on Test 0.7172619047619048

**** Epoch 8/25 ****
9/33-(0.756)
24/33-(1.419)
6/33-(1.182)
21/33-(1.064)
3/33-(1.669)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Total valid loss 0.8125784013952527
accuracy on Test 0.6696428571428571
Best accuracy on Test 0.7172619047619048

**** Epoch 9/25 ****
18/33-(2.474)
0/33-(2.353)
15/33-(1.357)
30/33-(1.038)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Total valid loss 0.7353279037134988
accuracy on Test 0.6994047619047619
Best accuracy on Test 0.7172619047619048

**** Epoch 10/25 ****
12/33-(0.848)
27/33-(1.156)
9/33-(1.441)
24/33-(1.086)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Total valid loss 0.7953268885612488
accuracy on Test 0.6994047619047619
Best accuracy on Test 0.7172619047619048

**** Epoch 11/25 ****
6/33-(1.000)
21/33-(1.089)
3/33-(1.041)
18/33-(0.961)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Total valid loss 0.8083311929589226
accuracy on Test 0.7172619047619048
Best accuracy on Test 0.7172619047619048

**** Epoch 12/25 ****
0/33-(0.972)
15/33-(1.046)
30/33-(0.934)
12/33-(1.370)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701

Total valid loss 0.9481144604228792
accuracy on Test 0.6964285714285714
Best accuracy on Test 0.7172619047619048

**** Epoch 13/25 ****
27/33-(1.213)
9/33-(1.054)
24/33-(1.029)
6/33-(0.566)
21/33-(0.911)

=== Evaluating Model ===
accuracy on Valid 0.7181008902077152

Total valid loss 0.9005831338110424
accuracy on Test 0.6934523809523809
Best accuracy on Test 0.7172619047619048

**** Epoch 14/25 ****
3/33-(0.612)
18/33-(1.029)
0/33-(1.120)
15/33-(0.347)

=== Evaluating Model ===
accuracy on Valid 0.599406528189911

Total valid loss 1.8211231600670588
accuracy on Test 0.5535714285714286
Best accuracy on Test 0.7172619047619048

**** Epoch 15/25 ****
30/33-(0.556)
12/33-(1.049)
27/33-(0.937)
9/33-(0.770)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934

Total valid loss 1.0966594474656242
accuracy on Test 0.6517857142857143
Best accuracy on Test 0.7172619047619048

**** Epoch 16/25 ****
24/33-(1.107)
6/33-(0.933)
21/33-(0.467)
3/33-(0.986)

=== Evaluating Model ===
accuracy on Valid 0.658753709198813

Total valid loss 1.2513989039829798
accuracy on Test 0.6636904761904762
Best accuracy on Test 0.7172619047619048

**** Epoch 17/25 ****
18/33-(1.203)
0/33-(0.877)
15/33-(0.912)
30/33-(1.083)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819

Total valid loss 0.898831288019816
accuracy on Test 0.6994047619047619
Best accuracy on Test 0.7172619047619048

**** Epoch 18/25 ****
12/33-(0.592)
27/33-(0.827)
9/33-(0.836)
24/33-(0.949)
6/33-(0.640)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229

Total valid loss 1.4003540589695884
accuracy on Test 0.6577380952380952
Best accuracy on Test 0.7172619047619048

**** Epoch 19/25 ****
21/33-(0.698)
3/33-(0.629)
18/33-(0.694)
0/33-(0.740)

=== Evaluating Model ===
accuracy on Valid 0.6735905044510386

Total valid loss 1.5330485616411482
accuracy on Test 0.6904761904761905
Best accuracy on Test 0.7172619047619048

**** Epoch 20/25 ****
15/33-(0.862)
30/33-(0.499)
12/33-(0.788)
27/33-(1.541)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Total valid loss 1.1123226299172355
accuracy on Test 0.7172619047619048
Best accuracy on Test 0.7172619047619048

**** Epoch 21/25 ****
9/33-(1.025)
24/33-(0.531)
6/33-(1.025)
21/33-(0.724)

=== Evaluating Model ===
accuracy on Valid 0.6824925816023739

Total valid loss 1.2169194519519806
accuracy on Test 0.6636904761904762
Best accuracy on Test 0.7172619047619048

**** Epoch 22/25 ****
3/33-(2.189)
18/33-(0.721)
0/33-(0.614)
15/33-(1.151)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Total valid loss 1.289288993392672
accuracy on Test 0.7113095238095238
Best accuracy on Test 0.7172619047619048

**** Epoch 23/25 ****
30/33-(1.446)
12/33-(0.792)
27/33-(0.584)
9/33-(1.267)
24/33-(0.308)

=== Evaluating Model ===
accuracy on Valid 0.6676557863501483

Total valid loss 1.5753606529462905
accuracy on Test 0.6458333333333334
Best accuracy on Test 0.7172619047619048

**** Epoch 24/25 ****
6/33-(0.794)
Best accuracy on Test 0.7172619047619048

Source domain: 8, Target domain: 8, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(2.889)
30/33-(4.483)
12/33-(1.483)
27/33-(2.502)

=== Evaluating Model ===
accuracy on Valid 0.6231454005934718

Best accuracy on Valid 0.6231454005934718
Total valid loss 0.8196840584278107
accuracy on Test 0.5845697329376854
Best accuracy on Test 0.5845697329376854

**** Epoch 0/25 ****
9/33-(2.662)
24/33-(2.518)
6/33-(2.365)
21/33-(1.590)

=== Evaluating Model ===
accuracy on Valid 0.6112759643916914

Total valid loss 0.6984976909377358
accuracy on Test 0.6409495548961425
Best accuracy on Test 0.6409495548961425

**** Epoch 1/25 ****
3/33-(2.255)
18/33-(1.317)
0/33-(2.386)
15/33-(1.053)

=== Evaluating Model ===
accuracy on Valid 0.6379821958456974

Best accuracy on Valid 0.6379821958456974
Total valid loss 0.6714230369437825
accuracy on Test 0.6439169139465876
Best accuracy on Test 0.6439169139465876

**** Epoch 2/25 ****
30/33-(2.133)
12/33-(1.267)
27/33-(2.366)
9/33-(1.490)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701

Best accuracy on Valid 0.7151335311572701
Total valid loss 0.6393818272785707
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.6943620178041543

**** Epoch 3/25 ****
24/33-(1.054)
6/33-(1.268)
21/33-(1.462)
3/33-(1.440)
18/33-(2.237)

=== Evaluating Model ===
accuracy on Valid 0.6320474777448071

Total valid loss 0.6968725743618879
accuracy on Test 0.6706231454005934
Best accuracy on Test 0.6943620178041543

**** Epoch 4/25 ****
0/33-(2.522)
15/33-(2.377)
30/33-(1.792)
12/33-(1.246)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819

Total valid loss 0.6236112036488273
accuracy on Test 0.7002967359050445
Best accuracy on Test 0.7002967359050445

**** Epoch 5/25 ****
27/33-(1.704)
9/33-(1.841)
24/33-(2.073)
6/33-(1.218)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994

Total valid loss 0.6069606488401239
accuracy on Test 0.712166172106825
Best accuracy on Test 0.712166172106825

**** Epoch 6/25 ****
21/33-(0.959)
3/33-(1.839)
18/33-(4.307)
0/33-(1.694)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934

Total valid loss 0.7019485743208365
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.712166172106825

**** Epoch 7/25 ****
15/33-(1.532)
30/33-(2.023)
12/33-(1.653)
27/33-(1.486)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825

Total valid loss 0.5994570309465582
accuracy on Test 0.7270029673590505
Best accuracy on Test 0.7270029673590505

**** Epoch 8/25 ****
9/33-(0.792)
24/33-(1.844)
6/33-(1.128)
21/33-(2.321)
3/33-(1.610)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Total valid loss 0.6349861486391588
accuracy on Test 0.712166172106825
Best accuracy on Test 0.7270029673590505

**** Epoch 9/25 ****
18/33-(1.023)
0/33-(0.836)
15/33-(2.172)
30/33-(2.067)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934

Total valid loss 0.7003664381124757
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.7270029673590505

**** Epoch 10/25 ****
12/33-(1.435)
27/33-(0.653)
9/33-(0.956)
24/33-(0.948)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Total valid loss 0.7639157047325914
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.7270029673590505

**** Epoch 11/25 ****
6/33-(1.547)
21/33-(1.498)
3/33-(0.948)
18/33-(0.785)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Total valid loss 0.8639470004391941
accuracy on Test 0.685459940652819
Best accuracy on Test 0.7270029673590505

**** Epoch 12/25 ****
0/33-(1.882)
15/33-(1.618)
30/33-(1.176)
12/33-(0.702)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347

Total valid loss 0.7568063282153823
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.7270029673590505

**** Epoch 13/25 ****
27/33-(1.259)
9/33-(0.939)
24/33-(0.611)
6/33-(1.609)
21/33-(1.542)

=== Evaluating Model ===
accuracy on Valid 0.6498516320474778

Total valid loss 0.8992634361440485
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.7270029673590505

**** Epoch 14/25 ****
3/33-(0.204)
18/33-(0.702)
0/33-(0.750)
15/33-(1.529)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Total valid loss 0.7332273599776354
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.7270029673590505

**** Epoch 15/25 ****
30/33-(2.140)
12/33-(0.474)
27/33-(0.713)
9/33-(0.848)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819

Total valid loss 1.00303174352104
accuracy on Test 0.7032640949554896
Best accuracy on Test 0.7270029673590505

**** Epoch 16/25 ****
24/33-(0.798)
6/33-(1.143)
21/33-(0.667)
3/33-(1.046)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347

Total valid loss 0.7908318322998557
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.7270029673590505

**** Epoch 17/25 ****
18/33-(0.719)
0/33-(0.622)
15/33-(0.678)
30/33-(1.449)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934

Total valid loss 0.8574335497211326
accuracy on Test 0.7240356083086054
Best accuracy on Test 0.7270029673590505

**** Epoch 18/25 ****
12/33-(0.869)
27/33-(0.693)
9/33-(0.515)
24/33-(2.037)
6/33-(1.105)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701

Best accuracy on Valid 0.7151335311572701
Total valid loss 1.0254850604317405
accuracy on Test 0.7091988130563798
Best accuracy on Test 0.7270029673590505

**** Epoch 19/25 ****
21/33-(0.644)
3/33-(0.787)
18/33-(0.838)
0/33-(0.612)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Total valid loss 1.1187764035368508
accuracy on Test 0.6884272997032641
Best accuracy on Test 0.7270029673590505

**** Epoch 20/25 ****
15/33-(0.989)
30/33-(0.529)
12/33-(1.094)
27/33-(0.449)

=== Evaluating Model ===
accuracy on Valid 0.658753709198813

Total valid loss 1.0921781140972266
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.7270029673590505

**** Epoch 21/25 ****
9/33-(0.563)
24/33-(0.898)
6/33-(0.420)
21/33-(0.842)

=== Evaluating Model ===
accuracy on Valid 0.6824925816023739

Total valid loss 1.281401202082634
accuracy on Test 0.6646884272997032
Best accuracy on Test 0.7270029673590505

**** Epoch 22/25 ****
3/33-(0.492)
18/33-(0.667)
0/33-(0.367)
15/33-(0.353)

=== Evaluating Model ===
accuracy on Valid 0.658753709198813

Total valid loss 1.5478518158197403
accuracy on Test 0.658753709198813
Best accuracy on Test 0.7270029673590505

**** Epoch 23/25 ****
30/33-(0.461)
12/33-(0.667)
27/33-(0.509)
9/33-(1.006)
24/33-(1.148)

=== Evaluating Model ===
accuracy on Valid 0.6676557863501483

Total valid loss 1.52399124272845
accuracy on Test 0.6646884272997032
Best accuracy on Test 0.7270029673590505

**** Epoch 24/25 ****
6/33-(0.589)
Best accuracy on Test 0.7270029673590505

Source domain: 8, Target domain: 8, Cur_fold 3
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(2.892)
30/33-(2.058)
12/33-(2.908)
27/33-(2.541)

=== Evaluating Model ===
accuracy on Valid 0.5905044510385756

Best accuracy on Valid 0.5905044510385756
Total valid loss 0.8497222607786005
accuracy on Test 0.5905044510385756
Best accuracy on Test 0.5905044510385756

**** Epoch 0/25 ****
9/33-(2.721)
24/33-(1.714)
6/33-(2.352)
21/33-(2.009)

=== Evaluating Model ===
accuracy on Valid 0.6201780415430267

Best accuracy on Valid 0.6201780415430267
Total valid loss 0.7347197478467767
accuracy on Test 0.6409495548961425
Best accuracy on Test 0.6409495548961425

**** Epoch 1/25 ****
3/33-(1.371)
18/33-(2.302)
0/33-(2.067)
15/33-(2.165)

=== Evaluating Model ===
accuracy on Valid 0.6498516320474778

Best accuracy on Valid 0.6498516320474778
Total valid loss 0.6445432034405795
accuracy on Test 0.6913946587537092
Best accuracy on Test 0.6913946587537092

**** Epoch 2/25 ****
30/33-(2.169)
12/33-(2.366)
27/33-(2.403)
9/33-(1.735)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Best accuracy on Valid 0.6943620178041543
Total valid loss 0.7708263356577266
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.6913946587537092

**** Epoch 3/25 ****
24/33-(2.483)
6/33-(1.323)
21/33-(1.813)
3/33-(1.867)
18/33-(2.361)

=== Evaluating Model ===
accuracy on Valid 0.6735905044510386

Total valid loss 0.6963684030554511
accuracy on Test 0.6468842729970327
Best accuracy on Test 0.6913946587537092

**** Epoch 4/25 ****
0/33-(1.872)
15/33-(2.090)
30/33-(1.943)
12/33-(1.521)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Total valid loss 0.6245776536789808
accuracy on Test 0.7240356083086054
Best accuracy on Test 0.7240356083086054

**** Epoch 5/25 ****
27/33-(1.238)
9/33-(1.770)
24/33-(0.696)
6/33-(0.841)

=== Evaluating Model ===
accuracy on Valid 0.5637982195845698

Total valid loss 0.9682504378936507
accuracy on Test 0.5548961424332344
Best accuracy on Test 0.7240356083086054

**** Epoch 6/25 ****
21/33-(1.875)
3/33-(1.986)
18/33-(1.482)
0/33-(1.852)

=== Evaluating Model ===
accuracy on Valid 0.6053412462908012

Total valid loss 0.7903232848779722
accuracy on Test 0.6201780415430267
Best accuracy on Test 0.7240356083086054

**** Epoch 7/25 ****
15/33-(2.373)
30/33-(1.324)
12/33-(0.938)
27/33-(1.210)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Total valid loss 0.7374666739593853
accuracy on Test 0.6646884272997032
Best accuracy on Test 0.7240356083086054

**** Epoch 8/25 ****
9/33-(1.080)
24/33-(1.002)
6/33-(1.672)
21/33-(1.141)
3/33-(1.493)

=== Evaluating Model ===
accuracy on Valid 0.7210682492581603

Best accuracy on Valid 0.7210682492581603
Total valid loss 0.7747701921246268
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.7240356083086054

**** Epoch 9/25 ****
18/33-(0.952)
0/33-(0.888)
15/33-(1.483)
30/33-(1.875)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825

Total valid loss 0.7822592976418409
accuracy on Test 0.6913946587537092
Best accuracy on Test 0.7240356083086054

**** Epoch 10/25 ****
12/33-(0.688)
27/33-(0.872)
9/33-(2.387)
24/33-(1.681)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641

Total valid loss 0.9133537384596738
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.7240356083086054

**** Epoch 11/25 ****
6/33-(0.645)
21/33-(0.826)
3/33-(0.851)
18/33-(1.151)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Total valid loss 0.8125503361225128
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.7240356083086054

**** Epoch 12/25 ****
0/33-(1.600)
15/33-(1.313)
30/33-(0.830)
12/33-(0.749)

=== Evaluating Model ===
accuracy on Valid 0.7270029673590505

Best accuracy on Valid 0.7270029673590505
Total valid loss 1.005467493425716
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.7240356083086054

**** Epoch 13/25 ****
27/33-(1.109)
9/33-(0.968)
24/33-(1.914)
6/33-(1.272)
21/33-(0.752)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347

Total valid loss 1.0694704299623317
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.7240356083086054

**** Epoch 14/25 ****
3/33-(0.378)
18/33-(0.802)
0/33-(1.373)
15/33-(0.780)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Total valid loss 0.8699829442934557
accuracy on Test 0.7062314540059347
Best accuracy on Test 0.7240356083086054

**** Epoch 15/25 ****
30/33-(0.792)
12/33-(0.857)
27/33-(0.634)
9/33-(0.543)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Total valid loss 1.2236716202036901
accuracy on Test 0.6646884272997032
Best accuracy on Test 0.7240356083086054

**** Epoch 16/25 ****
24/33-(2.357)
6/33-(0.552)
21/33-(0.527)
3/33-(0.876)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Total valid loss 1.2579007622870533
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.7240356083086054

**** Epoch 17/25 ****
18/33-(1.115)
0/33-(1.358)
15/33-(1.227)
30/33-(1.127)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Total valid loss 1.3006230728192762
accuracy on Test 0.655786350148368
Best accuracy on Test 0.7240356083086054

**** Epoch 18/25 ****
12/33-(0.655)
27/33-(3.365)
9/33-(0.893)
24/33-(1.449)
6/33-(0.480)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Total valid loss 1.3299657519568095
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.7240356083086054

**** Epoch 19/25 ****
21/33-(1.305)
3/33-(0.892)
18/33-(0.708)
0/33-(1.415)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Total valid loss 1.460871001790193
accuracy on Test 0.6735905044510386
Best accuracy on Test 0.7240356083086054

**** Epoch 20/25 ****
15/33-(0.895)
30/33-(0.539)
12/33-(1.200)
27/33-(0.935)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641

Total valid loss 1.7630837836503899
accuracy on Test 0.6498516320474778
Best accuracy on Test 0.7240356083086054

**** Epoch 21/25 ****
9/33-(0.727)
24/33-(1.133)
6/33-(0.940)
21/33-(0.639)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Total valid loss 1.5855754740451546
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.7240356083086054

**** Epoch 22/25 ****
3/33-(0.956)
18/33-(0.890)
0/33-(0.699)
15/33-(0.740)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347

Total valid loss 1.9290249476590278
accuracy on Test 0.6617210682492581
Best accuracy on Test 0.7240356083086054

**** Epoch 23/25 ****
30/33-(0.606)
12/33-(0.239)
27/33-(0.543)
9/33-(0.625)
24/33-(0.460)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308

Best accuracy on Valid 0.7388724035608308
Total valid loss 1.558419953989373
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.7240356083086054

**** Epoch 24/25 ****
6/33-(0.495)
Best accuracy on Test 0.7240356083086054

Source domain: 8, Target domain: 8, Cur_fold 4
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(3.042)
30/33-(2.931)
12/33-(3.112)
27/33-(2.736)

=== Evaluating Model ===
accuracy on Valid 0.5416666666666666

Best accuracy on Valid 0.5416666666666666
Total valid loss 0.9125212403860959
accuracy on Test 0.5786350148367952
Best accuracy on Test 0.5786350148367952

**** Epoch 0/25 ****
9/33-(2.743)
24/33-(2.276)
6/33-(2.933)
21/33-(1.619)

=== Evaluating Model ===
accuracy on Valid 0.6964285714285714

Best accuracy on Valid 0.6964285714285714
Total valid loss 0.8089378178119659
accuracy on Test 0.6439169139465876
Best accuracy on Test 0.6439169139465876

**** Epoch 1/25 ****
3/33-(1.911)
18/33-(2.069)
0/33-(1.321)
15/33-(1.622)

=== Evaluating Model ===
accuracy on Valid 0.7589285714285714

Best accuracy on Valid 0.7589285714285714
Total valid loss 0.6534301963719454
accuracy on Test 0.7151335311572701
Best accuracy on Test 0.7151335311572701

**** Epoch 2/25 ****
30/33-(2.124)
12/33-(2.283)
27/33-(2.704)
9/33-(1.356)

=== Evaluating Model ===
accuracy on Valid 0.5892857142857143

Total valid loss 0.869425196539272
accuracy on Test 0.5845697329376854
Best accuracy on Test 0.7151335311572701

**** Epoch 3/25 ****
24/33-(2.118)
6/33-(2.068)
21/33-(2.440)
3/33-(2.147)
18/33-(1.971)

=== Evaluating Model ===
accuracy on Valid 0.7053571428571429

Total valid loss 0.7063761109655554
accuracy on Test 0.6706231454005934
Best accuracy on Test 0.7151335311572701

**** Epoch 4/25 ****
0/33-(1.746)
15/33-(1.969)
30/33-(1.896)
12/33-(0.834)

=== Evaluating Model ===
accuracy on Valid 0.7351190476190477

Total valid loss 0.6710305498404936
accuracy on Test 0.7091988130563798
Best accuracy on Test 0.7151335311572701

**** Epoch 5/25 ****
27/33-(1.707)
9/33-(1.445)
24/33-(1.844)
6/33-(1.767)

=== Evaluating Model ===
accuracy on Valid 0.625

Total valid loss 0.9170910688963804
accuracy on Test 0.6023738872403561
Best accuracy on Test 0.7151335311572701

**** Epoch 6/25 ****
21/33-(1.082)
3/33-(1.163)
18/33-(0.707)
0/33-(1.854)

=== Evaluating Model ===
accuracy on Valid 0.7529761904761905

Total valid loss 0.7172856263139031
accuracy on Test 0.7091988130563798
Best accuracy on Test 0.7151335311572701

**** Epoch 7/25 ****
15/33-(0.954)
30/33-(1.481)
12/33-(1.118)
27/33-(1.156)

=== Evaluating Model ===
accuracy on Valid 0.6964285714285714

Total valid loss 0.9880313643000342
accuracy on Test 0.655786350148368
Best accuracy on Test 0.7151335311572701

**** Epoch 8/25 ****
9/33-(1.302)
24/33-(1.509)
6/33-(1.065)
21/33-(1.312)
3/33-(1.592)

=== Evaluating Model ===
accuracy on Valid 0.6071428571428571

Total valid loss 1.3267759084701538
accuracy on Test 0.543026706231454
Best accuracy on Test 0.7151335311572701

**** Epoch 9/25 ****
18/33-(1.650)
0/33-(1.089)
15/33-(1.717)
30/33-(1.269)

=== Evaluating Model ===
accuracy on Valid 0.7380952380952381

Total valid loss 0.8342173952947963
accuracy on Test 0.7002967359050445
Best accuracy on Test 0.7151335311572701

**** Epoch 10/25 ****
12/33-(0.752)
27/33-(1.072)
9/33-(0.934)
24/33-(1.407)

=== Evaluating Model ===
accuracy on Valid 0.7470238095238095

Total valid loss 0.7629454948685386
accuracy on Test 0.7032640949554896
Best accuracy on Test 0.7151335311572701

**** Epoch 11/25 ****
6/33-(1.306)
21/33-(1.495)
3/33-(1.458)
18/33-(0.885)

=== Evaluating Model ===
accuracy on Valid 0.7172619047619048

Total valid loss 0.965942071242766
accuracy on Test 0.7151335311572701
Best accuracy on Test 0.7151335311572701

**** Epoch 12/25 ****
0/33-(1.892)
15/33-(0.735)
30/33-(1.911)
12/33-(1.136)

=== Evaluating Model ===
accuracy on Valid 0.7113095238095238

Total valid loss 0.9138562164523385
accuracy on Test 0.7002967359050445
Best accuracy on Test 0.7151335311572701

**** Epoch 13/25 ****
27/33-(0.841)
9/33-(0.885)
24/33-(0.541)
6/33-(0.613)
21/33-(1.230)

=== Evaluating Model ===
accuracy on Valid 0.7023809523809523

Total valid loss 1.1778011511672626
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.7151335311572701

**** Epoch 14/25 ****
3/33-(0.245)
18/33-(1.382)
0/33-(0.900)
15/33-(0.883)

=== Evaluating Model ===
accuracy on Valid 0.7053571428571429

Total valid loss 1.0978058156642048
accuracy on Test 0.7181008902077152
Best accuracy on Test 0.7181008902077152

**** Epoch 15/25 ****
30/33-(0.547)
12/33-(0.409)
27/33-(0.990)
9/33-(0.900)

=== Evaluating Model ===
accuracy on Valid 0.7172619047619048

Total valid loss 1.082136500965465
accuracy on Test 0.712166172106825
Best accuracy on Test 0.7181008902077152

**** Epoch 16/25 ****
24/33-(1.334)
6/33-(0.447)
21/33-(1.140)
3/33-(1.173)

=== Evaluating Model ===
accuracy on Valid 0.7351190476190477

Total valid loss 1.271750424395908
accuracy on Test 0.7062314540059347
Best accuracy on Test 0.7181008902077152

**** Epoch 17/25 ****
18/33-(0.331)
0/33-(0.945)
15/33-(0.591)
30/33-(1.233)

=== Evaluating Model ===
accuracy on Valid 0.6904761904761905

Total valid loss 1.4063821563666516
accuracy on Test 0.7002967359050445
Best accuracy on Test 0.7181008902077152

**** Epoch 18/25 ****
12/33-(1.493)
27/33-(1.129)
9/33-(0.769)
24/33-(0.674)
6/33-(0.995)

=== Evaluating Model ===
accuracy on Valid 0.6875

Total valid loss 1.2746198096058585
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.7181008902077152

**** Epoch 19/25 ****
21/33-(0.571)
3/33-(0.619)
18/33-(0.763)
0/33-(0.674)

=== Evaluating Model ===
accuracy on Valid 0.6726190476190477

Total valid loss 2.0291939201680096
accuracy on Test 0.6379821958456974
Best accuracy on Test 0.7181008902077152

**** Epoch 20/25 ****
15/33-(1.158)
30/33-(1.098)
12/33-(1.089)
27/33-(0.514)

=== Evaluating Model ===
accuracy on Valid 0.7142857142857143

Total valid loss 1.2955470003864982
accuracy on Test 0.7062314540059347
Best accuracy on Test 0.7181008902077152

**** Epoch 21/25 ****
9/33-(0.782)
24/33-(1.135)
6/33-(0.515)
21/33-(1.090)

=== Evaluating Model ===
accuracy on Valid 0.7053571428571429

Total valid loss 1.0763699358159846
accuracy on Test 0.7062314540059347
Best accuracy on Test 0.7181008902077152

**** Epoch 22/25 ****
3/33-(0.187)
18/33-(0.255)
0/33-(0.829)
15/33-(0.785)

=== Evaluating Model ===
accuracy on Valid 0.7053571428571429

Total valid loss 1.5483991368250414
accuracy on Test 0.6795252225519288
Best accuracy on Test 0.7181008902077152

**** Epoch 23/25 ****
30/33-(0.536)
12/33-(1.967)
27/33-(0.408)
9/33-(0.778)
24/33-(0.739)

=== Evaluating Model ===
accuracy on Valid 0.7202380952380952

Total valid loss 1.522181131623008
accuracy on Test 0.6706231454005934
Best accuracy on Test 0.7181008902077152

**** Epoch 24/25 ****
6/33-(0.746)
Best accuracy on Test 0.7181008902077152

Final k-fold valid 0.7046930196410909
[0.7023809523809523, 0.712166172106825, 0.712166172106825, 0.6913946587537092, 0.7053571428571429]
Final k-fold eval 0.7248993217465027
[0.7380952380952381, 0.7172619047619048, 0.7270029673590505, 0.7240356083086054, 0.7181008902077152]
