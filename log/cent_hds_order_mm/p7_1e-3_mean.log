Whole k-fold eval mode
Source domain: 7, Target domain: 7, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(2.372)
30/33-(1.621)
12/33-(3.424)
27/33-(2.030)

=== Evaluating Model ===
accuracy on Valid 0.6468842729970327

Best accuracy on Valid 0.6468842729970327
Total valid loss 0.8623803501779382
accuracy on Test 0.6201780415430267
Best accuracy on Test 0.6201780415430267

**** Epoch 0/25 ****
9/33-(1.539)
24/33-(1.562)
6/33-(1.536)
21/33-(1.813)

=== Evaluating Model ===
accuracy on Valid 0.629080118694362

Total valid loss 0.7353375987573103
accuracy on Test 0.6142433234421365
Best accuracy on Test 0.6201780415430267

**** Epoch 1/25 ****
3/33-(1.002)
18/33-(1.593)
0/33-(2.073)
15/33-(1.717)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701

Best accuracy on Valid 0.7151335311572701
Total valid loss 0.7454003380103544
accuracy on Test 0.6795252225519288
Best accuracy on Test 0.6795252225519288

**** Epoch 2/25 ****
30/33-(1.871)
12/33-(1.976)
27/33-(0.836)
9/33-(2.363)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229

Total valid loss 0.7319115833802656
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.6824925816023739

**** Epoch 3/25 ****
24/33-(1.581)
6/33-(1.213)
21/33-(1.687)
3/33-(2.806)
18/33-(0.971)

=== Evaluating Model ===
accuracy on Valid 0.7329376854599406

Best accuracy on Valid 0.7329376854599406
Total valid loss 0.7719589376991446
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.6973293768545994

**** Epoch 4/25 ****
0/33-(1.055)
15/33-(1.287)
30/33-(0.831)
12/33-(1.275)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819

Total valid loss 0.8815128992904316
accuracy on Test 0.6350148367952523
Best accuracy on Test 0.6973293768545994

**** Epoch 5/25 ****
27/33-(1.286)
9/33-(1.289)
24/33-(1.077)
6/33-(1.926)

=== Evaluating Model ===
accuracy on Valid 0.56973293768546

Total valid loss 0.8651667535305023
accuracy on Test 0.5727002967359051
Best accuracy on Test 0.6973293768545994

**** Epoch 6/25 ****
21/33-(1.141)
3/33-(1.042)
18/33-(1.122)
0/33-(1.679)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308

Best accuracy on Valid 0.7388724035608308
Total valid loss 0.8251375000585209
accuracy on Test 0.6795252225519288
Best accuracy on Test 0.6973293768545994

**** Epoch 7/25 ****
15/33-(1.601)
30/33-(1.409)
12/33-(1.153)
27/33-(0.818)

=== Evaluating Model ===
accuracy on Valid 0.5756676557863502

Total valid loss 1.4846249385313555
accuracy on Test 0.5341246290801187
Best accuracy on Test 0.6973293768545994

**** Epoch 8/25 ****
9/33-(2.080)
24/33-(1.072)
6/33-(0.949)
21/33-(1.045)
3/33-(0.963)

=== Evaluating Model ===
accuracy on Valid 0.7329376854599406

Total valid loss 0.8802374222061851
accuracy on Test 0.685459940652819
Best accuracy on Test 0.6973293768545994

**** Epoch 9/25 ****
18/33-(0.846)
0/33-(0.639)
15/33-(0.839)
30/33-(0.363)

=== Evaluating Model ===
accuracy on Valid 0.7477744807121661

Best accuracy on Valid 0.7477744807121661
Total valid loss 0.7851562621918592
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.6973293768545994

**** Epoch 10/25 ****
12/33-(0.902)
27/33-(0.844)
9/33-(0.499)
24/33-(1.594)

=== Evaluating Model ===
accuracy on Valid 0.7626112759643917

Best accuracy on Valid 0.7626112759643917
Total valid loss 0.7752128974957899
accuracy on Test 0.712166172106825
Best accuracy on Test 0.712166172106825

**** Epoch 11/25 ****
6/33-(0.362)
21/33-(0.768)
3/33-(0.483)
18/33-(0.843)

=== Evaluating Model ===
accuracy on Valid 0.7299703264094956

Total valid loss 1.0614355518059297
accuracy on Test 0.7002967359050445
Best accuracy on Test 0.712166172106825

**** Epoch 12/25 ****
0/33-(0.569)
15/33-(0.469)
30/33-(0.973)
12/33-(0.572)

=== Evaluating Model ===
accuracy on Valid 0.7418397626112759

Total valid loss 0.8903417790477927
accuracy on Test 0.7181008902077152
Best accuracy on Test 0.7181008902077152

**** Epoch 13/25 ****
27/33-(0.944)
9/33-(0.349)
24/33-(0.755)
6/33-(0.612)
21/33-(0.563)

=== Evaluating Model ===
accuracy on Valid 0.7596439169139466

Total valid loss 1.02718023955822
accuracy on Test 0.685459940652819
Best accuracy on Test 0.7181008902077152

**** Epoch 14/25 ****
3/33-(2.556)
18/33-(0.818)
0/33-(0.624)
15/33-(0.627)

=== Evaluating Model ===
accuracy on Valid 0.7240356083086054

Total valid loss 1.1436097852208398
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.7181008902077152

**** Epoch 15/25 ****
30/33-(0.637)
12/33-(0.337)
27/33-(0.777)
9/33-(0.404)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308

Total valid loss 1.1892089328982614
accuracy on Test 0.7091988130563798
Best accuracy on Test 0.7181008902077152

**** Epoch 16/25 ****
24/33-(0.596)
6/33-(1.490)
21/33-(0.522)
3/33-(0.433)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Total valid loss 1.2633128423582425
accuracy on Test 0.6379821958456974
Best accuracy on Test 0.7181008902077152

**** Epoch 17/25 ****
18/33-(1.316)
0/33-(0.736)
15/33-(0.301)
30/33-(0.375)

=== Evaluating Model ===
accuracy on Valid 0.6735905044510386

Total valid loss 1.8841865685853092
accuracy on Test 0.6142433234421365
Best accuracy on Test 0.7181008902077152

**** Epoch 18/25 ****
12/33-(0.533)
27/33-(0.473)
9/33-(0.364)
24/33-(0.256)
6/33-(0.151)

=== Evaluating Model ===
accuracy on Valid 0.7329376854599406

Total valid loss 1.423385201530023
accuracy on Test 0.6706231454005934
Best accuracy on Test 0.7181008902077152

**** Epoch 19/25 ****
21/33-(0.432)
3/33-(0.797)
18/33-(0.586)
0/33-(0.352)

=== Evaluating Model ===
accuracy on Valid 0.7240356083086054

Total valid loss 1.1880683370611884
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.7181008902077152

**** Epoch 20/25 ****
15/33-(0.377)
30/33-(0.664)
12/33-(0.342)
27/33-(0.352)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229

Total valid loss 1.161736635999246
accuracy on Test 0.6528189910979229
Best accuracy on Test 0.7181008902077152

**** Epoch 21/25 ****
9/33-(0.257)
24/33-(0.248)
6/33-(0.098)
21/33-(0.205)

=== Evaluating Model ===
accuracy on Valid 0.7210682492581603

Total valid loss 1.447994503107938
accuracy on Test 0.685459940652819
Best accuracy on Test 0.7181008902077152

**** Epoch 22/25 ****
3/33-(0.554)
18/33-(0.309)
0/33-(0.765)
15/33-(1.120)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825

Total valid loss 1.5289355892349372
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.7181008902077152

**** Epoch 23/25 ****
30/33-(0.682)
12/33-(0.369)
27/33-(0.764)
9/33-(0.305)
24/33-(0.448)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Total valid loss 1.6071480758149514
accuracy on Test 0.6528189910979229
Best accuracy on Test 0.7181008902077152

**** Epoch 24/25 ****
6/33-(0.080)
Best accuracy on Test 0.7181008902077152

Source domain: 7, Target domain: 7, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(2.856)
30/33-(2.167)
12/33-(2.263)
27/33-(1.471)

=== Evaluating Model ===
accuracy on Valid 0.6350148367952523

Best accuracy on Valid 0.6350148367952523
Total valid loss 0.8245433894070712
accuracy on Test 0.6498516320474778
Best accuracy on Test 0.6498516320474778

**** Epoch 0/25 ****
9/33-(2.140)
24/33-(1.786)
6/33-(2.607)
21/33-(2.214)

=== Evaluating Model ===
accuracy on Valid 0.6735905044510386

Best accuracy on Valid 0.6735905044510386
Total valid loss 0.7017529037865725
accuracy on Test 0.7091988130563798
Best accuracy on Test 0.7091988130563798

**** Epoch 1/25 ****
3/33-(1.427)
18/33-(1.482)
0/33-(1.119)
15/33-(2.095)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Best accuracy on Valid 0.7032640949554896
Total valid loss 0.6564840728586371
accuracy on Test 0.7181008902077152
Best accuracy on Test 0.7181008902077152

**** Epoch 2/25 ****
30/33-(1.824)
12/33-(1.671)
27/33-(1.259)
9/33-(1.294)

=== Evaluating Model ===
accuracy on Valid 0.6409495548961425

Total valid loss 0.8605445054444399
accuracy on Test 0.6617210682492581
Best accuracy on Test 0.7181008902077152

**** Epoch 3/25 ****
24/33-(1.418)
6/33-(0.955)
21/33-(1.432)
3/33-(1.062)
18/33-(1.689)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819

Total valid loss 0.7355757626620206
accuracy on Test 0.7359050445103857
Best accuracy on Test 0.7359050445103857

**** Epoch 4/25 ****
0/33-(1.750)
15/33-(0.840)
30/33-(1.923)
12/33-(1.442)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825

Best accuracy on Valid 0.712166172106825
Total valid loss 0.6473215384916826
accuracy on Test 0.744807121661721
Best accuracy on Test 0.744807121661721

**** Epoch 5/25 ****
27/33-(1.165)
9/33-(0.877)
24/33-(1.205)
6/33-(1.854)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Total valid loss 0.6620458662509918
accuracy on Test 0.7418397626112759
Best accuracy on Test 0.744807121661721

**** Epoch 6/25 ****
21/33-(1.863)
3/33-(1.608)
18/33-(0.717)
0/33-(0.945)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825

Best accuracy on Valid 0.712166172106825
Total valid loss 0.6927769570188089
accuracy on Test 0.7507418397626113
Best accuracy on Test 0.7507418397626113

**** Epoch 7/25 ****
15/33-(1.875)
30/33-(0.671)
12/33-(0.957)
27/33-(0.627)

=== Evaluating Model ===
accuracy on Valid 0.6617210682492581

Total valid loss 0.8254676975987174
accuracy on Test 0.6795252225519288
Best accuracy on Test 0.7507418397626113

**** Epoch 8/25 ****
9/33-(1.940)
24/33-(1.353)
6/33-(0.942)
21/33-(1.813)
3/33-(1.657)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Total valid loss 0.735380155119029
accuracy on Test 0.6735905044510386
Best accuracy on Test 0.7507418397626113

**** Epoch 9/25 ****
18/33-(0.525)
0/33-(0.690)
15/33-(0.747)
30/33-(1.166)

=== Evaluating Model ===
accuracy on Valid 0.6824925816023739

Total valid loss 0.897581591524861
accuracy on Test 0.7329376854599406
Best accuracy on Test 0.7507418397626113

**** Epoch 10/25 ****
12/33-(0.732)
27/33-(0.801)
9/33-(1.488)
24/33-(2.441)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819

Total valid loss 0.9630576927553524
accuracy on Test 0.7151335311572701
Best accuracy on Test 0.7507418397626113

**** Epoch 11/25 ****
6/33-(1.640)
21/33-(0.322)
3/33-(1.957)
18/33-(0.467)

=== Evaluating Model ===
accuracy on Valid 0.6468842729970327

Total valid loss 1.249880413440141
accuracy on Test 0.6350148367952523
Best accuracy on Test 0.7507418397626113

**** Epoch 12/25 ****
0/33-(1.473)
15/33-(0.862)
30/33-(1.485)
12/33-(1.106)

=== Evaluating Model ===
accuracy on Valid 0.6735905044510386

Total valid loss 0.9189428687095642
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.7507418397626113

**** Epoch 13/25 ****
27/33-(0.552)
9/33-(0.549)
24/33-(1.148)
6/33-(0.410)
21/33-(0.650)

=== Evaluating Model ===
accuracy on Valid 0.6617210682492581

Total valid loss 1.1313602274114436
accuracy on Test 0.6706231454005934
Best accuracy on Test 0.7507418397626113

**** Epoch 14/25 ****
3/33-(0.682)
18/33-(0.601)
0/33-(0.451)
15/33-(0.553)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Total valid loss 0.9237558123740283
accuracy on Test 0.7270029673590505
Best accuracy on Test 0.7507418397626113

**** Epoch 15/25 ****
30/33-(0.661)
12/33-(0.508)
27/33-(0.347)
9/33-(0.627)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Total valid loss 1.0947597629644654
accuracy on Test 0.7477744807121661
Best accuracy on Test 0.7507418397626113

**** Epoch 16/25 ****
24/33-(0.240)
6/33-(2.061)
21/33-(0.386)
3/33-(0.350)

=== Evaluating Model ===
accuracy on Valid 0.655786350148368

Total valid loss 1.3923553011634133
accuracy on Test 0.685459940652819
Best accuracy on Test 0.7507418397626113

**** Epoch 17/25 ****
18/33-(0.898)
0/33-(1.334)
15/33-(0.891)
30/33-(0.240)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701

Best accuracy on Valid 0.7151335311572701
Total valid loss 1.1972467885776
accuracy on Test 0.7181008902077152
Best accuracy on Test 0.7507418397626113

**** Epoch 18/25 ****
12/33-(0.220)
27/33-(0.772)
9/33-(0.355)
24/33-(0.727)
6/33-(0.210)

=== Evaluating Model ===
accuracy on Valid 0.7181008902077152

Best accuracy on Valid 0.7181008902077152
Total valid loss 1.224140534346754
accuracy on Test 0.6884272997032641
Best accuracy on Test 0.7507418397626113

**** Epoch 19/25 ****
21/33-(0.421)
3/33-(0.569)
18/33-(0.535)
0/33-(1.182)

=== Evaluating Model ===
accuracy on Valid 0.5489614243323442

Total valid loss 2.9159938205372202
accuracy on Test 0.56973293768546
Best accuracy on Test 0.7507418397626113

**** Epoch 20/25 ****
15/33-(1.564)
30/33-(0.258)
12/33-(0.100)
27/33-(0.820)

=== Evaluating Model ===
accuracy on Valid 0.6824925816023739

Total valid loss 1.5710920759222724
accuracy on Test 0.7091988130563798
Best accuracy on Test 0.7507418397626113

**** Epoch 21/25 ****
9/33-(0.086)
24/33-(0.166)
6/33-(0.456)
21/33-(0.185)

=== Evaluating Model ===
accuracy on Valid 0.6320474777448071

Total valid loss 1.9834944660013372
accuracy on Test 0.6261127596439169
Best accuracy on Test 0.7507418397626113

**** Epoch 22/25 ****
3/33-(1.677)
18/33-(0.307)
0/33-(0.693)
15/33-(0.320)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Total valid loss 1.3193870715119622
accuracy on Test 0.6884272997032641
Best accuracy on Test 0.7507418397626113

**** Epoch 23/25 ****
30/33-(1.233)
12/33-(0.199)
27/33-(0.234)
9/33-(0.675)
24/33-(0.314)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Total valid loss 1.511262386021289
accuracy on Test 0.7240356083086054
Best accuracy on Test 0.7507418397626113

**** Epoch 24/25 ****
6/33-(0.647)
Best accuracy on Test 0.7507418397626113

Source domain: 7, Target domain: 7, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(2.039)
30/33-(1.980)
12/33-(2.312)
27/33-(1.969)

=== Evaluating Model ===
accuracy on Valid 0.6231454005934718

Best accuracy on Valid 0.6231454005934718
Total valid loss 0.847419956868345
accuracy on Test 0.6409495548961425
Best accuracy on Test 0.6409495548961425

**** Epoch 0/25 ****
9/33-(1.808)
24/33-(1.235)
6/33-(1.881)
21/33-(2.003)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Best accuracy on Valid 0.6795252225519288
Total valid loss 0.7202019203792919
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.6765578635014837

**** Epoch 1/25 ****
3/33-(1.482)
18/33-(1.343)
0/33-(1.537)
15/33-(1.091)

=== Evaluating Model ===
accuracy on Valid 0.5519287833827893

Total valid loss 1.173481659455733
accuracy on Test 0.49851632047477745
Best accuracy on Test 0.6765578635014837

**** Epoch 2/25 ****
30/33-(2.611)
12/33-(1.251)
27/33-(1.451)
9/33-(1.737)

=== Evaluating Model ===
accuracy on Valid 0.5637982195845698

Total valid loss 0.8669695407152176
accuracy on Test 0.6201780415430267
Best accuracy on Test 0.6765578635014837

**** Epoch 3/25 ****
24/33-(1.935)
6/33-(1.029)
21/33-(1.145)
3/33-(1.098)
18/33-(1.510)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Best accuracy on Valid 0.6795252225519288
Total valid loss 0.688368180936033
accuracy on Test 0.6795252225519288
Best accuracy on Test 0.6795252225519288

**** Epoch 4/25 ****
0/33-(1.335)
15/33-(1.336)
30/33-(0.892)
12/33-(1.709)

=== Evaluating Model ===
accuracy on Valid 0.6231454005934718

Total valid loss 0.7022200531580232
accuracy on Test 0.6646884272997032
Best accuracy on Test 0.6795252225519288

**** Epoch 5/25 ****
27/33-(1.221)
9/33-(0.800)
24/33-(0.699)
6/33-(1.164)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Best accuracy on Valid 0.7002967359050445
Total valid loss 0.686593309044838
accuracy on Test 0.6646884272997032
Best accuracy on Test 0.6795252225519288

**** Epoch 6/25 ****
21/33-(0.800)
3/33-(0.664)
18/33-(2.043)
0/33-(1.192)

=== Evaluating Model ===
accuracy on Valid 0.7329376854599406

Best accuracy on Valid 0.7329376854599406
Total valid loss 0.6915846141901884
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.6973293768545994

**** Epoch 7/25 ****
15/33-(1.108)
30/33-(1.123)
12/33-(0.557)
27/33-(0.823)

=== Evaluating Model ===
accuracy on Valid 0.7477744807121661

Best accuracy on Valid 0.7477744807121661
Total valid loss 0.6349878683686256
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.6973293768545994

**** Epoch 8/25 ****
9/33-(0.969)
24/33-(1.454)
6/33-(0.838)
21/33-(1.401)
3/33-(0.547)

=== Evaluating Model ===
accuracy on Valid 0.7270029673590505

Total valid loss 0.7265513905070045
accuracy on Test 0.6884272997032641
Best accuracy on Test 0.6973293768545994

**** Epoch 9/25 ****
18/33-(2.102)
0/33-(0.789)
15/33-(1.385)
30/33-(0.552)

=== Evaluating Model ===
accuracy on Valid 0.629080118694362

Total valid loss 0.9774830016222867
accuracy on Test 0.655786350148368
Best accuracy on Test 0.6973293768545994

**** Epoch 10/25 ****
12/33-(0.716)
27/33-(2.375)
9/33-(1.010)
24/33-(0.815)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Total valid loss 1.2895075733011419
accuracy on Test 0.6706231454005934
Best accuracy on Test 0.6973293768545994

**** Epoch 11/25 ****
6/33-(0.627)
21/33-(0.469)
3/33-(0.545)
18/33-(1.670)

=== Evaluating Model ===
accuracy on Valid 0.599406528189911

Total valid loss 0.9032137949358333
accuracy on Test 0.6528189910979229
Best accuracy on Test 0.6973293768545994

**** Epoch 12/25 ****
0/33-(0.867)
15/33-(0.641)
30/33-(0.961)
12/33-(0.826)

=== Evaluating Model ===
accuracy on Valid 0.7270029673590505

Total valid loss 0.8897707377645102
accuracy on Test 0.7002967359050445
Best accuracy on Test 0.7002967359050445

**** Epoch 13/25 ****
27/33-(1.189)
9/33-(1.544)
24/33-(0.828)
6/33-(0.470)
21/33-(0.701)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819

Total valid loss 1.0692954974418336
accuracy on Test 0.6795252225519288
Best accuracy on Test 0.7002967359050445

**** Epoch 14/25 ****
3/33-(0.294)
18/33-(0.386)
0/33-(1.396)
15/33-(1.192)

=== Evaluating Model ===
accuracy on Valid 0.7329376854599406

Total valid loss 1.109459223691374
accuracy on Test 0.6498516320474778
Best accuracy on Test 0.7002967359050445

**** Epoch 15/25 ****
30/33-(0.480)
12/33-(0.634)
27/33-(0.689)
9/33-(0.821)

=== Evaluating Model ===
accuracy on Valid 0.7477744807121661

Best accuracy on Valid 0.7477744807121661
Total valid loss 1.109208732843399
accuracy on Test 0.658753709198813
Best accuracy on Test 0.7002967359050445

**** Epoch 16/25 ****
24/33-(0.750)
6/33-(0.610)
21/33-(0.282)
3/33-(0.254)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Total valid loss 1.0529838252061217
accuracy on Test 0.6795252225519288
Best accuracy on Test 0.7002967359050445

**** Epoch 17/25 ****
18/33-(0.251)
0/33-(0.705)
15/33-(0.274)
30/33-(0.836)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825

Total valid loss 1.0863605677573518
accuracy on Test 0.7002967359050445
Best accuracy on Test 0.7002967359050445

**** Epoch 18/25 ****
12/33-(0.533)
27/33-(0.919)
9/33-(0.198)
24/33-(0.207)
6/33-(0.564)

=== Evaluating Model ===
accuracy on Valid 0.7181008902077152

Total valid loss 1.305049342187968
accuracy on Test 0.685459940652819
Best accuracy on Test 0.7002967359050445

**** Epoch 19/25 ****
21/33-(1.603)
3/33-(0.627)
18/33-(0.922)
0/33-(0.225)

=== Evaluating Model ===
accuracy on Valid 0.658753709198813

Total valid loss 1.4181702948490882
accuracy on Test 0.6706231454005934
Best accuracy on Test 0.7002967359050445

**** Epoch 20/25 ****
15/33-(0.406)
30/33-(0.348)
12/33-(0.343)
27/33-(0.252)

=== Evaluating Model ===
accuracy on Valid 0.6735905044510386

Total valid loss 1.1986162667665419
accuracy on Test 0.655786350148368
Best accuracy on Test 0.7002967359050445

**** Epoch 21/25 ****
9/33-(0.462)
24/33-(1.135)
6/33-(0.189)
21/33-(0.176)

=== Evaluating Model ===
accuracy on Valid 0.7329376854599406

Total valid loss 1.583130553724583
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.7002967359050445

**** Epoch 22/25 ****
3/33-(0.539)
18/33-(0.581)
0/33-(0.453)
15/33-(0.163)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825

Total valid loss 1.4134137780532579
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.7002967359050445

**** Epoch 23/25 ****
30/33-(0.279)
12/33-(0.097)
27/33-(0.158)
9/33-(0.145)
24/33-(0.239)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Total valid loss 1.7415847859103286
accuracy on Test 0.7032640949554896
Best accuracy on Test 0.7032640949554896

**** Epoch 24/25 ****
6/33-(0.610)
Best accuracy on Test 0.7032640949554896

Source domain: 7, Target domain: 7, Cur_fold 3
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(2.642)
30/33-(2.280)
12/33-(2.609)
27/33-(1.679)

=== Evaluating Model ===
accuracy on Valid 0.5710059171597633

Best accuracy on Valid 0.5710059171597633
Total valid loss 0.9324368184263055
accuracy on Test 0.5608308605341247
Best accuracy on Test 0.5608308605341247

**** Epoch 0/25 ****
9/33-(1.416)
24/33-(2.008)
6/33-(2.337)
21/33-(1.571)

=== Evaluating Model ===
accuracy on Valid 0.5532544378698225

Total valid loss 0.9056696945970709
accuracy on Test 0.5281899109792285
Best accuracy on Test 0.5608308605341247

**** Epoch 1/25 ****
3/33-(2.349)
18/33-(2.464)
0/33-(2.220)
15/33-(2.576)

=== Evaluating Model ===
accuracy on Valid 0.6715976331360947

Best accuracy on Valid 0.6715976331360947
Total valid loss 0.7116723656654358
accuracy on Test 0.6528189910979229
Best accuracy on Test 0.6528189910979229

**** Epoch 2/25 ****
30/33-(1.561)
12/33-(1.915)
27/33-(1.317)
9/33-(1.576)

=== Evaluating Model ===
accuracy on Valid 0.6952662721893491

Best accuracy on Valid 0.6952662721893491
Total valid loss 0.643411019986326
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.6943620178041543

**** Epoch 3/25 ****
24/33-(1.633)
6/33-(1.627)
21/33-(1.197)
3/33-(1.098)
18/33-(1.300)

=== Evaluating Model ===
accuracy on Valid 0.727810650887574

Best accuracy on Valid 0.727810650887574
Total valid loss 0.5992839634418488
accuracy on Test 0.7151335311572701
Best accuracy on Test 0.7151335311572701

**** Epoch 4/25 ****
0/33-(1.530)
15/33-(1.512)
30/33-(1.308)
12/33-(1.638)

=== Evaluating Model ===
accuracy on Valid 0.7218934911242604

Total valid loss 0.6669771698388186
accuracy on Test 0.6706231454005934
Best accuracy on Test 0.7151335311572701

**** Epoch 5/25 ****
27/33-(1.684)
9/33-(1.414)
24/33-(1.497)
6/33-(1.636)

=== Evaluating Model ===
accuracy on Valid 0.650887573964497

Total valid loss 0.8549060083248399
accuracy on Test 0.6053412462908012
Best accuracy on Test 0.7151335311572701

**** Epoch 6/25 ****
21/33-(0.894)
3/33-(0.988)
18/33-(0.951)
0/33-(1.306)

=== Evaluating Model ===
accuracy on Valid 0.6272189349112426

Total valid loss 0.9172474000264298
accuracy on Test 0.6231454005934718
Best accuracy on Test 0.7151335311572701

**** Epoch 7/25 ****
15/33-(1.183)
30/33-(1.287)
12/33-(1.193)
27/33-(0.701)

=== Evaluating Model ===
accuracy on Valid 0.7189349112426036

Total valid loss 0.7172562195496126
accuracy on Test 0.7299703264094956
Best accuracy on Test 0.7299703264094956

**** Epoch 8/25 ****
9/33-(1.166)
24/33-(1.489)
6/33-(1.018)
21/33-(2.120)
3/33-(0.764)

=== Evaluating Model ===
accuracy on Valid 0.6715976331360947

Total valid loss 0.7667905891483481
accuracy on Test 0.7032640949554896
Best accuracy on Test 0.7299703264094956

**** Epoch 9/25 ****
18/33-(0.807)
0/33-(0.508)
15/33-(0.753)
30/33-(0.754)

=== Evaluating Model ===
accuracy on Valid 0.7041420118343196

Total valid loss 0.8120452233336188
accuracy on Test 0.7240356083086054
Best accuracy on Test 0.7299703264094956

**** Epoch 10/25 ****
12/33-(1.144)
27/33-(0.671)
9/33-(2.952)
24/33-(0.449)

=== Evaluating Model ===
accuracy on Valid 0.7071005917159763

Total valid loss 0.9164313284510915
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.7299703264094956

**** Epoch 11/25 ****
6/33-(0.931)
21/33-(0.600)
3/33-(0.715)
18/33-(1.180)

=== Evaluating Model ===
accuracy on Valid 0.6923076923076923

Total valid loss 0.8967364747077227
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.7299703264094956

**** Epoch 12/25 ****
0/33-(0.404)
15/33-(0.487)
30/33-(0.339)
12/33-(0.467)

=== Evaluating Model ===
accuracy on Valid 0.6893491124260355

Total valid loss 0.9508603591133248
accuracy on Test 0.6646884272997032
Best accuracy on Test 0.7299703264094956

**** Epoch 13/25 ****
27/33-(0.622)
9/33-(0.487)
24/33-(0.521)
6/33-(0.679)
21/33-(0.708)

=== Evaluating Model ===
accuracy on Valid 0.7248520710059172

Total valid loss 0.8179088751362129
accuracy on Test 0.7181008902077152
Best accuracy on Test 0.7299703264094956

**** Epoch 14/25 ****
3/33-(0.169)
18/33-(0.569)
0/33-(0.570)
15/33-(0.487)

=== Evaluating Model ===
accuracy on Valid 0.6449704142011834

Total valid loss 1.3912770842964
accuracy on Test 0.6261127596439169
Best accuracy on Test 0.7299703264094956

**** Epoch 15/25 ****
30/33-(0.489)
12/33-(0.782)
27/33-(0.282)
9/33-(0.256)

=== Evaluating Model ===
accuracy on Valid 0.727810650887574

Best accuracy on Valid 0.727810650887574
Total valid loss 1.0577345492148942
accuracy on Test 0.7359050445103857
Best accuracy on Test 0.7359050445103857

**** Epoch 16/25 ****
24/33-(0.230)
6/33-(0.371)
21/33-(0.582)
3/33-(1.019)

=== Evaluating Model ===
accuracy on Valid 0.6449704142011834

Total valid loss 1.4317758197007193
accuracy on Test 0.6468842729970327
Best accuracy on Test 0.7359050445103857

**** Epoch 17/25 ****
18/33-(0.657)
0/33-(0.411)
15/33-(0.291)
30/33-(0.220)

=== Evaluating Model ===
accuracy on Valid 0.6893491124260355

Total valid loss 1.0857852318070151
accuracy on Test 0.7181008902077152
Best accuracy on Test 0.7359050445103857

**** Epoch 18/25 ****
12/33-(0.323)
27/33-(0.181)
9/33-(0.269)
24/33-(0.280)
6/33-(0.300)

=== Evaluating Model ===
accuracy on Valid 0.6715976331360947

Total valid loss 1.3598836054178802
accuracy on Test 0.655786350148368
Best accuracy on Test 0.7359050445103857

**** Epoch 19/25 ****
21/33-(0.183)
3/33-(0.879)
18/33-(0.827)
0/33-(0.251)

=== Evaluating Model ===
accuracy on Valid 0.7100591715976331

Total valid loss 1.1999927992001176
accuracy on Test 0.7151335311572701
Best accuracy on Test 0.7359050445103857

**** Epoch 20/25 ****
15/33-(0.277)
30/33-(0.252)
12/33-(0.123)
27/33-(0.375)

=== Evaluating Model ===
accuracy on Valid 0.6775147928994083

Total valid loss 1.4655037188309838
accuracy on Test 0.6676557863501483
Best accuracy on Test 0.7359050445103857

**** Epoch 21/25 ****
9/33-(0.401)
24/33-(0.491)
6/33-(0.405)
21/33-(2.275)

=== Evaluating Model ===
accuracy on Valid 0.7307692307692307

Best accuracy on Valid 0.7307692307692307
Total valid loss 1.2290356974540786
accuracy on Test 0.7062314540059347
Best accuracy on Test 0.7359050445103857

**** Epoch 22/25 ****
3/33-(0.244)
18/33-(0.333)
0/33-(0.852)
15/33-(0.488)

=== Evaluating Model ===
accuracy on Valid 0.7041420118343196

Total valid loss 1.769376336962027
accuracy on Test 0.6884272997032641
Best accuracy on Test 0.7359050445103857

**** Epoch 23/25 ****
30/33-(0.131)
12/33-(0.260)
27/33-(0.499)
9/33-(0.150)
24/33-(0.114)

=== Evaluating Model ===
accuracy on Valid 0.665680473372781

Total valid loss 2.095273225351279
accuracy on Test 0.6350148367952523
Best accuracy on Test 0.7359050445103857

**** Epoch 24/25 ****
6/33-(0.225)
Best accuracy on Test 0.7359050445103857

Source domain: 7, Target domain: 7, Cur_fold 4
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(2.415)
30/33-(2.378)
12/33-(1.673)
27/33-(1.553)

=== Evaluating Model ===
accuracy on Valid 0.5400593471810089

Best accuracy on Valid 0.5400593471810089
Total valid loss 0.901170096614144
accuracy on Test 0.5680473372781065
Best accuracy on Test 0.5680473372781065

**** Epoch 0/25 ****
9/33-(2.070)
24/33-(2.064)
6/33-(1.752)
21/33-(3.031)

=== Evaluating Model ===
accuracy on Valid 0.5608308605341247

Best accuracy on Valid 0.5608308605341247
Total valid loss 0.8940957405350425
accuracy on Test 0.5857988165680473
Best accuracy on Test 0.5857988165680473

**** Epoch 1/25 ****
3/33-(1.238)
18/33-(1.711)
0/33-(1.554)
15/33-(1.695)

=== Evaluating Model ===
accuracy on Valid 0.6201780415430267

Best accuracy on Valid 0.6201780415430267
Total valid loss 0.7129364569078792
accuracy on Test 0.6538461538461539
Best accuracy on Test 0.6538461538461539

**** Epoch 2/25 ****
30/33-(1.201)
12/33-(1.166)
27/33-(1.925)
9/33-(0.905)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819

Best accuracy on Valid 0.685459940652819
Total valid loss 0.6954649768092416
accuracy on Test 0.6568047337278107
Best accuracy on Test 0.6568047337278107

**** Epoch 3/25 ****
24/33-(1.232)
6/33-(1.225)
21/33-(1.301)
3/33-(2.236)
18/33-(1.590)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Best accuracy on Valid 0.6943620178041543
Total valid loss 0.5957371308044954
accuracy on Test 0.7189349112426036
Best accuracy on Test 0.7189349112426036

**** Epoch 4/25 ****
0/33-(0.892)
15/33-(1.468)
30/33-(1.240)
12/33-(1.435)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825

Best accuracy on Valid 0.712166172106825
Total valid loss 0.6645351174202833
accuracy on Test 0.7130177514792899
Best accuracy on Test 0.7189349112426036

**** Epoch 5/25 ****
27/33-(1.070)
9/33-(0.674)
24/33-(0.610)
6/33-(1.325)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Total valid loss 0.6608660085634752
accuracy on Test 0.7189349112426036
Best accuracy on Test 0.7189349112426036

**** Epoch 6/25 ****
21/33-(0.810)
3/33-(1.068)
18/33-(1.416)
0/33-(0.896)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701

Best accuracy on Valid 0.7151335311572701
Total valid loss 0.6870894025672566
accuracy on Test 0.7100591715976331
Best accuracy on Test 0.7189349112426036

**** Epoch 7/25 ****
15/33-(1.032)
30/33-(0.402)
12/33-(0.943)
27/33-(1.041)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641

Total valid loss 0.7988947284492579
accuracy on Test 0.7307692307692307
Best accuracy on Test 0.7307692307692307

**** Epoch 8/25 ****
9/33-(0.656)
24/33-(1.360)
6/33-(0.761)
21/33-(0.943)
3/33-(2.705)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994

Total valid loss 1.078100797804919
accuracy on Test 0.6449704142011834
Best accuracy on Test 0.7307692307692307

**** Epoch 9/25 ****
18/33-(0.518)
0/33-(0.603)
15/33-(1.030)
30/33-(1.225)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308

Best accuracy on Valid 0.7388724035608308
Total valid loss 0.7587472003969279
accuracy on Test 0.7248520710059172
Best accuracy on Test 0.7307692307692307

**** Epoch 10/25 ****
12/33-(0.694)
27/33-(0.493)
9/33-(0.897)
24/33-(0.609)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308

Best accuracy on Valid 0.7388724035608308
Total valid loss 0.8770472502166574
accuracy on Test 0.7218934911242604
Best accuracy on Test 0.7307692307692307

**** Epoch 11/25 ****
6/33-(0.706)
21/33-(0.319)
3/33-(0.670)
18/33-(0.438)

=== Evaluating Model ===
accuracy on Valid 0.655786350148368

Total valid loss 1.3374409282749349
accuracy on Test 0.6242603550295858
Best accuracy on Test 0.7307692307692307

**** Epoch 12/25 ****
0/33-(0.468)
15/33-(0.376)
30/33-(0.477)
12/33-(0.228)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Total valid loss 1.051701708273454
accuracy on Test 0.7248520710059172
Best accuracy on Test 0.7307692307692307

**** Epoch 13/25 ****
27/33-(0.940)
9/33-(1.020)
24/33-(0.796)
6/33-(0.551)
21/33-(0.463)

=== Evaluating Model ===
accuracy on Valid 0.6439169139465876

Total valid loss 1.2092365256764672
accuracy on Test 0.6715976331360947
Best accuracy on Test 0.7307692307692307

**** Epoch 14/25 ****
3/33-(0.149)
18/33-(0.898)
0/33-(0.520)
15/33-(0.715)

=== Evaluating Model ===
accuracy on Valid 0.6498516320474778

Total valid loss 1.4185331104831262
accuracy on Test 0.6804733727810651
Best accuracy on Test 0.7307692307692307

**** Epoch 15/25 ****
30/33-(0.410)
12/33-(1.144)
27/33-(0.296)
9/33-(0.571)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641

Total valid loss 1.1946162662722848
accuracy on Test 0.6952662721893491
Best accuracy on Test 0.7307692307692307

**** Epoch 16/25 ****
24/33-(0.465)
6/33-(0.306)
21/33-(0.292)
3/33-(0.101)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994

Total valid loss 1.1504705548286438
accuracy on Test 0.7100591715976331
Best accuracy on Test 0.7307692307692307

**** Epoch 17/25 ****
18/33-(0.103)
0/33-(0.517)
15/33-(0.277)
30/33-(0.289)

=== Evaluating Model ===
accuracy on Valid 0.6765578635014837

Total valid loss 1.1325361742214723
accuracy on Test 0.6893491124260355
Best accuracy on Test 0.7307692307692307

**** Epoch 18/25 ****
12/33-(0.292)
27/33-(0.334)
9/33-(0.151)
24/33-(0.145)
6/33-(0.742)

=== Evaluating Model ===
accuracy on Valid 0.629080118694362

Total valid loss 1.6696334088390523
accuracy on Test 0.6863905325443787
Best accuracy on Test 0.7307692307692307

**** Epoch 19/25 ****
21/33-(0.111)
3/33-(0.352)
18/33-(0.293)
0/33-(0.165)

=== Evaluating Model ===
accuracy on Valid 0.655786350148368

Total valid loss 1.3260698860341853
accuracy on Test 0.7041420118343196
Best accuracy on Test 0.7307692307692307

**** Epoch 20/25 ****
15/33-(1.254)
30/33-(0.221)
12/33-(0.166)
27/33-(0.072)

=== Evaluating Model ===
accuracy on Valid 0.6439169139465876

Total valid loss 1.4462574476545507
accuracy on Test 0.6952662721893491
Best accuracy on Test 0.7307692307692307

**** Epoch 21/25 ****
9/33-(0.498)
24/33-(0.097)
6/33-(0.174)
21/33-(0.562)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819

Total valid loss 1.6948773752559314
accuracy on Test 0.6775147928994083
Best accuracy on Test 0.7307692307692307

**** Epoch 22/25 ****
3/33-(0.579)
18/33-(0.310)
0/33-(0.164)
15/33-(0.979)

=== Evaluating Model ===
accuracy on Valid 0.6439169139465876

Total valid loss 1.3513976840133017
accuracy on Test 0.7218934911242604
Best accuracy on Test 0.7307692307692307

**** Epoch 23/25 ****
30/33-(0.205)
12/33-(0.243)
27/33-(0.280)
9/33-(0.148)
24/33-(0.217)

=== Evaluating Model ===
accuracy on Valid 0.6765578635014837

Total valid loss 1.486381207677451
accuracy on Test 0.7011834319526628
Best accuracy on Test 0.7307692307692307

**** Epoch 24/25 ****
6/33-(0.408)
Best accuracy on Test 0.7307692307692307

Final k-fold valid 0.7158885396730638
[0.7418397626112759, 0.712166172106825, 0.7091988130563798, 0.727810650887574, 0.6884272997032641]
Final k-fold eval 0.7277562200410865
[0.7181008902077152, 0.7507418397626113, 0.7032640949554896, 0.7359050445103857, 0.7307692307692307]
