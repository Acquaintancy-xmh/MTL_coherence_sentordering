Whole k-fold eval mode
Source domain: 7, Target domain: 7, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(3.188)
30/33-(2.654)
12/33-(2.729)
27/33-(2.074)

=== Evaluating Model ===
accuracy on Valid 0.5548961424332344

Best accuracy on Valid 0.5548961424332344
Total valid loss 1.0006547759879718
accuracy on Test 0.5400593471810089
Best accuracy on Test 0.5400593471810089

**** Epoch 0/25 ****
9/33-(2.722)
24/33-(2.544)
6/33-(2.805)
21/33-(2.918)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347

Best accuracy on Valid 0.7062314540059347
Total valid loss 0.7708178596063093
accuracy on Test 0.6676557863501483
Best accuracy on Test 0.6676557863501483

**** Epoch 1/25 ****
3/33-(2.456)
18/33-(2.409)
0/33-(2.820)
15/33-(2.878)

=== Evaluating Model ===
accuracy on Valid 0.5934718100890207

Total valid loss 0.8516787128014998
accuracy on Test 0.6172106824925816
Best accuracy on Test 0.6676557863501483

**** Epoch 2/25 ****
30/33-(2.919)
12/33-(2.709)
27/33-(2.530)
9/33-(2.235)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Total valid loss 0.6867606287652795
accuracy on Test 0.7002967359050445
Best accuracy on Test 0.7002967359050445

**** Epoch 3/25 ****
24/33-(2.530)
6/33-(3.117)
21/33-(2.569)
3/33-(2.602)
18/33-(2.447)

=== Evaluating Model ===
accuracy on Valid 0.7685459940652819

Best accuracy on Valid 0.7685459940652819
Total valid loss 0.6534238051284443
accuracy on Test 0.7240356083086054
Best accuracy on Test 0.7240356083086054

**** Epoch 4/25 ****
0/33-(2.026)
15/33-(4.974)
30/33-(2.752)
12/33-(2.442)

=== Evaluating Model ===
accuracy on Valid 0.6439169139465876

Total valid loss 0.9241277602585879
accuracy on Test 0.6528189910979229
Best accuracy on Test 0.7240356083086054

**** Epoch 5/25 ****
27/33-(2.534)
9/33-(1.548)
24/33-(2.242)
6/33-(1.986)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308

Total valid loss 0.6870572749863971
accuracy on Test 0.7002967359050445
Best accuracy on Test 0.7240356083086054

**** Epoch 6/25 ****
21/33-(2.116)
3/33-(1.593)
18/33-(1.559)
0/33-(1.907)

=== Evaluating Model ===
accuracy on Valid 0.7477744807121661

Total valid loss 0.7009608176621523
accuracy on Test 0.685459940652819
Best accuracy on Test 0.7240356083086054

**** Epoch 7/25 ****
15/33-(2.059)
30/33-(1.741)
12/33-(1.901)
27/33-(1.614)

=== Evaluating Model ===
accuracy on Valid 0.6824925816023739

Total valid loss 0.7999403856017373
accuracy on Test 0.6617210682492581
Best accuracy on Test 0.7240356083086054

**** Epoch 8/25 ****
9/33-(1.548)
24/33-(1.938)
6/33-(1.679)
21/33-(3.632)
3/33-(1.710)

=== Evaluating Model ===
accuracy on Valid 0.6735905044510386

Total valid loss 0.810247850689021
accuracy on Test 0.6528189910979229
Best accuracy on Test 0.7240356083086054

**** Epoch 9/25 ****
18/33-(2.231)
0/33-(1.466)
15/33-(1.424)
30/33-(1.945)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934

Total valid loss 0.9508168236775831
accuracy on Test 0.6706231454005934
Best accuracy on Test 0.7240356083086054

**** Epoch 10/25 ****
12/33-(1.422)
27/33-(1.947)
9/33-(0.685)
24/33-(2.183)

=== Evaluating Model ===
accuracy on Valid 0.7181008902077152

Total valid loss 0.761472917415879
accuracy on Test 0.685459940652819
Best accuracy on Test 0.7240356083086054

**** Epoch 11/25 ****
6/33-(0.936)
21/33-(2.027)
3/33-(1.124)
18/33-(1.059)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825

Total valid loss 0.7662613811818036
accuracy on Test 0.7002967359050445
Best accuracy on Test 0.7240356083086054

**** Epoch 12/25 ****
0/33-(1.220)
15/33-(0.834)
30/33-(1.913)
12/33-(1.426)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641

Total valid loss 0.8744374134323813
accuracy on Test 0.6913946587537092
Best accuracy on Test 0.7240356083086054

**** Epoch 13/25 ****
27/33-(1.282)
9/33-(0.922)
24/33-(1.119)
6/33-(1.315)
21/33-(4.590)

=== Evaluating Model ===
accuracy on Valid 0.7240356083086054

Total valid loss 1.0004205798560923
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.7240356083086054

**** Epoch 14/25 ****
3/33-(0.793)
18/33-(1.146)
0/33-(1.135)
15/33-(1.682)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308

Total valid loss 0.8570264726877213
accuracy on Test 0.7062314540059347
Best accuracy on Test 0.7240356083086054

**** Epoch 15/25 ****
30/33-(1.831)
12/33-(0.758)
27/33-(3.218)
9/33-(0.836)

=== Evaluating Model ===
accuracy on Valid 0.7477744807121661

Total valid loss 1.155799696391279
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.7240356083086054

**** Epoch 16/25 ****
24/33-(1.277)
6/33-(0.692)
21/33-(0.835)
3/33-(0.955)

=== Evaluating Model ===
accuracy on Valid 0.744807121661721

Total valid loss 0.9995031234892932
accuracy on Test 0.6913946587537092
Best accuracy on Test 0.7240356083086054

**** Epoch 17/25 ****
18/33-(0.994)
0/33-(1.215)
15/33-(0.991)
30/33-(1.831)

=== Evaluating Model ===
accuracy on Valid 0.7477744807121661

Total valid loss 1.1920751536434346
accuracy on Test 0.6735905044510386
Best accuracy on Test 0.7240356083086054

**** Epoch 18/25 ****
12/33-(10.246)
27/33-(0.940)
9/33-(0.960)
24/33-(1.860)
6/33-(1.031)

=== Evaluating Model ===
accuracy on Valid 0.7299703264094956

Total valid loss 1.2609115568074314
accuracy on Test 0.6884272997032641
Best accuracy on Test 0.7240356083086054

**** Epoch 19/25 ****
21/33-(0.963)
3/33-(0.911)
18/33-(0.918)
0/33-(1.121)

=== Evaluating Model ===
accuracy on Valid 0.7210682492581603

Total valid loss 0.9814934649250724
accuracy on Test 0.6884272997032641
Best accuracy on Test 0.7240356083086054

**** Epoch 20/25 ****
15/33-(1.596)
30/33-(3.623)
12/33-(0.907)
27/33-(0.432)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701

Total valid loss 1.5099645351821727
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.7240356083086054

**** Epoch 21/25 ****
9/33-(1.073)
24/33-(0.721)
6/33-(0.873)
21/33-(0.458)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Total valid loss 1.0979908366094937
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.7240356083086054

**** Epoch 22/25 ****
3/33-(1.287)
18/33-(1.573)
0/33-(0.556)
15/33-(0.895)

=== Evaluating Model ===
accuracy on Valid 0.7299703264094956

Total valid loss 1.58094113658775
accuracy on Test 0.6646884272997032
Best accuracy on Test 0.7240356083086054

**** Epoch 23/25 ****
30/33-(0.685)
12/33-(0.632)
27/33-(0.402)
9/33-(1.435)
24/33-(0.504)

=== Evaluating Model ===
accuracy on Valid 0.7477744807121661

Total valid loss 1.6307726488872007
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.7240356083086054

**** Epoch 24/25 ****
6/33-(4.048)
Best accuracy on Test 0.7240356083086054

Source domain: 7, Target domain: 7, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(3.550)
30/33-(3.350)
12/33-(3.040)
27/33-(2.895)

=== Evaluating Model ===
accuracy on Valid 0.6350148367952523

Best accuracy on Valid 0.6350148367952523
Total valid loss 0.8324854563583027
accuracy on Test 0.6617210682492581
Best accuracy on Test 0.6617210682492581

**** Epoch 0/25 ****
9/33-(3.038)
24/33-(3.030)
6/33-(3.732)
21/33-(2.756)

=== Evaluating Model ===
accuracy on Valid 0.6083086053412463

Total valid loss 0.7273582734844901
accuracy on Test 0.6142433234421365
Best accuracy on Test 0.6617210682492581

**** Epoch 1/25 ****
3/33-(3.334)
18/33-(2.833)
0/33-(2.418)
15/33-(3.599)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Best accuracy on Valid 0.7002967359050445
Total valid loss 0.7230613367124037
accuracy on Test 0.712166172106825
Best accuracy on Test 0.712166172106825

**** Epoch 2/25 ****
30/33-(1.612)
12/33-(4.042)
27/33-(2.499)
9/33-(1.994)

=== Evaluating Model ===
accuracy on Valid 0.6765578635014837

Total valid loss 0.6941361684690822
accuracy on Test 0.7181008902077152
Best accuracy on Test 0.7181008902077152

**** Epoch 3/25 ****
24/33-(2.739)
6/33-(1.377)
21/33-(1.376)
3/33-(1.281)
18/33-(2.397)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347

Best accuracy on Valid 0.7062314540059347
Total valid loss 0.6738139269026843
accuracy on Test 0.7299703264094956
Best accuracy on Test 0.7299703264094956

**** Epoch 4/25 ****
0/33-(2.219)
15/33-(2.240)
30/33-(2.327)
12/33-(4.135)

=== Evaluating Model ===
accuracy on Valid 0.6646884272997032

Total valid loss 0.6907916150309823
accuracy on Test 0.685459940652819
Best accuracy on Test 0.7299703264094956

**** Epoch 5/25 ****
27/33-(1.766)
9/33-(1.449)
24/33-(2.001)
6/33-(1.751)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825

Best accuracy on Valid 0.712166172106825
Total valid loss 0.6596274104985324
accuracy on Test 0.7151335311572701
Best accuracy on Test 0.7299703264094956

**** Epoch 6/25 ****
21/33-(2.377)
3/33-(1.901)
18/33-(2.030)
0/33-(2.385)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Total valid loss 0.6403765299103477
accuracy on Test 0.7566765578635015
Best accuracy on Test 0.7566765578635015

**** Epoch 7/25 ****
15/33-(2.187)
30/33-(1.629)
12/33-(1.811)
27/33-(2.186)

=== Evaluating Model ===
accuracy on Valid 0.7270029673590505

Best accuracy on Valid 0.7270029673590505
Total valid loss 0.6798180572011254
accuracy on Test 0.7418397626112759
Best accuracy on Test 0.7566765578635015

**** Epoch 8/25 ****
9/33-(1.932)
24/33-(1.810)
6/33-(1.388)
21/33-(2.153)
3/33-(1.732)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Total valid loss 0.6641389280557632
accuracy on Test 0.7566765578635015
Best accuracy on Test 0.7566765578635015

**** Epoch 9/25 ****
18/33-(1.366)
0/33-(1.452)
15/33-(1.793)
30/33-(1.164)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Total valid loss 0.7002089443531904
accuracy on Test 0.7685459940652819
Best accuracy on Test 0.7685459940652819

**** Epoch 10/25 ****
12/33-(2.013)
27/33-(1.287)
9/33-(1.423)
24/33-(3.263)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Total valid loss 0.8249172310937535
accuracy on Test 0.7002967359050445
Best accuracy on Test 0.7685459940652819

**** Epoch 11/25 ****
6/33-(1.328)
21/33-(1.226)
3/33-(1.565)
18/33-(2.914)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Total valid loss 0.7739626250483773
accuracy on Test 0.744807121661721
Best accuracy on Test 0.7685459940652819

**** Epoch 12/25 ****
0/33-(2.984)
15/33-(1.321)
30/33-(1.836)
12/33-(1.943)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Total valid loss 0.7283701842481439
accuracy on Test 0.7359050445103857
Best accuracy on Test 0.7685459940652819

**** Epoch 13/25 ****
27/33-(1.507)
9/33-(0.840)
24/33-(2.674)
6/33-(0.984)
21/33-(0.952)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Total valid loss 0.8781432611021128
accuracy on Test 0.7507418397626113
Best accuracy on Test 0.7685459940652819

**** Epoch 14/25 ****
3/33-(2.367)
18/33-(1.554)
0/33-(1.645)
15/33-(7.843)

=== Evaluating Model ===
accuracy on Valid 0.6409495548961425

Total valid loss 1.053830480033701
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.7685459940652819

**** Epoch 15/25 ****
30/33-(1.148)
12/33-(1.237)
27/33-(1.041)
9/33-(2.119)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Total valid loss 1.016539872369983
accuracy on Test 0.7359050445103857
Best accuracy on Test 0.7685459940652819

**** Epoch 16/25 ****
24/33-(1.225)
6/33-(1.342)
21/33-(1.736)
3/33-(6.916)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Total valid loss 0.9504598907449029
accuracy on Test 0.7240356083086054
Best accuracy on Test 0.7685459940652819

**** Epoch 17/25 ****
18/33-(0.885)
0/33-(1.308)
15/33-(0.671)
30/33-(0.555)

=== Evaluating Model ===
accuracy on Valid 0.6172106824925816

Total valid loss 1.2086121141910553
accuracy on Test 0.6112759643916914
Best accuracy on Test 0.7685459940652819

**** Epoch 18/25 ****
12/33-(0.974)
27/33-(1.302)
9/33-(1.032)
24/33-(0.767)
6/33-(1.179)

=== Evaluating Model ===
accuracy on Valid 0.6350148367952523

Total valid loss 1.0408761392940173
accuracy on Test 0.685459940652819
Best accuracy on Test 0.7685459940652819

**** Epoch 19/25 ****
21/33-(1.149)
3/33-(1.093)
18/33-(1.026)
0/33-(1.184)

=== Evaluating Model ===
accuracy on Valid 0.7210682492581603

Total valid loss 1.0273918997157703
accuracy on Test 0.7359050445103857
Best accuracy on Test 0.7685459940652819

**** Epoch 20/25 ****
15/33-(1.191)
30/33-(1.053)
12/33-(1.131)
27/33-(1.581)

=== Evaluating Model ===
accuracy on Valid 0.7240356083086054

Total valid loss 1.1541226790709929
accuracy on Test 0.7329376854599406
Best accuracy on Test 0.7685459940652819

**** Epoch 21/25 ****
9/33-(1.715)
24/33-(0.933)
6/33-(1.858)
21/33-(0.869)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Total valid loss 0.9978534321893345
accuracy on Test 0.7181008902077152
Best accuracy on Test 0.7685459940652819

**** Epoch 22/25 ****
3/33-(0.597)
18/33-(1.048)
0/33-(0.788)
15/33-(0.680)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Total valid loss 1.4524958729743958
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.7685459940652819

**** Epoch 23/25 ****
30/33-(0.860)
12/33-(8.172)
27/33-(0.729)
9/33-(1.200)
24/33-(1.582)

=== Evaluating Model ===
accuracy on Valid 0.6765578635014837

Total valid loss 1.3242607739838688
accuracy on Test 0.7210682492581603
Best accuracy on Test 0.7685459940652819

**** Epoch 24/25 ****
6/33-(1.307)
Best accuracy on Test 0.7685459940652819

Source domain: 7, Target domain: 7, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(3.334)
30/33-(2.931)
12/33-(3.200)
27/33-(2.570)

=== Evaluating Model ===
accuracy on Valid 0.5905044510385756

Best accuracy on Valid 0.5905044510385756
Total valid loss 0.820854124697772
accuracy on Test 0.6053412462908012
Best accuracy on Test 0.6053412462908012

**** Epoch 0/25 ****
9/33-(2.150)
24/33-(2.496)
6/33-(2.803)
21/33-(2.255)

=== Evaluating Model ===
accuracy on Valid 0.6439169139465876

Best accuracy on Valid 0.6439169139465876
Total valid loss 0.721504610370506
accuracy on Test 0.6439169139465876
Best accuracy on Test 0.6439169139465876

**** Epoch 1/25 ****
3/33-(2.885)
18/33-(1.835)
0/33-(2.565)
15/33-(2.471)

=== Evaluating Model ===
accuracy on Valid 0.6676557863501483

Best accuracy on Valid 0.6676557863501483
Total valid loss 0.6593176085840572
accuracy on Test 0.6884272997032641
Best accuracy on Test 0.6884272997032641

**** Epoch 2/25 ****
30/33-(2.020)
12/33-(1.927)
27/33-(3.232)
9/33-(2.395)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Best accuracy on Valid 0.7032640949554896
Total valid loss 0.6440648964860223
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.6973293768545994

**** Epoch 3/25 ****
24/33-(2.510)
6/33-(2.701)
21/33-(1.527)
3/33-(2.055)
18/33-(2.103)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Total valid loss 0.627729204567996
accuracy on Test 0.6884272997032641
Best accuracy on Test 0.6973293768545994

**** Epoch 4/25 ****
0/33-(2.089)
15/33-(2.516)
30/33-(2.544)
12/33-(2.791)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092

Total valid loss 0.6828113238919865
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.6973293768545994

**** Epoch 5/25 ****
27/33-(2.382)
9/33-(3.499)
24/33-(1.973)
6/33-(1.867)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994

Total valid loss 0.6648235524242575
accuracy on Test 0.6735905044510386
Best accuracy on Test 0.6973293768545994

**** Epoch 6/25 ****
21/33-(1.877)
3/33-(1.627)
18/33-(1.878)
0/33-(3.672)

=== Evaluating Model ===
accuracy on Valid 0.6617210682492581

Total valid loss 0.7956325398250059
accuracy on Test 0.6379821958456974
Best accuracy on Test 0.6973293768545994

**** Epoch 7/25 ****
15/33-(2.082)
30/33-(1.590)
12/33-(1.915)
27/33-(1.735)

=== Evaluating Model ===
accuracy on Valid 0.5370919881305638

Total valid loss 1.017622243274342
accuracy on Test 0.5281899109792285
Best accuracy on Test 0.6973293768545994

**** Epoch 8/25 ****
9/33-(1.487)
24/33-(1.592)
6/33-(2.583)
21/33-(1.343)
3/33-(3.557)

=== Evaluating Model ===
accuracy on Valid 0.7270029673590505

Best accuracy on Valid 0.7270029673590505
Total valid loss 0.6559899479828097
accuracy on Test 0.7062314540059347
Best accuracy on Test 0.7062314540059347

**** Epoch 9/25 ****
18/33-(3.131)
0/33-(1.993)
15/33-(3.409)
30/33-(2.485)

=== Evaluating Model ===
accuracy on Valid 0.744807121661721

Best accuracy on Valid 0.744807121661721
Total valid loss 0.5831014703620564
accuracy on Test 0.7091988130563798
Best accuracy on Test 0.7091988130563798

**** Epoch 10/25 ****
12/33-(1.969)
27/33-(1.544)
9/33-(1.613)
24/33-(1.576)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Total valid loss 0.6731977076693014
accuracy on Test 0.6706231454005934
Best accuracy on Test 0.7091988130563798

**** Epoch 11/25 ****
6/33-(1.912)
21/33-(1.277)
3/33-(2.654)
18/33-(1.296)

=== Evaluating Model ===
accuracy on Valid 0.6646884272997032

Total valid loss 0.6832900687374852
accuracy on Test 0.7032640949554896
Best accuracy on Test 0.7091988130563798

**** Epoch 12/25 ****
0/33-(1.610)
15/33-(1.237)
30/33-(1.557)
12/33-(0.744)

=== Evaluating Model ===
accuracy on Valid 0.655786350148368

Total valid loss 0.7519031532786109
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.7091988130563798

**** Epoch 13/25 ****
27/33-(1.508)
9/33-(1.842)
24/33-(1.073)
6/33-(1.403)
21/33-(0.705)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308

Total valid loss 0.888208507136865
accuracy on Test 0.6884272997032641
Best accuracy on Test 0.7091988130563798

**** Epoch 14/25 ****
3/33-(0.383)
18/33-(1.104)
0/33-(1.160)
15/33-(2.307)

=== Evaluating Model ===
accuracy on Valid 0.6498516320474778

Total valid loss 0.9160192732445218
accuracy on Test 0.6350148367952523
Best accuracy on Test 0.7091988130563798

**** Epoch 15/25 ****
30/33-(1.568)
12/33-(1.737)
27/33-(0.916)
9/33-(0.823)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308

Total valid loss 0.8405861592089588
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.7091988130563798

**** Epoch 16/25 ****
24/33-(1.429)
6/33-(1.144)
21/33-(1.323)
3/33-(1.042)

=== Evaluating Model ===
accuracy on Valid 0.6231454005934718

Total valid loss 1.1666976390829817
accuracy on Test 0.6261127596439169
Best accuracy on Test 0.7091988130563798

**** Epoch 17/25 ****
18/33-(4.335)
0/33-(0.661)
15/33-(1.409)
30/33-(1.355)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701

Total valid loss 0.9814309526488862
accuracy on Test 0.7062314540059347
Best accuracy on Test 0.7091988130563798

**** Epoch 18/25 ****
12/33-(1.217)
27/33-(0.828)
9/33-(6.960)
24/33-(1.478)
6/33-(1.429)

=== Evaluating Model ===
accuracy on Valid 0.6498516320474778

Total valid loss 1.4476678453131833
accuracy on Test 0.6201780415430267
Best accuracy on Test 0.7091988130563798

**** Epoch 19/25 ****
21/33-(1.008)
3/33-(1.200)
18/33-(0.884)
0/33-(0.596)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641

Total valid loss 0.919896040958437
accuracy on Test 0.685459940652819
Best accuracy on Test 0.7091988130563798

**** Epoch 20/25 ****
15/33-(1.357)
30/33-(1.348)
12/33-(0.768)
27/33-(2.004)

=== Evaluating Model ===
accuracy on Valid 0.6468842729970327

Total valid loss 1.3563743172298102
accuracy on Test 0.6201780415430267
Best accuracy on Test 0.7091988130563798

**** Epoch 21/25 ****
9/33-(0.394)
24/33-(4.771)
6/33-(0.826)
21/33-(0.948)

=== Evaluating Model ===
accuracy on Valid 0.7477744807121661

Best accuracy on Valid 0.7477744807121661
Total valid loss 1.0395653161897578
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.7091988130563798

**** Epoch 22/25 ****
3/33-(3.244)
18/33-(1.174)
0/33-(0.873)
15/33-(0.783)

=== Evaluating Model ===
accuracy on Valid 0.6765578635014837

Total valid loss 1.6224128007009064
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.7091988130563798

**** Epoch 23/25 ****
30/33-(0.614)
12/33-(0.971)
27/33-(0.643)
9/33-(0.861)
24/33-(1.018)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Total valid loss 1.0917448050088503
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.7091988130563798

**** Epoch 24/25 ****
6/33-(0.911)
Best accuracy on Test 0.7091988130563798

Source domain: 7, Target domain: 7, Cur_fold 3
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(3.269)
30/33-(3.366)
12/33-(2.154)
27/33-(3.236)

=== Evaluating Model ===
accuracy on Valid 0.5739644970414202

Best accuracy on Valid 0.5739644970414202
Total valid loss 0.9182330478321422
accuracy on Test 0.5578635014836796
Best accuracy on Test 0.5578635014836796

**** Epoch 0/25 ****
9/33-(3.197)
24/33-(2.753)
6/33-(2.453)
21/33-(2.919)

=== Evaluating Model ===
accuracy on Valid 0.5384615384615384

Total valid loss 0.8317706923593174
accuracy on Test 0.5074183976261127
Best accuracy on Test 0.5578635014836796

**** Epoch 1/25 ****
3/33-(2.727)
18/33-(2.246)
0/33-(2.714)
15/33-(3.305)

=== Evaluating Model ===
accuracy on Valid 0.6834319526627219

Best accuracy on Valid 0.6834319526627219
Total valid loss 0.6707768602804705
accuracy on Test 0.6735905044510386
Best accuracy on Test 0.6735905044510386

**** Epoch 2/25 ****
30/33-(2.688)
12/33-(2.906)
27/33-(2.521)
9/33-(1.879)

=== Evaluating Model ===
accuracy on Valid 0.6952662721893491

Best accuracy on Valid 0.6952662721893491
Total valid loss 0.712328163060275
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.6943620178041543

**** Epoch 3/25 ****
24/33-(2.275)
6/33-(2.258)
21/33-(2.570)
3/33-(1.616)
18/33-(2.689)

=== Evaluating Model ===
accuracy on Valid 0.6863905325443787

Total valid loss 0.7495405172759836
accuracy on Test 0.6498516320474778
Best accuracy on Test 0.6943620178041543

**** Epoch 4/25 ****
0/33-(2.315)
15/33-(1.996)
30/33-(1.762)
12/33-(1.658)

=== Evaluating Model ===
accuracy on Valid 0.5591715976331361

Total valid loss 1.0098177858374335
accuracy on Test 0.5459940652818991
Best accuracy on Test 0.6943620178041543

**** Epoch 5/25 ****
27/33-(2.333)
9/33-(2.276)
24/33-(3.154)
6/33-(2.177)

=== Evaluating Model ===
accuracy on Valid 0.7041420118343196

Best accuracy on Valid 0.7041420118343196
Total valid loss 0.6691402237523686
accuracy on Test 0.6913946587537092
Best accuracy on Test 0.6943620178041543

**** Epoch 6/25 ****
21/33-(2.070)
3/33-(3.022)
18/33-(1.863)
0/33-(1.516)

=== Evaluating Model ===
accuracy on Valid 0.7071005917159763

Best accuracy on Valid 0.7071005917159763
Total valid loss 0.723040609197183
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.6943620178041543

**** Epoch 7/25 ****
15/33-(2.000)
30/33-(1.913)
12/33-(1.644)
27/33-(3.151)

=== Evaluating Model ===
accuracy on Valid 0.7189349112426036

Best accuracy on Valid 0.7189349112426036
Total valid loss 0.731603669849309
accuracy on Test 0.7062314540059347
Best accuracy on Test 0.7062314540059347

**** Epoch 8/25 ****
9/33-(1.482)
24/33-(1.451)
6/33-(1.882)
21/33-(2.077)
3/33-(2.239)

=== Evaluating Model ===
accuracy on Valid 0.6745562130177515

Total valid loss 0.7670646851713007
accuracy on Test 0.6795252225519288
Best accuracy on Test 0.7062314540059347

**** Epoch 9/25 ****
18/33-(3.025)
0/33-(1.214)
15/33-(1.165)
30/33-(2.126)

=== Evaluating Model ===
accuracy on Valid 0.7307692307692307

Best accuracy on Valid 0.7307692307692307
Total valid loss 0.7474116256291216
accuracy on Test 0.7329376854599406
Best accuracy on Test 0.7329376854599406

**** Epoch 10/25 ****
12/33-(1.983)
27/33-(1.045)
9/33-(1.423)
24/33-(3.041)

=== Evaluating Model ===
accuracy on Valid 0.6982248520710059

Total valid loss 0.6679562492804094
accuracy on Test 0.7240356083086054
Best accuracy on Test 0.7329376854599406

**** Epoch 11/25 ****
6/33-(1.538)
21/33-(1.051)
3/33-(5.633)
18/33-(1.139)

=== Evaluating Model ===
accuracy on Valid 0.6952662721893491

Total valid loss 0.8601220372048292
accuracy on Test 0.658753709198813
Best accuracy on Test 0.7329376854599406

**** Epoch 12/25 ****
0/33-(1.975)
15/33-(1.326)
30/33-(1.204)
12/33-(1.690)

=== Evaluating Model ===
accuracy on Valid 0.7100591715976331

Total valid loss 0.6929155161434953
accuracy on Test 0.7210682492581603
Best accuracy on Test 0.7329376854599406

**** Epoch 13/25 ****
27/33-(1.014)
9/33-(1.081)
24/33-(1.126)
6/33-(0.960)
21/33-(2.453)

=== Evaluating Model ===
accuracy on Valid 0.7189349112426036

Total valid loss 0.850714058699933
accuracy on Test 0.7151335311572701
Best accuracy on Test 0.7329376854599406

**** Epoch 14/25 ****
3/33-(0.404)
18/33-(0.874)
0/33-(1.340)
15/33-(1.291)

=== Evaluating Model ===
accuracy on Valid 0.7455621301775148

Best accuracy on Valid 0.7455621301775148
Total valid loss 0.8201297616416757
accuracy on Test 0.7477744807121661
Best accuracy on Test 0.7477744807121661

**** Epoch 15/25 ****
30/33-(1.031)
12/33-(1.230)
27/33-(0.661)
9/33-(1.261)

=== Evaluating Model ===
accuracy on Valid 0.6745562130177515

Total valid loss 0.8590615635568445
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.7477744807121661

**** Epoch 16/25 ****
24/33-(1.120)
6/33-(0.950)
21/33-(1.684)
3/33-(1.183)

=== Evaluating Model ===
accuracy on Valid 0.7248520710059172

Total valid loss 0.7189003364606337
accuracy on Test 0.7240356083086054
Best accuracy on Test 0.7477744807121661

**** Epoch 17/25 ****
18/33-(0.821)
0/33-(1.131)
15/33-(0.748)
30/33-(0.697)

=== Evaluating Model ===
accuracy on Valid 0.7366863905325444

Total valid loss 0.8258398513902317
accuracy on Test 0.7388724035608308
Best accuracy on Test 0.7477744807121661

**** Epoch 18/25 ****
12/33-(1.203)
27/33-(3.255)
9/33-(1.047)
24/33-(0.825)
6/33-(1.626)

=== Evaluating Model ===
accuracy on Valid 0.6272189349112426

Total valid loss 1.1513331260278143
accuracy on Test 0.629080118694362
Best accuracy on Test 0.7477744807121661

**** Epoch 19/25 ****
21/33-(1.054)
3/33-(0.850)
18/33-(0.550)
0/33-(1.010)

=== Evaluating Model ===
accuracy on Valid 0.6745562130177515

Total valid loss 1.3488058248661796
accuracy on Test 0.6468842729970327
Best accuracy on Test 0.7477744807121661

**** Epoch 20/25 ****
15/33-(1.719)
30/33-(0.888)
12/33-(1.133)
27/33-(1.637)

=== Evaluating Model ===
accuracy on Valid 0.7071005917159763

Total valid loss 1.0429296744140713
accuracy on Test 0.7091988130563798
Best accuracy on Test 0.7477744807121661

**** Epoch 21/25 ****
9/33-(0.657)
24/33-(1.112)
6/33-(0.899)
21/33-(0.830)

=== Evaluating Model ===
accuracy on Valid 0.7307692307692307

Total valid loss 0.8844851587306369
accuracy on Test 0.7359050445103857
Best accuracy on Test 0.7477744807121661

**** Epoch 22/25 ****
3/33-(1.010)
18/33-(0.762)
0/33-(0.826)
15/33-(0.815)

=== Evaluating Model ===
accuracy on Valid 0.6863905325443787

Total valid loss 1.047942196780985
accuracy on Test 0.7359050445103857
Best accuracy on Test 0.7477744807121661

**** Epoch 23/25 ****
30/33-(1.005)
12/33-(0.354)
27/33-(1.457)
9/33-(1.196)
24/33-(0.640)

=== Evaluating Model ===
accuracy on Valid 0.6893491124260355

Total valid loss 1.086104876742783
accuracy on Test 0.7210682492581603
Best accuracy on Test 0.7477744807121661

**** Epoch 24/25 ****
6/33-(0.461)
Best accuracy on Test 0.7477744807121661

Source domain: 7, Target domain: 7, Cur_fold 4
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Order Plus Max_Min
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/25 ****
Use CrossEntropyLoss
15/33-(3.295)
30/33-(3.245)
12/33-(2.275)
27/33-(3.104)

=== Evaluating Model ===
accuracy on Valid 0.5548961424332344

Best accuracy on Valid 0.5548961424332344
Total valid loss 0.8614228151061318
accuracy on Test 0.5857988165680473
Best accuracy on Test 0.5857988165680473

**** Epoch 0/25 ****
9/33-(3.496)
24/33-(2.401)
6/33-(3.007)
21/33-(2.164)

=== Evaluating Model ===
accuracy on Valid 0.4362017804154303

Total valid loss 0.9248869879679247
accuracy on Test 0.4970414201183432
Best accuracy on Test 0.5857988165680473

**** Epoch 1/25 ****
3/33-(2.864)
18/33-(2.700)
0/33-(2.317)
15/33-(2.869)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229

Best accuracy on Valid 0.6528189910979229
Total valid loss 0.6578105864199725
accuracy on Test 0.6804733727810651
Best accuracy on Test 0.6804733727810651

**** Epoch 2/25 ****
30/33-(2.347)
12/33-(2.616)
27/33-(2.790)
9/33-(2.480)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Best accuracy on Valid 0.7091988130563798
Total valid loss 0.6015377600084651
accuracy on Test 0.7011834319526628
Best accuracy on Test 0.7011834319526628

**** Epoch 3/25 ****
24/33-(3.760)
6/33-(1.836)
21/33-(2.119)
3/33-(2.176)
18/33-(1.844)

=== Evaluating Model ===
accuracy on Valid 0.7210682492581603

Best accuracy on Valid 0.7210682492581603
Total valid loss 0.5871706103736704
accuracy on Test 0.7337278106508875
Best accuracy on Test 0.7337278106508875

**** Epoch 4/25 ****
0/33-(1.908)
15/33-(1.803)
30/33-(2.047)
12/33-(2.016)

=== Evaluating Model ===
accuracy on Valid 0.658753709198813

Total valid loss 0.7864871025085449
accuracy on Test 0.6301775147928994
Best accuracy on Test 0.7337278106508875

**** Epoch 5/25 ****
27/33-(1.440)
9/33-(1.434)
24/33-(2.345)
6/33-(2.733)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Total valid loss 0.6194609024307944
accuracy on Test 0.7366863905325444
Best accuracy on Test 0.7366863905325444

**** Epoch 6/25 ****
21/33-(1.079)
3/33-(1.107)
18/33-(2.018)
0/33-(2.261)

=== Evaluating Model ===
accuracy on Valid 0.6201780415430267

Total valid loss 0.81128444861282
accuracy on Test 0.6094674556213018
Best accuracy on Test 0.7366863905325444

**** Epoch 7/25 ****
15/33-(1.785)
30/33-(1.513)
12/33-(2.139)
27/33-(1.232)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641

Total valid loss 0.7660625306042758
accuracy on Test 0.7159763313609467
Best accuracy on Test 0.7366863905325444

**** Epoch 8/25 ****
9/33-(1.843)
24/33-(2.102)
6/33-(1.222)
21/33-(2.002)
3/33-(1.644)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Total valid loss 0.7047168720852245
accuracy on Test 0.6834319526627219
Best accuracy on Test 0.7366863905325444

**** Epoch 9/25 ****
18/33-(1.100)
0/33-(4.372)
15/33-(1.311)
30/33-(1.640)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825

Total valid loss 0.6663187511942603
accuracy on Test 0.7366863905325444
Best accuracy on Test 0.7366863905325444

**** Epoch 10/25 ****
12/33-(0.837)
27/33-(1.180)
9/33-(1.973)
24/33-(1.244)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819

Total valid loss 0.6159583154049787
accuracy on Test 0.7514792899408284
Best accuracy on Test 0.7514792899408284

**** Epoch 11/25 ****
6/33-(1.527)
21/33-(0.894)
3/33-(0.972)
18/33-(0.868)

=== Evaluating Model ===
accuracy on Valid 0.6617210682492581

Total valid loss 0.6505298275839199
accuracy on Test 0.7455621301775148
Best accuracy on Test 0.7514792899408284

**** Epoch 12/25 ****
0/33-(1.405)
15/33-(1.519)
30/33-(1.542)
12/33-(1.213)

=== Evaluating Model ===
accuracy on Valid 0.6824925816023739

Total valid loss 0.8397971269759265
accuracy on Test 0.7218934911242604
Best accuracy on Test 0.7514792899408284

**** Epoch 13/25 ****
27/33-(1.994)
9/33-(1.227)
24/33-(1.692)
6/33-(0.783)
21/33-(1.328)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Total valid loss 0.8307851972905073
accuracy on Test 0.7189349112426036
Best accuracy on Test 0.7514792899408284

**** Epoch 14/25 ****
3/33-(1.001)
18/33-(0.741)
0/33-(0.775)
15/33-(1.414)

=== Evaluating Model ===
accuracy on Valid 0.6468842729970327

Total valid loss 1.0236435640941968
accuracy on Test 0.7130177514792899
Best accuracy on Test 0.7514792899408284

**** Epoch 15/25 ****
30/33-(1.346)
12/33-(0.989)
27/33-(1.217)
9/33-(1.641)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641

Total valid loss 0.8419668078422546
accuracy on Test 0.727810650887574
Best accuracy on Test 0.7514792899408284

**** Epoch 16/25 ****
24/33-(2.773)
6/33-(1.214)
21/33-(2.996)
3/33-(0.827)

=== Evaluating Model ===
accuracy on Valid 0.6676557863501483

Total valid loss 0.8422341272234917
accuracy on Test 0.7130177514792899
Best accuracy on Test 0.7514792899408284

**** Epoch 17/25 ****
18/33-(0.408)
0/33-(1.313)
15/33-(0.724)
30/33-(0.947)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347

Total valid loss 1.0483971346508374
accuracy on Test 0.7189349112426036
Best accuracy on Test 0.7514792899408284

**** Epoch 18/25 ****
12/33-(0.720)
27/33-(0.691)
9/33-(1.189)
24/33-(0.689)
6/33-(0.608)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229

Total valid loss 0.9951364912770011
accuracy on Test 0.7071005917159763
Best accuracy on Test 0.7514792899408284

**** Epoch 19/25 ****
21/33-(0.750)
3/33-(0.998)
18/33-(0.830)
0/33-(0.890)

=== Evaluating Model ===
accuracy on Valid 0.6646884272997032

Total valid loss 0.9717473264106296
accuracy on Test 0.7248520710059172
Best accuracy on Test 0.7514792899408284

**** Epoch 20/25 ****
15/33-(1.307)
30/33-(0.769)
12/33-(2.244)
27/33-(0.941)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347

Total valid loss 1.0520224523815243
accuracy on Test 0.7071005917159763
Best accuracy on Test 0.7514792899408284

**** Epoch 21/25 ****
9/33-(0.991)
24/33-(1.037)
6/33-(1.209)
21/33-(0.497)

=== Evaluating Model ===
accuracy on Valid 0.6379821958456974

Total valid loss 1.0274604071270337
accuracy on Test 0.727810650887574
Best accuracy on Test 0.7514792899408284

**** Epoch 22/25 ****
3/33-(0.597)
18/33-(1.223)
0/33-(0.951)
15/33-(0.336)

=== Evaluating Model ===
accuracy on Valid 0.6646884272997032

Total valid loss 1.1575557420199567
accuracy on Test 0.7100591715976331
Best accuracy on Test 0.7514792899408284

**** Epoch 23/25 ****
30/33-(0.398)
12/33-(0.736)
27/33-(0.506)
9/33-(0.559)
24/33-(0.710)

=== Evaluating Model ===
accuracy on Valid 0.5816023738872403

Total valid loss 1.5982219319451938
accuracy on Test 0.6686390532544378
Best accuracy on Test 0.7514792899408284

**** Epoch 24/25 ****
6/33-(0.950)
Best accuracy on Test 0.7514792899408284

Final k-fold valid 0.7307147999227432
[0.7685459940652819, 0.7091988130563798, 0.744807121661721, 0.7455621301775148, 0.685459940652819]
Final k-fold eval 0.7402068372166524
[0.7240356083086054, 0.7685459940652819, 0.7091988130563798, 0.7477744807121661, 0.7514792899408284]
