Whole k-fold eval mode
Source domain: 8, Target domain: 8, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.641)
30/33-(1.533)
12/33-(1.491)
27/33-(1.250)

=== Evaluating Model ===
accuracy on Valid 0.5952380952380952
accuracy on Valid 0.6011904761904762

Best accuracy on Valid 0.5952380952380952
Total valid loss 0.8659264473688035
accuracy on Test 0.5982142857142857
Best accuracy on Test 0.5982142857142857
Total valid loss 0.898011755375635
accuracy on Test 0.5952380952380952
Best accuracy on Test 0.5982142857142857

**** Epoch 0/20 ****
9/33-(0.982)
24/33-(0.803)
6/33-(0.938)
21/33-(0.937)

=== Evaluating Model ===
accuracy on Valid 0.6398809523809523
accuracy on Valid 0.6190476190476191

Best accuracy on Valid 0.6398809523809523
Total valid loss 0.7761710811228979
accuracy on Test 0.6488095238095238
Best accuracy on Test 0.6488095238095238
Total valid loss 0.7775946770395551
accuracy on Test 0.6517857142857143
Best accuracy on Test 0.6517857142857143

**** Epoch 1/20 ****
3/33-(0.808)
18/33-(0.886)
0/33-(0.685)
15/33-(1.084)

=== Evaluating Model ===
accuracy on Valid 0.6815476190476191
accuracy on Valid 0.6815476190476191

Best accuracy on Valid 0.6815476190476191
Total valid loss 0.6390932287488665
accuracy on Test 0.7261904761904762
Best accuracy on Test 0.7261904761904762
Total valid loss 0.6510981789657048
accuracy on Test 0.7380952380952381
Best accuracy on Test 0.7380952380952381

**** Epoch 2/20 ****
30/33-(0.661)
12/33-(0.769)
27/33-(1.027)
9/33-(0.820)

=== Evaluating Model ===
accuracy on Valid 0.6755952380952381
accuracy on Valid 0.6785714285714286

Total valid loss 0.7176920885131473
accuracy on Test 0.6666666666666666
Best accuracy on Test 0.7380952380952381
Total valid loss 0.6487413062935784
accuracy on Test 0.6934523809523809
Best accuracy on Test 0.7380952380952381

**** Epoch 3/20 ****
24/33-(0.868)
6/33-(0.485)
21/33-(0.784)
3/33-(1.065)
18/33-(0.605)

=== Evaluating Model ===
accuracy on Valid 0.5922619047619048
accuracy on Valid 0.5863095238095238

Total valid loss 0.7523576134727115
accuracy on Test 0.6607142857142857
Best accuracy on Test 0.7380952380952381
Total valid loss 0.8152790395986467
accuracy on Test 0.6547619047619048
Best accuracy on Test 0.7380952380952381

**** Epoch 4/20 ****
0/33-(0.986)
15/33-(0.540)
30/33-(0.414)
12/33-(0.601)

=== Evaluating Model ===
accuracy on Valid 0.6875
accuracy on Valid 0.6845238095238095

Best accuracy on Valid 0.6875
Total valid loss 0.6770121121690387
accuracy on Test 0.6994047619047619
Best accuracy on Test 0.7380952380952381
Total valid loss 0.6559605853898185
accuracy on Test 0.7142857142857143
Best accuracy on Test 0.7380952380952381

**** Epoch 5/20 ****
27/33-(0.808)
9/33-(0.301)
24/33-(0.542)
6/33-(0.708)

=== Evaluating Model ===
accuracy on Valid 0.5982142857142857
accuracy on Valid 0.5892857142857143

Total valid loss 0.7103726012366158
accuracy on Test 0.6577380952380952
Best accuracy on Test 0.7380952380952381
Total valid loss 0.7576068086283547
accuracy on Test 0.6458333333333334
Best accuracy on Test 0.7380952380952381

**** Epoch 6/20 ****
21/33-(0.534)
3/33-(0.704)
18/33-(1.217)
0/33-(0.478)

=== Evaluating Model ===
accuracy on Valid 0.6309523809523809
accuracy on Valid 0.625

Total valid loss 0.7972012630530766
accuracy on Test 0.6458333333333334
Best accuracy on Test 0.7380952380952381
Total valid loss 0.8110163268588838
accuracy on Test 0.6488095238095238
Best accuracy on Test 0.7380952380952381

**** Epoch 7/20 ****
15/33-(0.678)
30/33-(0.385)
12/33-(0.545)
27/33-(0.373)

=== Evaluating Model ===
accuracy on Valid 0.7053571428571429
accuracy on Valid 0.6994047619047619

Best accuracy on Valid 0.7053571428571429
Total valid loss 0.5509572163933799
accuracy on Test 0.7529761904761905
Best accuracy on Test 0.7529761904761905
Total valid loss 0.5605014179434095
accuracy on Test 0.7470238095238095
Best accuracy on Test 0.7529761904761905

**** Epoch 8/20 ****
9/33-(0.406)
24/33-(0.599)
6/33-(0.691)
21/33-(0.825)
3/33-(0.828)

=== Evaluating Model ===
accuracy on Valid 0.5476190476190477
accuracy on Valid 0.5416666666666666

Total valid loss 0.8740042178403764
accuracy on Test 0.6041666666666666
Best accuracy on Test 0.7529761904761905
Total valid loss 0.8624582418373653
accuracy on Test 0.6071428571428571
Best accuracy on Test 0.7529761904761905

**** Epoch 9/20 ****
18/33-(1.321)
0/33-(0.673)
15/33-(0.699)
30/33-(0.672)

=== Evaluating Model ===
accuracy on Valid 0.6904761904761905
accuracy on Valid 0.6994047619047619

Total valid loss 0.7218530405135382
accuracy on Test 0.6815476190476191
Best accuracy on Test 0.7529761904761905
Total valid loss 0.7003936157340095
accuracy on Test 0.7053571428571429
Best accuracy on Test 0.7529761904761905

**** Epoch 10/20 ****
12/33-(0.435)
27/33-(0.544)
9/33-(0.307)
24/33-(0.740)

=== Evaluating Model ===
accuracy on Valid 0.6934523809523809
accuracy on Valid 0.6934523809523809

Total valid loss 0.6824873054311389
accuracy on Test 0.7142857142857143
Best accuracy on Test 0.7529761904761905
Total valid loss 0.664821174173128
accuracy on Test 0.7202380952380952
Best accuracy on Test 0.7529761904761905

**** Epoch 11/20 ****
6/33-(0.596)
21/33-(0.364)
3/33-(0.316)
18/33-(1.275)

=== Evaluating Model ===
accuracy on Valid 0.7202380952380952
accuracy on Valid 0.7202380952380952

Best accuracy on Valid 0.7202380952380952
Total valid loss 0.6830721114362989
accuracy on Test 0.7321428571428571
Best accuracy on Test 0.7529761904761905
Total valid loss 0.6856310580457959
accuracy on Test 0.7351190476190477
Best accuracy on Test 0.7529761904761905

**** Epoch 12/20 ****
0/33-(0.375)
15/33-(0.326)
30/33-(0.974)
12/33-(0.246)

=== Evaluating Model ===
accuracy on Valid 0.7053571428571429
accuracy on Valid 0.7083333333333334

Total valid loss 0.7345542645170575
accuracy on Test 0.7202380952380952
Best accuracy on Test 0.7529761904761905
Total valid loss 0.7400148120664415
accuracy on Test 0.7083333333333334
Best accuracy on Test 0.7529761904761905

**** Epoch 13/20 ****
27/33-(0.520)
9/33-(0.196)
24/33-(0.797)
6/33-(0.121)
21/33-(0.632)

=== Evaluating Model ===
accuracy on Valid 0.6160714285714286
accuracy on Valid 0.6041666666666666

Total valid loss 0.8504665068217686
accuracy on Test 0.6815476190476191
Best accuracy on Test 0.7529761904761905
Total valid loss 0.8985266600336347
accuracy on Test 0.6696428571428571
Best accuracy on Test 0.7529761904761905

**** Epoch 14/20 ****
3/33-(0.395)
18/33-(0.264)
0/33-(0.398)
15/33-(0.249)

=== Evaluating Model ===
accuracy on Valid 0.6488095238095238
accuracy on Valid 0.6309523809523809

Total valid loss 0.8697155295383363
accuracy on Test 0.7053571428571429
Best accuracy on Test 0.7529761904761905
Total valid loss 0.9246131231387457
accuracy on Test 0.7023809523809523
Best accuracy on Test 0.7529761904761905

**** Epoch 15/20 ****
30/33-(0.219)
12/33-(0.214)
27/33-(0.116)
9/33-(0.250)

=== Evaluating Model ===
accuracy on Valid 0.6458333333333334
accuracy on Valid 0.6369047619047619

Total valid loss 1.1536857868943895
accuracy on Test 0.6904761904761905
Best accuracy on Test 0.7529761904761905
Total valid loss 1.2185578828766233
accuracy on Test 0.6964285714285714
Best accuracy on Test 0.7529761904761905

**** Epoch 16/20 ****
24/33-(0.213)
6/33-(0.263)
21/33-(0.880)
3/33-(0.248)

=== Evaluating Model ===
accuracy on Valid 0.6964285714285714
accuracy on Valid 0.7023809523809523

Total valid loss 1.0317688850419862
accuracy on Test 0.6875
Best accuracy on Test 0.7529761904761905
Total valid loss 1.0099040809131803
accuracy on Test 0.6875
Best accuracy on Test 0.7529761904761905

**** Epoch 17/20 ****
18/33-(0.307)
0/33-(0.216)
15/33-(0.543)
30/33-(0.612)

=== Evaluating Model ===
accuracy on Valid 0.6964285714285714
accuracy on Valid 0.7113095238095238

Total valid loss 1.042636168854577
accuracy on Test 0.6964285714285714
Best accuracy on Test 0.7529761904761905
Total valid loss 1.0690343181292217
accuracy on Test 0.7023809523809523
Best accuracy on Test 0.7529761904761905

**** Epoch 18/20 ****
12/33-(0.150)
27/33-(0.271)
9/33-(0.053)
24/33-(0.814)
6/33-(0.304)

=== Evaluating Model ===
accuracy on Valid 0.6845238095238095
accuracy on Valid 0.6875

Total valid loss 1.1642947175673075
accuracy on Test 0.7172619047619048
Best accuracy on Test 0.7529761904761905
Total valid loss 1.1915246120521001
accuracy on Test 0.7202380952380952
Best accuracy on Test 0.7529761904761905

**** Epoch 19/20 ****
21/33-(0.053)
Best accuracy on Test 0.7529761904761905

Source domain: 8, Target domain: 8, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.904)
30/33-(1.532)
12/33-(1.254)
27/33-(1.433)

=== Evaluating Model ===
accuracy on Valid 0.6409495548961425
accuracy on Valid 0.6498516320474778

Best accuracy on Valid 0.6409495548961425
Total valid loss 0.8314552505811056
accuracy on Test 0.6309523809523809
Best accuracy on Test 0.6309523809523809
Total valid loss 0.8355160696165902
accuracy on Test 0.6369047619047619
Best accuracy on Test 0.6369047619047619

**** Epoch 0/20 ****
9/33-(0.993)
24/33-(1.019)
6/33-(1.050)
21/33-(1.194)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229
accuracy on Valid 0.6646884272997032

Best accuracy on Valid 0.6528189910979229
Total valid loss 0.7778613482202802
accuracy on Test 0.6607142857142857
Best accuracy on Test 0.6607142857142857
Total valid loss 0.8353595506577265
accuracy on Test 0.6666666666666666
Best accuracy on Test 0.6666666666666666

**** Epoch 1/20 ****
3/33-(0.962)
18/33-(0.788)
0/33-(0.868)
15/33-(0.612)

=== Evaluating Model ===
accuracy on Valid 0.6053412462908012
accuracy on Valid 0.6379821958456974

Total valid loss 0.9197748899459839
accuracy on Test 0.5684523809523809
Best accuracy on Test 0.6666666666666666
Total valid loss 0.9473023840359279
accuracy on Test 0.5833333333333334
Best accuracy on Test 0.6666666666666666

**** Epoch 2/20 ****
30/33-(0.849)
12/33-(0.729)
27/33-(0.711)
9/33-(0.683)

=== Evaluating Model ===
accuracy on Valid 0.7240356083086054
accuracy on Valid 0.7359050445103857

Best accuracy on Valid 0.7240356083086054
Total valid loss 0.6699375396683103
accuracy on Test 0.6696428571428571
Best accuracy on Test 0.6696428571428571
Total valid loss 0.6662745532535371
accuracy on Test 0.7023809523809523
Best accuracy on Test 0.7023809523809523

**** Epoch 3/20 ****
24/33-(0.930)
6/33-(0.866)
21/33-(0.653)
