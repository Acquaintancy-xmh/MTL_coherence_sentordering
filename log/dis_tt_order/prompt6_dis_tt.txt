Whole k-fold eval mode
Source domain: 6, Target domain: 6, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.267)
30/33-(1.228)

=== Evaluating Model ===
accuracy on Valid 0.5833333333333334

Best accuracy on Valid 0.5833333333333334
Total valid loss 1.0290209750334423
accuracy on Test 0.5
Best accuracy on Test 0.5

**** Epoch 0/20 ****
12/33-(0.893)
27/33-(1.189)

=== Evaluating Model ===
accuracy on Valid 0.4947916666666667


**** Epoch 1/20 ****
9/33-(0.800)
24/33-(1.742)
6/33-(1.057)

=== Evaluating Model ===
accuracy on Valid 0.5833333333333334

Best accuracy on Valid 0.5833333333333334
Total valid loss 0.9474631895621618
accuracy on Test 0.5
Best accuracy on Test 0.5

**** Epoch 2/20 ****
21/33-(0.809)
3/33-(0.888)

=== Evaluating Model ===
accuracy on Valid 0.59375

Best accuracy on Valid 0.59375
Total valid loss 1.0191618303457897
accuracy on Test 0.5052083333333334
Best accuracy on Test 0.5052083333333334

**** Epoch 3/20 ****
18/33-(1.158)
0/33-(1.387)
15/33-(0.842)

=== Evaluating Model ===
accuracy on Valid 0.5833333333333334


**** Epoch 4/20 ****
30/33-(0.722)
12/33-(1.038)

=== Evaluating Model ===
accuracy on Valid 0.5833333333333334


**** Epoch 5/20 ****
27/33-(0.717)
9/33-(0.697)

=== Evaluating Model ===
accuracy on Valid 0.6666666666666666

Best accuracy on Valid 0.6666666666666666
Total valid loss 0.7353734920422236
accuracy on Test 0.6145833333333334
Best accuracy on Test 0.6145833333333334

**** Epoch 6/20 ****
24/33-(0.405)
6/33-(1.532)
21/33-(0.546)

=== Evaluating Model ===
accuracy on Valid 0.6770833333333334

Best accuracy on Valid 0.6770833333333334
Total valid loss 0.7936508158842722
accuracy on Test 0.6041666666666666
Best accuracy on Test 0.6145833333333334

**** Epoch 7/20 ****
3/33-(0.741)
18/33-(0.632)

=== Evaluating Model ===
accuracy on Valid 0.6770833333333334

Best accuracy on Valid 0.6770833333333334
Total valid loss 0.8870798746744791
accuracy on Test 0.6302083333333334
Best accuracy on Test 0.6302083333333334

**** Epoch 8/20 ****
0/33-(0.732)
15/33-(0.447)
30/33-(0.859)

=== Evaluating Model ===
accuracy on Valid 0.703125

Best accuracy on Valid 0.703125
Total valid loss 0.8294153859217962
accuracy on Test 0.6614583333333334
Best accuracy on Test 0.6614583333333334

**** Epoch 9/20 ****
12/33-(0.255)
27/33-(0.557)

=== Evaluating Model ===
accuracy on Valid 0.71875

Best accuracy on Valid 0.71875
Total valid loss 0.7499322940905889
accuracy on Test 0.640625
Best accuracy on Test 0.6614583333333334

**** Epoch 10/20 ****
9/33-(0.716)
24/33-(0.515)

=== Evaluating Model ===
accuracy on Valid 0.671875


**** Epoch 11/20 ****
6/33-(0.567)
21/33-(0.088)
3/33-(0.556)

=== Evaluating Model ===
accuracy on Valid 0.5833333333333334


**** Epoch 12/20 ****
18/33-(0.304)
0/33-(0.682)

=== Evaluating Model ===
accuracy on Valid 0.6875


**** Epoch 13/20 ****
15/33-(0.581)
30/33-(0.340)
12/33-(0.443)

=== Evaluating Model ===
accuracy on Valid 0.703125


**** Epoch 14/20 ****
27/33-(0.266)
9/33-(0.545)

=== Evaluating Model ===
accuracy on Valid 0.6927083333333334


**** Epoch 15/20 ****
24/33-(0.788)
6/33-(0.305)

=== Evaluating Model ===
accuracy on Valid 0.65625


**** Epoch 16/20 ****
21/33-(0.051)
3/33-(0.083)
18/33-(0.139)

=== Evaluating Model ===
accuracy on Valid 0.6822916666666666


**** Epoch 17/20 ****
0/33-(0.256)
15/33-(0.089)

=== Evaluating Model ===
accuracy on Valid 0.6666666666666666


**** Epoch 18/20 ****
30/33-(0.148)
12/33-(0.417)
27/33-(0.350)

=== Evaluating Model ===
accuracy on Valid 0.65625


**** Epoch 19/20 ****
Best accuracy on Test 0.6614583333333334

Source domain: 6, Target domain: 6, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.431)
30/33-(0.954)

=== Evaluating Model ===
accuracy on Valid 0.515625

Best accuracy on Valid 0.515625
Total valid loss 1.367179274559021
accuracy on Test 0.5833333333333334
Best accuracy on Test 0.5833333333333334

**** Epoch 0/20 ****
12/33-(1.331)
27/33-(0.920)

=== Evaluating Model ===
accuracy on Valid 0.515625

Best accuracy on Valid 0.515625
Total valid loss 0.9353737433751425
accuracy on Test 0.5833333333333334
Best accuracy on Test 0.5833333333333334

**** Epoch 1/20 ****
9/33-(0.878)
24/33-(1.004)
6/33-(0.850)

=== Evaluating Model ===
accuracy on Valid 0.515625

Best accuracy on Valid 0.515625
Total valid loss 0.8627719680468241
accuracy on Test 0.5729166666666666
Best accuracy on Test 0.5833333333333334

**** Epoch 2/20 ****
21/33-(0.874)
3/33-(1.212)

=== Evaluating Model ===
accuracy on Valid 0.578125

Best accuracy on Valid 0.578125
Total valid loss 0.7737347781658173
accuracy on Test 0.6145833333333334
Best accuracy on Test 0.6145833333333334

**** Epoch 3/20 ****
18/33-(1.270)
0/33-(0.537)
15/33-(0.779)

=== Evaluating Model ===
accuracy on Valid 0.6822916666666666

Best accuracy on Valid 0.6822916666666666
Total valid loss 0.7226396799087524
accuracy on Test 0.6875
Best accuracy on Test 0.6875

**** Epoch 4/20 ****
30/33-(0.688)
12/33-(0.888)

=== Evaluating Model ===
accuracy on Valid 0.578125


**** Epoch 5/20 ****
27/33-(0.668)
9/33-(0.585)

=== Evaluating Model ===
accuracy on Valid 0.546875


**** Epoch 6/20 ****
24/33-(0.648)
6/33-(0.640)
21/33-(0.633)

=== Evaluating Model ===
accuracy on Valid 0.6770833333333334


**** Epoch 7/20 ****
3/33-(0.618)
18/33-(0.949)

=== Evaluating Model ===
accuracy on Valid 0.7135416666666666

Best accuracy on Valid 0.7135416666666666
Total valid loss 0.6983133926987648
accuracy on Test 0.6979166666666666
Best accuracy on Test 0.6979166666666666

**** Epoch 8/20 ****
0/33-(0.521)
15/33-(0.627)
30/33-(0.362)

=== Evaluating Model ===
accuracy on Valid 0.6770833333333334


**** Epoch 9/20 ****
12/33-(1.723)
27/33-(0.549)

=== Evaluating Model ===
accuracy on Valid 0.65625


**** Epoch 10/20 ****
9/33-(0.290)
24/33-(0.746)

=== Evaluating Model ===
accuracy on Valid 0.6666666666666666


**** Epoch 11/20 ****
6/33-(0.463)
21/33-(0.766)
3/33-(0.545)

=== Evaluating Model ===
accuracy on Valid 0.671875


**** Epoch 12/20 ****
18/33-(1.004)
0/33-(0.886)

=== Evaluating Model ===
accuracy on Valid 0.640625


**** Epoch 13/20 ****
15/33-(0.630)
30/33-(1.333)
12/33-(0.401)

=== Evaluating Model ===
accuracy on Valid 0.703125


**** Epoch 14/20 ****
27/33-(0.515)
9/33-(0.453)

=== Evaluating Model ===
accuracy on Valid 0.6041666666666666


**** Epoch 15/20 ****
24/33-(0.449)
6/33-(0.219)

=== Evaluating Model ===
accuracy on Valid 0.6145833333333334


**** Epoch 16/20 ****
21/33-(0.673)
3/33-(0.629)
18/33-(0.265)

=== Evaluating Model ===
accuracy on Valid 0.640625


**** Epoch 17/20 ****
0/33-(0.148)
15/33-(0.424)

=== Evaluating Model ===
accuracy on Valid 0.625


**** Epoch 18/20 ****
30/33-(0.202)
12/33-(0.493)
27/33-(0.477)

=== Evaluating Model ===
accuracy on Valid 0.640625


**** Epoch 19/20 ****
Best accuracy on Test 0.6979166666666666

Source domain: 6, Target domain: 6, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.368)
30/33-(0.924)

=== Evaluating Model ===
accuracy on Valid 0.5729166666666666

Best accuracy on Valid 0.5729166666666666
Total valid loss 0.9959881256024042
accuracy on Test 0.515625
Best accuracy on Test 0.515625

**** Epoch 0/20 ****
12/33-(1.021)
27/33-(0.888)

=== Evaluating Model ===
accuracy on Valid 0.5729166666666666

Best accuracy on Valid 0.5729166666666666
Total valid loss 0.961379329363505
accuracy on Test 0.515625
Best accuracy on Test 0.515625

**** Epoch 1/20 ****
9/33-(1.182)
24/33-(1.458)
6/33-(0.715)

=== Evaluating Model ===
accuracy on Valid 0.5729166666666666

Best accuracy on Valid 0.5729166666666666
Total valid loss 1.0256311347087224
accuracy on Test 0.515625
Best accuracy on Test 0.515625

**** Epoch 2/20 ****
21/33-(0.773)
3/33-(1.546)

=== Evaluating Model ===
accuracy on Valid 0.5885416666666666

Best accuracy on Valid 0.5885416666666666
Total valid loss 1.0647389441728592
accuracy on Test 0.5416666666666666
Best accuracy on Test 0.5416666666666666

**** Epoch 3/20 ****
18/33-(0.859)
0/33-(0.718)
15/33-(1.106)

=== Evaluating Model ===
accuracy on Valid 0.5677083333333334


**** Epoch 4/20 ****
30/33-(0.857)
12/33-(1.508)

=== Evaluating Model ===
accuracy on Valid 0.625

Best accuracy on Valid 0.625
Total valid loss 0.8081797212362289
accuracy on Test 0.609375
Best accuracy on Test 0.609375

**** Epoch 5/20 ****
27/33-(0.534)
9/33-(0.279)

=== Evaluating Model ===
accuracy on Valid 0.5989583333333334


**** Epoch 6/20 ****
24/33-(1.048)
6/33-(0.723)
21/33-(0.348)

=== Evaluating Model ===
accuracy on Valid 0.7135416666666666

Best accuracy on Valid 0.7135416666666666
Total valid loss 0.7934103359778722
accuracy on Test 0.6614583333333334
Best accuracy on Test 0.6614583333333334

**** Epoch 7/20 ****
3/33-(0.542)
18/33-(1.004)

=== Evaluating Model ===
accuracy on Valid 0.7604166666666666

Best accuracy on Valid 0.7604166666666666
Total valid loss 0.6836532577872276
accuracy on Test 0.7135416666666666
Best accuracy on Test 0.7135416666666666

**** Epoch 8/20 ****
0/33-(0.504)
15/33-(0.483)
30/33-(0.500)

=== Evaluating Model ===
accuracy on Valid 0.6145833333333334


**** Epoch 9/20 ****
12/33-(0.585)
27/33-(0.492)

=== Evaluating Model ===
accuracy on Valid 0.6927083333333334


**** Epoch 10/20 ****
9/33-(0.520)
24/33-(0.122)

=== Evaluating Model ===
accuracy on Valid 0.6145833333333334


**** Epoch 11/20 ****
6/33-(0.422)
21/33-(0.109)
3/33-(0.389)

=== Evaluating Model ===
accuracy on Valid 0.6875


**** Epoch 12/20 ****
18/33-(0.546)
0/33-(0.516)

=== Evaluating Model ===
accuracy on Valid 0.6875


**** Epoch 13/20 ****
15/33-(0.389)
30/33-(0.443)
12/33-(0.509)

=== Evaluating Model ===
accuracy on Valid 0.6458333333333334


**** Epoch 14/20 ****
27/33-(0.761)
9/33-(0.329)

=== Evaluating Model ===
accuracy on Valid 0.65625


**** Epoch 15/20 ****
24/33-(0.538)
6/33-(0.184)

=== Evaluating Model ===
accuracy on Valid 0.6822916666666666


**** Epoch 16/20 ****
21/33-(0.144)
3/33-(0.424)
18/33-(0.905)

=== Evaluating Model ===
accuracy on Valid 0.6875


**** Epoch 17/20 ****
0/33-(0.313)
15/33-(0.488)

=== Evaluating Model ===
accuracy on Valid 0.65625


**** Epoch 18/20 ****
30/33-(0.392)
12/33-(0.469)
27/33-(0.663)

=== Evaluating Model ===
accuracy on Valid 0.6770833333333334


**** Epoch 19/20 ****
Best accuracy on Test 0.7135416666666666

Source domain: 6, Target domain: 6, Cur_fold 3
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.197)
30/33-(1.022)

=== Evaluating Model ===
accuracy on Valid 0.3697916666666667

Best accuracy on Valid 0.3697916666666667
Total valid loss 0.9325603544712067
accuracy on Test 0.34375
Best accuracy on Test 0.34375

**** Epoch 0/20 ****
12/33-(1.068)
27/33-(1.036)

=== Evaluating Model ===
accuracy on Valid 0.5572916666666666

Best accuracy on Valid 0.5572916666666666
Total valid loss 0.8900107989708582
accuracy on Test 0.5729166666666666
Best accuracy on Test 0.5729166666666666

**** Epoch 1/20 ****
9/33-(0.843)
24/33-(0.899)
6/33-(0.772)

=== Evaluating Model ===
accuracy on Valid 0.5729166666666666

Best accuracy on Valid 0.5729166666666666
Total valid loss 0.8563394347826639
accuracy on Test 0.5833333333333334
Best accuracy on Test 0.5833333333333334

**** Epoch 2/20 ****
21/33-(0.787)
3/33-(1.017)

=== Evaluating Model ===
accuracy on Valid 0.6354166666666666

Best accuracy on Valid 0.6354166666666666
Total valid loss 0.7521292418241501
accuracy on Test 0.6041666666666666
Best accuracy on Test 0.6041666666666666

**** Epoch 3/20 ****
18/33-(0.894)
0/33-(0.598)
15/33-(0.743)

=== Evaluating Model ===
accuracy on Valid 0.671875

Best accuracy on Valid 0.671875
Total valid loss 0.6046907678246498
accuracy on Test 0.75
Best accuracy on Test 0.75

**** Epoch 4/20 ****
30/33-(0.764)
12/33-(0.554)

=== Evaluating Model ===
accuracy on Valid 0.5625


**** Epoch 5/20 ****
27/33-(1.018)
9/33-(0.938)

=== Evaluating Model ===
accuracy on Valid 0.6510416666666666


**** Epoch 6/20 ****
24/33-(0.657)
6/33-(2.788)
21/33-(0.814)

=== Evaluating Model ===
accuracy on Valid 0.6666666666666666


**** Epoch 7/20 ****
3/33-(0.763)
18/33-(0.409)

=== Evaluating Model ===
accuracy on Valid 0.6458333333333334


**** Epoch 8/20 ****
0/33-(0.665)
15/33-(1.000)
30/33-(0.259)

=== Evaluating Model ===
accuracy on Valid 0.6822916666666666

Best accuracy on Valid 0.6822916666666666
Total valid loss 0.7655608455340067
accuracy on Test 0.6822916666666666
Best accuracy on Test 0.75

**** Epoch 9/20 ****
12/33-(0.504)
27/33-(0.763)

=== Evaluating Model ===
accuracy on Valid 0.671875


**** Epoch 10/20 ****
9/33-(0.303)
24/33-(0.195)

=== Evaluating Model ===
accuracy on Valid 0.7083333333333334

Best accuracy on Valid 0.7083333333333334
Total valid loss 1.0758343587319057
accuracy on Test 0.7083333333333334
Best accuracy on Test 0.75

**** Epoch 11/20 ****
6/33-(0.960)
21/33-(0.376)
3/33-(0.520)

=== Evaluating Model ===
accuracy on Valid 0.7239583333333334

Best accuracy on Valid 0.7239583333333334
Total valid loss 0.6770045608282089
accuracy on Test 0.734375
Best accuracy on Test 0.75

**** Epoch 12/20 ****
18/33-(0.364)
0/33-(0.671)

=== Evaluating Model ===
accuracy on Valid 0.6614583333333334


**** Epoch 13/20 ****
15/33-(0.359)
30/33-(0.755)
12/33-(0.345)

=== Evaluating Model ===
accuracy on Valid 0.6875


**** Epoch 14/20 ****
27/33-(0.781)
9/33-(0.322)

=== Evaluating Model ===
accuracy on Valid 0.6354166666666666


**** Epoch 15/20 ****
24/33-(0.540)
6/33-(0.045)

=== Evaluating Model ===
accuracy on Valid 0.6979166666666666


**** Epoch 16/20 ****
21/33-(0.281)
3/33-(0.080)
18/33-(0.150)

=== Evaluating Model ===
accuracy on Valid 0.6197916666666666


**** Epoch 17/20 ****
0/33-(0.077)
15/33-(0.122)

=== Evaluating Model ===
accuracy on Valid 0.6666666666666666


**** Epoch 18/20 ****
30/33-(0.277)
12/33-(0.019)
27/33-(0.484)

=== Evaluating Model ===
accuracy on Valid 0.6197916666666666


**** Epoch 19/20 ****
Best accuracy on Test 0.75

Source domain: 6, Target domain: 6, Cur_fold 4
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.310)
30/33-(1.374)

=== Evaluating Model ===
accuracy on Valid 0.5

Best accuracy on Valid 0.5
Total valid loss 0.9972749600807825
accuracy on Test 0.5572916666666666
Best accuracy on Test 0.5572916666666666

**** Epoch 0/20 ****
12/33-(1.150)
27/33-(1.391)

=== Evaluating Model ===
accuracy on Valid 0.5

Best accuracy on Valid 0.5
Total valid loss 0.8968983242909113
accuracy on Test 0.5572916666666666
Best accuracy on Test 0.5572916666666666

**** Epoch 1/20 ****
9/33-(0.867)
24/33-(1.075)
6/33-(0.746)

=== Evaluating Model ===
accuracy on Valid 0.5

Best accuracy on Valid 0.5
Total valid loss 0.8996079762776693
accuracy on Test 0.5572916666666666
Best accuracy on Test 0.5572916666666666

**** Epoch 2/20 ****
21/33-(1.114)
3/33-(0.869)

=== Evaluating Model ===
accuracy on Valid 0.6510416666666666

Best accuracy on Valid 0.6510416666666666
Total valid loss 0.7644884089628855
accuracy on Test 0.6458333333333334
Best accuracy on Test 0.6458333333333334

**** Epoch 3/20 ****
18/33-(0.860)
0/33-(0.444)
15/33-(1.089)

=== Evaluating Model ===
accuracy on Valid 0.6875

Best accuracy on Valid 0.6875
Total valid loss 0.7864653319120407
accuracy on Test 0.6927083333333334
Best accuracy on Test 0.6927083333333334

**** Epoch 4/20 ****
30/33-(0.787)
12/33-(0.775)

=== Evaluating Model ===
accuracy on Valid 0.7083333333333334

Best accuracy on Valid 0.7083333333333334
Total valid loss 0.6741672108570734
accuracy on Test 0.6927083333333334
Best accuracy on Test 0.6927083333333334

**** Epoch 5/20 ****
27/33-(0.611)
9/33-(0.422)

=== Evaluating Model ===
accuracy on Valid 0.6927083333333334


**** Epoch 6/20 ****
24/33-(0.357)
6/33-(0.224)
21/33-(0.483)

=== Evaluating Model ===
accuracy on Valid 0.6875


**** Epoch 7/20 ****
3/33-(0.518)
18/33-(0.146)

=== Evaluating Model ===
accuracy on Valid 0.6458333333333334


**** Epoch 8/20 ****
0/33-(0.563)
15/33-(0.661)
30/33-(0.569)

=== Evaluating Model ===
accuracy on Valid 0.7083333333333334

Best accuracy on Valid 0.7083333333333334
Total valid loss 0.9060655236244202
accuracy on Test 0.7239583333333334
Best accuracy on Test 0.7239583333333334

**** Epoch 9/20 ****
12/33-(0.086)
27/33-(2.155)

=== Evaluating Model ===
accuracy on Valid 0.5885416666666666


**** Epoch 10/20 ****
9/33-(1.237)
24/33-(0.200)

=== Evaluating Model ===
accuracy on Valid 0.71875

Best accuracy on Valid 0.71875
Total valid loss 1.3029754136999447
accuracy on Test 0.6614583333333334
Best accuracy on Test 0.7239583333333334

**** Epoch 11/20 ****
6/33-(0.546)
21/33-(0.031)
3/33-(0.204)

=== Evaluating Model ===
accuracy on Valid 0.6510416666666666


**** Epoch 12/20 ****
18/33-(0.341)
0/33-(0.373)

=== Evaluating Model ===
accuracy on Valid 0.65625


**** Epoch 13/20 ****
15/33-(0.031)
30/33-(0.054)
12/33-(0.162)

=== Evaluating Model ===
accuracy on Valid 0.578125


**** Epoch 14/20 ****
27/33-(0.693)
9/33-(0.271)

=== Evaluating Model ===
accuracy on Valid 0.7083333333333334


**** Epoch 15/20 ****
24/33-(0.260)
6/33-(0.096)

=== Evaluating Model ===
accuracy on Valid 0.6927083333333334


**** Epoch 16/20 ****
21/33-(0.057)
3/33-(0.186)
18/33-(0.054)

=== Evaluating Model ===
accuracy on Valid 0.65625


**** Epoch 17/20 ****
0/33-(0.017)
15/33-(0.074)

=== Evaluating Model ===
accuracy on Valid 0.7083333333333334


**** Epoch 18/20 ****
30/33-(0.024)
12/33-(0.057)
27/33-(0.034)

=== Evaluating Model ===
accuracy on Valid 0.6614583333333334


**** Epoch 19/20 ****
Best accuracy on Test 0.7239583333333334

Final k-fold valid 0.7114583333333333
[0.703125, 0.7135416666666666, 0.7604166666666666, 0.671875, 0.7083333333333334]
Final k-fold eval 0.709375
[0.6614583333333334, 0.6979166666666666, 0.7135416666666666, 0.75, 0.7239583333333334]
