Whole k-fold eval mode
Source domain: 4, Target domain: 4, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.218)
30/33-(1.267)
12/33-(1.172)

=== Evaluating Model ===
accuracy on Valid 0.5596026490066225

Best accuracy on Valid 0.5596026490066225
Total valid loss 0.9766921181427805
accuracy on Test 0.53156146179402
Best accuracy on Test 0.53156146179402

**** Epoch 0/20 ****
27/33-(0.923)
9/33-(0.803)
24/33-(1.154)
6/33-(0.969)

=== Evaluating Model ===
accuracy on Valid 0.5596026490066225

Best accuracy on Valid 0.5596026490066225
Total valid loss 0.8681779001888476
accuracy on Test 0.5382059800664452
Best accuracy on Test 0.5382059800664452

**** Epoch 1/20 ****
21/33-(1.088)
3/33-(0.706)
18/33-(0.781)
0/33-(0.639)

=== Evaluating Model ===
accuracy on Valid 0.6490066225165563

Best accuracy on Valid 0.6490066225165563
Total valid loss 0.730533104193838
accuracy on Test 0.6843853820598007
Best accuracy on Test 0.6843853820598007

**** Epoch 2/20 ****
15/33-(0.929)
30/33-(1.397)
12/33-(0.685)

=== Evaluating Model ===
accuracy on Valid 0.5165562913907285


**** Epoch 3/20 ****
27/33-(1.101)
9/33-(0.804)
24/33-(0.624)
6/33-(0.397)

=== Evaluating Model ===
accuracy on Valid 0.6721854304635762

Best accuracy on Valid 0.6721854304635762
Total valid loss 0.8492241219470376
accuracy on Test 0.6744186046511628
Best accuracy on Test 0.6843853820598007

**** Epoch 4/20 ****
21/33-(0.817)
3/33-(0.917)
18/33-(0.350)
0/33-(0.338)

=== Evaluating Model ===
accuracy on Valid 0.6556291390728477


**** Epoch 5/20 ****
15/33-(0.524)
30/33-(0.545)
12/33-(0.256)
27/33-(0.542)

=== Evaluating Model ===
accuracy on Valid 0.6291390728476821


**** Epoch 6/20 ****
9/33-(0.241)
24/33-(0.342)
6/33-(0.199)

=== Evaluating Model ===
accuracy on Valid 0.652317880794702


**** Epoch 7/20 ****
21/33-(0.289)
3/33-(0.329)
18/33-(0.648)
0/33-(1.000)

=== Evaluating Model ===
accuracy on Valid 0.6456953642384106


**** Epoch 8/20 ****
15/33-(0.382)
30/33-(0.177)
12/33-(0.208)
27/33-(0.297)

=== Evaluating Model ===
accuracy on Valid 0.6821192052980133

Best accuracy on Valid 0.6821192052980133
Total valid loss 0.6842226025305296
accuracy on Test 0.7009966777408638
Best accuracy on Test 0.7009966777408638

**** Epoch 9/20 ****
9/33-(1.595)
24/33-(0.527)
6/33-(0.382)
21/33-(0.392)

=== Evaluating Model ===
accuracy on Valid 0.609271523178808


**** Epoch 10/20 ****
3/33-(0.208)
18/33-(0.700)
0/33-(0.336)

=== Evaluating Model ===
accuracy on Valid 0.6622516556291391


**** Epoch 11/20 ****
15/33-(0.176)
30/33-(0.419)
12/33-(0.855)
27/33-(1.159)

=== Evaluating Model ===
accuracy on Valid 0.5629139072847682


**** Epoch 12/20 ****
9/33-(1.033)
24/33-(0.631)
6/33-(0.022)
21/33-(0.108)

=== Evaluating Model ===
accuracy on Valid 0.6423841059602649


**** Epoch 13/20 ****
3/33-(1.449)
18/33-(0.172)
0/33-(0.341)
15/33-(0.536)

=== Evaluating Model ===
accuracy on Valid 0.6291390728476821


**** Epoch 14/20 ****
30/33-(0.250)
12/33-(0.313)
27/33-(0.122)

=== Evaluating Model ===
accuracy on Valid 0.6125827814569537


**** Epoch 15/20 ****
9/33-(0.330)
24/33-(0.065)
6/33-(0.400)
21/33-(0.964)

=== Evaluating Model ===
accuracy on Valid 0.5827814569536424


**** Epoch 16/20 ****
3/33-(0.588)
18/33-(0.207)
0/33-(0.131)
15/33-(0.075)

=== Evaluating Model ===
accuracy on Valid 0.6490066225165563


**** Epoch 17/20 ****
30/33-(0.375)
12/33-(0.023)
27/33-(0.253)

=== Evaluating Model ===
accuracy on Valid 0.6258278145695364


**** Epoch 18/20 ****
9/33-(0.272)
24/33-(0.604)
6/33-(0.236)
21/33-(0.021)

=== Evaluating Model ===
accuracy on Valid 0.6324503311258278


**** Epoch 19/20 ****
3/33-(0.209)
18/33-(0.290)
Best accuracy on Test 0.7009966777408638

Source domain: 4, Target domain: 4, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(0.856)
30/33-(1.142)
12/33-(0.819)

=== Evaluating Model ===
accuracy on Valid 0.3675496688741722

Best accuracy on Valid 0.3675496688741722
Total valid loss 1.0383017972895974
accuracy on Test 0.3741721854304636
Best accuracy on Test 0.3741721854304636

**** Epoch 0/20 ****
27/33-(1.048)
9/33-(0.870)
24/33-(0.716)
6/33-(0.662)

=== Evaluating Model ===
accuracy on Valid 0.5629139072847682

Best accuracy on Valid 0.5629139072847682
Total valid loss 0.8468223747454191
accuracy on Test 0.5364238410596026
Best accuracy on Test 0.5364238410596026

**** Epoch 1/20 ****
21/33-(0.888)
3/33-(1.095)
18/33-(0.828)
0/33-(0.816)

=== Evaluating Model ===
accuracy on Valid 0.6258278145695364

Best accuracy on Valid 0.6258278145695364
Total valid loss 0.8216460535400792
accuracy on Test 0.6059602649006622
Best accuracy on Test 0.6059602649006622

**** Epoch 2/20 ****
15/33-(1.405)
30/33-(0.776)
12/33-(1.691)

=== Evaluating Model ===
accuracy on Valid 0.6821192052980133

Best accuracy on Valid 0.6821192052980133
Total valid loss 0.8158013569681268
accuracy on Test 0.6192052980132451
Best accuracy on Test 0.6192052980132451

**** Epoch 3/20 ****
27/33-(0.610)
9/33-(0.707)
24/33-(0.842)
6/33-(0.462)

=== Evaluating Model ===
accuracy on Valid 0.6688741721854304


**** Epoch 4/20 ****
21/33-(0.928)
3/33-(0.844)
18/33-(0.876)
0/33-(0.645)

=== Evaluating Model ===
accuracy on Valid 0.7152317880794702

Best accuracy on Valid 0.7152317880794702
Total valid loss 0.6738734982515636
accuracy on Test 0.6887417218543046
Best accuracy on Test 0.6887417218543046

**** Epoch 5/20 ****
15/33-(0.667)
30/33-(0.295)
12/33-(1.200)
27/33-(0.421)

=== Evaluating Model ===
accuracy on Valid 0.7152317880794702

Best accuracy on Valid 0.7152317880794702
Total valid loss 0.8726643198414853
accuracy on Test 0.6754966887417219
Best accuracy on Test 0.6887417218543046

**** Epoch 6/20 ****
9/33-(0.824)
24/33-(1.098)
6/33-(1.143)

=== Evaluating Model ===
accuracy on Valid 0.7218543046357616

Best accuracy on Valid 0.7218543046357616
Total valid loss 0.8104129590486225
accuracy on Test 0.6456953642384106
Best accuracy on Test 0.6887417218543046

**** Epoch 7/20 ****
21/33-(0.411)
3/33-(0.869)
18/33-(0.485)
0/33-(0.450)

=== Evaluating Model ===
accuracy on Valid 0.6721854304635762


**** Epoch 8/20 ****
15/33-(0.735)
30/33-(0.419)
12/33-(0.689)
27/33-(0.688)

=== Evaluating Model ===
accuracy on Valid 0.7185430463576159


**** Epoch 9/20 ****
9/33-(0.728)
24/33-(0.441)
6/33-(0.390)
21/33-(0.837)

=== Evaluating Model ===
accuracy on Valid 0.7417218543046358

Best accuracy on Valid 0.7417218543046358
Total valid loss 1.1476587747272693
accuracy on Test 0.6721854304635762
Best accuracy on Test 0.6887417218543046

**** Epoch 10/20 ****
3/33-(0.380)
18/33-(0.423)
0/33-(0.051)

=== Evaluating Model ===
accuracy on Valid 0.6490066225165563


**** Epoch 11/20 ****
15/33-(0.430)
30/33-(0.291)
12/33-(1.041)
27/33-(0.664)

=== Evaluating Model ===
accuracy on Valid 0.5662251655629139


**** Epoch 12/20 ****
9/33-(0.509)
24/33-(0.353)
6/33-(0.324)
21/33-(0.249)

=== Evaluating Model ===
accuracy on Valid 0.6754966887417219


**** Epoch 13/20 ****
3/33-(0.365)
18/33-(0.259)
0/33-(0.893)
15/33-(0.364)

=== Evaluating Model ===
accuracy on Valid 0.6556291390728477


**** Epoch 14/20 ****
30/33-(1.104)
12/33-(0.486)
27/33-(0.105)

=== Evaluating Model ===
accuracy on Valid 0.7019867549668874


**** Epoch 15/20 ****
9/33-(0.280)
24/33-(0.234)
6/33-(0.232)
21/33-(0.153)

=== Evaluating Model ===
accuracy on Valid 0.6887417218543046


**** Epoch 16/20 ****
3/33-(0.505)
18/33-(0.354)
0/33-(0.381)
15/33-(0.387)

=== Evaluating Model ===
accuracy on Valid 0.6490066225165563


**** Epoch 17/20 ****
30/33-(0.104)
12/33-(0.465)
27/33-(0.634)

=== Evaluating Model ===
accuracy on Valid 0.7086092715231788


**** Epoch 18/20 ****
9/33-(0.355)
24/33-(1.028)
6/33-(0.444)
21/33-(0.459)

=== Evaluating Model ===
accuracy on Valid 0.6158940397350994


**** Epoch 19/20 ****
3/33-(0.741)
18/33-(0.409)
Best accuracy on Test 0.6887417218543046

Source domain: 4, Target domain: 4, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.020)
30/33-(1.040)
12/33-(1.192)

=== Evaluating Model ===
accuracy on Valid 0.5033112582781457

Best accuracy on Valid 0.5033112582781457
Total valid loss 1.0278165999211764
accuracy on Test 0.5397350993377483
Best accuracy on Test 0.5397350993377483

**** Epoch 0/20 ****
27/33-(1.019)
9/33-(0.759)
24/33-(0.758)
6/33-(1.111)

=== Evaluating Model ===
accuracy on Valid 0.5066225165562914

Best accuracy on Valid 0.5066225165562914
Total valid loss 1.1065935429773832
accuracy on Test 0.5397350993377483
Best accuracy on Test 0.5397350993377483

**** Epoch 1/20 ****
21/33-(0.824)
3/33-(0.725)
18/33-(0.887)
0/33-(0.787)

=== Evaluating Model ===
accuracy on Valid 0.6920529801324503

Best accuracy on Valid 0.6920529801324503
Total valid loss 0.7957017343295248
accuracy on Test 0.6589403973509934
Best accuracy on Test 0.6589403973509934

**** Epoch 2/20 ****
15/33-(0.730)
30/33-(0.828)
12/33-(1.225)

=== Evaluating Model ===
accuracy on Valid 0.6721854304635762


**** Epoch 3/20 ****
27/33-(0.791)
9/33-(0.786)
24/33-(0.928)
6/33-(0.499)

=== Evaluating Model ===
accuracy on Valid 0.6059602649006622


**** Epoch 4/20 ****
21/33-(0.246)
3/33-(0.664)
18/33-(0.625)
0/33-(0.554)

=== Evaluating Model ===
accuracy on Valid 0.7086092715231788

Best accuracy on Valid 0.7086092715231788
Total valid loss 0.6435676138651999
accuracy on Test 0.7251655629139073
Best accuracy on Test 0.7251655629139073

**** Epoch 5/20 ****
15/33-(0.249)
30/33-(0.598)
12/33-(0.724)
27/33-(0.594)

=== Evaluating Model ===
accuracy on Valid 0.6026490066225165


**** Epoch 6/20 ****
9/33-(0.709)
24/33-(0.502)
6/33-(0.639)

=== Evaluating Model ===
accuracy on Valid 0.7251655629139073

Best accuracy on Valid 0.7251655629139073
Total valid loss 0.6575609853393153
accuracy on Test 0.6920529801324503
Best accuracy on Test 0.7251655629139073

**** Epoch 7/20 ****
21/33-(0.400)
3/33-(0.911)
18/33-(0.616)
0/33-(0.395)

=== Evaluating Model ===
accuracy on Valid 0.7450331125827815

Best accuracy on Valid 0.7450331125827815
Total valid loss 0.6204398266578975
accuracy on Test 0.7284768211920529
Best accuracy on Test 0.7284768211920529

**** Epoch 8/20 ****
15/33-(0.700)
30/33-(0.320)
12/33-(0.483)
27/33-(0.792)

=== Evaluating Model ===
accuracy on Valid 0.6887417218543046


**** Epoch 9/20 ****
9/33-(0.393)
24/33-(0.129)
6/33-(0.467)
21/33-(0.564)

=== Evaluating Model ===
accuracy on Valid 0.7086092715231788


**** Epoch 10/20 ****
3/33-(0.235)
18/33-(0.110)
0/33-(0.536)

=== Evaluating Model ===
accuracy on Valid 0.7152317880794702


**** Epoch 11/20 ****
15/33-(0.756)
30/33-(0.182)
12/33-(0.307)
27/33-(0.260)

=== Evaluating Model ===
accuracy on Valid 0.7086092715231788


**** Epoch 12/20 ****
9/33-(0.223)
24/33-(0.680)
6/33-(0.379)
21/33-(0.024)

=== Evaluating Model ===
accuracy on Valid 0.7086092715231788


**** Epoch 13/20 ****
3/33-(0.234)
18/33-(0.724)
0/33-(0.097)
15/33-(0.226)

=== Evaluating Model ===
accuracy on Valid 0.7284768211920529


**** Epoch 14/20 ****
30/33-(0.024)
12/33-(0.315)
27/33-(0.832)

=== Evaluating Model ===
accuracy on Valid 0.6821192052980133


**** Epoch 15/20 ****
9/33-(0.599)
24/33-(0.531)
6/33-(0.028)
21/33-(0.020)

=== Evaluating Model ===
accuracy on Valid 0.7251655629139073


**** Epoch 16/20 ****
3/33-(0.517)
18/33-(0.019)
0/33-(0.100)
15/33-(0.318)

=== Evaluating Model ===
accuracy on Valid 0.7350993377483444


**** Epoch 17/20 ****
30/33-(0.075)
12/33-(0.012)
27/33-(0.334)

=== Evaluating Model ===
accuracy on Valid 0.6622516556291391


**** Epoch 18/20 ****
9/33-(0.016)
24/33-(0.127)
6/33-(0.119)
21/33-(0.054)

=== Evaluating Model ===
accuracy on Valid 0.7119205298013245


**** Epoch 19/20 ****
3/33-(0.011)
18/33-(0.062)
Best accuracy on Test 0.7284768211920529

Source domain: 4, Target domain: 4, Cur_fold 3
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.402)
30/33-(0.928)
12/33-(1.163)

=== Evaluating Model ===
accuracy on Valid 0.5728476821192053

Best accuracy on Valid 0.5728476821192053
Total valid loss 1.0148615805726302
accuracy on Test 0.5033112582781457
Best accuracy on Test 0.5033112582781457

**** Epoch 0/20 ****
27/33-(0.899)
9/33-(0.911)
24/33-(1.063)
6/33-(0.666)

=== Evaluating Model ===
accuracy on Valid 0.3211920529801324


**** Epoch 1/20 ****
21/33-(1.069)
3/33-(2.203)
18/33-(0.709)
0/33-(1.959)

=== Evaluating Model ===
accuracy on Valid 0.6258278145695364

Best accuracy on Valid 0.6258278145695364
Total valid loss 1.3000216201732033
accuracy on Test 0.6324503311258278
Best accuracy on Test 0.6324503311258278

**** Epoch 2/20 ****
15/33-(0.836)
30/33-(1.187)
12/33-(1.154)

=== Evaluating Model ===
accuracy on Valid 0.7417218543046358

Best accuracy on Valid 0.7417218543046358
Total valid loss 0.664431935862491
accuracy on Test 0.7086092715231788
Best accuracy on Test 0.7086092715231788

**** Epoch 3/20 ****
27/33-(0.426)
9/33-(1.179)
24/33-(0.569)
6/33-(0.945)

=== Evaluating Model ===
accuracy on Valid 0.7218543046357616


**** Epoch 4/20 ****
21/33-(0.481)
3/33-(0.526)
18/33-(0.831)
0/33-(0.518)

=== Evaluating Model ===
accuracy on Valid 0.7119205298013245


**** Epoch 5/20 ****
15/33-(1.225)
30/33-(0.952)
12/33-(0.720)
27/33-(0.542)

=== Evaluating Model ===
accuracy on Valid 0.6920529801324503


**** Epoch 6/20 ****
9/33-(0.913)
24/33-(0.374)
6/33-(0.345)

=== Evaluating Model ===
accuracy on Valid 0.7649006622516556

Best accuracy on Valid 0.7649006622516556
Total valid loss 0.558447174335781
accuracy on Test 0.7218543046357616
Best accuracy on Test 0.7218543046357616

**** Epoch 7/20 ****
21/33-(0.463)
3/33-(0.948)
18/33-(0.479)
0/33-(0.502)

=== Evaluating Model ===
accuracy on Valid 0.7417218543046358


**** Epoch 8/20 ****
15/33-(0.752)
30/33-(0.310)
12/33-(0.196)
27/33-(0.271)

=== Evaluating Model ===
accuracy on Valid 0.7317880794701986


**** Epoch 9/20 ****
9/33-(0.271)
24/33-(0.319)
6/33-(0.823)
21/33-(0.273)

=== Evaluating Model ===
accuracy on Valid 0.609271523178808


**** Epoch 10/20 ****
3/33-(0.294)
18/33-(0.468)
0/33-(0.214)

=== Evaluating Model ===
accuracy on Valid 0.6655629139072847


**** Epoch 11/20 ****
15/33-(0.314)
30/33-(0.049)
12/33-(1.408)
27/33-(0.526)

=== Evaluating Model ===
accuracy on Valid 0.7152317880794702


**** Epoch 12/20 ****
9/33-(0.148)
24/33-(0.516)
6/33-(0.316)
21/33-(0.313)

=== Evaluating Model ===
accuracy on Valid 0.7152317880794702


**** Epoch 13/20 ****
3/33-(0.285)
18/33-(0.069)
0/33-(0.232)
15/33-(0.741)

=== Evaluating Model ===
accuracy on Valid 0.695364238410596


**** Epoch 14/20 ****
30/33-(0.050)
12/33-(0.341)
27/33-(0.353)

=== Evaluating Model ===
accuracy on Valid 0.6026490066225165


**** Epoch 15/20 ****
9/33-(0.259)
24/33-(0.786)
6/33-(0.061)
21/33-(0.079)

=== Evaluating Model ===
accuracy on Valid 0.6986754966887417


**** Epoch 16/20 ****
3/33-(0.411)
18/33-(0.148)
0/33-(0.535)
15/33-(0.165)

=== Evaluating Model ===
accuracy on Valid 0.6655629139072847


**** Epoch 17/20 ****
30/33-(0.360)
12/33-(0.075)
27/33-(0.137)

=== Evaluating Model ===
accuracy on Valid 0.6655629139072847


**** Epoch 18/20 ****
9/33-(0.098)
24/33-(0.388)
6/33-(0.035)
21/33-(0.692)

=== Evaluating Model ===
accuracy on Valid 0.7152317880794702


**** Epoch 19/20 ****
3/33-(0.490)
18/33-(0.083)
Best accuracy on Test 0.7218543046357616

Source domain: 4, Target domain: 4, Cur_fold 4
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Tree_Transformer
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.242)
30/33-(1.176)
12/33-(0.843)

=== Evaluating Model ===
accuracy on Valid 0.53156146179402

Best accuracy on Valid 0.53156146179402
Total valid loss 0.9694199279734963
accuracy on Test 0.5728476821192053
Best accuracy on Test 0.5728476821192053

**** Epoch 0/20 ****
27/33-(0.928)
9/33-(1.162)
24/33-(1.002)
6/33-(0.512)

=== Evaluating Model ===
accuracy on Valid 0.584717607973422

Best accuracy on Valid 0.584717607973422
Total valid loss 0.9066085580148195
accuracy on Test 0.609271523178808
Best accuracy on Test 0.609271523178808

**** Epoch 1/20 ****
21/33-(0.805)
3/33-(0.704)
18/33-(0.816)
0/33-(0.985)

=== Evaluating Model ===
accuracy on Valid 0.584717607973422

Best accuracy on Valid 0.584717607973422
Total valid loss 0.7624696461777938
accuracy on Test 0.6125827814569537
Best accuracy on Test 0.6125827814569537

**** Epoch 2/20 ****
15/33-(0.461)
30/33-(0.759)
12/33-(1.145)

=== Evaluating Model ===
accuracy on Valid 0.6511627906976745

Best accuracy on Valid 0.6511627906976745
Total valid loss 0.690379240010914
accuracy on Test 0.652317880794702
Best accuracy on Test 0.652317880794702

**** Epoch 3/20 ****
27/33-(0.682)
9/33-(1.123)
24/33-(1.093)
6/33-(0.385)

=== Evaluating Model ===
accuracy on Valid 0.53156146179402


**** Epoch 4/20 ****
21/33-(0.714)
3/33-(0.732)
18/33-(0.687)
0/33-(0.670)

=== Evaluating Model ===
accuracy on Valid 0.4950166112956811


**** Epoch 5/20 ****
15/33-(0.733)
30/33-(0.374)
12/33-(0.620)
27/33-(0.702)

=== Evaluating Model ===
accuracy on Valid 0.6644518272425249

Best accuracy on Valid 0.6644518272425249
Total valid loss 0.8345727904846794
accuracy on Test 0.6589403973509934
Best accuracy on Test 0.6589403973509934

**** Epoch 6/20 ****
9/33-(0.390)
24/33-(0.384)
6/33-(0.791)

=== Evaluating Model ===
accuracy on Valid 0.6677740863787376

Best accuracy on Valid 0.6677740863787376
Total valid loss 0.6969250848418788
accuracy on Test 0.6788079470198676
Best accuracy on Test 0.6788079470198676

**** Epoch 7/20 ****
21/33-(0.936)
3/33-(0.114)
18/33-(0.542)
0/33-(0.574)

=== Evaluating Model ===
accuracy on Valid 0.6810631229235881

Best accuracy on Valid 0.6810631229235881
Total valid loss 0.6918551419910631
accuracy on Test 0.7152317880794702
Best accuracy on Test 0.7152317880794702

**** Epoch 8/20 ****
15/33-(0.358)
30/33-(0.479)
12/33-(1.665)
27/33-(0.596)

=== Evaluating Model ===
accuracy on Valid 0.6445182724252492


**** Epoch 9/20 ****
9/33-(0.422)
24/33-(0.202)
6/33-(0.473)
21/33-(0.360)

=== Evaluating Model ===
accuracy on Valid 0.6445182724252492


**** Epoch 10/20 ****
3/33-(0.294)
18/33-(0.047)
0/33-(0.271)

=== Evaluating Model ===
accuracy on Valid 0.6312292358803987


**** Epoch 11/20 ****
15/33-(0.348)
30/33-(0.679)
12/33-(0.332)
27/33-(0.221)

=== Evaluating Model ===
accuracy on Valid 0.6710963455149501


**** Epoch 12/20 ****
9/33-(0.462)
24/33-(0.237)
6/33-(1.709)
21/33-(0.268)

=== Evaluating Model ===
accuracy on Valid 0.6710963455149501


**** Epoch 13/20 ****
3/33-(1.439)
18/33-(0.288)
0/33-(0.133)
15/33-(0.858)

=== Evaluating Model ===
accuracy on Valid 0.5913621262458472


**** Epoch 14/20 ****
30/33-(0.616)
12/33-(0.328)
27/33-(0.178)

=== Evaluating Model ===
accuracy on Valid 0.654485049833887


**** Epoch 15/20 ****
9/33-(0.094)
24/33-(0.304)
6/33-(0.057)
21/33-(0.223)

=== Evaluating Model ===
accuracy on Valid 0.6910299003322259

Best accuracy on Valid 0.6910299003322259
Total valid loss 0.9253548697421425
accuracy on Test 0.6854304635761589
Best accuracy on Test 0.7152317880794702

**** Epoch 16/20 ****
3/33-(0.535)
18/33-(0.042)
0/33-(0.306)
15/33-(0.756)

=== Evaluating Model ===
accuracy on Valid 0.6777408637873754


**** Epoch 17/20 ****
30/33-(0.411)
12/33-(0.147)
27/33-(0.333)

=== Evaluating Model ===
accuracy on Valid 0.6710963455149501


**** Epoch 18/20 ****
9/33-(0.352)
24/33-(0.328)
6/33-(0.226)
21/33-(0.401)

=== Evaluating Model ===
accuracy on Valid 0.6345514950166113


**** Epoch 19/20 ****
3/33-(0.242)
18/33-(0.091)
Best accuracy on Test 0.7152317880794702

Final k-fold valid 0.7176695782271018
[0.6821192052980133, 0.7152317880794702, 0.7450331125827815, 0.7649006622516556, 0.6810631229235881]
Final k-fold eval 0.7110602627004907
[0.7009966777408638, 0.6887417218543046, 0.7284768211920529, 0.7218543046357616, 0.7152317880794702]
