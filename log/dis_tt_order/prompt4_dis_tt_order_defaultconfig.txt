Whole k-fold eval mode
Source domain: 4, Target domain: 4, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

context_weight True
base_encoder.encoder.model.mask_emb True
base_encoder.encoder.model.word_embedding.weight True
base_encoder.encoder.model.layer.0.rel_attn.q True
base_encoder.encoder.model.layer.0.rel_attn.k True
base_encoder.encoder.model.layer.0.rel_attn.v True
base_encoder.encoder.model.layer.0.rel_attn.o True
base_encoder.encoder.model.layer.0.rel_attn.r True
base_encoder.encoder.model.layer.0.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.0.rel_attn.seg_embed True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_norm.weight True
base_encoder.encoder.model.layer.0.ff.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_1.weight True
base_encoder.encoder.model.layer.0.ff.layer_1.bias True
base_encoder.encoder.model.layer.0.ff.layer_2.weight True
base_encoder.encoder.model.layer.0.ff.layer_2.bias True
base_encoder.encoder.model.layer.1.rel_attn.q True
base_encoder.encoder.model.layer.1.rel_attn.k True
base_encoder.encoder.model.layer.1.rel_attn.v True
base_encoder.encoder.model.layer.1.rel_attn.o True
base_encoder.encoder.model.layer.1.rel_attn.r True
base_encoder.encoder.model.layer.1.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.1.rel_attn.seg_embed True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_norm.weight True
base_encoder.encoder.model.layer.1.ff.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_1.weight True
base_encoder.encoder.model.layer.1.ff.layer_1.bias True
base_encoder.encoder.model.layer.1.ff.layer_2.weight True
base_encoder.encoder.model.layer.1.ff.layer_2.bias True
base_encoder.encoder.model.layer.2.rel_attn.q True
base_encoder.encoder.model.layer.2.rel_attn.k True
base_encoder.encoder.model.layer.2.rel_attn.v True
base_encoder.encoder.model.layer.2.rel_attn.o True
base_encoder.encoder.model.layer.2.rel_attn.r True
base_encoder.encoder.model.layer.2.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.2.rel_attn.seg_embed True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_norm.weight True
base_encoder.encoder.model.layer.2.ff.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_1.weight True
base_encoder.encoder.model.layer.2.ff.layer_1.bias True
base_encoder.encoder.model.layer.2.ff.layer_2.weight True
base_encoder.encoder.model.layer.2.ff.layer_2.bias True
base_encoder.encoder.model.layer.3.rel_attn.q True
base_encoder.encoder.model.layer.3.rel_attn.k True
base_encoder.encoder.model.layer.3.rel_attn.v True
base_encoder.encoder.model.layer.3.rel_attn.o True
base_encoder.encoder.model.layer.3.rel_attn.r True
base_encoder.encoder.model.layer.3.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.3.rel_attn.seg_embed True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_norm.weight True
base_encoder.encoder.model.layer.3.ff.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_1.weight True
base_encoder.encoder.model.layer.3.ff.layer_1.bias True
base_encoder.encoder.model.layer.3.ff.layer_2.weight True
base_encoder.encoder.model.layer.3.ff.layer_2.bias True
base_encoder.encoder.model.layer.4.rel_attn.q True
base_encoder.encoder.model.layer.4.rel_attn.k True
base_encoder.encoder.model.layer.4.rel_attn.v True
base_encoder.encoder.model.layer.4.rel_attn.o True
base_encoder.encoder.model.layer.4.rel_attn.r True
base_encoder.encoder.model.layer.4.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.4.rel_attn.seg_embed True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_norm.weight True
base_encoder.encoder.model.layer.4.ff.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_1.weight True
base_encoder.encoder.model.layer.4.ff.layer_1.bias True
base_encoder.encoder.model.layer.4.ff.layer_2.weight True
base_encoder.encoder.model.layer.4.ff.layer_2.bias True
base_encoder.encoder.model.layer.5.rel_attn.q True
base_encoder.encoder.model.layer.5.rel_attn.k True
base_encoder.encoder.model.layer.5.rel_attn.v True
base_encoder.encoder.model.layer.5.rel_attn.o True
base_encoder.encoder.model.layer.5.rel_attn.r True
base_encoder.encoder.model.layer.5.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.5.rel_attn.seg_embed True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_norm.weight True
base_encoder.encoder.model.layer.5.ff.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_1.weight True
base_encoder.encoder.model.layer.5.ff.layer_1.bias True
base_encoder.encoder.model.layer.5.ff.layer_2.weight True
base_encoder.encoder.model.layer.5.ff.layer_2.bias True
base_encoder.encoder.model.layer.6.rel_attn.q True
base_encoder.encoder.model.layer.6.rel_attn.k True
base_encoder.encoder.model.layer.6.rel_attn.v True
base_encoder.encoder.model.layer.6.rel_attn.o True
base_encoder.encoder.model.layer.6.rel_attn.r True
base_encoder.encoder.model.layer.6.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.6.rel_attn.seg_embed True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_norm.weight True
base_encoder.encoder.model.layer.6.ff.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_1.weight True
base_encoder.encoder.model.layer.6.ff.layer_1.bias True
base_encoder.encoder.model.layer.6.ff.layer_2.weight True
base_encoder.encoder.model.layer.6.ff.layer_2.bias True
base_encoder.encoder.model.layer.7.rel_attn.q True
base_encoder.encoder.model.layer.7.rel_attn.k True
base_encoder.encoder.model.layer.7.rel_attn.v True
base_encoder.encoder.model.layer.7.rel_attn.o True
base_encoder.encoder.model.layer.7.rel_attn.r True
base_encoder.encoder.model.layer.7.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.7.rel_attn.seg_embed True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_norm.weight True
base_encoder.encoder.model.layer.7.ff.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_1.weight True
base_encoder.encoder.model.layer.7.ff.layer_1.bias True
base_encoder.encoder.model.layer.7.ff.layer_2.weight True
base_encoder.encoder.model.layer.7.ff.layer_2.bias True
base_encoder.encoder.model.layer.8.rel_attn.q True
base_encoder.encoder.model.layer.8.rel_attn.k True
base_encoder.encoder.model.layer.8.rel_attn.v True
base_encoder.encoder.model.layer.8.rel_attn.o True
base_encoder.encoder.model.layer.8.rel_attn.r True
base_encoder.encoder.model.layer.8.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.8.rel_attn.seg_embed True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_norm.weight True
base_encoder.encoder.model.layer.8.ff.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_1.weight True
base_encoder.encoder.model.layer.8.ff.layer_1.bias True
base_encoder.encoder.model.layer.8.ff.layer_2.weight True
base_encoder.encoder.model.layer.8.ff.layer_2.bias True
base_encoder.encoder.model.layer.9.rel_attn.q True
base_encoder.encoder.model.layer.9.rel_attn.k True
base_encoder.encoder.model.layer.9.rel_attn.v True
base_encoder.encoder.model.layer.9.rel_attn.o True
base_encoder.encoder.model.layer.9.rel_attn.r True
base_encoder.encoder.model.layer.9.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.9.rel_attn.seg_embed True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_norm.weight True
base_encoder.encoder.model.layer.9.ff.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_1.weight True
base_encoder.encoder.model.layer.9.ff.layer_1.bias True
base_encoder.encoder.model.layer.9.ff.layer_2.weight True
base_encoder.encoder.model.layer.9.ff.layer_2.bias True
base_encoder.encoder.model.layer.10.rel_attn.q True
base_encoder.encoder.model.layer.10.rel_attn.k True
base_encoder.encoder.model.layer.10.rel_attn.v True
base_encoder.encoder.model.layer.10.rel_attn.o True
base_encoder.encoder.model.layer.10.rel_attn.r True
base_encoder.encoder.model.layer.10.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.10.rel_attn.seg_embed True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_norm.weight True
base_encoder.encoder.model.layer.10.ff.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_1.weight True
base_encoder.encoder.model.layer.10.ff.layer_1.bias True
base_encoder.encoder.model.layer.10.ff.layer_2.weight True
base_encoder.encoder.model.layer.10.ff.layer_2.bias True
base_encoder.encoder.model.layer.11.rel_attn.q True
base_encoder.encoder.model.layer.11.rel_attn.k True
base_encoder.encoder.model.layer.11.rel_attn.v True
base_encoder.encoder.model.layer.11.rel_attn.o True
base_encoder.encoder.model.layer.11.rel_attn.r True
base_encoder.encoder.model.layer.11.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.11.rel_attn.seg_embed True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_norm.weight True
base_encoder.encoder.model.layer.11.ff.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_1.weight True
base_encoder.encoder.model.layer.11.ff.layer_1.bias True
base_encoder.encoder.model.layer.11.ff.layer_2.weight True
base_encoder.encoder.model.layer.11.ff.layer_2.bias True
tt_encoder.layers.0.self_attn.linears.0.weight True
tt_encoder.layers.0.self_attn.linears.0.bias True
tt_encoder.layers.0.self_attn.linears.1.weight True
tt_encoder.layers.0.self_attn.linears.1.bias True
tt_encoder.layers.0.self_attn.linears.2.weight True
tt_encoder.layers.0.self_attn.linears.2.bias True
tt_encoder.layers.0.self_attn.linears.3.weight True
tt_encoder.layers.0.self_attn.linears.3.bias True
tt_encoder.layers.0.feed_forward.w_1.weight True
tt_encoder.layers.0.feed_forward.w_1.bias True
tt_encoder.layers.0.feed_forward.w_2.weight True
tt_encoder.layers.0.feed_forward.w_2.bias True
tt_encoder.layers.0.group_attn.linear_key.weight True
tt_encoder.layers.0.group_attn.linear_key.bias True
tt_encoder.layers.0.group_attn.linear_query.weight True
tt_encoder.layers.0.group_attn.linear_query.bias True
tt_encoder.layers.0.group_attn.norm.a_2 True
tt_encoder.layers.0.group_attn.norm.b_2 True
tt_encoder.layers.0.sublayer.0.norm.a_2 True
tt_encoder.layers.0.sublayer.0.norm.b_2 True
tt_encoder.layers.0.sublayer.1.norm.a_2 True
tt_encoder.layers.0.sublayer.1.norm.b_2 True
tt_encoder.layers.1.self_attn.linears.0.weight True
tt_encoder.layers.1.self_attn.linears.0.bias True
tt_encoder.layers.1.self_attn.linears.1.weight True
tt_encoder.layers.1.self_attn.linears.1.bias True
tt_encoder.layers.1.self_attn.linears.2.weight True
tt_encoder.layers.1.self_attn.linears.2.bias True
tt_encoder.layers.1.self_attn.linears.3.weight True
tt_encoder.layers.1.self_attn.linears.3.bias True
tt_encoder.layers.1.feed_forward.w_1.weight True
tt_encoder.layers.1.feed_forward.w_1.bias True
tt_encoder.layers.1.feed_forward.w_2.weight True
tt_encoder.layers.1.feed_forward.w_2.bias True
tt_encoder.layers.1.group_attn.linear_key.weight True
tt_encoder.layers.1.group_attn.linear_key.bias True
tt_encoder.layers.1.group_attn.linear_query.weight True
tt_encoder.layers.1.group_attn.linear_query.bias True
tt_encoder.layers.1.group_attn.norm.a_2 True
tt_encoder.layers.1.group_attn.norm.b_2 True
tt_encoder.layers.1.sublayer.0.norm.a_2 True
tt_encoder.layers.1.sublayer.0.norm.b_2 True
tt_encoder.layers.1.sublayer.1.norm.a_2 True
tt_encoder.layers.1.sublayer.1.norm.b_2 True
tt_encoder.layers.2.self_attn.linears.0.weight True
tt_encoder.layers.2.self_attn.linears.0.bias True
tt_encoder.layers.2.self_attn.linears.1.weight True
tt_encoder.layers.2.self_attn.linears.1.bias True
tt_encoder.layers.2.self_attn.linears.2.weight True
tt_encoder.layers.2.self_attn.linears.2.bias True
tt_encoder.layers.2.self_attn.linears.3.weight True
tt_encoder.layers.2.self_attn.linears.3.bias True
tt_encoder.layers.2.feed_forward.w_1.weight True
tt_encoder.layers.2.feed_forward.w_1.bias True
tt_encoder.layers.2.feed_forward.w_2.weight True
tt_encoder.layers.2.feed_forward.w_2.bias True
tt_encoder.layers.2.group_attn.linear_key.weight True
tt_encoder.layers.2.group_attn.linear_key.bias True
tt_encoder.layers.2.group_attn.linear_query.weight True
tt_encoder.layers.2.group_attn.linear_query.bias True
tt_encoder.layers.2.group_attn.norm.a_2 True
tt_encoder.layers.2.group_attn.norm.b_2 True
tt_encoder.layers.2.sublayer.0.norm.a_2 True
tt_encoder.layers.2.sublayer.0.norm.b_2 True
tt_encoder.layers.2.sublayer.1.norm.a_2 True
tt_encoder.layers.2.sublayer.1.norm.b_2 True
tt_encoder.layers.3.self_attn.linears.0.weight True
tt_encoder.layers.3.self_attn.linears.0.bias True
tt_encoder.layers.3.self_attn.linears.1.weight True
tt_encoder.layers.3.self_attn.linears.1.bias True
tt_encoder.layers.3.self_attn.linears.2.weight True
tt_encoder.layers.3.self_attn.linears.2.bias True
tt_encoder.layers.3.self_attn.linears.3.weight True
tt_encoder.layers.3.self_attn.linears.3.bias True
tt_encoder.layers.3.feed_forward.w_1.weight True
tt_encoder.layers.3.feed_forward.w_1.bias True
tt_encoder.layers.3.feed_forward.w_2.weight True
tt_encoder.layers.3.feed_forward.w_2.bias True
tt_encoder.layers.3.group_attn.linear_key.weight True
tt_encoder.layers.3.group_attn.linear_key.bias True
tt_encoder.layers.3.group_attn.linear_query.weight True
tt_encoder.layers.3.group_attn.linear_query.bias True
tt_encoder.layers.3.group_attn.norm.a_2 True
tt_encoder.layers.3.group_attn.norm.b_2 True
tt_encoder.layers.3.sublayer.0.norm.a_2 True
tt_encoder.layers.3.sublayer.0.norm.b_2 True
tt_encoder.layers.3.sublayer.1.norm.a_2 True
tt_encoder.layers.3.sublayer.1.norm.b_2 True
tt_encoder.norm.a_2 True
tt_encoder.norm.b_2 True
linear_1.weight True
linear_1.bias True
linear_2.weight True
linear_2.bias True
linear_out.weight True
linear_out.bias True
so_linear_1.weight True
so_linear_1.bias True
so_linear_2.weight True
so_linear_2.bias True
so_linear_out.weight True
so_linear_out.bias True
layer_norm1.weight True
layer_norm1.bias True
layer_norm2.weight True
layer_norm2.bias True
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(2.311)
30/33-(1.497)
12/33-(1.277)

=== Evaluating Model ===
accuracy on Valid 0.5596026490066225

Best accuracy on Valid 0.5596026490066225
Total valid loss 0.8740407604920236
accuracy on Test 0.5348837209302325
Best accuracy on Test 0.5348837209302325

**** Epoch 0/20 ****
27/33-(1.016)
9/33-(1.791)
24/33-(0.759)
6/33-(0.910)

=== Evaluating Model ===
accuracy on Valid 0.6456953642384106

Best accuracy on Valid 0.6456953642384106
Total valid loss 0.695379829720447
accuracy on Test 0.6810631229235881
Best accuracy on Test 0.6810631229235881

**** Epoch 1/20 ****
21/33-(1.811)
3/33-(0.836)
18/33-(0.789)
0/33-(0.858)

=== Evaluating Model ===
accuracy on Valid 0.7218543046357616

Best accuracy on Valid 0.7218543046357616
Total valid loss 0.7138691528847343
accuracy on Test 0.6910299003322259
Best accuracy on Test 0.6910299003322259

**** Epoch 2/20 ****
15/33-(1.268)
30/33-(0.376)
12/33-(0.622)

=== Evaluating Model ===
accuracy on Valid 0.6622516556291391


**** Epoch 3/20 ****
27/33-(0.523)
9/33-(0.682)
24/33-(2.206)
6/33-(0.512)

=== Evaluating Model ===
accuracy on Valid 0.695364238410596


**** Epoch 4/20 ****
21/33-(0.374)
3/33-(0.765)
18/33-(0.468)
0/33-(0.430)

=== Evaluating Model ===
accuracy on Valid 0.6456953642384106


**** Epoch 5/20 ****
15/33-(0.453)
30/33-(0.599)
12/33-(0.773)
27/33-(0.292)

=== Evaluating Model ===
accuracy on Valid 0.6622516556291391


**** Epoch 6/20 ****
9/33-(0.395)
24/33-(0.157)
6/33-(0.960)

=== Evaluating Model ===
accuracy on Valid 0.6026490066225165


**** Epoch 7/20 ****
21/33-(1.503)
3/33-(0.262)
18/33-(0.305)
0/33-(0.500)

=== Evaluating Model ===
accuracy on Valid 0.6192052980132451


**** Epoch 8/20 ****
15/33-(0.998)
30/33-(0.194)
12/33-(0.343)
27/33-(0.241)

=== Evaluating Model ===
accuracy on Valid 0.695364238410596


**** Epoch 9/20 ****
9/33-(0.158)
24/33-(1.458)
6/33-(0.422)
21/33-(0.191)

=== Evaluating Model ===
accuracy on Valid 0.6589403973509934


**** Epoch 10/20 ****
3/33-(0.270)
18/33-(0.159)
0/33-(0.904)

=== Evaluating Model ===
accuracy on Valid 0.6622516556291391


**** Epoch 11/20 ****
15/33-(0.406)
30/33-(0.269)
12/33-(0.383)
27/33-(0.330)

=== Evaluating Model ===
accuracy on Valid 0.6721854304635762


**** Epoch 12/20 ****
9/33-(0.264)
24/33-(1.074)
6/33-(0.391)
21/33-(0.198)

=== Evaluating Model ===
accuracy on Valid 0.5827814569536424


**** Epoch 13/20 ****
3/33-(0.854)
18/33-(0.227)
0/33-(0.084)
15/33-(0.667)

=== Evaluating Model ===
accuracy on Valid 0.6986754966887417


**** Epoch 14/20 ****
30/33-(0.279)
12/33-(0.470)
27/33-(0.097)

=== Evaluating Model ===
accuracy on Valid 0.6158940397350994


**** Epoch 15/20 ****
9/33-(0.218)
24/33-(0.161)
6/33-(0.221)
21/33-(0.155)

=== Evaluating Model ===
accuracy on Valid 0.6887417218543046


**** Epoch 16/20 ****
3/33-(0.160)
18/33-(0.384)
0/33-(0.179)
15/33-(0.089)

=== Evaluating Model ===
accuracy on Valid 0.6920529801324503


**** Epoch 17/20 ****
30/33-(0.178)
12/33-(0.220)
27/33-(0.253)

=== Evaluating Model ===
accuracy on Valid 0.6920529801324503


**** Epoch 18/20 ****
9/33-(0.392)
24/33-(0.398)
6/33-(0.082)
21/33-(0.083)

=== Evaluating Model ===
accuracy on Valid 0.6423841059602649


**** Epoch 19/20 ****
3/33-(0.251)
18/33-(0.039)
Best accuracy on Test 0.6910299003322259

Source domain: 4, Target domain: 4, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

context_weight True
base_encoder.encoder.model.mask_emb True
base_encoder.encoder.model.word_embedding.weight True
base_encoder.encoder.model.layer.0.rel_attn.q True
base_encoder.encoder.model.layer.0.rel_attn.k True
base_encoder.encoder.model.layer.0.rel_attn.v True
base_encoder.encoder.model.layer.0.rel_attn.o True
base_encoder.encoder.model.layer.0.rel_attn.r True
base_encoder.encoder.model.layer.0.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.0.rel_attn.seg_embed True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_norm.weight True
base_encoder.encoder.model.layer.0.ff.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_1.weight True
base_encoder.encoder.model.layer.0.ff.layer_1.bias True
base_encoder.encoder.model.layer.0.ff.layer_2.weight True
base_encoder.encoder.model.layer.0.ff.layer_2.bias True
base_encoder.encoder.model.layer.1.rel_attn.q True
base_encoder.encoder.model.layer.1.rel_attn.k True
base_encoder.encoder.model.layer.1.rel_attn.v True
base_encoder.encoder.model.layer.1.rel_attn.o True
base_encoder.encoder.model.layer.1.rel_attn.r True
base_encoder.encoder.model.layer.1.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.1.rel_attn.seg_embed True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_norm.weight True
base_encoder.encoder.model.layer.1.ff.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_1.weight True
base_encoder.encoder.model.layer.1.ff.layer_1.bias True
base_encoder.encoder.model.layer.1.ff.layer_2.weight True
base_encoder.encoder.model.layer.1.ff.layer_2.bias True
base_encoder.encoder.model.layer.2.rel_attn.q True
base_encoder.encoder.model.layer.2.rel_attn.k True
base_encoder.encoder.model.layer.2.rel_attn.v True
base_encoder.encoder.model.layer.2.rel_attn.o True
base_encoder.encoder.model.layer.2.rel_attn.r True
base_encoder.encoder.model.layer.2.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.2.rel_attn.seg_embed True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_norm.weight True
base_encoder.encoder.model.layer.2.ff.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_1.weight True
base_encoder.encoder.model.layer.2.ff.layer_1.bias True
base_encoder.encoder.model.layer.2.ff.layer_2.weight True
base_encoder.encoder.model.layer.2.ff.layer_2.bias True
base_encoder.encoder.model.layer.3.rel_attn.q True
base_encoder.encoder.model.layer.3.rel_attn.k True
base_encoder.encoder.model.layer.3.rel_attn.v True
base_encoder.encoder.model.layer.3.rel_attn.o True
base_encoder.encoder.model.layer.3.rel_attn.r True
base_encoder.encoder.model.layer.3.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.3.rel_attn.seg_embed True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_norm.weight True
base_encoder.encoder.model.layer.3.ff.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_1.weight True
base_encoder.encoder.model.layer.3.ff.layer_1.bias True
base_encoder.encoder.model.layer.3.ff.layer_2.weight True
base_encoder.encoder.model.layer.3.ff.layer_2.bias True
base_encoder.encoder.model.layer.4.rel_attn.q True
base_encoder.encoder.model.layer.4.rel_attn.k True
base_encoder.encoder.model.layer.4.rel_attn.v True
base_encoder.encoder.model.layer.4.rel_attn.o True
base_encoder.encoder.model.layer.4.rel_attn.r True
base_encoder.encoder.model.layer.4.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.4.rel_attn.seg_embed True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_norm.weight True
base_encoder.encoder.model.layer.4.ff.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_1.weight True
base_encoder.encoder.model.layer.4.ff.layer_1.bias True
base_encoder.encoder.model.layer.4.ff.layer_2.weight True
base_encoder.encoder.model.layer.4.ff.layer_2.bias True
base_encoder.encoder.model.layer.5.rel_attn.q True
base_encoder.encoder.model.layer.5.rel_attn.k True
base_encoder.encoder.model.layer.5.rel_attn.v True
base_encoder.encoder.model.layer.5.rel_attn.o True
base_encoder.encoder.model.layer.5.rel_attn.r True
base_encoder.encoder.model.layer.5.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.5.rel_attn.seg_embed True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_norm.weight True
base_encoder.encoder.model.layer.5.ff.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_1.weight True
base_encoder.encoder.model.layer.5.ff.layer_1.bias True
base_encoder.encoder.model.layer.5.ff.layer_2.weight True
base_encoder.encoder.model.layer.5.ff.layer_2.bias True
base_encoder.encoder.model.layer.6.rel_attn.q True
base_encoder.encoder.model.layer.6.rel_attn.k True
base_encoder.encoder.model.layer.6.rel_attn.v True
base_encoder.encoder.model.layer.6.rel_attn.o True
base_encoder.encoder.model.layer.6.rel_attn.r True
base_encoder.encoder.model.layer.6.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.6.rel_attn.seg_embed True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_norm.weight True
base_encoder.encoder.model.layer.6.ff.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_1.weight True
base_encoder.encoder.model.layer.6.ff.layer_1.bias True
base_encoder.encoder.model.layer.6.ff.layer_2.weight True
base_encoder.encoder.model.layer.6.ff.layer_2.bias True
base_encoder.encoder.model.layer.7.rel_attn.q True
base_encoder.encoder.model.layer.7.rel_attn.k True
base_encoder.encoder.model.layer.7.rel_attn.v True
base_encoder.encoder.model.layer.7.rel_attn.o True
base_encoder.encoder.model.layer.7.rel_attn.r True
base_encoder.encoder.model.layer.7.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.7.rel_attn.seg_embed True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_norm.weight True
base_encoder.encoder.model.layer.7.ff.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_1.weight True
base_encoder.encoder.model.layer.7.ff.layer_1.bias True
base_encoder.encoder.model.layer.7.ff.layer_2.weight True
base_encoder.encoder.model.layer.7.ff.layer_2.bias True
base_encoder.encoder.model.layer.8.rel_attn.q True
base_encoder.encoder.model.layer.8.rel_attn.k True
base_encoder.encoder.model.layer.8.rel_attn.v True
base_encoder.encoder.model.layer.8.rel_attn.o True
base_encoder.encoder.model.layer.8.rel_attn.r True
base_encoder.encoder.model.layer.8.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.8.rel_attn.seg_embed True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_norm.weight True
base_encoder.encoder.model.layer.8.ff.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_1.weight True
base_encoder.encoder.model.layer.8.ff.layer_1.bias True
base_encoder.encoder.model.layer.8.ff.layer_2.weight True
base_encoder.encoder.model.layer.8.ff.layer_2.bias True
base_encoder.encoder.model.layer.9.rel_attn.q True
base_encoder.encoder.model.layer.9.rel_attn.k True
base_encoder.encoder.model.layer.9.rel_attn.v True
base_encoder.encoder.model.layer.9.rel_attn.o True
base_encoder.encoder.model.layer.9.rel_attn.r True
base_encoder.encoder.model.layer.9.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.9.rel_attn.seg_embed True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_norm.weight True
base_encoder.encoder.model.layer.9.ff.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_1.weight True
base_encoder.encoder.model.layer.9.ff.layer_1.bias True
base_encoder.encoder.model.layer.9.ff.layer_2.weight True
base_encoder.encoder.model.layer.9.ff.layer_2.bias True
base_encoder.encoder.model.layer.10.rel_attn.q True
base_encoder.encoder.model.layer.10.rel_attn.k True
base_encoder.encoder.model.layer.10.rel_attn.v True
base_encoder.encoder.model.layer.10.rel_attn.o True
base_encoder.encoder.model.layer.10.rel_attn.r True
base_encoder.encoder.model.layer.10.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.10.rel_attn.seg_embed True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_norm.weight True
base_encoder.encoder.model.layer.10.ff.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_1.weight True
base_encoder.encoder.model.layer.10.ff.layer_1.bias True
base_encoder.encoder.model.layer.10.ff.layer_2.weight True
base_encoder.encoder.model.layer.10.ff.layer_2.bias True
base_encoder.encoder.model.layer.11.rel_attn.q True
base_encoder.encoder.model.layer.11.rel_attn.k True
base_encoder.encoder.model.layer.11.rel_attn.v True
base_encoder.encoder.model.layer.11.rel_attn.o True
base_encoder.encoder.model.layer.11.rel_attn.r True
base_encoder.encoder.model.layer.11.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.11.rel_attn.seg_embed True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_norm.weight True
base_encoder.encoder.model.layer.11.ff.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_1.weight True
base_encoder.encoder.model.layer.11.ff.layer_1.bias True
base_encoder.encoder.model.layer.11.ff.layer_2.weight True
base_encoder.encoder.model.layer.11.ff.layer_2.bias True
tt_encoder.layers.0.self_attn.linears.0.weight True
tt_encoder.layers.0.self_attn.linears.0.bias True
tt_encoder.layers.0.self_attn.linears.1.weight True
tt_encoder.layers.0.self_attn.linears.1.bias True
tt_encoder.layers.0.self_attn.linears.2.weight True
tt_encoder.layers.0.self_attn.linears.2.bias True
tt_encoder.layers.0.self_attn.linears.3.weight True
tt_encoder.layers.0.self_attn.linears.3.bias True
tt_encoder.layers.0.feed_forward.w_1.weight True
tt_encoder.layers.0.feed_forward.w_1.bias True
tt_encoder.layers.0.feed_forward.w_2.weight True
tt_encoder.layers.0.feed_forward.w_2.bias True
tt_encoder.layers.0.group_attn.linear_key.weight True
tt_encoder.layers.0.group_attn.linear_key.bias True
tt_encoder.layers.0.group_attn.linear_query.weight True
tt_encoder.layers.0.group_attn.linear_query.bias True
tt_encoder.layers.0.group_attn.norm.a_2 True
tt_encoder.layers.0.group_attn.norm.b_2 True
tt_encoder.layers.0.sublayer.0.norm.a_2 True
tt_encoder.layers.0.sublayer.0.norm.b_2 True
tt_encoder.layers.0.sublayer.1.norm.a_2 True
tt_encoder.layers.0.sublayer.1.norm.b_2 True
tt_encoder.layers.1.self_attn.linears.0.weight True
tt_encoder.layers.1.self_attn.linears.0.bias True
tt_encoder.layers.1.self_attn.linears.1.weight True
tt_encoder.layers.1.self_attn.linears.1.bias True
tt_encoder.layers.1.self_attn.linears.2.weight True
tt_encoder.layers.1.self_attn.linears.2.bias True
tt_encoder.layers.1.self_attn.linears.3.weight True
tt_encoder.layers.1.self_attn.linears.3.bias True
tt_encoder.layers.1.feed_forward.w_1.weight True
tt_encoder.layers.1.feed_forward.w_1.bias True
tt_encoder.layers.1.feed_forward.w_2.weight True
tt_encoder.layers.1.feed_forward.w_2.bias True
tt_encoder.layers.1.group_attn.linear_key.weight True
tt_encoder.layers.1.group_attn.linear_key.bias True
tt_encoder.layers.1.group_attn.linear_query.weight True
tt_encoder.layers.1.group_attn.linear_query.bias True
tt_encoder.layers.1.group_attn.norm.a_2 True
tt_encoder.layers.1.group_attn.norm.b_2 True
tt_encoder.layers.1.sublayer.0.norm.a_2 True
tt_encoder.layers.1.sublayer.0.norm.b_2 True
tt_encoder.layers.1.sublayer.1.norm.a_2 True
tt_encoder.layers.1.sublayer.1.norm.b_2 True
tt_encoder.layers.2.self_attn.linears.0.weight True
tt_encoder.layers.2.self_attn.linears.0.bias True
tt_encoder.layers.2.self_attn.linears.1.weight True
tt_encoder.layers.2.self_attn.linears.1.bias True
tt_encoder.layers.2.self_attn.linears.2.weight True
tt_encoder.layers.2.self_attn.linears.2.bias True
tt_encoder.layers.2.self_attn.linears.3.weight True
tt_encoder.layers.2.self_attn.linears.3.bias True
tt_encoder.layers.2.feed_forward.w_1.weight True
tt_encoder.layers.2.feed_forward.w_1.bias True
tt_encoder.layers.2.feed_forward.w_2.weight True
tt_encoder.layers.2.feed_forward.w_2.bias True
tt_encoder.layers.2.group_attn.linear_key.weight True
tt_encoder.layers.2.group_attn.linear_key.bias True
tt_encoder.layers.2.group_attn.linear_query.weight True
tt_encoder.layers.2.group_attn.linear_query.bias True
tt_encoder.layers.2.group_attn.norm.a_2 True
tt_encoder.layers.2.group_attn.norm.b_2 True
tt_encoder.layers.2.sublayer.0.norm.a_2 True
tt_encoder.layers.2.sublayer.0.norm.b_2 True
tt_encoder.layers.2.sublayer.1.norm.a_2 True
tt_encoder.layers.2.sublayer.1.norm.b_2 True
tt_encoder.layers.3.self_attn.linears.0.weight True
tt_encoder.layers.3.self_attn.linears.0.bias True
tt_encoder.layers.3.self_attn.linears.1.weight True
tt_encoder.layers.3.self_attn.linears.1.bias True
tt_encoder.layers.3.self_attn.linears.2.weight True
tt_encoder.layers.3.self_attn.linears.2.bias True
tt_encoder.layers.3.self_attn.linears.3.weight True
tt_encoder.layers.3.self_attn.linears.3.bias True
tt_encoder.layers.3.feed_forward.w_1.weight True
tt_encoder.layers.3.feed_forward.w_1.bias True
tt_encoder.layers.3.feed_forward.w_2.weight True
tt_encoder.layers.3.feed_forward.w_2.bias True
tt_encoder.layers.3.group_attn.linear_key.weight True
tt_encoder.layers.3.group_attn.linear_key.bias True
tt_encoder.layers.3.group_attn.linear_query.weight True
tt_encoder.layers.3.group_attn.linear_query.bias True
tt_encoder.layers.3.group_attn.norm.a_2 True
tt_encoder.layers.3.group_attn.norm.b_2 True
tt_encoder.layers.3.sublayer.0.norm.a_2 True
tt_encoder.layers.3.sublayer.0.norm.b_2 True
tt_encoder.layers.3.sublayer.1.norm.a_2 True
tt_encoder.layers.3.sublayer.1.norm.b_2 True
tt_encoder.norm.a_2 True
tt_encoder.norm.b_2 True
linear_1.weight True
linear_1.bias True
linear_2.weight True
linear_2.bias True
linear_out.weight True
linear_out.bias True
so_linear_1.weight True
so_linear_1.bias True
so_linear_2.weight True
so_linear_2.bias True
so_linear_out.weight True
so_linear_out.bias True
layer_norm1.weight True
layer_norm1.bias True
layer_norm2.weight True
layer_norm2.bias True
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.839)
30/33-(1.454)
12/33-(1.309)

=== Evaluating Model ===
accuracy on Valid 0.5562913907284768

Best accuracy on Valid 0.5562913907284768
Total valid loss 0.906896108075192
accuracy on Test 0.5463576158940397
Best accuracy on Test 0.5463576158940397

**** Epoch 0/20 ****
27/33-(1.299)
9/33-(0.959)
24/33-(0.625)
6/33-(1.076)

=== Evaluating Model ===
accuracy on Valid 0.5033112582781457


**** Epoch 1/20 ****
21/33-(1.011)
3/33-(2.306)
18/33-(0.770)
0/33-(1.866)

=== Evaluating Model ===
accuracy on Valid 0.6324503311258278

Best accuracy on Valid 0.6324503311258278
Total valid loss 0.9156693157396818
accuracy on Test 0.5927152317880795
Best accuracy on Test 0.5927152317880795

**** Epoch 2/20 ****
15/33-(0.831)
30/33-(0.885)
12/33-(1.130)

=== Evaluating Model ===
accuracy on Valid 0.6324503311258278

Best accuracy on Valid 0.6324503311258278
Total valid loss 1.1102373505893506
accuracy on Test 0.6357615894039735
Best accuracy on Test 0.6357615894039735

**** Epoch 3/20 ****
27/33-(0.841)
9/33-(0.970)
24/33-(0.814)
6/33-(0.900)

=== Evaluating Model ===
accuracy on Valid 0.7483443708609272

Best accuracy on Valid 0.7483443708609272
Total valid loss 0.6885959976597836
accuracy on Test 0.6788079470198676
Best accuracy on Test 0.6788079470198676

**** Epoch 4/20 ****
21/33-(0.937)
3/33-(0.454)
18/33-(0.890)
0/33-(0.891)

=== Evaluating Model ===
accuracy on Valid 0.7417218543046358


**** Epoch 5/20 ****
15/33-(0.581)
30/33-(1.280)
12/33-(0.419)
27/33-(0.533)

=== Evaluating Model ===
accuracy on Valid 0.6456953642384106


**** Epoch 6/20 ****
9/33-(0.661)
24/33-(0.772)
6/33-(1.113)

=== Evaluating Model ===
accuracy on Valid 0.7450331125827815


**** Epoch 7/20 ****
21/33-(0.489)
3/33-(0.428)
18/33-(0.635)
0/33-(0.518)

=== Evaluating Model ===
accuracy on Valid 0.7152317880794702


**** Epoch 8/20 ****
15/33-(0.405)
30/33-(0.139)
12/33-(0.649)
27/33-(0.944)

=== Evaluating Model ===
accuracy on Valid 0.6920529801324503


**** Epoch 9/20 ****
9/33-(0.468)
24/33-(1.025)
6/33-(0.499)
21/33-(0.176)

=== Evaluating Model ===
accuracy on Valid 0.7218543046357616


**** Epoch 10/20 ****
3/33-(0.276)
18/33-(0.225)
0/33-(0.270)

=== Evaluating Model ===
accuracy on Valid 0.6821192052980133


**** Epoch 11/20 ****
15/33-(0.578)
30/33-(0.184)
12/33-(0.812)
27/33-(1.001)

=== Evaluating Model ===
accuracy on Valid 0.6324503311258278


**** Epoch 12/20 ****
9/33-(0.361)
24/33-(0.211)
6/33-(0.121)
21/33-(0.342)

=== Evaluating Model ===
accuracy on Valid 0.6456953642384106


**** Epoch 13/20 ****
3/33-(0.310)
18/33-(0.219)
0/33-(0.732)
15/33-(0.300)

=== Evaluating Model ===
accuracy on Valid 0.7019867549668874


**** Epoch 14/20 ****
30/33-(0.142)
12/33-(0.254)
27/33-(0.275)

=== Evaluating Model ===
accuracy on Valid 0.6456953642384106


**** Epoch 15/20 ****
9/33-(0.294)
24/33-(0.757)
6/33-(0.261)
21/33-(0.143)

=== Evaluating Model ===
accuracy on Valid 0.6821192052980133


**** Epoch 16/20 ****
3/33-(0.410)
18/33-(0.210)
0/33-(0.277)
15/33-(0.541)

=== Evaluating Model ===
accuracy on Valid 0.7185430463576159


**** Epoch 17/20 ****
30/33-(0.219)
12/33-(0.279)
27/33-(0.697)

=== Evaluating Model ===
accuracy on Valid 0.7284768211920529


**** Epoch 18/20 ****
9/33-(0.131)
24/33-(0.071)
6/33-(0.787)
21/33-(0.327)

=== Evaluating Model ===
accuracy on Valid 0.6986754966887417


**** Epoch 19/20 ****
3/33-(0.105)
18/33-(0.048)
Best accuracy on Test 0.6788079470198676

Source domain: 4, Target domain: 4, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

context_weight True
base_encoder.encoder.model.mask_emb True
base_encoder.encoder.model.word_embedding.weight True
base_encoder.encoder.model.layer.0.rel_attn.q True
base_encoder.encoder.model.layer.0.rel_attn.k True
base_encoder.encoder.model.layer.0.rel_attn.v True
base_encoder.encoder.model.layer.0.rel_attn.o True
base_encoder.encoder.model.layer.0.rel_attn.r True
base_encoder.encoder.model.layer.0.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.0.rel_attn.seg_embed True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_norm.weight True
base_encoder.encoder.model.layer.0.ff.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_1.weight True
base_encoder.encoder.model.layer.0.ff.layer_1.bias True
base_encoder.encoder.model.layer.0.ff.layer_2.weight True
base_encoder.encoder.model.layer.0.ff.layer_2.bias True
base_encoder.encoder.model.layer.1.rel_attn.q True
base_encoder.encoder.model.layer.1.rel_attn.k True
base_encoder.encoder.model.layer.1.rel_attn.v True
base_encoder.encoder.model.layer.1.rel_attn.o True
base_encoder.encoder.model.layer.1.rel_attn.r True
base_encoder.encoder.model.layer.1.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.1.rel_attn.seg_embed True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_norm.weight True
base_encoder.encoder.model.layer.1.ff.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_1.weight True
base_encoder.encoder.model.layer.1.ff.layer_1.bias True
base_encoder.encoder.model.layer.1.ff.layer_2.weight True
base_encoder.encoder.model.layer.1.ff.layer_2.bias True
base_encoder.encoder.model.layer.2.rel_attn.q True
base_encoder.encoder.model.layer.2.rel_attn.k True
base_encoder.encoder.model.layer.2.rel_attn.v True
base_encoder.encoder.model.layer.2.rel_attn.o True
base_encoder.encoder.model.layer.2.rel_attn.r True
base_encoder.encoder.model.layer.2.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.2.rel_attn.seg_embed True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_norm.weight True
base_encoder.encoder.model.layer.2.ff.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_1.weight True
base_encoder.encoder.model.layer.2.ff.layer_1.bias True
base_encoder.encoder.model.layer.2.ff.layer_2.weight True
base_encoder.encoder.model.layer.2.ff.layer_2.bias True
base_encoder.encoder.model.layer.3.rel_attn.q True
base_encoder.encoder.model.layer.3.rel_attn.k True
base_encoder.encoder.model.layer.3.rel_attn.v True
base_encoder.encoder.model.layer.3.rel_attn.o True
base_encoder.encoder.model.layer.3.rel_attn.r True
base_encoder.encoder.model.layer.3.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.3.rel_attn.seg_embed True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_norm.weight True
base_encoder.encoder.model.layer.3.ff.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_1.weight True
base_encoder.encoder.model.layer.3.ff.layer_1.bias True
base_encoder.encoder.model.layer.3.ff.layer_2.weight True
base_encoder.encoder.model.layer.3.ff.layer_2.bias True
base_encoder.encoder.model.layer.4.rel_attn.q True
base_encoder.encoder.model.layer.4.rel_attn.k True
base_encoder.encoder.model.layer.4.rel_attn.v True
base_encoder.encoder.model.layer.4.rel_attn.o True
base_encoder.encoder.model.layer.4.rel_attn.r True
base_encoder.encoder.model.layer.4.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.4.rel_attn.seg_embed True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_norm.weight True
base_encoder.encoder.model.layer.4.ff.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_1.weight True
base_encoder.encoder.model.layer.4.ff.layer_1.bias True
base_encoder.encoder.model.layer.4.ff.layer_2.weight True
base_encoder.encoder.model.layer.4.ff.layer_2.bias True
base_encoder.encoder.model.layer.5.rel_attn.q True
base_encoder.encoder.model.layer.5.rel_attn.k True
base_encoder.encoder.model.layer.5.rel_attn.v True
base_encoder.encoder.model.layer.5.rel_attn.o True
base_encoder.encoder.model.layer.5.rel_attn.r True
base_encoder.encoder.model.layer.5.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.5.rel_attn.seg_embed True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_norm.weight True
base_encoder.encoder.model.layer.5.ff.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_1.weight True
base_encoder.encoder.model.layer.5.ff.layer_1.bias True
base_encoder.encoder.model.layer.5.ff.layer_2.weight True
base_encoder.encoder.model.layer.5.ff.layer_2.bias True
base_encoder.encoder.model.layer.6.rel_attn.q True
base_encoder.encoder.model.layer.6.rel_attn.k True
base_encoder.encoder.model.layer.6.rel_attn.v True
base_encoder.encoder.model.layer.6.rel_attn.o True
base_encoder.encoder.model.layer.6.rel_attn.r True
base_encoder.encoder.model.layer.6.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.6.rel_attn.seg_embed True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_norm.weight True
base_encoder.encoder.model.layer.6.ff.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_1.weight True
base_encoder.encoder.model.layer.6.ff.layer_1.bias True
base_encoder.encoder.model.layer.6.ff.layer_2.weight True
base_encoder.encoder.model.layer.6.ff.layer_2.bias True
base_encoder.encoder.model.layer.7.rel_attn.q True
base_encoder.encoder.model.layer.7.rel_attn.k True
base_encoder.encoder.model.layer.7.rel_attn.v True
base_encoder.encoder.model.layer.7.rel_attn.o True
base_encoder.encoder.model.layer.7.rel_attn.r True
base_encoder.encoder.model.layer.7.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.7.rel_attn.seg_embed True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_norm.weight True
base_encoder.encoder.model.layer.7.ff.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_1.weight True
base_encoder.encoder.model.layer.7.ff.layer_1.bias True
base_encoder.encoder.model.layer.7.ff.layer_2.weight True
base_encoder.encoder.model.layer.7.ff.layer_2.bias True
base_encoder.encoder.model.layer.8.rel_attn.q True
base_encoder.encoder.model.layer.8.rel_attn.k True
base_encoder.encoder.model.layer.8.rel_attn.v True
base_encoder.encoder.model.layer.8.rel_attn.o True
base_encoder.encoder.model.layer.8.rel_attn.r True
base_encoder.encoder.model.layer.8.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.8.rel_attn.seg_embed True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_norm.weight True
base_encoder.encoder.model.layer.8.ff.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_1.weight True
base_encoder.encoder.model.layer.8.ff.layer_1.bias True
base_encoder.encoder.model.layer.8.ff.layer_2.weight True
base_encoder.encoder.model.layer.8.ff.layer_2.bias True
base_encoder.encoder.model.layer.9.rel_attn.q True
base_encoder.encoder.model.layer.9.rel_attn.k True
base_encoder.encoder.model.layer.9.rel_attn.v True
base_encoder.encoder.model.layer.9.rel_attn.o True
base_encoder.encoder.model.layer.9.rel_attn.r True
base_encoder.encoder.model.layer.9.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.9.rel_attn.seg_embed True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_norm.weight True
base_encoder.encoder.model.layer.9.ff.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_1.weight True
base_encoder.encoder.model.layer.9.ff.layer_1.bias True
base_encoder.encoder.model.layer.9.ff.layer_2.weight True
base_encoder.encoder.model.layer.9.ff.layer_2.bias True
base_encoder.encoder.model.layer.10.rel_attn.q True
base_encoder.encoder.model.layer.10.rel_attn.k True
base_encoder.encoder.model.layer.10.rel_attn.v True
base_encoder.encoder.model.layer.10.rel_attn.o True
base_encoder.encoder.model.layer.10.rel_attn.r True
base_encoder.encoder.model.layer.10.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.10.rel_attn.seg_embed True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_norm.weight True
base_encoder.encoder.model.layer.10.ff.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_1.weight True
base_encoder.encoder.model.layer.10.ff.layer_1.bias True
base_encoder.encoder.model.layer.10.ff.layer_2.weight True
base_encoder.encoder.model.layer.10.ff.layer_2.bias True
base_encoder.encoder.model.layer.11.rel_attn.q True
base_encoder.encoder.model.layer.11.rel_attn.k True
base_encoder.encoder.model.layer.11.rel_attn.v True
base_encoder.encoder.model.layer.11.rel_attn.o True
base_encoder.encoder.model.layer.11.rel_attn.r True
base_encoder.encoder.model.layer.11.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.11.rel_attn.seg_embed True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_norm.weight True
base_encoder.encoder.model.layer.11.ff.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_1.weight True
base_encoder.encoder.model.layer.11.ff.layer_1.bias True
base_encoder.encoder.model.layer.11.ff.layer_2.weight True
base_encoder.encoder.model.layer.11.ff.layer_2.bias True
tt_encoder.layers.0.self_attn.linears.0.weight True
tt_encoder.layers.0.self_attn.linears.0.bias True
tt_encoder.layers.0.self_attn.linears.1.weight True
tt_encoder.layers.0.self_attn.linears.1.bias True
tt_encoder.layers.0.self_attn.linears.2.weight True
tt_encoder.layers.0.self_attn.linears.2.bias True
tt_encoder.layers.0.self_attn.linears.3.weight True
tt_encoder.layers.0.self_attn.linears.3.bias True
tt_encoder.layers.0.feed_forward.w_1.weight True
tt_encoder.layers.0.feed_forward.w_1.bias True
tt_encoder.layers.0.feed_forward.w_2.weight True
tt_encoder.layers.0.feed_forward.w_2.bias True
tt_encoder.layers.0.group_attn.linear_key.weight True
tt_encoder.layers.0.group_attn.linear_key.bias True
tt_encoder.layers.0.group_attn.linear_query.weight True
tt_encoder.layers.0.group_attn.linear_query.bias True
tt_encoder.layers.0.group_attn.norm.a_2 True
tt_encoder.layers.0.group_attn.norm.b_2 True
tt_encoder.layers.0.sublayer.0.norm.a_2 True
tt_encoder.layers.0.sublayer.0.norm.b_2 True
tt_encoder.layers.0.sublayer.1.norm.a_2 True
tt_encoder.layers.0.sublayer.1.norm.b_2 True
tt_encoder.layers.1.self_attn.linears.0.weight True
tt_encoder.layers.1.self_attn.linears.0.bias True
tt_encoder.layers.1.self_attn.linears.1.weight True
tt_encoder.layers.1.self_attn.linears.1.bias True
tt_encoder.layers.1.self_attn.linears.2.weight True
tt_encoder.layers.1.self_attn.linears.2.bias True
tt_encoder.layers.1.self_attn.linears.3.weight True
tt_encoder.layers.1.self_attn.linears.3.bias True
tt_encoder.layers.1.feed_forward.w_1.weight True
tt_encoder.layers.1.feed_forward.w_1.bias True
tt_encoder.layers.1.feed_forward.w_2.weight True
tt_encoder.layers.1.feed_forward.w_2.bias True
tt_encoder.layers.1.group_attn.linear_key.weight True
tt_encoder.layers.1.group_attn.linear_key.bias True
tt_encoder.layers.1.group_attn.linear_query.weight True
tt_encoder.layers.1.group_attn.linear_query.bias True
tt_encoder.layers.1.group_attn.norm.a_2 True
tt_encoder.layers.1.group_attn.norm.b_2 True
tt_encoder.layers.1.sublayer.0.norm.a_2 True
tt_encoder.layers.1.sublayer.0.norm.b_2 True
tt_encoder.layers.1.sublayer.1.norm.a_2 True
tt_encoder.layers.1.sublayer.1.norm.b_2 True
tt_encoder.layers.2.self_attn.linears.0.weight True
tt_encoder.layers.2.self_attn.linears.0.bias True
tt_encoder.layers.2.self_attn.linears.1.weight True
tt_encoder.layers.2.self_attn.linears.1.bias True
tt_encoder.layers.2.self_attn.linears.2.weight True
tt_encoder.layers.2.self_attn.linears.2.bias True
tt_encoder.layers.2.self_attn.linears.3.weight True
tt_encoder.layers.2.self_attn.linears.3.bias True
tt_encoder.layers.2.feed_forward.w_1.weight True
tt_encoder.layers.2.feed_forward.w_1.bias True
tt_encoder.layers.2.feed_forward.w_2.weight True
tt_encoder.layers.2.feed_forward.w_2.bias True
tt_encoder.layers.2.group_attn.linear_key.weight True
tt_encoder.layers.2.group_attn.linear_key.bias True
tt_encoder.layers.2.group_attn.linear_query.weight True
tt_encoder.layers.2.group_attn.linear_query.bias True
tt_encoder.layers.2.group_attn.norm.a_2 True
tt_encoder.layers.2.group_attn.norm.b_2 True
tt_encoder.layers.2.sublayer.0.norm.a_2 True
tt_encoder.layers.2.sublayer.0.norm.b_2 True
tt_encoder.layers.2.sublayer.1.norm.a_2 True
tt_encoder.layers.2.sublayer.1.norm.b_2 True
tt_encoder.layers.3.self_attn.linears.0.weight True
tt_encoder.layers.3.self_attn.linears.0.bias True
tt_encoder.layers.3.self_attn.linears.1.weight True
tt_encoder.layers.3.self_attn.linears.1.bias True
tt_encoder.layers.3.self_attn.linears.2.weight True
tt_encoder.layers.3.self_attn.linears.2.bias True
tt_encoder.layers.3.self_attn.linears.3.weight True
tt_encoder.layers.3.self_attn.linears.3.bias True
tt_encoder.layers.3.feed_forward.w_1.weight True
tt_encoder.layers.3.feed_forward.w_1.bias True
tt_encoder.layers.3.feed_forward.w_2.weight True
tt_encoder.layers.3.feed_forward.w_2.bias True
tt_encoder.layers.3.group_attn.linear_key.weight True
tt_encoder.layers.3.group_attn.linear_key.bias True
tt_encoder.layers.3.group_attn.linear_query.weight True
tt_encoder.layers.3.group_attn.linear_query.bias True
tt_encoder.layers.3.group_attn.norm.a_2 True
tt_encoder.layers.3.group_attn.norm.b_2 True
tt_encoder.layers.3.sublayer.0.norm.a_2 True
tt_encoder.layers.3.sublayer.0.norm.b_2 True
tt_encoder.layers.3.sublayer.1.norm.a_2 True
tt_encoder.layers.3.sublayer.1.norm.b_2 True
tt_encoder.norm.a_2 True
tt_encoder.norm.b_2 True
linear_1.weight True
linear_1.bias True
linear_2.weight True
linear_2.bias True
linear_out.weight True
linear_out.bias True
so_linear_1.weight True
so_linear_1.bias True
so_linear_2.weight True
so_linear_2.bias True
so_linear_out.weight True
so_linear_out.bias True
layer_norm1.weight True
layer_norm1.bias True
layer_norm2.weight True
layer_norm2.bias True
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(2.306)
30/33-(1.613)
12/33-(1.245)

=== Evaluating Model ===
accuracy on Valid 0.5066225165562914

Best accuracy on Valid 0.5066225165562914
Total valid loss 1.0312525567255522
accuracy on Test 0.5397350993377483
Best accuracy on Test 0.5397350993377483

**** Epoch 0/20 ****
27/33-(1.121)
9/33-(0.934)
24/33-(1.058)
6/33-(0.960)

=== Evaluating Model ===
accuracy on Valid 0.5132450331125827

Best accuracy on Valid 0.5132450331125827
Total valid loss 0.9199404904716894
accuracy on Test 0.5496688741721855
Best accuracy on Test 0.5496688741721855

**** Epoch 1/20 ****
21/33-(0.847)
3/33-(0.846)
18/33-(1.145)
0/33-(0.795)

=== Evaluating Model ===
accuracy on Valid 0.5264900662251656

Best accuracy on Valid 0.5264900662251656
Total valid loss 0.9901071410430106
accuracy on Test 0.5198675496688742
Best accuracy on Test 0.5496688741721855

**** Epoch 2/20 ****
15/33-(1.573)
30/33-(1.369)
12/33-(0.737)

=== Evaluating Model ===
accuracy on Valid 0.5629139072847682

Best accuracy on Valid 0.5629139072847682
Total valid loss 0.751359760761261
accuracy on Test 0.5662251655629139
Best accuracy on Test 0.5662251655629139

**** Epoch 3/20 ****
27/33-(0.659)
9/33-(0.937)
24/33-(0.798)
6/33-(0.461)

=== Evaluating Model ===
accuracy on Valid 0.6589403973509934

Best accuracy on Valid 0.6589403973509934
Total valid loss 0.7003209967362253
accuracy on Test 0.6655629139072847
Best accuracy on Test 0.6655629139072847

**** Epoch 4/20 ****
21/33-(0.739)
3/33-(0.572)
18/33-(0.886)
0/33-(0.747)

=== Evaluating Model ===
accuracy on Valid 0.6423841059602649


**** Epoch 5/20 ****
15/33-(0.574)
30/33-(0.599)
12/33-(0.814)
27/33-(0.383)

=== Evaluating Model ===
accuracy on Valid 0.6754966887417219

Best accuracy on Valid 0.6754966887417219
Total valid loss 0.7604572051449826
accuracy on Test 0.6622516556291391
Best accuracy on Test 0.6655629139072847

**** Epoch 6/20 ****
9/33-(0.535)
24/33-(0.501)
6/33-(0.257)

=== Evaluating Model ===
accuracy on Valid 0.6589403973509934


**** Epoch 7/20 ****
21/33-(0.726)
3/33-(0.586)
18/33-(0.515)
0/33-(0.627)

=== Evaluating Model ===
accuracy on Valid 0.6556291390728477


**** Epoch 8/20 ****
15/33-(0.674)
30/33-(0.397)
12/33-(0.369)
27/33-(0.250)

=== Evaluating Model ===
accuracy on Valid 0.6721854304635762


**** Epoch 9/20 ****
9/33-(0.206)
24/33-(0.197)
6/33-(1.986)
21/33-(0.326)

=== Evaluating Model ===
accuracy on Valid 0.6754966887417219

Best accuracy on Valid 0.6754966887417219
Total valid loss 0.8601443751862174
accuracy on Test 0.7185430463576159
Best accuracy on Test 0.7185430463576159

**** Epoch 10/20 ****
3/33-(0.114)
18/33-(0.141)
0/33-(0.531)

=== Evaluating Model ===
accuracy on Valid 0.6721854304635762


**** Epoch 11/20 ****
15/33-(0.584)
30/33-(0.759)
12/33-(0.140)
27/33-(0.203)

=== Evaluating Model ===
accuracy on Valid 0.6390728476821192


**** Epoch 12/20 ****
9/33-(0.990)
24/33-(0.387)
6/33-(0.581)
21/33-(1.564)

=== Evaluating Model ===
accuracy on Valid 0.6986754966887417

Best accuracy on Valid 0.6986754966887417
Total valid loss 0.7548473351880124
accuracy on Test 0.7516556291390728
Best accuracy on Test 0.7516556291390728

**** Epoch 13/20 ****
3/33-(0.659)
18/33-(0.273)
0/33-(0.408)
15/33-(0.187)

=== Evaluating Model ===
accuracy on Valid 0.6655629139072847


**** Epoch 14/20 ****
30/33-(0.115)
12/33-(0.156)
27/33-(0.511)

=== Evaluating Model ===
accuracy on Valid 0.6655629139072847


**** Epoch 15/20 ****
9/33-(0.266)
24/33-(0.102)
6/33-(0.427)
21/33-(0.390)

=== Evaluating Model ===
accuracy on Valid 0.6854304635761589


**** Epoch 16/20 ****
3/33-(0.197)
18/33-(0.292)
0/33-(0.199)
15/33-(0.663)

=== Evaluating Model ===
accuracy on Valid 0.6655629139072847


**** Epoch 17/20 ****
30/33-(0.123)
12/33-(1.619)
27/33-(0.273)

=== Evaluating Model ===
accuracy on Valid 0.6821192052980133


**** Epoch 18/20 ****
9/33-(0.125)
24/33-(0.102)
6/33-(0.176)
21/33-(0.540)

=== Evaluating Model ===
accuracy on Valid 0.6754966887417219


**** Epoch 19/20 ****
3/33-(0.342)
18/33-(0.629)
Best accuracy on Test 0.7516556291390728

Source domain: 4, Target domain: 4, Cur_fold 3
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

context_weight True
base_encoder.encoder.model.mask_emb True
base_encoder.encoder.model.word_embedding.weight True
base_encoder.encoder.model.layer.0.rel_attn.q True
base_encoder.encoder.model.layer.0.rel_attn.k True
base_encoder.encoder.model.layer.0.rel_attn.v True
base_encoder.encoder.model.layer.0.rel_attn.o True
base_encoder.encoder.model.layer.0.rel_attn.r True
base_encoder.encoder.model.layer.0.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.0.rel_attn.seg_embed True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_norm.weight True
base_encoder.encoder.model.layer.0.ff.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_1.weight True
base_encoder.encoder.model.layer.0.ff.layer_1.bias True
base_encoder.encoder.model.layer.0.ff.layer_2.weight True
base_encoder.encoder.model.layer.0.ff.layer_2.bias True
base_encoder.encoder.model.layer.1.rel_attn.q True
base_encoder.encoder.model.layer.1.rel_attn.k True
base_encoder.encoder.model.layer.1.rel_attn.v True
base_encoder.encoder.model.layer.1.rel_attn.o True
base_encoder.encoder.model.layer.1.rel_attn.r True
base_encoder.encoder.model.layer.1.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.1.rel_attn.seg_embed True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_norm.weight True
base_encoder.encoder.model.layer.1.ff.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_1.weight True
base_encoder.encoder.model.layer.1.ff.layer_1.bias True
base_encoder.encoder.model.layer.1.ff.layer_2.weight True
base_encoder.encoder.model.layer.1.ff.layer_2.bias True
base_encoder.encoder.model.layer.2.rel_attn.q True
base_encoder.encoder.model.layer.2.rel_attn.k True
base_encoder.encoder.model.layer.2.rel_attn.v True
base_encoder.encoder.model.layer.2.rel_attn.o True
base_encoder.encoder.model.layer.2.rel_attn.r True
base_encoder.encoder.model.layer.2.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.2.rel_attn.seg_embed True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_norm.weight True
base_encoder.encoder.model.layer.2.ff.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_1.weight True
base_encoder.encoder.model.layer.2.ff.layer_1.bias True
base_encoder.encoder.model.layer.2.ff.layer_2.weight True
base_encoder.encoder.model.layer.2.ff.layer_2.bias True
base_encoder.encoder.model.layer.3.rel_attn.q True
base_encoder.encoder.model.layer.3.rel_attn.k True
base_encoder.encoder.model.layer.3.rel_attn.v True
base_encoder.encoder.model.layer.3.rel_attn.o True
base_encoder.encoder.model.layer.3.rel_attn.r True
base_encoder.encoder.model.layer.3.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.3.rel_attn.seg_embed True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_norm.weight True
base_encoder.encoder.model.layer.3.ff.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_1.weight True
base_encoder.encoder.model.layer.3.ff.layer_1.bias True
base_encoder.encoder.model.layer.3.ff.layer_2.weight True
base_encoder.encoder.model.layer.3.ff.layer_2.bias True
base_encoder.encoder.model.layer.4.rel_attn.q True
base_encoder.encoder.model.layer.4.rel_attn.k True
base_encoder.encoder.model.layer.4.rel_attn.v True
base_encoder.encoder.model.layer.4.rel_attn.o True
base_encoder.encoder.model.layer.4.rel_attn.r True
base_encoder.encoder.model.layer.4.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.4.rel_attn.seg_embed True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_norm.weight True
base_encoder.encoder.model.layer.4.ff.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_1.weight True
base_encoder.encoder.model.layer.4.ff.layer_1.bias True
base_encoder.encoder.model.layer.4.ff.layer_2.weight True
base_encoder.encoder.model.layer.4.ff.layer_2.bias True
base_encoder.encoder.model.layer.5.rel_attn.q True
base_encoder.encoder.model.layer.5.rel_attn.k True
base_encoder.encoder.model.layer.5.rel_attn.v True
base_encoder.encoder.model.layer.5.rel_attn.o True
base_encoder.encoder.model.layer.5.rel_attn.r True
base_encoder.encoder.model.layer.5.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.5.rel_attn.seg_embed True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_norm.weight True
base_encoder.encoder.model.layer.5.ff.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_1.weight True
base_encoder.encoder.model.layer.5.ff.layer_1.bias True
base_encoder.encoder.model.layer.5.ff.layer_2.weight True
base_encoder.encoder.model.layer.5.ff.layer_2.bias True
base_encoder.encoder.model.layer.6.rel_attn.q True
base_encoder.encoder.model.layer.6.rel_attn.k True
base_encoder.encoder.model.layer.6.rel_attn.v True
base_encoder.encoder.model.layer.6.rel_attn.o True
base_encoder.encoder.model.layer.6.rel_attn.r True
base_encoder.encoder.model.layer.6.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.6.rel_attn.seg_embed True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_norm.weight True
base_encoder.encoder.model.layer.6.ff.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_1.weight True
base_encoder.encoder.model.layer.6.ff.layer_1.bias True
base_encoder.encoder.model.layer.6.ff.layer_2.weight True
base_encoder.encoder.model.layer.6.ff.layer_2.bias True
base_encoder.encoder.model.layer.7.rel_attn.q True
base_encoder.encoder.model.layer.7.rel_attn.k True
base_encoder.encoder.model.layer.7.rel_attn.v True
base_encoder.encoder.model.layer.7.rel_attn.o True
base_encoder.encoder.model.layer.7.rel_attn.r True
base_encoder.encoder.model.layer.7.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.7.rel_attn.seg_embed True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_norm.weight True
base_encoder.encoder.model.layer.7.ff.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_1.weight True
base_encoder.encoder.model.layer.7.ff.layer_1.bias True
base_encoder.encoder.model.layer.7.ff.layer_2.weight True
base_encoder.encoder.model.layer.7.ff.layer_2.bias True
base_encoder.encoder.model.layer.8.rel_attn.q True
base_encoder.encoder.model.layer.8.rel_attn.k True
base_encoder.encoder.model.layer.8.rel_attn.v True
base_encoder.encoder.model.layer.8.rel_attn.o True
base_encoder.encoder.model.layer.8.rel_attn.r True
base_encoder.encoder.model.layer.8.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.8.rel_attn.seg_embed True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_norm.weight True
base_encoder.encoder.model.layer.8.ff.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_1.weight True
base_encoder.encoder.model.layer.8.ff.layer_1.bias True
base_encoder.encoder.model.layer.8.ff.layer_2.weight True
base_encoder.encoder.model.layer.8.ff.layer_2.bias True
base_encoder.encoder.model.layer.9.rel_attn.q True
base_encoder.encoder.model.layer.9.rel_attn.k True
base_encoder.encoder.model.layer.9.rel_attn.v True
base_encoder.encoder.model.layer.9.rel_attn.o True
base_encoder.encoder.model.layer.9.rel_attn.r True
base_encoder.encoder.model.layer.9.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.9.rel_attn.seg_embed True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_norm.weight True
base_encoder.encoder.model.layer.9.ff.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_1.weight True
base_encoder.encoder.model.layer.9.ff.layer_1.bias True
base_encoder.encoder.model.layer.9.ff.layer_2.weight True
base_encoder.encoder.model.layer.9.ff.layer_2.bias True
base_encoder.encoder.model.layer.10.rel_attn.q True
base_encoder.encoder.model.layer.10.rel_attn.k True
base_encoder.encoder.model.layer.10.rel_attn.v True
base_encoder.encoder.model.layer.10.rel_attn.o True
base_encoder.encoder.model.layer.10.rel_attn.r True
base_encoder.encoder.model.layer.10.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.10.rel_attn.seg_embed True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_norm.weight True
base_encoder.encoder.model.layer.10.ff.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_1.weight True
base_encoder.encoder.model.layer.10.ff.layer_1.bias True
base_encoder.encoder.model.layer.10.ff.layer_2.weight True
base_encoder.encoder.model.layer.10.ff.layer_2.bias True
base_encoder.encoder.model.layer.11.rel_attn.q True
base_encoder.encoder.model.layer.11.rel_attn.k True
base_encoder.encoder.model.layer.11.rel_attn.v True
base_encoder.encoder.model.layer.11.rel_attn.o True
base_encoder.encoder.model.layer.11.rel_attn.r True
base_encoder.encoder.model.layer.11.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.11.rel_attn.seg_embed True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_norm.weight True
base_encoder.encoder.model.layer.11.ff.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_1.weight True
base_encoder.encoder.model.layer.11.ff.layer_1.bias True
base_encoder.encoder.model.layer.11.ff.layer_2.weight True
base_encoder.encoder.model.layer.11.ff.layer_2.bias True
tt_encoder.layers.0.self_attn.linears.0.weight True
tt_encoder.layers.0.self_attn.linears.0.bias True
tt_encoder.layers.0.self_attn.linears.1.weight True
tt_encoder.layers.0.self_attn.linears.1.bias True
tt_encoder.layers.0.self_attn.linears.2.weight True
tt_encoder.layers.0.self_attn.linears.2.bias True
tt_encoder.layers.0.self_attn.linears.3.weight True
tt_encoder.layers.0.self_attn.linears.3.bias True
tt_encoder.layers.0.feed_forward.w_1.weight True
tt_encoder.layers.0.feed_forward.w_1.bias True
tt_encoder.layers.0.feed_forward.w_2.weight True
tt_encoder.layers.0.feed_forward.w_2.bias True
tt_encoder.layers.0.group_attn.linear_key.weight True
tt_encoder.layers.0.group_attn.linear_key.bias True
tt_encoder.layers.0.group_attn.linear_query.weight True
tt_encoder.layers.0.group_attn.linear_query.bias True
tt_encoder.layers.0.group_attn.norm.a_2 True
tt_encoder.layers.0.group_attn.norm.b_2 True
tt_encoder.layers.0.sublayer.0.norm.a_2 True
tt_encoder.layers.0.sublayer.0.norm.b_2 True
tt_encoder.layers.0.sublayer.1.norm.a_2 True
tt_encoder.layers.0.sublayer.1.norm.b_2 True
tt_encoder.layers.1.self_attn.linears.0.weight True
tt_encoder.layers.1.self_attn.linears.0.bias True
tt_encoder.layers.1.self_attn.linears.1.weight True
tt_encoder.layers.1.self_attn.linears.1.bias True
tt_encoder.layers.1.self_attn.linears.2.weight True
tt_encoder.layers.1.self_attn.linears.2.bias True
tt_encoder.layers.1.self_attn.linears.3.weight True
tt_encoder.layers.1.self_attn.linears.3.bias True
tt_encoder.layers.1.feed_forward.w_1.weight True
tt_encoder.layers.1.feed_forward.w_1.bias True
tt_encoder.layers.1.feed_forward.w_2.weight True
tt_encoder.layers.1.feed_forward.w_2.bias True
tt_encoder.layers.1.group_attn.linear_key.weight True
tt_encoder.layers.1.group_attn.linear_key.bias True
tt_encoder.layers.1.group_attn.linear_query.weight True
tt_encoder.layers.1.group_attn.linear_query.bias True
tt_encoder.layers.1.group_attn.norm.a_2 True
tt_encoder.layers.1.group_attn.norm.b_2 True
tt_encoder.layers.1.sublayer.0.norm.a_2 True
tt_encoder.layers.1.sublayer.0.norm.b_2 True
tt_encoder.layers.1.sublayer.1.norm.a_2 True
tt_encoder.layers.1.sublayer.1.norm.b_2 True
tt_encoder.layers.2.self_attn.linears.0.weight True
tt_encoder.layers.2.self_attn.linears.0.bias True
tt_encoder.layers.2.self_attn.linears.1.weight True
tt_encoder.layers.2.self_attn.linears.1.bias True
tt_encoder.layers.2.self_attn.linears.2.weight True
tt_encoder.layers.2.self_attn.linears.2.bias True
tt_encoder.layers.2.self_attn.linears.3.weight True
tt_encoder.layers.2.self_attn.linears.3.bias True
tt_encoder.layers.2.feed_forward.w_1.weight True
tt_encoder.layers.2.feed_forward.w_1.bias True
tt_encoder.layers.2.feed_forward.w_2.weight True
tt_encoder.layers.2.feed_forward.w_2.bias True
tt_encoder.layers.2.group_attn.linear_key.weight True
tt_encoder.layers.2.group_attn.linear_key.bias True
tt_encoder.layers.2.group_attn.linear_query.weight True
tt_encoder.layers.2.group_attn.linear_query.bias True
tt_encoder.layers.2.group_attn.norm.a_2 True
tt_encoder.layers.2.group_attn.norm.b_2 True
tt_encoder.layers.2.sublayer.0.norm.a_2 True
tt_encoder.layers.2.sublayer.0.norm.b_2 True
tt_encoder.layers.2.sublayer.1.norm.a_2 True
tt_encoder.layers.2.sublayer.1.norm.b_2 True
tt_encoder.layers.3.self_attn.linears.0.weight True
tt_encoder.layers.3.self_attn.linears.0.bias True
tt_encoder.layers.3.self_attn.linears.1.weight True
tt_encoder.layers.3.self_attn.linears.1.bias True
tt_encoder.layers.3.self_attn.linears.2.weight True
tt_encoder.layers.3.self_attn.linears.2.bias True
tt_encoder.layers.3.self_attn.linears.3.weight True
tt_encoder.layers.3.self_attn.linears.3.bias True
tt_encoder.layers.3.feed_forward.w_1.weight True
tt_encoder.layers.3.feed_forward.w_1.bias True
tt_encoder.layers.3.feed_forward.w_2.weight True
tt_encoder.layers.3.feed_forward.w_2.bias True
tt_encoder.layers.3.group_attn.linear_key.weight True
tt_encoder.layers.3.group_attn.linear_key.bias True
tt_encoder.layers.3.group_attn.linear_query.weight True
tt_encoder.layers.3.group_attn.linear_query.bias True
tt_encoder.layers.3.group_attn.norm.a_2 True
tt_encoder.layers.3.group_attn.norm.b_2 True
tt_encoder.layers.3.sublayer.0.norm.a_2 True
tt_encoder.layers.3.sublayer.0.norm.b_2 True
tt_encoder.layers.3.sublayer.1.norm.a_2 True
tt_encoder.layers.3.sublayer.1.norm.b_2 True
tt_encoder.norm.a_2 True
tt_encoder.norm.b_2 True
linear_1.weight True
linear_1.bias True
linear_2.weight True
linear_2.bias True
linear_out.weight True
linear_out.bias True
so_linear_1.weight True
so_linear_1.bias True
so_linear_2.weight True
so_linear_2.bias True
so_linear_out.weight True
so_linear_out.bias True
layer_norm1.weight True
layer_norm1.bias True
layer_norm2.weight True
layer_norm2.bias True
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.724)
30/33-(1.913)
12/33-(1.597)

=== Evaluating Model ===
accuracy on Valid 0.3509933774834437

Best accuracy on Valid 0.3509933774834437
Total valid loss 1.0152986143764697
accuracy on Test 0.36423841059602646
Best accuracy on Test 0.36423841059602646

**** Epoch 0/20 ****
27/33-(1.145)
9/33-(1.381)
24/33-(1.126)
6/33-(1.106)

=== Evaluating Model ===
accuracy on Valid 0.6059602649006622

Best accuracy on Valid 0.6059602649006622
Total valid loss 0.895592495014793
accuracy on Test 0.5794701986754967
Best accuracy on Test 0.5794701986754967

**** Epoch 1/20 ****
21/33-(0.883)
3/33-(1.347)
18/33-(1.000)
0/33-(1.021)

=== Evaluating Model ===
accuracy on Valid 0.7218543046357616

Best accuracy on Valid 0.7218543046357616
Total valid loss 0.6401919989209426
accuracy on Test 0.7086092715231788
Best accuracy on Test 0.7086092715231788

**** Epoch 2/20 ****
15/33-(0.793)
30/33-(0.497)
12/33-(0.792)

=== Evaluating Model ===
accuracy on Valid 0.7019867549668874


**** Epoch 3/20 ****
27/33-(0.893)
9/33-(0.646)
24/33-(0.946)
6/33-(0.860)

=== Evaluating Model ===
accuracy on Valid 0.6622516556291391


**** Epoch 4/20 ****
21/33-(0.946)
3/33-(0.894)
18/33-(0.754)
0/33-(0.404)

=== Evaluating Model ===
accuracy on Valid 0.7649006622516556

Best accuracy on Valid 0.7649006622516556
Total valid loss 0.6254660016612003
accuracy on Test 0.7350993377483444
Best accuracy on Test 0.7350993377483444

**** Epoch 5/20 ****
15/33-(0.602)
30/33-(0.583)
12/33-(0.637)
27/33-(0.723)

=== Evaluating Model ===
accuracy on Valid 0.7251655629139073


**** Epoch 6/20 ****
9/33-(0.675)
24/33-(0.463)
6/33-(0.185)

=== Evaluating Model ===
accuracy on Valid 0.7450331125827815


**** Epoch 7/20 ****
21/33-(0.464)
3/33-(0.352)
18/33-(0.677)
0/33-(0.500)

=== Evaluating Model ===
accuracy on Valid 0.6721854304635762


**** Epoch 8/20 ****
15/33-(0.961)
30/33-(0.404)
12/33-(0.419)
27/33-(0.718)

=== Evaluating Model ===
accuracy on Valid 0.7417218543046358


**** Epoch 9/20 ****
9/33-(0.154)
24/33-(1.295)
6/33-(0.181)
21/33-(0.315)

=== Evaluating Model ===
accuracy on Valid 0.7185430463576159


**** Epoch 10/20 ****
3/33-(0.470)
18/33-(0.238)
0/33-(0.194)

=== Evaluating Model ===
accuracy on Valid 0.7615894039735099


**** Epoch 11/20 ****
15/33-(0.285)
30/33-(0.387)
12/33-(0.320)
27/33-(0.649)

=== Evaluating Model ===
accuracy on Valid 0.7185430463576159


**** Epoch 12/20 ****
9/33-(0.236)
24/33-(0.466)
6/33-(0.791)
21/33-(0.339)

=== Evaluating Model ===
accuracy on Valid 0.6721854304635762


**** Epoch 13/20 ****
3/33-(0.358)
18/33-(0.676)
0/33-(0.234)
15/33-(0.215)

=== Evaluating Model ===
accuracy on Valid 0.7152317880794702


**** Epoch 14/20 ****
30/33-(0.496)
12/33-(0.700)
27/33-(0.943)

=== Evaluating Model ===
accuracy on Valid 0.7350993377483444


**** Epoch 15/20 ****
9/33-(0.121)
24/33-(0.240)
6/33-(0.568)
21/33-(0.147)

=== Evaluating Model ===
accuracy on Valid 0.7086092715231788


**** Epoch 16/20 ****
3/33-(1.263)
18/33-(0.139)
0/33-(0.076)
15/33-(0.700)

=== Evaluating Model ===
accuracy on Valid 0.6821192052980133


**** Epoch 17/20 ****
30/33-(0.214)
12/33-(0.115)
27/33-(0.138)

=== Evaluating Model ===
accuracy on Valid 0.6887417218543046


**** Epoch 18/20 ****
9/33-(0.409)
24/33-(0.713)
6/33-(0.628)
21/33-(0.277)

=== Evaluating Model ===
accuracy on Valid 0.7450331125827815


**** Epoch 19/20 ****
3/33-(0.878)
18/33-(0.091)
Best accuracy on Test 0.7350993377483444

Source domain: 4, Target domain: 4, Cur_fold 4
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

context_weight True
base_encoder.encoder.model.mask_emb True
base_encoder.encoder.model.word_embedding.weight True
base_encoder.encoder.model.layer.0.rel_attn.q True
base_encoder.encoder.model.layer.0.rel_attn.k True
base_encoder.encoder.model.layer.0.rel_attn.v True
base_encoder.encoder.model.layer.0.rel_attn.o True
base_encoder.encoder.model.layer.0.rel_attn.r True
base_encoder.encoder.model.layer.0.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.0.rel_attn.seg_embed True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_norm.weight True
base_encoder.encoder.model.layer.0.ff.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_1.weight True
base_encoder.encoder.model.layer.0.ff.layer_1.bias True
base_encoder.encoder.model.layer.0.ff.layer_2.weight True
base_encoder.encoder.model.layer.0.ff.layer_2.bias True
base_encoder.encoder.model.layer.1.rel_attn.q True
base_encoder.encoder.model.layer.1.rel_attn.k True
base_encoder.encoder.model.layer.1.rel_attn.v True
base_encoder.encoder.model.layer.1.rel_attn.o True
base_encoder.encoder.model.layer.1.rel_attn.r True
base_encoder.encoder.model.layer.1.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.1.rel_attn.seg_embed True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_norm.weight True
base_encoder.encoder.model.layer.1.ff.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_1.weight True
base_encoder.encoder.model.layer.1.ff.layer_1.bias True
base_encoder.encoder.model.layer.1.ff.layer_2.weight True
base_encoder.encoder.model.layer.1.ff.layer_2.bias True
base_encoder.encoder.model.layer.2.rel_attn.q True
base_encoder.encoder.model.layer.2.rel_attn.k True
base_encoder.encoder.model.layer.2.rel_attn.v True
base_encoder.encoder.model.layer.2.rel_attn.o True
base_encoder.encoder.model.layer.2.rel_attn.r True
base_encoder.encoder.model.layer.2.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.2.rel_attn.seg_embed True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_norm.weight True
base_encoder.encoder.model.layer.2.ff.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_1.weight True
base_encoder.encoder.model.layer.2.ff.layer_1.bias True
base_encoder.encoder.model.layer.2.ff.layer_2.weight True
base_encoder.encoder.model.layer.2.ff.layer_2.bias True
base_encoder.encoder.model.layer.3.rel_attn.q True
base_encoder.encoder.model.layer.3.rel_attn.k True
base_encoder.encoder.model.layer.3.rel_attn.v True
base_encoder.encoder.model.layer.3.rel_attn.o True
base_encoder.encoder.model.layer.3.rel_attn.r True
base_encoder.encoder.model.layer.3.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.3.rel_attn.seg_embed True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_norm.weight True
base_encoder.encoder.model.layer.3.ff.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_1.weight True
base_encoder.encoder.model.layer.3.ff.layer_1.bias True
base_encoder.encoder.model.layer.3.ff.layer_2.weight True
base_encoder.encoder.model.layer.3.ff.layer_2.bias True
base_encoder.encoder.model.layer.4.rel_attn.q True
base_encoder.encoder.model.layer.4.rel_attn.k True
base_encoder.encoder.model.layer.4.rel_attn.v True
base_encoder.encoder.model.layer.4.rel_attn.o True
base_encoder.encoder.model.layer.4.rel_attn.r True
base_encoder.encoder.model.layer.4.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.4.rel_attn.seg_embed True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_norm.weight True
base_encoder.encoder.model.layer.4.ff.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_1.weight True
base_encoder.encoder.model.layer.4.ff.layer_1.bias True
base_encoder.encoder.model.layer.4.ff.layer_2.weight True
base_encoder.encoder.model.layer.4.ff.layer_2.bias True
base_encoder.encoder.model.layer.5.rel_attn.q True
base_encoder.encoder.model.layer.5.rel_attn.k True
base_encoder.encoder.model.layer.5.rel_attn.v True
base_encoder.encoder.model.layer.5.rel_attn.o True
base_encoder.encoder.model.layer.5.rel_attn.r True
base_encoder.encoder.model.layer.5.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.5.rel_attn.seg_embed True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_norm.weight True
base_encoder.encoder.model.layer.5.ff.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_1.weight True
base_encoder.encoder.model.layer.5.ff.layer_1.bias True
base_encoder.encoder.model.layer.5.ff.layer_2.weight True
base_encoder.encoder.model.layer.5.ff.layer_2.bias True
base_encoder.encoder.model.layer.6.rel_attn.q True
base_encoder.encoder.model.layer.6.rel_attn.k True
base_encoder.encoder.model.layer.6.rel_attn.v True
base_encoder.encoder.model.layer.6.rel_attn.o True
base_encoder.encoder.model.layer.6.rel_attn.r True
base_encoder.encoder.model.layer.6.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.6.rel_attn.seg_embed True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_norm.weight True
base_encoder.encoder.model.layer.6.ff.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_1.weight True
base_encoder.encoder.model.layer.6.ff.layer_1.bias True
base_encoder.encoder.model.layer.6.ff.layer_2.weight True
base_encoder.encoder.model.layer.6.ff.layer_2.bias True
base_encoder.encoder.model.layer.7.rel_attn.q True
base_encoder.encoder.model.layer.7.rel_attn.k True
base_encoder.encoder.model.layer.7.rel_attn.v True
base_encoder.encoder.model.layer.7.rel_attn.o True
base_encoder.encoder.model.layer.7.rel_attn.r True
base_encoder.encoder.model.layer.7.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.7.rel_attn.seg_embed True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_norm.weight True
base_encoder.encoder.model.layer.7.ff.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_1.weight True
base_encoder.encoder.model.layer.7.ff.layer_1.bias True
base_encoder.encoder.model.layer.7.ff.layer_2.weight True
base_encoder.encoder.model.layer.7.ff.layer_2.bias True
base_encoder.encoder.model.layer.8.rel_attn.q True
base_encoder.encoder.model.layer.8.rel_attn.k True
base_encoder.encoder.model.layer.8.rel_attn.v True
base_encoder.encoder.model.layer.8.rel_attn.o True
base_encoder.encoder.model.layer.8.rel_attn.r True
base_encoder.encoder.model.layer.8.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.8.rel_attn.seg_embed True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_norm.weight True
base_encoder.encoder.model.layer.8.ff.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_1.weight True
base_encoder.encoder.model.layer.8.ff.layer_1.bias True
base_encoder.encoder.model.layer.8.ff.layer_2.weight True
base_encoder.encoder.model.layer.8.ff.layer_2.bias True
base_encoder.encoder.model.layer.9.rel_attn.q True
base_encoder.encoder.model.layer.9.rel_attn.k True
base_encoder.encoder.model.layer.9.rel_attn.v True
base_encoder.encoder.model.layer.9.rel_attn.o True
base_encoder.encoder.model.layer.9.rel_attn.r True
base_encoder.encoder.model.layer.9.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.9.rel_attn.seg_embed True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_norm.weight True
base_encoder.encoder.model.layer.9.ff.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_1.weight True
base_encoder.encoder.model.layer.9.ff.layer_1.bias True
base_encoder.encoder.model.layer.9.ff.layer_2.weight True
base_encoder.encoder.model.layer.9.ff.layer_2.bias True
base_encoder.encoder.model.layer.10.rel_attn.q True
base_encoder.encoder.model.layer.10.rel_attn.k True
base_encoder.encoder.model.layer.10.rel_attn.v True
base_encoder.encoder.model.layer.10.rel_attn.o True
base_encoder.encoder.model.layer.10.rel_attn.r True
base_encoder.encoder.model.layer.10.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.10.rel_attn.seg_embed True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_norm.weight True
base_encoder.encoder.model.layer.10.ff.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_1.weight True
base_encoder.encoder.model.layer.10.ff.layer_1.bias True
base_encoder.encoder.model.layer.10.ff.layer_2.weight True
base_encoder.encoder.model.layer.10.ff.layer_2.bias True
base_encoder.encoder.model.layer.11.rel_attn.q True
base_encoder.encoder.model.layer.11.rel_attn.k True
base_encoder.encoder.model.layer.11.rel_attn.v True
base_encoder.encoder.model.layer.11.rel_attn.o True
base_encoder.encoder.model.layer.11.rel_attn.r True
base_encoder.encoder.model.layer.11.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.11.rel_attn.seg_embed True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_norm.weight True
base_encoder.encoder.model.layer.11.ff.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_1.weight True
base_encoder.encoder.model.layer.11.ff.layer_1.bias True
base_encoder.encoder.model.layer.11.ff.layer_2.weight True
base_encoder.encoder.model.layer.11.ff.layer_2.bias True
tt_encoder.layers.0.self_attn.linears.0.weight True
tt_encoder.layers.0.self_attn.linears.0.bias True
tt_encoder.layers.0.self_attn.linears.1.weight True
tt_encoder.layers.0.self_attn.linears.1.bias True
tt_encoder.layers.0.self_attn.linears.2.weight True
tt_encoder.layers.0.self_attn.linears.2.bias True
tt_encoder.layers.0.self_attn.linears.3.weight True
tt_encoder.layers.0.self_attn.linears.3.bias True
tt_encoder.layers.0.feed_forward.w_1.weight True
tt_encoder.layers.0.feed_forward.w_1.bias True
tt_encoder.layers.0.feed_forward.w_2.weight True
tt_encoder.layers.0.feed_forward.w_2.bias True
tt_encoder.layers.0.group_attn.linear_key.weight True
tt_encoder.layers.0.group_attn.linear_key.bias True
tt_encoder.layers.0.group_attn.linear_query.weight True
tt_encoder.layers.0.group_attn.linear_query.bias True
tt_encoder.layers.0.group_attn.norm.a_2 True
tt_encoder.layers.0.group_attn.norm.b_2 True
tt_encoder.layers.0.sublayer.0.norm.a_2 True
tt_encoder.layers.0.sublayer.0.norm.b_2 True
tt_encoder.layers.0.sublayer.1.norm.a_2 True
tt_encoder.layers.0.sublayer.1.norm.b_2 True
tt_encoder.layers.1.self_attn.linears.0.weight True
tt_encoder.layers.1.self_attn.linears.0.bias True
tt_encoder.layers.1.self_attn.linears.1.weight True
tt_encoder.layers.1.self_attn.linears.1.bias True
tt_encoder.layers.1.self_attn.linears.2.weight True
tt_encoder.layers.1.self_attn.linears.2.bias True
tt_encoder.layers.1.self_attn.linears.3.weight True
tt_encoder.layers.1.self_attn.linears.3.bias True
tt_encoder.layers.1.feed_forward.w_1.weight True
tt_encoder.layers.1.feed_forward.w_1.bias True
tt_encoder.layers.1.feed_forward.w_2.weight True
tt_encoder.layers.1.feed_forward.w_2.bias True
tt_encoder.layers.1.group_attn.linear_key.weight True
tt_encoder.layers.1.group_attn.linear_key.bias True
tt_encoder.layers.1.group_attn.linear_query.weight True
tt_encoder.layers.1.group_attn.linear_query.bias True
tt_encoder.layers.1.group_attn.norm.a_2 True
tt_encoder.layers.1.group_attn.norm.b_2 True
tt_encoder.layers.1.sublayer.0.norm.a_2 True
tt_encoder.layers.1.sublayer.0.norm.b_2 True
tt_encoder.layers.1.sublayer.1.norm.a_2 True
tt_encoder.layers.1.sublayer.1.norm.b_2 True
tt_encoder.layers.2.self_attn.linears.0.weight True
tt_encoder.layers.2.self_attn.linears.0.bias True
tt_encoder.layers.2.self_attn.linears.1.weight True
tt_encoder.layers.2.self_attn.linears.1.bias True
tt_encoder.layers.2.self_attn.linears.2.weight True
tt_encoder.layers.2.self_attn.linears.2.bias True
tt_encoder.layers.2.self_attn.linears.3.weight True
tt_encoder.layers.2.self_attn.linears.3.bias True
tt_encoder.layers.2.feed_forward.w_1.weight True
tt_encoder.layers.2.feed_forward.w_1.bias True
tt_encoder.layers.2.feed_forward.w_2.weight True
tt_encoder.layers.2.feed_forward.w_2.bias True
tt_encoder.layers.2.group_attn.linear_key.weight True
tt_encoder.layers.2.group_attn.linear_key.bias True
tt_encoder.layers.2.group_attn.linear_query.weight True
tt_encoder.layers.2.group_attn.linear_query.bias True
tt_encoder.layers.2.group_attn.norm.a_2 True
tt_encoder.layers.2.group_attn.norm.b_2 True
tt_encoder.layers.2.sublayer.0.norm.a_2 True
tt_encoder.layers.2.sublayer.0.norm.b_2 True
tt_encoder.layers.2.sublayer.1.norm.a_2 True
tt_encoder.layers.2.sublayer.1.norm.b_2 True
tt_encoder.layers.3.self_attn.linears.0.weight True
tt_encoder.layers.3.self_attn.linears.0.bias True
tt_encoder.layers.3.self_attn.linears.1.weight True
tt_encoder.layers.3.self_attn.linears.1.bias True
tt_encoder.layers.3.self_attn.linears.2.weight True
tt_encoder.layers.3.self_attn.linears.2.bias True
tt_encoder.layers.3.self_attn.linears.3.weight True
tt_encoder.layers.3.self_attn.linears.3.bias True
tt_encoder.layers.3.feed_forward.w_1.weight True
tt_encoder.layers.3.feed_forward.w_1.bias True
tt_encoder.layers.3.feed_forward.w_2.weight True
tt_encoder.layers.3.feed_forward.w_2.bias True
tt_encoder.layers.3.group_attn.linear_key.weight True
tt_encoder.layers.3.group_attn.linear_key.bias True
tt_encoder.layers.3.group_attn.linear_query.weight True
tt_encoder.layers.3.group_attn.linear_query.bias True
tt_encoder.layers.3.group_attn.norm.a_2 True
tt_encoder.layers.3.group_attn.norm.b_2 True
tt_encoder.layers.3.sublayer.0.norm.a_2 True
tt_encoder.layers.3.sublayer.0.norm.b_2 True
tt_encoder.layers.3.sublayer.1.norm.a_2 True
tt_encoder.layers.3.sublayer.1.norm.b_2 True
tt_encoder.norm.a_2 True
tt_encoder.norm.b_2 True
linear_1.weight True
linear_1.bias True
linear_2.weight True
linear_2.bias True
linear_out.weight True
linear_out.bias True
so_linear_1.weight True
so_linear_1.bias True
so_linear_2.weight True
so_linear_2.bias True
so_linear_out.weight True
so_linear_out.bias True
layer_norm1.weight True
layer_norm1.bias True
layer_norm2.weight True
layer_norm2.bias True
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.607)
30/33-(1.694)
12/33-(1.540)

=== Evaluating Model ===
accuracy on Valid 0.5780730897009967

Best accuracy on Valid 0.5780730897009967
Total valid loss 0.888093418196628
accuracy on Test 0.5331125827814569
Best accuracy on Test 0.5331125827814569

**** Epoch 0/20 ****
27/33-(1.360)
9/33-(1.020)
24/33-(0.691)
6/33-(1.145)

=== Evaluating Model ===
accuracy on Valid 0.53156146179402


**** Epoch 1/20 ****
21/33-(0.883)
3/33-(1.082)
18/33-(0.973)
0/33-(0.707)

=== Evaluating Model ===
accuracy on Valid 0.4983388704318937


**** Epoch 2/20 ****
15/33-(1.236)
30/33-(0.621)
12/33-(0.822)

=== Evaluating Model ===
accuracy on Valid 0.717607973421927

Best accuracy on Valid 0.717607973421927
Total valid loss 0.5549222968126598
accuracy on Test 0.7450331125827815
Best accuracy on Test 0.7450331125827815

**** Epoch 3/20 ****
27/33-(0.647)
9/33-(0.571)
24/33-(0.962)
6/33-(0.671)

=== Evaluating Model ===
accuracy on Valid 0.717607973421927

Best accuracy on Valid 0.717607973421927
Total valid loss 0.6378523785816995
accuracy on Test 0.7218543046357616
Best accuracy on Test 0.7450331125827815

**** Epoch 4/20 ****
21/33-(0.638)
3/33-(1.166)
18/33-(0.647)
0/33-(0.904)

=== Evaluating Model ===
accuracy on Valid 0.6810631229235881


**** Epoch 5/20 ****
15/33-(1.197)
30/33-(0.805)
12/33-(0.486)
27/33-(0.710)

=== Evaluating Model ===
accuracy on Valid 0.6411960132890365


**** Epoch 6/20 ****
9/33-(0.661)
24/33-(1.300)
6/33-(0.473)

=== Evaluating Model ===
accuracy on Valid 0.6179401993355482


**** Epoch 7/20 ****
21/33-(0.802)
3/33-(0.390)
18/33-(0.295)
0/33-(0.278)

=== Evaluating Model ===
accuracy on Valid 0.6312292358803987


**** Epoch 8/20 ****
15/33-(0.622)
30/33-(0.280)
12/33-(1.394)
27/33-(0.581)

=== Evaluating Model ===
accuracy on Valid 0.5780730897009967


**** Epoch 9/20 ****
9/33-(0.509)
24/33-(0.553)
6/33-(0.326)
21/33-(0.484)

=== Evaluating Model ===
accuracy on Valid 0.6943521594684385


**** Epoch 10/20 ****
3/33-(1.177)
18/33-(0.436)
0/33-(0.371)

=== Evaluating Model ===
accuracy on Valid 0.6777408637873754


**** Epoch 11/20 ****
15/33-(0.323)
30/33-(0.364)
12/33-(0.243)
27/33-(0.238)

=== Evaluating Model ===
accuracy on Valid 0.6079734219269103


**** Epoch 12/20 ****
9/33-(0.334)
24/33-(0.277)
6/33-(0.122)
21/33-(0.275)

=== Evaluating Model ===
accuracy on Valid 0.7408637873754153

Best accuracy on Valid 0.7408637873754153
Total valid loss 0.8410285726973885
accuracy on Test 0.7317880794701986
Best accuracy on Test 0.7450331125827815

**** Epoch 13/20 ****
3/33-(0.409)
18/33-(0.283)
0/33-(0.279)
15/33-(0.240)

=== Evaluating Model ===
accuracy on Valid 0.6843853820598007


**** Epoch 14/20 ****
30/33-(0.816)
12/33-(0.500)
27/33-(0.515)

=== Evaluating Model ===
accuracy on Valid 0.6578073089700996


**** Epoch 15/20 ****
9/33-(0.926)
24/33-(0.097)
6/33-(0.448)
21/33-(0.177)

=== Evaluating Model ===
accuracy on Valid 0.6976744186046512


**** Epoch 16/20 ****
3/33-(0.530)
18/33-(0.311)
0/33-(0.325)
15/33-(0.169)

=== Evaluating Model ===
accuracy on Valid 0.6810631229235881


**** Epoch 17/20 ****
30/33-(1.257)
12/33-(0.261)
27/33-(0.361)

=== Evaluating Model ===
accuracy on Valid 0.7009966777408638


**** Epoch 18/20 ****
9/33-(0.548)
24/33-(0.810)
6/33-(0.243)
21/33-(0.254)

=== Evaluating Model ===
accuracy on Valid 0.6777408637873754


**** Epoch 19/20 ****
3/33-(0.143)
18/33-(0.773)
Best accuracy on Test 0.7450331125827815

Final k-fold valid 0.7302765615718027
[0.7218543046357616, 0.7483443708609272, 0.6986754966887417, 0.7649006622516556, 0.717607973421927]
Final k-fold eval 0.7203251853644584
[0.6910299003322259, 0.6788079470198676, 0.7516556291390728, 0.7350993377483444, 0.7450331125827815]
