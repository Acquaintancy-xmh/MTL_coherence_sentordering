Whole k-fold eval mode
Source domain: 8, Target domain: 8, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

context_weight True
base_encoder.encoder.model.mask_emb True
base_encoder.encoder.model.word_embedding.weight True
base_encoder.encoder.model.layer.0.rel_attn.q True
base_encoder.encoder.model.layer.0.rel_attn.k True
base_encoder.encoder.model.layer.0.rel_attn.v True
base_encoder.encoder.model.layer.0.rel_attn.o True
base_encoder.encoder.model.layer.0.rel_attn.r True
base_encoder.encoder.model.layer.0.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.0.rel_attn.seg_embed True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_norm.weight True
base_encoder.encoder.model.layer.0.ff.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_1.weight True
base_encoder.encoder.model.layer.0.ff.layer_1.bias True
base_encoder.encoder.model.layer.0.ff.layer_2.weight True
base_encoder.encoder.model.layer.0.ff.layer_2.bias True
base_encoder.encoder.model.layer.1.rel_attn.q True
base_encoder.encoder.model.layer.1.rel_attn.k True
base_encoder.encoder.model.layer.1.rel_attn.v True
base_encoder.encoder.model.layer.1.rel_attn.o True
base_encoder.encoder.model.layer.1.rel_attn.r True
base_encoder.encoder.model.layer.1.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.1.rel_attn.seg_embed True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_norm.weight True
base_encoder.encoder.model.layer.1.ff.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_1.weight True
base_encoder.encoder.model.layer.1.ff.layer_1.bias True
base_encoder.encoder.model.layer.1.ff.layer_2.weight True
base_encoder.encoder.model.layer.1.ff.layer_2.bias True
base_encoder.encoder.model.layer.2.rel_attn.q True
base_encoder.encoder.model.layer.2.rel_attn.k True
base_encoder.encoder.model.layer.2.rel_attn.v True
base_encoder.encoder.model.layer.2.rel_attn.o True
base_encoder.encoder.model.layer.2.rel_attn.r True
base_encoder.encoder.model.layer.2.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.2.rel_attn.seg_embed True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_norm.weight True
base_encoder.encoder.model.layer.2.ff.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_1.weight True
base_encoder.encoder.model.layer.2.ff.layer_1.bias True
base_encoder.encoder.model.layer.2.ff.layer_2.weight True
base_encoder.encoder.model.layer.2.ff.layer_2.bias True
base_encoder.encoder.model.layer.3.rel_attn.q True
base_encoder.encoder.model.layer.3.rel_attn.k True
base_encoder.encoder.model.layer.3.rel_attn.v True
base_encoder.encoder.model.layer.3.rel_attn.o True
base_encoder.encoder.model.layer.3.rel_attn.r True
base_encoder.encoder.model.layer.3.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.3.rel_attn.seg_embed True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_norm.weight True
base_encoder.encoder.model.layer.3.ff.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_1.weight True
base_encoder.encoder.model.layer.3.ff.layer_1.bias True
base_encoder.encoder.model.layer.3.ff.layer_2.weight True
base_encoder.encoder.model.layer.3.ff.layer_2.bias True
base_encoder.encoder.model.layer.4.rel_attn.q True
base_encoder.encoder.model.layer.4.rel_attn.k True
base_encoder.encoder.model.layer.4.rel_attn.v True
base_encoder.encoder.model.layer.4.rel_attn.o True
base_encoder.encoder.model.layer.4.rel_attn.r True
base_encoder.encoder.model.layer.4.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.4.rel_attn.seg_embed True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_norm.weight True
base_encoder.encoder.model.layer.4.ff.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_1.weight True
base_encoder.encoder.model.layer.4.ff.layer_1.bias True
base_encoder.encoder.model.layer.4.ff.layer_2.weight True
base_encoder.encoder.model.layer.4.ff.layer_2.bias True
base_encoder.encoder.model.layer.5.rel_attn.q True
base_encoder.encoder.model.layer.5.rel_attn.k True
base_encoder.encoder.model.layer.5.rel_attn.v True
base_encoder.encoder.model.layer.5.rel_attn.o True
base_encoder.encoder.model.layer.5.rel_attn.r True
base_encoder.encoder.model.layer.5.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.5.rel_attn.seg_embed True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_norm.weight True
base_encoder.encoder.model.layer.5.ff.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_1.weight True
base_encoder.encoder.model.layer.5.ff.layer_1.bias True
base_encoder.encoder.model.layer.5.ff.layer_2.weight True
base_encoder.encoder.model.layer.5.ff.layer_2.bias True
base_encoder.encoder.model.layer.6.rel_attn.q True
base_encoder.encoder.model.layer.6.rel_attn.k True
base_encoder.encoder.model.layer.6.rel_attn.v True
base_encoder.encoder.model.layer.6.rel_attn.o True
base_encoder.encoder.model.layer.6.rel_attn.r True
base_encoder.encoder.model.layer.6.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.6.rel_attn.seg_embed True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_norm.weight True
base_encoder.encoder.model.layer.6.ff.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_1.weight True
base_encoder.encoder.model.layer.6.ff.layer_1.bias True
base_encoder.encoder.model.layer.6.ff.layer_2.weight True
base_encoder.encoder.model.layer.6.ff.layer_2.bias True
base_encoder.encoder.model.layer.7.rel_attn.q True
base_encoder.encoder.model.layer.7.rel_attn.k True
base_encoder.encoder.model.layer.7.rel_attn.v True
base_encoder.encoder.model.layer.7.rel_attn.o True
base_encoder.encoder.model.layer.7.rel_attn.r True
base_encoder.encoder.model.layer.7.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.7.rel_attn.seg_embed True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_norm.weight True
base_encoder.encoder.model.layer.7.ff.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_1.weight True
base_encoder.encoder.model.layer.7.ff.layer_1.bias True
base_encoder.encoder.model.layer.7.ff.layer_2.weight True
base_encoder.encoder.model.layer.7.ff.layer_2.bias True
base_encoder.encoder.model.layer.8.rel_attn.q True
base_encoder.encoder.model.layer.8.rel_attn.k True
base_encoder.encoder.model.layer.8.rel_attn.v True
base_encoder.encoder.model.layer.8.rel_attn.o True
base_encoder.encoder.model.layer.8.rel_attn.r True
base_encoder.encoder.model.layer.8.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.8.rel_attn.seg_embed True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_norm.weight True
base_encoder.encoder.model.layer.8.ff.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_1.weight True
base_encoder.encoder.model.layer.8.ff.layer_1.bias True
base_encoder.encoder.model.layer.8.ff.layer_2.weight True
base_encoder.encoder.model.layer.8.ff.layer_2.bias True
base_encoder.encoder.model.layer.9.rel_attn.q True
base_encoder.encoder.model.layer.9.rel_attn.k True
base_encoder.encoder.model.layer.9.rel_attn.v True
base_encoder.encoder.model.layer.9.rel_attn.o True
base_encoder.encoder.model.layer.9.rel_attn.r True
base_encoder.encoder.model.layer.9.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.9.rel_attn.seg_embed True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_norm.weight True
base_encoder.encoder.model.layer.9.ff.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_1.weight True
base_encoder.encoder.model.layer.9.ff.layer_1.bias True
base_encoder.encoder.model.layer.9.ff.layer_2.weight True
base_encoder.encoder.model.layer.9.ff.layer_2.bias True
base_encoder.encoder.model.layer.10.rel_attn.q True
base_encoder.encoder.model.layer.10.rel_attn.k True
base_encoder.encoder.model.layer.10.rel_attn.v True
base_encoder.encoder.model.layer.10.rel_attn.o True
base_encoder.encoder.model.layer.10.rel_attn.r True
base_encoder.encoder.model.layer.10.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.10.rel_attn.seg_embed True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_norm.weight True
base_encoder.encoder.model.layer.10.ff.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_1.weight True
base_encoder.encoder.model.layer.10.ff.layer_1.bias True
base_encoder.encoder.model.layer.10.ff.layer_2.weight True
base_encoder.encoder.model.layer.10.ff.layer_2.bias True
base_encoder.encoder.model.layer.11.rel_attn.q True
base_encoder.encoder.model.layer.11.rel_attn.k True
base_encoder.encoder.model.layer.11.rel_attn.v True
base_encoder.encoder.model.layer.11.rel_attn.o True
base_encoder.encoder.model.layer.11.rel_attn.r True
base_encoder.encoder.model.layer.11.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.11.rel_attn.seg_embed True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_norm.weight True
base_encoder.encoder.model.layer.11.ff.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_1.weight True
base_encoder.encoder.model.layer.11.ff.layer_1.bias True
base_encoder.encoder.model.layer.11.ff.layer_2.weight True
base_encoder.encoder.model.layer.11.ff.layer_2.bias True
tt_encoder.layers.0.self_attn.linears.0.weight True
tt_encoder.layers.0.self_attn.linears.0.bias True
tt_encoder.layers.0.self_attn.linears.1.weight True
tt_encoder.layers.0.self_attn.linears.1.bias True
tt_encoder.layers.0.self_attn.linears.2.weight True
tt_encoder.layers.0.self_attn.linears.2.bias True
tt_encoder.layers.0.self_attn.linears.3.weight True
tt_encoder.layers.0.self_attn.linears.3.bias True
tt_encoder.layers.0.feed_forward.w_1.weight True
tt_encoder.layers.0.feed_forward.w_1.bias True
tt_encoder.layers.0.feed_forward.w_2.weight True
tt_encoder.layers.0.feed_forward.w_2.bias True
tt_encoder.layers.0.group_attn.linear_key.weight True
tt_encoder.layers.0.group_attn.linear_key.bias True
tt_encoder.layers.0.group_attn.linear_query.weight True
tt_encoder.layers.0.group_attn.linear_query.bias True
tt_encoder.layers.0.group_attn.norm.a_2 True
tt_encoder.layers.0.group_attn.norm.b_2 True
tt_encoder.layers.0.sublayer.0.norm.a_2 True
tt_encoder.layers.0.sublayer.0.norm.b_2 True
tt_encoder.layers.0.sublayer.1.norm.a_2 True
tt_encoder.layers.0.sublayer.1.norm.b_2 True
tt_encoder.layers.1.self_attn.linears.0.weight True
tt_encoder.layers.1.self_attn.linears.0.bias True
tt_encoder.layers.1.self_attn.linears.1.weight True
tt_encoder.layers.1.self_attn.linears.1.bias True
tt_encoder.layers.1.self_attn.linears.2.weight True
tt_encoder.layers.1.self_attn.linears.2.bias True
tt_encoder.layers.1.self_attn.linears.3.weight True
tt_encoder.layers.1.self_attn.linears.3.bias True
tt_encoder.layers.1.feed_forward.w_1.weight True
tt_encoder.layers.1.feed_forward.w_1.bias True
tt_encoder.layers.1.feed_forward.w_2.weight True
tt_encoder.layers.1.feed_forward.w_2.bias True
tt_encoder.layers.1.group_attn.linear_key.weight True
tt_encoder.layers.1.group_attn.linear_key.bias True
tt_encoder.layers.1.group_attn.linear_query.weight True
tt_encoder.layers.1.group_attn.linear_query.bias True
tt_encoder.layers.1.group_attn.norm.a_2 True
tt_encoder.layers.1.group_attn.norm.b_2 True
tt_encoder.layers.1.sublayer.0.norm.a_2 True
tt_encoder.layers.1.sublayer.0.norm.b_2 True
tt_encoder.layers.1.sublayer.1.norm.a_2 True
tt_encoder.layers.1.sublayer.1.norm.b_2 True
tt_encoder.layers.2.self_attn.linears.0.weight True
tt_encoder.layers.2.self_attn.linears.0.bias True
tt_encoder.layers.2.self_attn.linears.1.weight True
tt_encoder.layers.2.self_attn.linears.1.bias True
tt_encoder.layers.2.self_attn.linears.2.weight True
tt_encoder.layers.2.self_attn.linears.2.bias True
tt_encoder.layers.2.self_attn.linears.3.weight True
tt_encoder.layers.2.self_attn.linears.3.bias True
tt_encoder.layers.2.feed_forward.w_1.weight True
tt_encoder.layers.2.feed_forward.w_1.bias True
tt_encoder.layers.2.feed_forward.w_2.weight True
tt_encoder.layers.2.feed_forward.w_2.bias True
tt_encoder.layers.2.group_attn.linear_key.weight True
tt_encoder.layers.2.group_attn.linear_key.bias True
tt_encoder.layers.2.group_attn.linear_query.weight True
tt_encoder.layers.2.group_attn.linear_query.bias True
tt_encoder.layers.2.group_attn.norm.a_2 True
tt_encoder.layers.2.group_attn.norm.b_2 True
tt_encoder.layers.2.sublayer.0.norm.a_2 True
tt_encoder.layers.2.sublayer.0.norm.b_2 True
tt_encoder.layers.2.sublayer.1.norm.a_2 True
tt_encoder.layers.2.sublayer.1.norm.b_2 True
tt_encoder.layers.3.self_attn.linears.0.weight True
tt_encoder.layers.3.self_attn.linears.0.bias True
tt_encoder.layers.3.self_attn.linears.1.weight True
tt_encoder.layers.3.self_attn.linears.1.bias True
tt_encoder.layers.3.self_attn.linears.2.weight True
tt_encoder.layers.3.self_attn.linears.2.bias True
tt_encoder.layers.3.self_attn.linears.3.weight True
tt_encoder.layers.3.self_attn.linears.3.bias True
tt_encoder.layers.3.feed_forward.w_1.weight True
tt_encoder.layers.3.feed_forward.w_1.bias True
tt_encoder.layers.3.feed_forward.w_2.weight True
tt_encoder.layers.3.feed_forward.w_2.bias True
tt_encoder.layers.3.group_attn.linear_key.weight True
tt_encoder.layers.3.group_attn.linear_key.bias True
tt_encoder.layers.3.group_attn.linear_query.weight True
tt_encoder.layers.3.group_attn.linear_query.bias True
tt_encoder.layers.3.group_attn.norm.a_2 True
tt_encoder.layers.3.group_attn.norm.b_2 True
tt_encoder.layers.3.sublayer.0.norm.a_2 True
tt_encoder.layers.3.sublayer.0.norm.b_2 True
tt_encoder.layers.3.sublayer.1.norm.a_2 True
tt_encoder.layers.3.sublayer.1.norm.b_2 True
tt_encoder.norm.a_2 True
tt_encoder.norm.b_2 True
linear_1.weight True
linear_1.bias True
linear_2.weight True
linear_2.bias True
linear_out.weight True
linear_out.bias True
so_linear_1.weight True
so_linear_1.bias True
so_linear_2.weight True
so_linear_2.bias True
so_linear_out.weight True
so_linear_out.bias True
layer_norm1.weight True
layer_norm1.bias True
layer_norm2.weight True
layer_norm2.bias True
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.878)
30/33-(1.564)
12/33-(0.817)
27/33-(1.103)

=== Evaluating Model ===
accuracy on Valid 0.4880952380952381

Best accuracy on Valid 0.4880952380952381
Total valid loss 0.9633925273304894
accuracy on Test 0.5059523809523809
Best accuracy on Test 0.5059523809523809

**** Epoch 0/20 ****
9/33-(1.114)
24/33-(0.725)
6/33-(0.902)
21/33-(1.047)

=== Evaluating Model ===
accuracy on Valid 0.47619047619047616


**** Epoch 1/20 ****
3/33-(0.873)
18/33-(1.399)
0/33-(0.826)
15/33-(0.857)

=== Evaluating Model ===
accuracy on Valid 0.7053571428571429

Best accuracy on Valid 0.7053571428571429
Total valid loss 0.6200857772713616
accuracy on Test 0.6994047619047619
Best accuracy on Test 0.6994047619047619

**** Epoch 2/20 ****
30/33-(0.955)
12/33-(1.036)
27/33-(1.237)
9/33-(0.785)

=== Evaluating Model ===
accuracy on Valid 0.6755952380952381


**** Epoch 3/20 ****
24/33-(0.651)
6/33-(1.033)
21/33-(0.832)
3/33-(0.711)
18/33-(0.983)

=== Evaluating Model ===
accuracy on Valid 0.7053571428571429

Best accuracy on Valid 0.7053571428571429
Total valid loss 0.5871445181823912
accuracy on Test 0.7321428571428571
Best accuracy on Test 0.7321428571428571

**** Epoch 4/20 ****
0/33-(0.786)
15/33-(0.914)
30/33-(0.795)
12/33-(0.697)

=== Evaluating Model ===
accuracy on Valid 0.6339285714285714


**** Epoch 5/20 ****
27/33-(0.630)
9/33-(0.654)
24/33-(0.608)
6/33-(0.653)

=== Evaluating Model ===
accuracy on Valid 0.6815476190476191


**** Epoch 6/20 ****
21/33-(0.703)
3/33-(0.885)
18/33-(0.374)
0/33-(0.726)

=== Evaluating Model ===
accuracy on Valid 0.6755952380952381


**** Epoch 7/20 ****
15/33-(0.780)
30/33-(0.834)
12/33-(0.506)
27/33-(0.600)

=== Evaluating Model ===
accuracy on Valid 0.7113095238095238

Best accuracy on Valid 0.7113095238095238
Total valid loss 0.6557230012757438
accuracy on Test 0.7142857142857143
Best accuracy on Test 0.7321428571428571

**** Epoch 8/20 ****
9/33-(0.833)
24/33-(0.839)
6/33-(0.594)
21/33-(0.421)
3/33-(0.605)

=== Evaluating Model ===
accuracy on Valid 0.6428571428571429


**** Epoch 9/20 ****
18/33-(0.560)
0/33-(0.993)
15/33-(0.329)
30/33-(0.448)

=== Evaluating Model ===
accuracy on Valid 0.6904761904761905


**** Epoch 10/20 ****
12/33-(0.686)
27/33-(0.577)
9/33-(0.363)
24/33-(0.745)

=== Evaluating Model ===
accuracy on Valid 0.6726190476190477


**** Epoch 11/20 ****
6/33-(1.012)
21/33-(0.399)
3/33-(0.227)
18/33-(0.326)

=== Evaluating Model ===
accuracy on Valid 0.6785714285714286


**** Epoch 12/20 ****
0/33-(0.310)
15/33-(0.512)
30/33-(0.580)
12/33-(0.343)

=== Evaluating Model ===
accuracy on Valid 0.7023809523809523


**** Epoch 13/20 ****
27/33-(0.371)
9/33-(0.489)
24/33-(0.265)
6/33-(0.859)
21/33-(0.629)

=== Evaluating Model ===
accuracy on Valid 0.6875


**** Epoch 14/20 ****
3/33-(0.046)
18/33-(0.477)
0/33-(0.594)
15/33-(0.499)

=== Evaluating Model ===
accuracy on Valid 0.7053571428571429


**** Epoch 15/20 ****
30/33-(0.281)
12/33-(0.206)
27/33-(0.432)
9/33-(0.423)

=== Evaluating Model ===
accuracy on Valid 0.6875


**** Epoch 16/20 ****
24/33-(0.509)
6/33-(0.261)
21/33-(0.135)
3/33-(0.148)

=== Evaluating Model ===
accuracy on Valid 0.6904761904761905


**** Epoch 17/20 ****
18/33-(0.551)
0/33-(0.094)
15/33-(0.076)
30/33-(0.227)

=== Evaluating Model ===
accuracy on Valid 0.6458333333333334


**** Epoch 18/20 ****
12/33-(0.583)
27/33-(0.491)
9/33-(0.097)
24/33-(0.075)
6/33-(0.039)

=== Evaluating Model ===
accuracy on Valid 0.6815476190476191


**** Epoch 19/20 ****
21/33-(0.436)
Best accuracy on Test 0.7321428571428571

Source domain: 8, Target domain: 8, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

context_weight True
base_encoder.encoder.model.mask_emb True
base_encoder.encoder.model.word_embedding.weight True
base_encoder.encoder.model.layer.0.rel_attn.q True
base_encoder.encoder.model.layer.0.rel_attn.k True
base_encoder.encoder.model.layer.0.rel_attn.v True
base_encoder.encoder.model.layer.0.rel_attn.o True
base_encoder.encoder.model.layer.0.rel_attn.r True
base_encoder.encoder.model.layer.0.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.0.rel_attn.seg_embed True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_norm.weight True
base_encoder.encoder.model.layer.0.ff.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_1.weight True
base_encoder.encoder.model.layer.0.ff.layer_1.bias True
base_encoder.encoder.model.layer.0.ff.layer_2.weight True
base_encoder.encoder.model.layer.0.ff.layer_2.bias True
base_encoder.encoder.model.layer.1.rel_attn.q True
base_encoder.encoder.model.layer.1.rel_attn.k True
base_encoder.encoder.model.layer.1.rel_attn.v True
base_encoder.encoder.model.layer.1.rel_attn.o True
base_encoder.encoder.model.layer.1.rel_attn.r True
base_encoder.encoder.model.layer.1.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.1.rel_attn.seg_embed True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_norm.weight True
base_encoder.encoder.model.layer.1.ff.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_1.weight True
base_encoder.encoder.model.layer.1.ff.layer_1.bias True
base_encoder.encoder.model.layer.1.ff.layer_2.weight True
base_encoder.encoder.model.layer.1.ff.layer_2.bias True
base_encoder.encoder.model.layer.2.rel_attn.q True
base_encoder.encoder.model.layer.2.rel_attn.k True
base_encoder.encoder.model.layer.2.rel_attn.v True
base_encoder.encoder.model.layer.2.rel_attn.o True
base_encoder.encoder.model.layer.2.rel_attn.r True
base_encoder.encoder.model.layer.2.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.2.rel_attn.seg_embed True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_norm.weight True
base_encoder.encoder.model.layer.2.ff.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_1.weight True
base_encoder.encoder.model.layer.2.ff.layer_1.bias True
base_encoder.encoder.model.layer.2.ff.layer_2.weight True
base_encoder.encoder.model.layer.2.ff.layer_2.bias True
base_encoder.encoder.model.layer.3.rel_attn.q True
base_encoder.encoder.model.layer.3.rel_attn.k True
base_encoder.encoder.model.layer.3.rel_attn.v True
base_encoder.encoder.model.layer.3.rel_attn.o True
base_encoder.encoder.model.layer.3.rel_attn.r True
base_encoder.encoder.model.layer.3.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.3.rel_attn.seg_embed True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_norm.weight True
base_encoder.encoder.model.layer.3.ff.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_1.weight True
base_encoder.encoder.model.layer.3.ff.layer_1.bias True
base_encoder.encoder.model.layer.3.ff.layer_2.weight True
base_encoder.encoder.model.layer.3.ff.layer_2.bias True
base_encoder.encoder.model.layer.4.rel_attn.q True
base_encoder.encoder.model.layer.4.rel_attn.k True
base_encoder.encoder.model.layer.4.rel_attn.v True
base_encoder.encoder.model.layer.4.rel_attn.o True
base_encoder.encoder.model.layer.4.rel_attn.r True
base_encoder.encoder.model.layer.4.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.4.rel_attn.seg_embed True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_norm.weight True
base_encoder.encoder.model.layer.4.ff.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_1.weight True
base_encoder.encoder.model.layer.4.ff.layer_1.bias True
base_encoder.encoder.model.layer.4.ff.layer_2.weight True
base_encoder.encoder.model.layer.4.ff.layer_2.bias True
base_encoder.encoder.model.layer.5.rel_attn.q True
base_encoder.encoder.model.layer.5.rel_attn.k True
base_encoder.encoder.model.layer.5.rel_attn.v True
base_encoder.encoder.model.layer.5.rel_attn.o True
base_encoder.encoder.model.layer.5.rel_attn.r True
base_encoder.encoder.model.layer.5.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.5.rel_attn.seg_embed True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_norm.weight True
base_encoder.encoder.model.layer.5.ff.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_1.weight True
base_encoder.encoder.model.layer.5.ff.layer_1.bias True
base_encoder.encoder.model.layer.5.ff.layer_2.weight True
base_encoder.encoder.model.layer.5.ff.layer_2.bias True
base_encoder.encoder.model.layer.6.rel_attn.q True
base_encoder.encoder.model.layer.6.rel_attn.k True
base_encoder.encoder.model.layer.6.rel_attn.v True
base_encoder.encoder.model.layer.6.rel_attn.o True
base_encoder.encoder.model.layer.6.rel_attn.r True
base_encoder.encoder.model.layer.6.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.6.rel_attn.seg_embed True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_norm.weight True
base_encoder.encoder.model.layer.6.ff.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_1.weight True
base_encoder.encoder.model.layer.6.ff.layer_1.bias True
base_encoder.encoder.model.layer.6.ff.layer_2.weight True
base_encoder.encoder.model.layer.6.ff.layer_2.bias True
base_encoder.encoder.model.layer.7.rel_attn.q True
base_encoder.encoder.model.layer.7.rel_attn.k True
base_encoder.encoder.model.layer.7.rel_attn.v True
base_encoder.encoder.model.layer.7.rel_attn.o True
base_encoder.encoder.model.layer.7.rel_attn.r True
base_encoder.encoder.model.layer.7.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.7.rel_attn.seg_embed True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_norm.weight True
base_encoder.encoder.model.layer.7.ff.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_1.weight True
base_encoder.encoder.model.layer.7.ff.layer_1.bias True
base_encoder.encoder.model.layer.7.ff.layer_2.weight True
base_encoder.encoder.model.layer.7.ff.layer_2.bias True
base_encoder.encoder.model.layer.8.rel_attn.q True
base_encoder.encoder.model.layer.8.rel_attn.k True
base_encoder.encoder.model.layer.8.rel_attn.v True
base_encoder.encoder.model.layer.8.rel_attn.o True
base_encoder.encoder.model.layer.8.rel_attn.r True
base_encoder.encoder.model.layer.8.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.8.rel_attn.seg_embed True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_norm.weight True
base_encoder.encoder.model.layer.8.ff.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_1.weight True
base_encoder.encoder.model.layer.8.ff.layer_1.bias True
base_encoder.encoder.model.layer.8.ff.layer_2.weight True
base_encoder.encoder.model.layer.8.ff.layer_2.bias True
base_encoder.encoder.model.layer.9.rel_attn.q True
base_encoder.encoder.model.layer.9.rel_attn.k True
base_encoder.encoder.model.layer.9.rel_attn.v True
base_encoder.encoder.model.layer.9.rel_attn.o True
base_encoder.encoder.model.layer.9.rel_attn.r True
base_encoder.encoder.model.layer.9.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.9.rel_attn.seg_embed True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_norm.weight True
base_encoder.encoder.model.layer.9.ff.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_1.weight True
base_encoder.encoder.model.layer.9.ff.layer_1.bias True
base_encoder.encoder.model.layer.9.ff.layer_2.weight True
base_encoder.encoder.model.layer.9.ff.layer_2.bias True
base_encoder.encoder.model.layer.10.rel_attn.q True
base_encoder.encoder.model.layer.10.rel_attn.k True
base_encoder.encoder.model.layer.10.rel_attn.v True
base_encoder.encoder.model.layer.10.rel_attn.o True
base_encoder.encoder.model.layer.10.rel_attn.r True
base_encoder.encoder.model.layer.10.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.10.rel_attn.seg_embed True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_norm.weight True
base_encoder.encoder.model.layer.10.ff.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_1.weight True
base_encoder.encoder.model.layer.10.ff.layer_1.bias True
base_encoder.encoder.model.layer.10.ff.layer_2.weight True
base_encoder.encoder.model.layer.10.ff.layer_2.bias True
base_encoder.encoder.model.layer.11.rel_attn.q True
base_encoder.encoder.model.layer.11.rel_attn.k True
base_encoder.encoder.model.layer.11.rel_attn.v True
base_encoder.encoder.model.layer.11.rel_attn.o True
base_encoder.encoder.model.layer.11.rel_attn.r True
base_encoder.encoder.model.layer.11.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.11.rel_attn.seg_embed True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_norm.weight True
base_encoder.encoder.model.layer.11.ff.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_1.weight True
base_encoder.encoder.model.layer.11.ff.layer_1.bias True
base_encoder.encoder.model.layer.11.ff.layer_2.weight True
base_encoder.encoder.model.layer.11.ff.layer_2.bias True
tt_encoder.layers.0.self_attn.linears.0.weight True
tt_encoder.layers.0.self_attn.linears.0.bias True
tt_encoder.layers.0.self_attn.linears.1.weight True
tt_encoder.layers.0.self_attn.linears.1.bias True
tt_encoder.layers.0.self_attn.linears.2.weight True
tt_encoder.layers.0.self_attn.linears.2.bias True
tt_encoder.layers.0.self_attn.linears.3.weight True
tt_encoder.layers.0.self_attn.linears.3.bias True
tt_encoder.layers.0.feed_forward.w_1.weight True
tt_encoder.layers.0.feed_forward.w_1.bias True
tt_encoder.layers.0.feed_forward.w_2.weight True
tt_encoder.layers.0.feed_forward.w_2.bias True
tt_encoder.layers.0.group_attn.linear_key.weight True
tt_encoder.layers.0.group_attn.linear_key.bias True
tt_encoder.layers.0.group_attn.linear_query.weight True
tt_encoder.layers.0.group_attn.linear_query.bias True
tt_encoder.layers.0.group_attn.norm.a_2 True
tt_encoder.layers.0.group_attn.norm.b_2 True
tt_encoder.layers.0.sublayer.0.norm.a_2 True
tt_encoder.layers.0.sublayer.0.norm.b_2 True
tt_encoder.layers.0.sublayer.1.norm.a_2 True
tt_encoder.layers.0.sublayer.1.norm.b_2 True
tt_encoder.layers.1.self_attn.linears.0.weight True
tt_encoder.layers.1.self_attn.linears.0.bias True
tt_encoder.layers.1.self_attn.linears.1.weight True
tt_encoder.layers.1.self_attn.linears.1.bias True
tt_encoder.layers.1.self_attn.linears.2.weight True
tt_encoder.layers.1.self_attn.linears.2.bias True
tt_encoder.layers.1.self_attn.linears.3.weight True
tt_encoder.layers.1.self_attn.linears.3.bias True
tt_encoder.layers.1.feed_forward.w_1.weight True
tt_encoder.layers.1.feed_forward.w_1.bias True
tt_encoder.layers.1.feed_forward.w_2.weight True
tt_encoder.layers.1.feed_forward.w_2.bias True
tt_encoder.layers.1.group_attn.linear_key.weight True
tt_encoder.layers.1.group_attn.linear_key.bias True
tt_encoder.layers.1.group_attn.linear_query.weight True
tt_encoder.layers.1.group_attn.linear_query.bias True
tt_encoder.layers.1.group_attn.norm.a_2 True
tt_encoder.layers.1.group_attn.norm.b_2 True
tt_encoder.layers.1.sublayer.0.norm.a_2 True
tt_encoder.layers.1.sublayer.0.norm.b_2 True
tt_encoder.layers.1.sublayer.1.norm.a_2 True
tt_encoder.layers.1.sublayer.1.norm.b_2 True
tt_encoder.layers.2.self_attn.linears.0.weight True
tt_encoder.layers.2.self_attn.linears.0.bias True
tt_encoder.layers.2.self_attn.linears.1.weight True
tt_encoder.layers.2.self_attn.linears.1.bias True
tt_encoder.layers.2.self_attn.linears.2.weight True
tt_encoder.layers.2.self_attn.linears.2.bias True
tt_encoder.layers.2.self_attn.linears.3.weight True
tt_encoder.layers.2.self_attn.linears.3.bias True
tt_encoder.layers.2.feed_forward.w_1.weight True
tt_encoder.layers.2.feed_forward.w_1.bias True
tt_encoder.layers.2.feed_forward.w_2.weight True
tt_encoder.layers.2.feed_forward.w_2.bias True
tt_encoder.layers.2.group_attn.linear_key.weight True
tt_encoder.layers.2.group_attn.linear_key.bias True
tt_encoder.layers.2.group_attn.linear_query.weight True
tt_encoder.layers.2.group_attn.linear_query.bias True
tt_encoder.layers.2.group_attn.norm.a_2 True
tt_encoder.layers.2.group_attn.norm.b_2 True
tt_encoder.layers.2.sublayer.0.norm.a_2 True
tt_encoder.layers.2.sublayer.0.norm.b_2 True
tt_encoder.layers.2.sublayer.1.norm.a_2 True
tt_encoder.layers.2.sublayer.1.norm.b_2 True
tt_encoder.layers.3.self_attn.linears.0.weight True
tt_encoder.layers.3.self_attn.linears.0.bias True
tt_encoder.layers.3.self_attn.linears.1.weight True
tt_encoder.layers.3.self_attn.linears.1.bias True
tt_encoder.layers.3.self_attn.linears.2.weight True
tt_encoder.layers.3.self_attn.linears.2.bias True
tt_encoder.layers.3.self_attn.linears.3.weight True
tt_encoder.layers.3.self_attn.linears.3.bias True
tt_encoder.layers.3.feed_forward.w_1.weight True
tt_encoder.layers.3.feed_forward.w_1.bias True
tt_encoder.layers.3.feed_forward.w_2.weight True
tt_encoder.layers.3.feed_forward.w_2.bias True
tt_encoder.layers.3.group_attn.linear_key.weight True
tt_encoder.layers.3.group_attn.linear_key.bias True
tt_encoder.layers.3.group_attn.linear_query.weight True
tt_encoder.layers.3.group_attn.linear_query.bias True
tt_encoder.layers.3.group_attn.norm.a_2 True
tt_encoder.layers.3.group_attn.norm.b_2 True
tt_encoder.layers.3.sublayer.0.norm.a_2 True
tt_encoder.layers.3.sublayer.0.norm.b_2 True
tt_encoder.layers.3.sublayer.1.norm.a_2 True
tt_encoder.layers.3.sublayer.1.norm.b_2 True
tt_encoder.norm.a_2 True
tt_encoder.norm.b_2 True
linear_1.weight True
linear_1.bias True
linear_2.weight True
linear_2.bias True
linear_out.weight True
linear_out.bias True
so_linear_1.weight True
so_linear_1.bias True
so_linear_2.weight True
so_linear_2.bias True
so_linear_out.weight True
so_linear_out.bias True
layer_norm1.weight True
layer_norm1.bias True
layer_norm2.weight True
layer_norm2.bias True
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(2.883)
30/33-(1.563)
12/33-(0.959)
27/33-(1.146)

=== Evaluating Model ===
accuracy on Valid 0.5311572700296736

Best accuracy on Valid 0.5311572700296736
Total valid loss 0.915352097579411
accuracy on Test 0.5684523809523809
Best accuracy on Test 0.5684523809523809

**** Epoch 0/20 ****
9/33-(1.148)
24/33-(0.872)
6/33-(0.977)
21/33-(1.111)

=== Evaluating Model ===
accuracy on Valid 0.5667655786350149

Best accuracy on Valid 0.5667655786350149
Total valid loss 0.8973506064642043
accuracy on Test 0.5595238095238095
Best accuracy on Test 0.5684523809523809

**** Epoch 1/20 ****
3/33-(0.926)
18/33-(1.009)
0/33-(1.347)
15/33-(0.720)

=== Evaluating Model ===
accuracy on Valid 0.6498516320474778

Best accuracy on Valid 0.6498516320474778
Total valid loss 0.8237013277553377
accuracy on Test 0.6279761904761905
Best accuracy on Test 0.6279761904761905

**** Epoch 2/20 ****
30/33-(0.935)
12/33-(1.073)
27/33-(0.714)
9/33-(1.360)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Best accuracy on Valid 0.6795252225519288
Total valid loss 0.7439396750359308
accuracy on Test 0.6755952380952381
Best accuracy on Test 0.6755952380952381

**** Epoch 3/20 ****
24/33-(0.865)
6/33-(0.607)
21/33-(0.547)
3/33-(0.890)
18/33-(0.767)

=== Evaluating Model ===
accuracy on Valid 0.5548961424332344


**** Epoch 4/20 ****
0/33-(0.853)
15/33-(0.601)
30/33-(0.629)
12/33-(0.795)

=== Evaluating Model ===
accuracy on Valid 0.6439169139465876


**** Epoch 5/20 ****
27/33-(0.691)
9/33-(0.541)
24/33-(0.913)
6/33-(0.700)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Best accuracy on Valid 0.7091988130563798
Total valid loss 0.6585116996651604
accuracy on Test 0.6964285714285714
Best accuracy on Test 0.6964285714285714

**** Epoch 6/20 ****
21/33-(0.395)
3/33-(0.316)
18/33-(0.561)
0/33-(0.845)

=== Evaluating Model ===
accuracy on Valid 0.6676557863501483


**** Epoch 7/20 ****
15/33-(1.155)
30/33-(0.295)
12/33-(0.551)
27/33-(0.433)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Best accuracy on Valid 0.7091988130563798
Total valid loss 0.6967877660478864
accuracy on Test 0.6934523809523809
Best accuracy on Test 0.6964285714285714

**** Epoch 8/20 ****
9/33-(1.120)
24/33-(0.273)
6/33-(0.144)
21/33-(0.305)
3/33-(0.734)

=== Evaluating Model ===
accuracy on Valid 0.6231454005934718


**** Epoch 9/20 ****
18/33-(0.425)
0/33-(0.462)
15/33-(0.178)
30/33-(0.376)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994


**** Epoch 10/20 ****
12/33-(0.596)
27/33-(0.434)
9/33-(0.146)
24/33-(0.532)

=== Evaluating Model ===
accuracy on Valid 0.6379821958456974


**** Epoch 11/20 ****
6/33-(0.574)
21/33-(0.319)
3/33-(0.412)
18/33-(0.554)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819


**** Epoch 12/20 ****
0/33-(0.749)
15/33-(0.367)
30/33-(1.777)
12/33-(0.186)

=== Evaluating Model ===
accuracy on Valid 0.6498516320474778


**** Epoch 13/20 ****
27/33-(0.356)
9/33-(0.234)
24/33-(0.748)
6/33-(0.389)
21/33-(0.546)

=== Evaluating Model ===
accuracy on Valid 0.6617210682492581


**** Epoch 14/20 ****
3/33-(0.179)
18/33-(0.105)
0/33-(0.429)
15/33-(0.184)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347


**** Epoch 15/20 ****
30/33-(0.344)
12/33-(0.194)
27/33-(0.295)
9/33-(0.378)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896


**** Epoch 16/20 ****
24/33-(0.696)
6/33-(0.087)
21/33-(0.327)
3/33-(0.325)

=== Evaluating Model ===
accuracy on Valid 0.6824925816023739


**** Epoch 17/20 ****
18/33-(0.349)
0/33-(0.285)
15/33-(0.111)
30/33-(0.849)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288


**** Epoch 18/20 ****
12/33-(0.433)
27/33-(0.183)
9/33-(0.789)
24/33-(0.208)
6/33-(0.864)

=== Evaluating Model ===
accuracy on Valid 0.6409495548961425


**** Epoch 19/20 ****
21/33-(0.618)
Best accuracy on Test 0.6964285714285714

Source domain: 8, Target domain: 8, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

context_weight True
base_encoder.encoder.model.mask_emb True
base_encoder.encoder.model.word_embedding.weight True
base_encoder.encoder.model.layer.0.rel_attn.q True
base_encoder.encoder.model.layer.0.rel_attn.k True
base_encoder.encoder.model.layer.0.rel_attn.v True
base_encoder.encoder.model.layer.0.rel_attn.o True
base_encoder.encoder.model.layer.0.rel_attn.r True
base_encoder.encoder.model.layer.0.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.0.rel_attn.seg_embed True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_norm.weight True
base_encoder.encoder.model.layer.0.ff.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_1.weight True
base_encoder.encoder.model.layer.0.ff.layer_1.bias True
base_encoder.encoder.model.layer.0.ff.layer_2.weight True
base_encoder.encoder.model.layer.0.ff.layer_2.bias True
base_encoder.encoder.model.layer.1.rel_attn.q True
base_encoder.encoder.model.layer.1.rel_attn.k True
base_encoder.encoder.model.layer.1.rel_attn.v True
base_encoder.encoder.model.layer.1.rel_attn.o True
base_encoder.encoder.model.layer.1.rel_attn.r True
base_encoder.encoder.model.layer.1.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.1.rel_attn.seg_embed True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_norm.weight True
base_encoder.encoder.model.layer.1.ff.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_1.weight True
base_encoder.encoder.model.layer.1.ff.layer_1.bias True
base_encoder.encoder.model.layer.1.ff.layer_2.weight True
base_encoder.encoder.model.layer.1.ff.layer_2.bias True
base_encoder.encoder.model.layer.2.rel_attn.q True
base_encoder.encoder.model.layer.2.rel_attn.k True
base_encoder.encoder.model.layer.2.rel_attn.v True
base_encoder.encoder.model.layer.2.rel_attn.o True
base_encoder.encoder.model.layer.2.rel_attn.r True
base_encoder.encoder.model.layer.2.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.2.rel_attn.seg_embed True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_norm.weight True
base_encoder.encoder.model.layer.2.ff.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_1.weight True
base_encoder.encoder.model.layer.2.ff.layer_1.bias True
base_encoder.encoder.model.layer.2.ff.layer_2.weight True
base_encoder.encoder.model.layer.2.ff.layer_2.bias True
base_encoder.encoder.model.layer.3.rel_attn.q True
base_encoder.encoder.model.layer.3.rel_attn.k True
base_encoder.encoder.model.layer.3.rel_attn.v True
base_encoder.encoder.model.layer.3.rel_attn.o True
base_encoder.encoder.model.layer.3.rel_attn.r True
base_encoder.encoder.model.layer.3.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.3.rel_attn.seg_embed True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_norm.weight True
base_encoder.encoder.model.layer.3.ff.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_1.weight True
base_encoder.encoder.model.layer.3.ff.layer_1.bias True
base_encoder.encoder.model.layer.3.ff.layer_2.weight True
base_encoder.encoder.model.layer.3.ff.layer_2.bias True
base_encoder.encoder.model.layer.4.rel_attn.q True
base_encoder.encoder.model.layer.4.rel_attn.k True
base_encoder.encoder.model.layer.4.rel_attn.v True
base_encoder.encoder.model.layer.4.rel_attn.o True
base_encoder.encoder.model.layer.4.rel_attn.r True
base_encoder.encoder.model.layer.4.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.4.rel_attn.seg_embed True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_norm.weight True
base_encoder.encoder.model.layer.4.ff.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_1.weight True
base_encoder.encoder.model.layer.4.ff.layer_1.bias True
base_encoder.encoder.model.layer.4.ff.layer_2.weight True
base_encoder.encoder.model.layer.4.ff.layer_2.bias True
base_encoder.encoder.model.layer.5.rel_attn.q True
base_encoder.encoder.model.layer.5.rel_attn.k True
base_encoder.encoder.model.layer.5.rel_attn.v True
base_encoder.encoder.model.layer.5.rel_attn.o True
base_encoder.encoder.model.layer.5.rel_attn.r True
base_encoder.encoder.model.layer.5.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.5.rel_attn.seg_embed True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_norm.weight True
base_encoder.encoder.model.layer.5.ff.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_1.weight True
base_encoder.encoder.model.layer.5.ff.layer_1.bias True
base_encoder.encoder.model.layer.5.ff.layer_2.weight True
base_encoder.encoder.model.layer.5.ff.layer_2.bias True
base_encoder.encoder.model.layer.6.rel_attn.q True
base_encoder.encoder.model.layer.6.rel_attn.k True
base_encoder.encoder.model.layer.6.rel_attn.v True
base_encoder.encoder.model.layer.6.rel_attn.o True
base_encoder.encoder.model.layer.6.rel_attn.r True
base_encoder.encoder.model.layer.6.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.6.rel_attn.seg_embed True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_norm.weight True
base_encoder.encoder.model.layer.6.ff.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_1.weight True
base_encoder.encoder.model.layer.6.ff.layer_1.bias True
base_encoder.encoder.model.layer.6.ff.layer_2.weight True
base_encoder.encoder.model.layer.6.ff.layer_2.bias True
base_encoder.encoder.model.layer.7.rel_attn.q True
base_encoder.encoder.model.layer.7.rel_attn.k True
base_encoder.encoder.model.layer.7.rel_attn.v True
base_encoder.encoder.model.layer.7.rel_attn.o True
base_encoder.encoder.model.layer.7.rel_attn.r True
base_encoder.encoder.model.layer.7.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.7.rel_attn.seg_embed True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_norm.weight True
base_encoder.encoder.model.layer.7.ff.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_1.weight True
base_encoder.encoder.model.layer.7.ff.layer_1.bias True
base_encoder.encoder.model.layer.7.ff.layer_2.weight True
base_encoder.encoder.model.layer.7.ff.layer_2.bias True
base_encoder.encoder.model.layer.8.rel_attn.q True
base_encoder.encoder.model.layer.8.rel_attn.k True
base_encoder.encoder.model.layer.8.rel_attn.v True
base_encoder.encoder.model.layer.8.rel_attn.o True
base_encoder.encoder.model.layer.8.rel_attn.r True
base_encoder.encoder.model.layer.8.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.8.rel_attn.seg_embed True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_norm.weight True
base_encoder.encoder.model.layer.8.ff.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_1.weight True
base_encoder.encoder.model.layer.8.ff.layer_1.bias True
base_encoder.encoder.model.layer.8.ff.layer_2.weight True
base_encoder.encoder.model.layer.8.ff.layer_2.bias True
base_encoder.encoder.model.layer.9.rel_attn.q True
base_encoder.encoder.model.layer.9.rel_attn.k True
base_encoder.encoder.model.layer.9.rel_attn.v True
base_encoder.encoder.model.layer.9.rel_attn.o True
base_encoder.encoder.model.layer.9.rel_attn.r True
base_encoder.encoder.model.layer.9.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.9.rel_attn.seg_embed True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_norm.weight True
base_encoder.encoder.model.layer.9.ff.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_1.weight True
base_encoder.encoder.model.layer.9.ff.layer_1.bias True
base_encoder.encoder.model.layer.9.ff.layer_2.weight True
base_encoder.encoder.model.layer.9.ff.layer_2.bias True
base_encoder.encoder.model.layer.10.rel_attn.q True
base_encoder.encoder.model.layer.10.rel_attn.k True
base_encoder.encoder.model.layer.10.rel_attn.v True
base_encoder.encoder.model.layer.10.rel_attn.o True
base_encoder.encoder.model.layer.10.rel_attn.r True
base_encoder.encoder.model.layer.10.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.10.rel_attn.seg_embed True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_norm.weight True
base_encoder.encoder.model.layer.10.ff.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_1.weight True
base_encoder.encoder.model.layer.10.ff.layer_1.bias True
base_encoder.encoder.model.layer.10.ff.layer_2.weight True
base_encoder.encoder.model.layer.10.ff.layer_2.bias True
base_encoder.encoder.model.layer.11.rel_attn.q True
base_encoder.encoder.model.layer.11.rel_attn.k True
base_encoder.encoder.model.layer.11.rel_attn.v True
base_encoder.encoder.model.layer.11.rel_attn.o True
base_encoder.encoder.model.layer.11.rel_attn.r True
base_encoder.encoder.model.layer.11.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.11.rel_attn.seg_embed True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_norm.weight True
base_encoder.encoder.model.layer.11.ff.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_1.weight True
base_encoder.encoder.model.layer.11.ff.layer_1.bias True
base_encoder.encoder.model.layer.11.ff.layer_2.weight True
base_encoder.encoder.model.layer.11.ff.layer_2.bias True
tt_encoder.layers.0.self_attn.linears.0.weight True
tt_encoder.layers.0.self_attn.linears.0.bias True
tt_encoder.layers.0.self_attn.linears.1.weight True
tt_encoder.layers.0.self_attn.linears.1.bias True
tt_encoder.layers.0.self_attn.linears.2.weight True
tt_encoder.layers.0.self_attn.linears.2.bias True
tt_encoder.layers.0.self_attn.linears.3.weight True
tt_encoder.layers.0.self_attn.linears.3.bias True
tt_encoder.layers.0.feed_forward.w_1.weight True
tt_encoder.layers.0.feed_forward.w_1.bias True
tt_encoder.layers.0.feed_forward.w_2.weight True
tt_encoder.layers.0.feed_forward.w_2.bias True
tt_encoder.layers.0.group_attn.linear_key.weight True
tt_encoder.layers.0.group_attn.linear_key.bias True
tt_encoder.layers.0.group_attn.linear_query.weight True
tt_encoder.layers.0.group_attn.linear_query.bias True
tt_encoder.layers.0.group_attn.norm.a_2 True
tt_encoder.layers.0.group_attn.norm.b_2 True
tt_encoder.layers.0.sublayer.0.norm.a_2 True
tt_encoder.layers.0.sublayer.0.norm.b_2 True
tt_encoder.layers.0.sublayer.1.norm.a_2 True
tt_encoder.layers.0.sublayer.1.norm.b_2 True
tt_encoder.layers.1.self_attn.linears.0.weight True
tt_encoder.layers.1.self_attn.linears.0.bias True
tt_encoder.layers.1.self_attn.linears.1.weight True
tt_encoder.layers.1.self_attn.linears.1.bias True
tt_encoder.layers.1.self_attn.linears.2.weight True
tt_encoder.layers.1.self_attn.linears.2.bias True
tt_encoder.layers.1.self_attn.linears.3.weight True
tt_encoder.layers.1.self_attn.linears.3.bias True
tt_encoder.layers.1.feed_forward.w_1.weight True
tt_encoder.layers.1.feed_forward.w_1.bias True
tt_encoder.layers.1.feed_forward.w_2.weight True
tt_encoder.layers.1.feed_forward.w_2.bias True
tt_encoder.layers.1.group_attn.linear_key.weight True
tt_encoder.layers.1.group_attn.linear_key.bias True
tt_encoder.layers.1.group_attn.linear_query.weight True
tt_encoder.layers.1.group_attn.linear_query.bias True
tt_encoder.layers.1.group_attn.norm.a_2 True
tt_encoder.layers.1.group_attn.norm.b_2 True
tt_encoder.layers.1.sublayer.0.norm.a_2 True
tt_encoder.layers.1.sublayer.0.norm.b_2 True
tt_encoder.layers.1.sublayer.1.norm.a_2 True
tt_encoder.layers.1.sublayer.1.norm.b_2 True
tt_encoder.layers.2.self_attn.linears.0.weight True
tt_encoder.layers.2.self_attn.linears.0.bias True
tt_encoder.layers.2.self_attn.linears.1.weight True
tt_encoder.layers.2.self_attn.linears.1.bias True
tt_encoder.layers.2.self_attn.linears.2.weight True
tt_encoder.layers.2.self_attn.linears.2.bias True
tt_encoder.layers.2.self_attn.linears.3.weight True
tt_encoder.layers.2.self_attn.linears.3.bias True
tt_encoder.layers.2.feed_forward.w_1.weight True
tt_encoder.layers.2.feed_forward.w_1.bias True
tt_encoder.layers.2.feed_forward.w_2.weight True
tt_encoder.layers.2.feed_forward.w_2.bias True
tt_encoder.layers.2.group_attn.linear_key.weight True
tt_encoder.layers.2.group_attn.linear_key.bias True
tt_encoder.layers.2.group_attn.linear_query.weight True
tt_encoder.layers.2.group_attn.linear_query.bias True
tt_encoder.layers.2.group_attn.norm.a_2 True
tt_encoder.layers.2.group_attn.norm.b_2 True
tt_encoder.layers.2.sublayer.0.norm.a_2 True
tt_encoder.layers.2.sublayer.0.norm.b_2 True
tt_encoder.layers.2.sublayer.1.norm.a_2 True
tt_encoder.layers.2.sublayer.1.norm.b_2 True
tt_encoder.layers.3.self_attn.linears.0.weight True
tt_encoder.layers.3.self_attn.linears.0.bias True
tt_encoder.layers.3.self_attn.linears.1.weight True
tt_encoder.layers.3.self_attn.linears.1.bias True
tt_encoder.layers.3.self_attn.linears.2.weight True
tt_encoder.layers.3.self_attn.linears.2.bias True
tt_encoder.layers.3.self_attn.linears.3.weight True
tt_encoder.layers.3.self_attn.linears.3.bias True
tt_encoder.layers.3.feed_forward.w_1.weight True
tt_encoder.layers.3.feed_forward.w_1.bias True
tt_encoder.layers.3.feed_forward.w_2.weight True
tt_encoder.layers.3.feed_forward.w_2.bias True
tt_encoder.layers.3.group_attn.linear_key.weight True
tt_encoder.layers.3.group_attn.linear_key.bias True
tt_encoder.layers.3.group_attn.linear_query.weight True
tt_encoder.layers.3.group_attn.linear_query.bias True
tt_encoder.layers.3.group_attn.norm.a_2 True
tt_encoder.layers.3.group_attn.norm.b_2 True
tt_encoder.layers.3.sublayer.0.norm.a_2 True
tt_encoder.layers.3.sublayer.0.norm.b_2 True
tt_encoder.layers.3.sublayer.1.norm.a_2 True
tt_encoder.layers.3.sublayer.1.norm.b_2 True
tt_encoder.norm.a_2 True
tt_encoder.norm.b_2 True
linear_1.weight True
linear_1.bias True
linear_2.weight True
linear_2.bias True
linear_out.weight True
linear_out.bias True
so_linear_1.weight True
so_linear_1.bias True
so_linear_2.weight True
so_linear_2.bias True
so_linear_out.weight True
so_linear_out.bias True
layer_norm1.weight True
layer_norm1.bias True
layer_norm2.weight True
layer_norm2.bias True
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.563)
30/33-(1.681)
12/33-(1.017)
27/33-(1.222)

=== Evaluating Model ===
accuracy on Valid 0.5133531157270029

Best accuracy on Valid 0.5133531157270029
Total valid loss 0.9575691385702654
accuracy on Test 0.4807121661721068
Best accuracy on Test 0.4807121661721068

**** Epoch 0/20 ****
9/33-(1.172)
24/33-(1.176)
6/33-(1.080)
21/33-(1.251)

=== Evaluating Model ===
accuracy on Valid 0.5252225519287834

Best accuracy on Valid 0.5252225519287834
Total valid loss 0.830996651541103
accuracy on Test 0.56973293768546
Best accuracy on Test 0.56973293768546

**** Epoch 1/20 ****
3/33-(1.136)
18/33-(0.972)
0/33-(0.922)
15/33-(1.009)

=== Evaluating Model ===
accuracy on Valid 0.6350148367952523

Best accuracy on Valid 0.6350148367952523
Total valid loss 0.6893294114958156
accuracy on Test 0.6528189910979229
Best accuracy on Test 0.6528189910979229

**** Epoch 2/20 ****
30/33-(0.750)
12/33-(0.653)
27/33-(0.673)
9/33-(0.725)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229

Best accuracy on Valid 0.6528189910979229
Total valid loss 0.6275229765610262
accuracy on Test 0.6824925816023739
Best accuracy on Test 0.6824925816023739

**** Epoch 3/20 ****
24/33-(0.771)
6/33-(0.539)
21/33-(0.632)
3/33-(0.785)
18/33-(1.446)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934

Best accuracy on Valid 0.6706231454005934
Total valid loss 0.6340582316572015
accuracy on Test 0.6913946587537092
Best accuracy on Test 0.6913946587537092

**** Epoch 4/20 ****
0/33-(0.948)
15/33-(0.916)
30/33-(0.719)
12/33-(0.333)

=== Evaluating Model ===
accuracy on Valid 0.6261127596439169


**** Epoch 5/20 ****
27/33-(0.597)
9/33-(0.535)
24/33-(0.648)
6/33-(0.892)

=== Evaluating Model ===
accuracy on Valid 0.6379821958456974


**** Epoch 6/20 ****
21/33-(0.509)
3/33-(0.747)
18/33-(0.829)
0/33-(0.866)

=== Evaluating Model ===
accuracy on Valid 0.6735905044510386

Best accuracy on Valid 0.6735905044510386
Total valid loss 0.5751435445113615
accuracy on Test 0.7418397626112759
Best accuracy on Test 0.7418397626112759

**** Epoch 7/20 ****
15/33-(0.583)
30/33-(1.960)
12/33-(0.747)
27/33-(0.382)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819

Best accuracy on Valid 0.685459940652819
Total valid loss 0.706551344557242
accuracy on Test 0.7329376854599406
Best accuracy on Test 0.7418397626112759

**** Epoch 8/20 ****
9/33-(0.932)
24/33-(0.396)
6/33-(0.292)
21/33-(0.424)
3/33-(0.564)

=== Evaluating Model ===
accuracy on Valid 0.6498516320474778


**** Epoch 9/20 ****
18/33-(0.446)
0/33-(0.200)
15/33-(0.622)
30/33-(0.324)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Best accuracy on Valid 0.6943620178041543
Total valid loss 0.6367957571690733
accuracy on Test 0.6795252225519288
Best accuracy on Test 0.7418397626112759

**** Epoch 10/20 ****
12/33-(0.234)
27/33-(0.320)
9/33-(1.433)
24/33-(0.223)

=== Evaluating Model ===
accuracy on Valid 0.658753709198813


**** Epoch 11/20 ****
6/33-(0.585)
21/33-(0.384)
3/33-(1.204)
18/33-(0.355)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543

Best accuracy on Valid 0.6943620178041543
Total valid loss 0.8864516036754305
accuracy on Test 0.7002967359050445
Best accuracy on Test 0.7418397626112759

**** Epoch 12/20 ****
0/33-(0.270)
15/33-(0.850)
30/33-(0.070)
12/33-(0.194)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701

Best accuracy on Valid 0.7151335311572701
Total valid loss 0.9927186013929631
accuracy on Test 0.7062314540059347
Best accuracy on Test 0.7418397626112759

**** Epoch 13/20 ****
27/33-(0.209)
9/33-(0.168)
24/33-(0.966)
6/33-(0.165)
21/33-(0.526)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092


**** Epoch 14/20 ****
3/33-(0.010)
18/33-(0.315)
0/33-(0.128)
15/33-(0.180)

=== Evaluating Model ===
accuracy on Valid 0.6350148367952523


**** Epoch 15/20 ****
30/33-(1.228)
12/33-(0.538)
27/33-(0.229)
9/33-(0.476)

=== Evaluating Model ===
accuracy on Valid 0.6379821958456974


**** Epoch 16/20 ****
24/33-(0.211)
6/33-(0.143)
21/33-(0.172)
3/33-(1.165)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934


**** Epoch 17/20 ****
18/33-(0.102)
0/33-(0.179)
15/33-(0.246)
30/33-(0.177)

=== Evaluating Model ===
accuracy on Valid 0.658753709198813


**** Epoch 18/20 ****
12/33-(0.152)
27/33-(0.358)
9/33-(0.348)
24/33-(0.288)
6/33-(0.292)

=== Evaluating Model ===
accuracy on Valid 0.599406528189911


**** Epoch 19/20 ****
21/33-(0.271)
Best accuracy on Test 0.7418397626112759

Source domain: 8, Target domain: 8, Cur_fold 3
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

context_weight True
base_encoder.encoder.model.mask_emb True
base_encoder.encoder.model.word_embedding.weight True
base_encoder.encoder.model.layer.0.rel_attn.q True
base_encoder.encoder.model.layer.0.rel_attn.k True
base_encoder.encoder.model.layer.0.rel_attn.v True
base_encoder.encoder.model.layer.0.rel_attn.o True
base_encoder.encoder.model.layer.0.rel_attn.r True
base_encoder.encoder.model.layer.0.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.0.rel_attn.seg_embed True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_norm.weight True
base_encoder.encoder.model.layer.0.ff.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_1.weight True
base_encoder.encoder.model.layer.0.ff.layer_1.bias True
base_encoder.encoder.model.layer.0.ff.layer_2.weight True
base_encoder.encoder.model.layer.0.ff.layer_2.bias True
base_encoder.encoder.model.layer.1.rel_attn.q True
base_encoder.encoder.model.layer.1.rel_attn.k True
base_encoder.encoder.model.layer.1.rel_attn.v True
base_encoder.encoder.model.layer.1.rel_attn.o True
base_encoder.encoder.model.layer.1.rel_attn.r True
base_encoder.encoder.model.layer.1.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.1.rel_attn.seg_embed True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_norm.weight True
base_encoder.encoder.model.layer.1.ff.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_1.weight True
base_encoder.encoder.model.layer.1.ff.layer_1.bias True
base_encoder.encoder.model.layer.1.ff.layer_2.weight True
base_encoder.encoder.model.layer.1.ff.layer_2.bias True
base_encoder.encoder.model.layer.2.rel_attn.q True
base_encoder.encoder.model.layer.2.rel_attn.k True
base_encoder.encoder.model.layer.2.rel_attn.v True
base_encoder.encoder.model.layer.2.rel_attn.o True
base_encoder.encoder.model.layer.2.rel_attn.r True
base_encoder.encoder.model.layer.2.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.2.rel_attn.seg_embed True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_norm.weight True
base_encoder.encoder.model.layer.2.ff.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_1.weight True
base_encoder.encoder.model.layer.2.ff.layer_1.bias True
base_encoder.encoder.model.layer.2.ff.layer_2.weight True
base_encoder.encoder.model.layer.2.ff.layer_2.bias True
base_encoder.encoder.model.layer.3.rel_attn.q True
base_encoder.encoder.model.layer.3.rel_attn.k True
base_encoder.encoder.model.layer.3.rel_attn.v True
base_encoder.encoder.model.layer.3.rel_attn.o True
base_encoder.encoder.model.layer.3.rel_attn.r True
base_encoder.encoder.model.layer.3.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.3.rel_attn.seg_embed True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_norm.weight True
base_encoder.encoder.model.layer.3.ff.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_1.weight True
base_encoder.encoder.model.layer.3.ff.layer_1.bias True
base_encoder.encoder.model.layer.3.ff.layer_2.weight True
base_encoder.encoder.model.layer.3.ff.layer_2.bias True
base_encoder.encoder.model.layer.4.rel_attn.q True
base_encoder.encoder.model.layer.4.rel_attn.k True
base_encoder.encoder.model.layer.4.rel_attn.v True
base_encoder.encoder.model.layer.4.rel_attn.o True
base_encoder.encoder.model.layer.4.rel_attn.r True
base_encoder.encoder.model.layer.4.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.4.rel_attn.seg_embed True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_norm.weight True
base_encoder.encoder.model.layer.4.ff.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_1.weight True
base_encoder.encoder.model.layer.4.ff.layer_1.bias True
base_encoder.encoder.model.layer.4.ff.layer_2.weight True
base_encoder.encoder.model.layer.4.ff.layer_2.bias True
base_encoder.encoder.model.layer.5.rel_attn.q True
base_encoder.encoder.model.layer.5.rel_attn.k True
base_encoder.encoder.model.layer.5.rel_attn.v True
base_encoder.encoder.model.layer.5.rel_attn.o True
base_encoder.encoder.model.layer.5.rel_attn.r True
base_encoder.encoder.model.layer.5.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.5.rel_attn.seg_embed True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_norm.weight True
base_encoder.encoder.model.layer.5.ff.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_1.weight True
base_encoder.encoder.model.layer.5.ff.layer_1.bias True
base_encoder.encoder.model.layer.5.ff.layer_2.weight True
base_encoder.encoder.model.layer.5.ff.layer_2.bias True
base_encoder.encoder.model.layer.6.rel_attn.q True
base_encoder.encoder.model.layer.6.rel_attn.k True
base_encoder.encoder.model.layer.6.rel_attn.v True
base_encoder.encoder.model.layer.6.rel_attn.o True
base_encoder.encoder.model.layer.6.rel_attn.r True
base_encoder.encoder.model.layer.6.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.6.rel_attn.seg_embed True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_norm.weight True
base_encoder.encoder.model.layer.6.ff.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_1.weight True
base_encoder.encoder.model.layer.6.ff.layer_1.bias True
base_encoder.encoder.model.layer.6.ff.layer_2.weight True
base_encoder.encoder.model.layer.6.ff.layer_2.bias True
base_encoder.encoder.model.layer.7.rel_attn.q True
base_encoder.encoder.model.layer.7.rel_attn.k True
base_encoder.encoder.model.layer.7.rel_attn.v True
base_encoder.encoder.model.layer.7.rel_attn.o True
base_encoder.encoder.model.layer.7.rel_attn.r True
base_encoder.encoder.model.layer.7.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.7.rel_attn.seg_embed True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_norm.weight True
base_encoder.encoder.model.layer.7.ff.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_1.weight True
base_encoder.encoder.model.layer.7.ff.layer_1.bias True
base_encoder.encoder.model.layer.7.ff.layer_2.weight True
base_encoder.encoder.model.layer.7.ff.layer_2.bias True
base_encoder.encoder.model.layer.8.rel_attn.q True
base_encoder.encoder.model.layer.8.rel_attn.k True
base_encoder.encoder.model.layer.8.rel_attn.v True
base_encoder.encoder.model.layer.8.rel_attn.o True
base_encoder.encoder.model.layer.8.rel_attn.r True
base_encoder.encoder.model.layer.8.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.8.rel_attn.seg_embed True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_norm.weight True
base_encoder.encoder.model.layer.8.ff.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_1.weight True
base_encoder.encoder.model.layer.8.ff.layer_1.bias True
base_encoder.encoder.model.layer.8.ff.layer_2.weight True
base_encoder.encoder.model.layer.8.ff.layer_2.bias True
base_encoder.encoder.model.layer.9.rel_attn.q True
base_encoder.encoder.model.layer.9.rel_attn.k True
base_encoder.encoder.model.layer.9.rel_attn.v True
base_encoder.encoder.model.layer.9.rel_attn.o True
base_encoder.encoder.model.layer.9.rel_attn.r True
base_encoder.encoder.model.layer.9.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.9.rel_attn.seg_embed True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_norm.weight True
base_encoder.encoder.model.layer.9.ff.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_1.weight True
base_encoder.encoder.model.layer.9.ff.layer_1.bias True
base_encoder.encoder.model.layer.9.ff.layer_2.weight True
base_encoder.encoder.model.layer.9.ff.layer_2.bias True
base_encoder.encoder.model.layer.10.rel_attn.q True
base_encoder.encoder.model.layer.10.rel_attn.k True
base_encoder.encoder.model.layer.10.rel_attn.v True
base_encoder.encoder.model.layer.10.rel_attn.o True
base_encoder.encoder.model.layer.10.rel_attn.r True
base_encoder.encoder.model.layer.10.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.10.rel_attn.seg_embed True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_norm.weight True
base_encoder.encoder.model.layer.10.ff.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_1.weight True
base_encoder.encoder.model.layer.10.ff.layer_1.bias True
base_encoder.encoder.model.layer.10.ff.layer_2.weight True
base_encoder.encoder.model.layer.10.ff.layer_2.bias True
base_encoder.encoder.model.layer.11.rel_attn.q True
base_encoder.encoder.model.layer.11.rel_attn.k True
base_encoder.encoder.model.layer.11.rel_attn.v True
base_encoder.encoder.model.layer.11.rel_attn.o True
base_encoder.encoder.model.layer.11.rel_attn.r True
base_encoder.encoder.model.layer.11.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.11.rel_attn.seg_embed True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_norm.weight True
base_encoder.encoder.model.layer.11.ff.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_1.weight True
base_encoder.encoder.model.layer.11.ff.layer_1.bias True
base_encoder.encoder.model.layer.11.ff.layer_2.weight True
base_encoder.encoder.model.layer.11.ff.layer_2.bias True
tt_encoder.layers.0.self_attn.linears.0.weight True
tt_encoder.layers.0.self_attn.linears.0.bias True
tt_encoder.layers.0.self_attn.linears.1.weight True
tt_encoder.layers.0.self_attn.linears.1.bias True
tt_encoder.layers.0.self_attn.linears.2.weight True
tt_encoder.layers.0.self_attn.linears.2.bias True
tt_encoder.layers.0.self_attn.linears.3.weight True
tt_encoder.layers.0.self_attn.linears.3.bias True
tt_encoder.layers.0.feed_forward.w_1.weight True
tt_encoder.layers.0.feed_forward.w_1.bias True
tt_encoder.layers.0.feed_forward.w_2.weight True
tt_encoder.layers.0.feed_forward.w_2.bias True
tt_encoder.layers.0.group_attn.linear_key.weight True
tt_encoder.layers.0.group_attn.linear_key.bias True
tt_encoder.layers.0.group_attn.linear_query.weight True
tt_encoder.layers.0.group_attn.linear_query.bias True
tt_encoder.layers.0.group_attn.norm.a_2 True
tt_encoder.layers.0.group_attn.norm.b_2 True
tt_encoder.layers.0.sublayer.0.norm.a_2 True
tt_encoder.layers.0.sublayer.0.norm.b_2 True
tt_encoder.layers.0.sublayer.1.norm.a_2 True
tt_encoder.layers.0.sublayer.1.norm.b_2 True
tt_encoder.layers.1.self_attn.linears.0.weight True
tt_encoder.layers.1.self_attn.linears.0.bias True
tt_encoder.layers.1.self_attn.linears.1.weight True
tt_encoder.layers.1.self_attn.linears.1.bias True
tt_encoder.layers.1.self_attn.linears.2.weight True
tt_encoder.layers.1.self_attn.linears.2.bias True
tt_encoder.layers.1.self_attn.linears.3.weight True
tt_encoder.layers.1.self_attn.linears.3.bias True
tt_encoder.layers.1.feed_forward.w_1.weight True
tt_encoder.layers.1.feed_forward.w_1.bias True
tt_encoder.layers.1.feed_forward.w_2.weight True
tt_encoder.layers.1.feed_forward.w_2.bias True
tt_encoder.layers.1.group_attn.linear_key.weight True
tt_encoder.layers.1.group_attn.linear_key.bias True
tt_encoder.layers.1.group_attn.linear_query.weight True
tt_encoder.layers.1.group_attn.linear_query.bias True
tt_encoder.layers.1.group_attn.norm.a_2 True
tt_encoder.layers.1.group_attn.norm.b_2 True
tt_encoder.layers.1.sublayer.0.norm.a_2 True
tt_encoder.layers.1.sublayer.0.norm.b_2 True
tt_encoder.layers.1.sublayer.1.norm.a_2 True
tt_encoder.layers.1.sublayer.1.norm.b_2 True
tt_encoder.layers.2.self_attn.linears.0.weight True
tt_encoder.layers.2.self_attn.linears.0.bias True
tt_encoder.layers.2.self_attn.linears.1.weight True
tt_encoder.layers.2.self_attn.linears.1.bias True
tt_encoder.layers.2.self_attn.linears.2.weight True
tt_encoder.layers.2.self_attn.linears.2.bias True
tt_encoder.layers.2.self_attn.linears.3.weight True
tt_encoder.layers.2.self_attn.linears.3.bias True
tt_encoder.layers.2.feed_forward.w_1.weight True
tt_encoder.layers.2.feed_forward.w_1.bias True
tt_encoder.layers.2.feed_forward.w_2.weight True
tt_encoder.layers.2.feed_forward.w_2.bias True
tt_encoder.layers.2.group_attn.linear_key.weight True
tt_encoder.layers.2.group_attn.linear_key.bias True
tt_encoder.layers.2.group_attn.linear_query.weight True
tt_encoder.layers.2.group_attn.linear_query.bias True
tt_encoder.layers.2.group_attn.norm.a_2 True
tt_encoder.layers.2.group_attn.norm.b_2 True
tt_encoder.layers.2.sublayer.0.norm.a_2 True
tt_encoder.layers.2.sublayer.0.norm.b_2 True
tt_encoder.layers.2.sublayer.1.norm.a_2 True
tt_encoder.layers.2.sublayer.1.norm.b_2 True
tt_encoder.layers.3.self_attn.linears.0.weight True
tt_encoder.layers.3.self_attn.linears.0.bias True
tt_encoder.layers.3.self_attn.linears.1.weight True
tt_encoder.layers.3.self_attn.linears.1.bias True
tt_encoder.layers.3.self_attn.linears.2.weight True
tt_encoder.layers.3.self_attn.linears.2.bias True
tt_encoder.layers.3.self_attn.linears.3.weight True
tt_encoder.layers.3.self_attn.linears.3.bias True
tt_encoder.layers.3.feed_forward.w_1.weight True
tt_encoder.layers.3.feed_forward.w_1.bias True
tt_encoder.layers.3.feed_forward.w_2.weight True
tt_encoder.layers.3.feed_forward.w_2.bias True
tt_encoder.layers.3.group_attn.linear_key.weight True
tt_encoder.layers.3.group_attn.linear_key.bias True
tt_encoder.layers.3.group_attn.linear_query.weight True
tt_encoder.layers.3.group_attn.linear_query.bias True
tt_encoder.layers.3.group_attn.norm.a_2 True
tt_encoder.layers.3.group_attn.norm.b_2 True
tt_encoder.layers.3.sublayer.0.norm.a_2 True
tt_encoder.layers.3.sublayer.0.norm.b_2 True
tt_encoder.layers.3.sublayer.1.norm.a_2 True
tt_encoder.layers.3.sublayer.1.norm.b_2 True
tt_encoder.norm.a_2 True
tt_encoder.norm.b_2 True
linear_1.weight True
linear_1.bias True
linear_2.weight True
linear_2.bias True
linear_out.weight True
linear_out.bias True
so_linear_1.weight True
so_linear_1.bias True
so_linear_2.weight True
so_linear_2.bias True
so_linear_out.weight True
so_linear_out.bias True
layer_norm1.weight True
layer_norm1.bias True
layer_norm2.weight True
layer_norm2.bias True
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.823)
30/33-(1.607)
12/33-(1.218)
27/33-(0.730)

=== Evaluating Model ===
accuracy on Valid 0.5519287833827893

Best accuracy on Valid 0.5519287833827893
Total valid loss 1.117575379935178
accuracy on Test 0.5222551928783383
Best accuracy on Test 0.5222551928783383

**** Epoch 0/20 ****
9/33-(0.883)
24/33-(1.008)
6/33-(1.014)
21/33-(0.992)

=== Evaluating Model ===
accuracy on Valid 0.6498516320474778

Best accuracy on Valid 0.6498516320474778
Total valid loss 0.7423020628365603
accuracy on Test 0.6409495548961425
Best accuracy on Test 0.6409495548961425

**** Epoch 1/20 ****
3/33-(0.641)
18/33-(1.175)
0/33-(0.380)
15/33-(0.946)

=== Evaluating Model ===
accuracy on Valid 0.5548961424332344


**** Epoch 2/20 ****
30/33-(0.517)
12/33-(1.576)
27/33-(0.803)
9/33-(0.837)

=== Evaluating Model ===
accuracy on Valid 0.6261127596439169


**** Epoch 3/20 ****
24/33-(1.168)
6/33-(0.803)
21/33-(1.193)
3/33-(0.618)
18/33-(0.916)

=== Evaluating Model ===
accuracy on Valid 0.6350148367952523


**** Epoch 4/20 ****
0/33-(0.534)
15/33-(0.872)
30/33-(0.905)
12/33-(0.645)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825

Best accuracy on Valid 0.712166172106825
Total valid loss 0.6321167620745572
accuracy on Test 0.7151335311572701
Best accuracy on Test 0.7151335311572701

**** Epoch 5/20 ****
27/33-(0.364)
9/33-(0.897)
24/33-(0.545)
6/33-(0.412)

=== Evaluating Model ===
accuracy on Valid 0.6973293768545994


**** Epoch 6/20 ****
21/33-(0.604)
3/33-(0.438)
18/33-(0.583)
0/33-(0.504)

=== Evaluating Model ===
accuracy on Valid 0.6498516320474778


**** Epoch 7/20 ****
15/33-(0.428)
30/33-(0.343)
12/33-(0.518)
27/33-(0.146)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229


**** Epoch 8/20 ****
9/33-(0.322)
24/33-(0.596)
6/33-(0.653)
21/33-(0.575)
3/33-(0.617)

=== Evaluating Model ===
accuracy on Valid 0.6350148367952523


**** Epoch 9/20 ****
18/33-(0.551)
0/33-(0.508)
15/33-(1.907)
30/33-(0.511)

=== Evaluating Model ===
accuracy on Valid 0.658753709198813


**** Epoch 10/20 ****
12/33-(0.209)
27/33-(0.254)
9/33-(0.632)
24/33-(0.564)

=== Evaluating Model ===
accuracy on Valid 0.6498516320474778


**** Epoch 11/20 ****
6/33-(0.477)
21/33-(0.351)
3/33-(0.425)
18/33-(0.316)

=== Evaluating Model ===
accuracy on Valid 0.658753709198813


**** Epoch 12/20 ****
0/33-(0.907)
15/33-(0.190)
30/33-(0.183)
12/33-(0.296)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934


**** Epoch 13/20 ****
27/33-(0.295)
9/33-(0.425)
24/33-(0.177)
6/33-(0.385)
21/33-(0.222)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288


**** Epoch 14/20 ****
3/33-(0.097)
18/33-(0.201)
0/33-(0.192)
15/33-(0.105)

=== Evaluating Model ===
accuracy on Valid 0.6617210682492581


**** Epoch 15/20 ****
30/33-(0.297)
12/33-(0.138)
27/33-(0.180)
9/33-(0.117)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934


**** Epoch 16/20 ****
24/33-(0.537)
6/33-(0.168)
21/33-(0.530)
3/33-(1.309)

=== Evaluating Model ===
accuracy on Valid 0.655786350148368


**** Epoch 17/20 ****
18/33-(0.192)
0/33-(0.266)
15/33-(0.298)
30/33-(0.331)

=== Evaluating Model ===
accuracy on Valid 0.6261127596439169


**** Epoch 18/20 ****
12/33-(0.200)
27/33-(0.399)
9/33-(0.240)
24/33-(0.373)
6/33-(0.086)

=== Evaluating Model ===
accuracy on Valid 0.6409495548961425


**** Epoch 19/20 ****
21/33-(0.575)
Best accuracy on Test 0.7151335311572701

Source domain: 8, Target domain: 8, Cur_fold 4
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

context_weight True
base_encoder.encoder.model.mask_emb True
base_encoder.encoder.model.word_embedding.weight True
base_encoder.encoder.model.layer.0.rel_attn.q True
base_encoder.encoder.model.layer.0.rel_attn.k True
base_encoder.encoder.model.layer.0.rel_attn.v True
base_encoder.encoder.model.layer.0.rel_attn.o True
base_encoder.encoder.model.layer.0.rel_attn.r True
base_encoder.encoder.model.layer.0.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.0.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.0.rel_attn.seg_embed True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.0.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_norm.weight True
base_encoder.encoder.model.layer.0.ff.layer_norm.bias True
base_encoder.encoder.model.layer.0.ff.layer_1.weight True
base_encoder.encoder.model.layer.0.ff.layer_1.bias True
base_encoder.encoder.model.layer.0.ff.layer_2.weight True
base_encoder.encoder.model.layer.0.ff.layer_2.bias True
base_encoder.encoder.model.layer.1.rel_attn.q True
base_encoder.encoder.model.layer.1.rel_attn.k True
base_encoder.encoder.model.layer.1.rel_attn.v True
base_encoder.encoder.model.layer.1.rel_attn.o True
base_encoder.encoder.model.layer.1.rel_attn.r True
base_encoder.encoder.model.layer.1.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.1.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.1.rel_attn.seg_embed True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.1.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_norm.weight True
base_encoder.encoder.model.layer.1.ff.layer_norm.bias True
base_encoder.encoder.model.layer.1.ff.layer_1.weight True
base_encoder.encoder.model.layer.1.ff.layer_1.bias True
base_encoder.encoder.model.layer.1.ff.layer_2.weight True
base_encoder.encoder.model.layer.1.ff.layer_2.bias True
base_encoder.encoder.model.layer.2.rel_attn.q True
base_encoder.encoder.model.layer.2.rel_attn.k True
base_encoder.encoder.model.layer.2.rel_attn.v True
base_encoder.encoder.model.layer.2.rel_attn.o True
base_encoder.encoder.model.layer.2.rel_attn.r True
base_encoder.encoder.model.layer.2.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.2.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.2.rel_attn.seg_embed True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.2.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_norm.weight True
base_encoder.encoder.model.layer.2.ff.layer_norm.bias True
base_encoder.encoder.model.layer.2.ff.layer_1.weight True
base_encoder.encoder.model.layer.2.ff.layer_1.bias True
base_encoder.encoder.model.layer.2.ff.layer_2.weight True
base_encoder.encoder.model.layer.2.ff.layer_2.bias True
base_encoder.encoder.model.layer.3.rel_attn.q True
base_encoder.encoder.model.layer.3.rel_attn.k True
base_encoder.encoder.model.layer.3.rel_attn.v True
base_encoder.encoder.model.layer.3.rel_attn.o True
base_encoder.encoder.model.layer.3.rel_attn.r True
base_encoder.encoder.model.layer.3.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.3.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.3.rel_attn.seg_embed True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.3.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_norm.weight True
base_encoder.encoder.model.layer.3.ff.layer_norm.bias True
base_encoder.encoder.model.layer.3.ff.layer_1.weight True
base_encoder.encoder.model.layer.3.ff.layer_1.bias True
base_encoder.encoder.model.layer.3.ff.layer_2.weight True
base_encoder.encoder.model.layer.3.ff.layer_2.bias True
base_encoder.encoder.model.layer.4.rel_attn.q True
base_encoder.encoder.model.layer.4.rel_attn.k True
base_encoder.encoder.model.layer.4.rel_attn.v True
base_encoder.encoder.model.layer.4.rel_attn.o True
base_encoder.encoder.model.layer.4.rel_attn.r True
base_encoder.encoder.model.layer.4.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.4.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.4.rel_attn.seg_embed True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.4.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_norm.weight True
base_encoder.encoder.model.layer.4.ff.layer_norm.bias True
base_encoder.encoder.model.layer.4.ff.layer_1.weight True
base_encoder.encoder.model.layer.4.ff.layer_1.bias True
base_encoder.encoder.model.layer.4.ff.layer_2.weight True
base_encoder.encoder.model.layer.4.ff.layer_2.bias True
base_encoder.encoder.model.layer.5.rel_attn.q True
base_encoder.encoder.model.layer.5.rel_attn.k True
base_encoder.encoder.model.layer.5.rel_attn.v True
base_encoder.encoder.model.layer.5.rel_attn.o True
base_encoder.encoder.model.layer.5.rel_attn.r True
base_encoder.encoder.model.layer.5.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.5.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.5.rel_attn.seg_embed True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.5.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_norm.weight True
base_encoder.encoder.model.layer.5.ff.layer_norm.bias True
base_encoder.encoder.model.layer.5.ff.layer_1.weight True
base_encoder.encoder.model.layer.5.ff.layer_1.bias True
base_encoder.encoder.model.layer.5.ff.layer_2.weight True
base_encoder.encoder.model.layer.5.ff.layer_2.bias True
base_encoder.encoder.model.layer.6.rel_attn.q True
base_encoder.encoder.model.layer.6.rel_attn.k True
base_encoder.encoder.model.layer.6.rel_attn.v True
base_encoder.encoder.model.layer.6.rel_attn.o True
base_encoder.encoder.model.layer.6.rel_attn.r True
base_encoder.encoder.model.layer.6.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.6.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.6.rel_attn.seg_embed True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.6.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_norm.weight True
base_encoder.encoder.model.layer.6.ff.layer_norm.bias True
base_encoder.encoder.model.layer.6.ff.layer_1.weight True
base_encoder.encoder.model.layer.6.ff.layer_1.bias True
base_encoder.encoder.model.layer.6.ff.layer_2.weight True
base_encoder.encoder.model.layer.6.ff.layer_2.bias True
base_encoder.encoder.model.layer.7.rel_attn.q True
base_encoder.encoder.model.layer.7.rel_attn.k True
base_encoder.encoder.model.layer.7.rel_attn.v True
base_encoder.encoder.model.layer.7.rel_attn.o True
base_encoder.encoder.model.layer.7.rel_attn.r True
base_encoder.encoder.model.layer.7.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.7.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.7.rel_attn.seg_embed True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.7.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_norm.weight True
base_encoder.encoder.model.layer.7.ff.layer_norm.bias True
base_encoder.encoder.model.layer.7.ff.layer_1.weight True
base_encoder.encoder.model.layer.7.ff.layer_1.bias True
base_encoder.encoder.model.layer.7.ff.layer_2.weight True
base_encoder.encoder.model.layer.7.ff.layer_2.bias True
base_encoder.encoder.model.layer.8.rel_attn.q True
base_encoder.encoder.model.layer.8.rel_attn.k True
base_encoder.encoder.model.layer.8.rel_attn.v True
base_encoder.encoder.model.layer.8.rel_attn.o True
base_encoder.encoder.model.layer.8.rel_attn.r True
base_encoder.encoder.model.layer.8.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.8.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.8.rel_attn.seg_embed True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.8.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_norm.weight True
base_encoder.encoder.model.layer.8.ff.layer_norm.bias True
base_encoder.encoder.model.layer.8.ff.layer_1.weight True
base_encoder.encoder.model.layer.8.ff.layer_1.bias True
base_encoder.encoder.model.layer.8.ff.layer_2.weight True
base_encoder.encoder.model.layer.8.ff.layer_2.bias True
base_encoder.encoder.model.layer.9.rel_attn.q True
base_encoder.encoder.model.layer.9.rel_attn.k True
base_encoder.encoder.model.layer.9.rel_attn.v True
base_encoder.encoder.model.layer.9.rel_attn.o True
base_encoder.encoder.model.layer.9.rel_attn.r True
base_encoder.encoder.model.layer.9.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.9.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.9.rel_attn.seg_embed True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.9.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_norm.weight True
base_encoder.encoder.model.layer.9.ff.layer_norm.bias True
base_encoder.encoder.model.layer.9.ff.layer_1.weight True
base_encoder.encoder.model.layer.9.ff.layer_1.bias True
base_encoder.encoder.model.layer.9.ff.layer_2.weight True
base_encoder.encoder.model.layer.9.ff.layer_2.bias True
base_encoder.encoder.model.layer.10.rel_attn.q True
base_encoder.encoder.model.layer.10.rel_attn.k True
base_encoder.encoder.model.layer.10.rel_attn.v True
base_encoder.encoder.model.layer.10.rel_attn.o True
base_encoder.encoder.model.layer.10.rel_attn.r True
base_encoder.encoder.model.layer.10.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.10.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.10.rel_attn.seg_embed True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.10.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_norm.weight True
base_encoder.encoder.model.layer.10.ff.layer_norm.bias True
base_encoder.encoder.model.layer.10.ff.layer_1.weight True
base_encoder.encoder.model.layer.10.ff.layer_1.bias True
base_encoder.encoder.model.layer.10.ff.layer_2.weight True
base_encoder.encoder.model.layer.10.ff.layer_2.bias True
base_encoder.encoder.model.layer.11.rel_attn.q True
base_encoder.encoder.model.layer.11.rel_attn.k True
base_encoder.encoder.model.layer.11.rel_attn.v True
base_encoder.encoder.model.layer.11.rel_attn.o True
base_encoder.encoder.model.layer.11.rel_attn.r True
base_encoder.encoder.model.layer.11.rel_attn.r_r_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_s_bias True
base_encoder.encoder.model.layer.11.rel_attn.r_w_bias True
base_encoder.encoder.model.layer.11.rel_attn.seg_embed True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.weight True
base_encoder.encoder.model.layer.11.rel_attn.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_norm.weight True
base_encoder.encoder.model.layer.11.ff.layer_norm.bias True
base_encoder.encoder.model.layer.11.ff.layer_1.weight True
base_encoder.encoder.model.layer.11.ff.layer_1.bias True
base_encoder.encoder.model.layer.11.ff.layer_2.weight True
base_encoder.encoder.model.layer.11.ff.layer_2.bias True
tt_encoder.layers.0.self_attn.linears.0.weight True
tt_encoder.layers.0.self_attn.linears.0.bias True
tt_encoder.layers.0.self_attn.linears.1.weight True
tt_encoder.layers.0.self_attn.linears.1.bias True
tt_encoder.layers.0.self_attn.linears.2.weight True
tt_encoder.layers.0.self_attn.linears.2.bias True
tt_encoder.layers.0.self_attn.linears.3.weight True
tt_encoder.layers.0.self_attn.linears.3.bias True
tt_encoder.layers.0.feed_forward.w_1.weight True
tt_encoder.layers.0.feed_forward.w_1.bias True
tt_encoder.layers.0.feed_forward.w_2.weight True
tt_encoder.layers.0.feed_forward.w_2.bias True
tt_encoder.layers.0.group_attn.linear_key.weight True
tt_encoder.layers.0.group_attn.linear_key.bias True
tt_encoder.layers.0.group_attn.linear_query.weight True
tt_encoder.layers.0.group_attn.linear_query.bias True
tt_encoder.layers.0.group_attn.norm.a_2 True
tt_encoder.layers.0.group_attn.norm.b_2 True
tt_encoder.layers.0.sublayer.0.norm.a_2 True
tt_encoder.layers.0.sublayer.0.norm.b_2 True
tt_encoder.layers.0.sublayer.1.norm.a_2 True
tt_encoder.layers.0.sublayer.1.norm.b_2 True
tt_encoder.layers.1.self_attn.linears.0.weight True
tt_encoder.layers.1.self_attn.linears.0.bias True
tt_encoder.layers.1.self_attn.linears.1.weight True
tt_encoder.layers.1.self_attn.linears.1.bias True
tt_encoder.layers.1.self_attn.linears.2.weight True
tt_encoder.layers.1.self_attn.linears.2.bias True
tt_encoder.layers.1.self_attn.linears.3.weight True
tt_encoder.layers.1.self_attn.linears.3.bias True
tt_encoder.layers.1.feed_forward.w_1.weight True
tt_encoder.layers.1.feed_forward.w_1.bias True
tt_encoder.layers.1.feed_forward.w_2.weight True
tt_encoder.layers.1.feed_forward.w_2.bias True
tt_encoder.layers.1.group_attn.linear_key.weight True
tt_encoder.layers.1.group_attn.linear_key.bias True
tt_encoder.layers.1.group_attn.linear_query.weight True
tt_encoder.layers.1.group_attn.linear_query.bias True
tt_encoder.layers.1.group_attn.norm.a_2 True
tt_encoder.layers.1.group_attn.norm.b_2 True
tt_encoder.layers.1.sublayer.0.norm.a_2 True
tt_encoder.layers.1.sublayer.0.norm.b_2 True
tt_encoder.layers.1.sublayer.1.norm.a_2 True
tt_encoder.layers.1.sublayer.1.norm.b_2 True
tt_encoder.layers.2.self_attn.linears.0.weight True
tt_encoder.layers.2.self_attn.linears.0.bias True
tt_encoder.layers.2.self_attn.linears.1.weight True
tt_encoder.layers.2.self_attn.linears.1.bias True
tt_encoder.layers.2.self_attn.linears.2.weight True
tt_encoder.layers.2.self_attn.linears.2.bias True
tt_encoder.layers.2.self_attn.linears.3.weight True
tt_encoder.layers.2.self_attn.linears.3.bias True
tt_encoder.layers.2.feed_forward.w_1.weight True
tt_encoder.layers.2.feed_forward.w_1.bias True
tt_encoder.layers.2.feed_forward.w_2.weight True
tt_encoder.layers.2.feed_forward.w_2.bias True
tt_encoder.layers.2.group_attn.linear_key.weight True
tt_encoder.layers.2.group_attn.linear_key.bias True
tt_encoder.layers.2.group_attn.linear_query.weight True
tt_encoder.layers.2.group_attn.linear_query.bias True
tt_encoder.layers.2.group_attn.norm.a_2 True
tt_encoder.layers.2.group_attn.norm.b_2 True
tt_encoder.layers.2.sublayer.0.norm.a_2 True
tt_encoder.layers.2.sublayer.0.norm.b_2 True
tt_encoder.layers.2.sublayer.1.norm.a_2 True
tt_encoder.layers.2.sublayer.1.norm.b_2 True
tt_encoder.layers.3.self_attn.linears.0.weight True
tt_encoder.layers.3.self_attn.linears.0.bias True
tt_encoder.layers.3.self_attn.linears.1.weight True
tt_encoder.layers.3.self_attn.linears.1.bias True
tt_encoder.layers.3.self_attn.linears.2.weight True
tt_encoder.layers.3.self_attn.linears.2.bias True
tt_encoder.layers.3.self_attn.linears.3.weight True
tt_encoder.layers.3.self_attn.linears.3.bias True
tt_encoder.layers.3.feed_forward.w_1.weight True
tt_encoder.layers.3.feed_forward.w_1.bias True
tt_encoder.layers.3.feed_forward.w_2.weight True
tt_encoder.layers.3.feed_forward.w_2.bias True
tt_encoder.layers.3.group_attn.linear_key.weight True
tt_encoder.layers.3.group_attn.linear_key.bias True
tt_encoder.layers.3.group_attn.linear_query.weight True
tt_encoder.layers.3.group_attn.linear_query.bias True
tt_encoder.layers.3.group_attn.norm.a_2 True
tt_encoder.layers.3.group_attn.norm.b_2 True
tt_encoder.layers.3.sublayer.0.norm.a_2 True
tt_encoder.layers.3.sublayer.0.norm.b_2 True
tt_encoder.layers.3.sublayer.1.norm.a_2 True
tt_encoder.layers.3.sublayer.1.norm.b_2 True
tt_encoder.norm.a_2 True
tt_encoder.norm.b_2 True
linear_1.weight True
linear_1.bias True
linear_2.weight True
linear_2.bias True
linear_out.weight True
linear_out.bias True
so_linear_1.weight True
so_linear_1.bias True
so_linear_2.weight True
so_linear_2.bias True
so_linear_out.weight True
so_linear_out.bias True
layer_norm1.weight True
layer_norm1.bias True
layer_norm2.weight True
layer_norm2.bias True
Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.686)
30/33-(1.844)
12/33-(1.604)
27/33-(1.246)

=== Evaluating Model ===
accuracy on Valid 0.5952380952380952

Best accuracy on Valid 0.5952380952380952
Total valid loss 0.9225566820664839
accuracy on Test 0.5519287833827893
Best accuracy on Test 0.5519287833827893

**** Epoch 0/20 ****
9/33-(0.979)
24/33-(0.967)
6/33-(1.018)
21/33-(1.192)

=== Evaluating Model ===
accuracy on Valid 0.5952380952380952

Best accuracy on Valid 0.5952380952380952
Total valid loss 1.1326975659890608
accuracy on Test 0.5637982195845698
Best accuracy on Test 0.5637982195845698

**** Epoch 1/20 ****
3/33-(0.932)
18/33-(0.746)
0/33-(0.711)
15/33-(1.150)

=== Evaluating Model ===
accuracy on Valid 0.5178571428571429


**** Epoch 2/20 ****
30/33-(0.918)
12/33-(0.582)
27/33-(1.035)
9/33-(1.176)

=== Evaluating Model ===
accuracy on Valid 0.6726190476190477

Best accuracy on Valid 0.6726190476190477
Total valid loss 0.8667688884518363
accuracy on Test 0.6468842729970327
Best accuracy on Test 0.6468842729970327

**** Epoch 3/20 ****
24/33-(0.524)
6/33-(0.937)
21/33-(0.777)
3/33-(0.847)
18/33-(0.773)

=== Evaluating Model ===
accuracy on Valid 0.7261904761904762

Best accuracy on Valid 0.7261904761904762
Total valid loss 0.7103185017000545
accuracy on Test 0.6617210682492581
Best accuracy on Test 0.6617210682492581

**** Epoch 4/20 ****
0/33-(0.769)
15/33-(0.656)
30/33-(0.676)
12/33-(0.598)

=== Evaluating Model ===
accuracy on Valid 0.6875


**** Epoch 5/20 ****
27/33-(0.542)
9/33-(0.802)
24/33-(0.823)
6/33-(0.641)

=== Evaluating Model ===
accuracy on Valid 0.6964285714285714


**** Epoch 6/20 ****
21/33-(0.444)
3/33-(0.541)
18/33-(0.485)
0/33-(0.559)

=== Evaluating Model ===
accuracy on Valid 0.6934523809523809


**** Epoch 7/20 ****
15/33-(0.634)
30/33-(0.907)
12/33-(0.687)
27/33-(0.548)

=== Evaluating Model ===
accuracy on Valid 0.7113095238095238


**** Epoch 8/20 ****
9/33-(0.479)
24/33-(0.750)
6/33-(1.167)
21/33-(0.883)
3/33-(0.730)

=== Evaluating Model ===
accuracy on Valid 0.6815476190476191


**** Epoch 9/20 ****
18/33-(0.939)
0/33-(0.312)
15/33-(2.147)
30/33-(0.597)

=== Evaluating Model ===
accuracy on Valid 0.6845238095238095


**** Epoch 10/20 ****
12/33-(0.395)
27/33-(0.605)
9/33-(0.275)
24/33-(0.498)

=== Evaluating Model ===
accuracy on Valid 0.7291666666666666

Best accuracy on Valid 0.7291666666666666
Total valid loss 0.8717056580565192
accuracy on Test 0.6973293768545994
Best accuracy on Test 0.6973293768545994

**** Epoch 11/20 ****
6/33-(0.640)
21/33-(0.270)
3/33-(0.283)
18/33-(0.243)

=== Evaluating Model ===
accuracy on Valid 0.7172619047619048


**** Epoch 12/20 ****
0/33-(0.755)
15/33-(0.135)
30/33-(1.028)
12/33-(0.237)

=== Evaluating Model ===
accuracy on Valid 0.6875


**** Epoch 13/20 ****
27/33-(0.378)
9/33-(0.220)
24/33-(0.237)
6/33-(0.966)
21/33-(0.304)

=== Evaluating Model ===
accuracy on Valid 0.7232142857142857


**** Epoch 14/20 ****
3/33-(0.076)
18/33-(0.335)
0/33-(0.304)
15/33-(0.332)

=== Evaluating Model ===
accuracy on Valid 0.6934523809523809


**** Epoch 15/20 ****
30/33-(0.798)
12/33-(0.418)
27/33-(0.125)
9/33-(0.161)

=== Evaluating Model ===
accuracy on Valid 0.6964285714285714


**** Epoch 16/20 ****
24/33-(0.945)
6/33-(0.573)
21/33-(0.307)
3/33-(0.432)

=== Evaluating Model ===
accuracy on Valid 0.7023809523809523


**** Epoch 17/20 ****
18/33-(0.428)
0/33-(0.267)
15/33-(0.322)
30/33-(0.459)

=== Evaluating Model ===
accuracy on Valid 0.6517857142857143


**** Epoch 18/20 ****
12/33-(0.283)
27/33-(0.117)
9/33-(0.076)
24/33-(0.130)
6/33-(0.193)

=== Evaluating Model ===
accuracy on Valid 0.6428571428571429


**** Epoch 19/20 ****
21/33-(0.197)
Best accuracy on Test 0.6973293768545994

Final k-fold valid 0.7058958598276106
[0.7053571428571429, 0.7091988130563798, 0.6735905044510386, 0.712166172106825, 0.7291666666666666]
Final k-fold eval 0.7165748198389148
[0.7321428571428571, 0.6964285714285714, 0.7418397626112759, 0.7151335311572701, 0.6973293768545994]
