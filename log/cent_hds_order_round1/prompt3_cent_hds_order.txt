Whole k-fold eval mode
Source domain: 3, Target domain: 3, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.681)
30/33-(1.612)
12/33-(1.981)

=== Evaluating Model ===
accuracy on Valid 0.5232974910394266

Best accuracy on Valid 0.5232974910394266
Total valid loss 1.1665758258766599
accuracy on Test 0.45878136200716846
Best accuracy on Test 0.45878136200716846

**** Epoch 0/20 ****
27/33-(1.018)
9/33-(1.054)
24/33-(1.146)

=== Evaluating Model ===
accuracy on Valid 0.6989247311827957

Best accuracy on Valid 0.6989247311827957
Total valid loss 0.7320554090870751
accuracy on Test 0.6666666666666666
Best accuracy on Test 0.6666666666666666

**** Epoch 1/20 ****
6/33-(1.165)
21/33-(1.257)
3/33-(0.770)
18/33-(0.640)

=== Evaluating Model ===
accuracy on Valid 0.5053763440860215


**** Epoch 2/20 ****
0/33-(0.803)
15/33-(0.618)
30/33-(0.920)

=== Evaluating Model ===
accuracy on Valid 0.7885304659498208

Best accuracy on Valid 0.7885304659498208
Total valid loss 0.6113496240642335
accuracy on Test 0.7311827956989247
Best accuracy on Test 0.7311827956989247

**** Epoch 3/20 ****
12/33-(0.640)
27/33-(1.342)
9/33-(0.568)
24/33-(0.676)

=== Evaluating Model ===
accuracy on Valid 0.7562724014336918


**** Epoch 4/20 ****
6/33-(0.345)
21/33-(0.767)
3/33-(0.779)

=== Evaluating Model ===
accuracy on Valid 0.6057347670250897


**** Epoch 5/20 ****
18/33-(0.907)
0/33-(0.650)
15/33-(0.667)
30/33-(0.497)

=== Evaluating Model ===
accuracy on Valid 0.8064516129032258

Best accuracy on Valid 0.8064516129032258
Total valid loss 0.5431061916881137
accuracy on Test 0.7706093189964157
Best accuracy on Test 0.7706093189964157

**** Epoch 6/20 ****
12/33-(0.552)
27/33-(1.111)
9/33-(0.437)

=== Evaluating Model ===
accuracy on Valid 0.7741935483870968


**** Epoch 7/20 ****
24/33-(0.826)
6/33-(0.466)
21/33-(0.330)
3/33-(0.905)

=== Evaluating Model ===
accuracy on Valid 0.7275985663082437


**** Epoch 8/20 ****
18/33-(0.337)
0/33-(0.716)
15/33-(1.016)

=== Evaluating Model ===
accuracy on Valid 0.7526881720430108


**** Epoch 9/20 ****
30/33-(0.568)
12/33-(0.498)
27/33-(0.520)
9/33-(0.712)

=== Evaluating Model ===
accuracy on Valid 0.7562724014336918


**** Epoch 10/20 ****
24/33-(0.164)
6/33-(0.286)
21/33-(0.353)

=== Evaluating Model ===
accuracy on Valid 0.7491039426523297


**** Epoch 11/20 ****
3/33-(1.075)
18/33-(0.573)
0/33-(0.244)
15/33-(0.583)

=== Evaluating Model ===
accuracy on Valid 0.6129032258064516


**** Epoch 12/20 ****
30/33-(0.322)
12/33-(0.278)
27/33-(2.068)

=== Evaluating Model ===
accuracy on Valid 0.7777777777777778


**** Epoch 13/20 ****
9/33-(0.187)
24/33-(0.650)
6/33-(0.488)
21/33-(0.223)

=== Evaluating Model ===
accuracy on Valid 0.7562724014336918


**** Epoch 14/20 ****
3/33-(0.127)
18/33-(0.090)
0/33-(0.110)

=== Evaluating Model ===
accuracy on Valid 0.7025089605734767


**** Epoch 15/20 ****
15/33-(1.771)
30/33-(0.159)
12/33-(0.074)

=== Evaluating Model ===
accuracy on Valid 0.7455197132616488


**** Epoch 16/20 ****
27/33-(0.597)
9/33-(0.475)
24/33-(0.151)
6/33-(0.526)

=== Evaluating Model ===
accuracy on Valid 0.7741935483870968


**** Epoch 17/20 ****
21/33-(0.144)
3/33-(0.173)
18/33-(0.320)

=== Evaluating Model ===
accuracy on Valid 0.6953405017921147


**** Epoch 18/20 ****
0/33-(1.535)
15/33-(0.194)
30/33-(0.099)
12/33-(0.086)

=== Evaluating Model ===
accuracy on Valid 0.7670250896057348


**** Epoch 19/20 ****
27/33-(0.257)
Best accuracy on Test 0.7706093189964157

Source domain: 3, Target domain: 3, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.761)
30/33-(1.211)
12/33-(0.906)

=== Evaluating Model ===
accuracy on Valid 0.6200716845878136

Best accuracy on Valid 0.6200716845878136
Total valid loss 0.7032723360591464
accuracy on Test 0.6774193548387096
Best accuracy on Test 0.6774193548387096

**** Epoch 0/20 ****
27/33-(0.990)
9/33-(1.363)
24/33-(0.980)

=== Evaluating Model ===
accuracy on Valid 0.6559139784946236

Best accuracy on Valid 0.6559139784946236
Total valid loss 0.6402738673819436
accuracy on Test 0.6989247311827957
Best accuracy on Test 0.6989247311827957

**** Epoch 1/20 ****
6/33-(1.083)
21/33-(1.471)
3/33-(0.526)
18/33-(1.132)

=== Evaluating Model ===
accuracy on Valid 0.6379928315412187


**** Epoch 2/20 ****
0/33-(1.667)
15/33-(0.723)
30/33-(0.659)

=== Evaluating Model ===
accuracy on Valid 0.6738351254480287

Best accuracy on Valid 0.6738351254480287
Total valid loss 0.4775344158212344
accuracy on Test 0.7885304659498208
Best accuracy on Test 0.7885304659498208

**** Epoch 3/20 ****
12/33-(0.286)
27/33-(0.706)
9/33-(1.358)
24/33-(0.891)

=== Evaluating Model ===
accuracy on Valid 0.6200716845878136


**** Epoch 4/20 ****
6/33-(0.744)
21/33-(0.765)
3/33-(0.534)

=== Evaluating Model ===
accuracy on Valid 0.6989247311827957

Best accuracy on Valid 0.6989247311827957
Total valid loss 0.43833504368861514
accuracy on Test 0.7992831541218638
Best accuracy on Test 0.7992831541218638

**** Epoch 5/20 ****
18/33-(0.582)
0/33-(1.189)
15/33-(0.415)
30/33-(0.556)

=== Evaluating Model ===
accuracy on Valid 0.6989247311827957

Best accuracy on Valid 0.6989247311827957
Total valid loss 0.4726616011725532
accuracy on Test 0.7777777777777778
Best accuracy on Test 0.7992831541218638

**** Epoch 6/20 ****
12/33-(0.706)
27/33-(0.469)
9/33-(0.615)

=== Evaluating Model ===
accuracy on Valid 0.6415770609318996


**** Epoch 7/20 ****
24/33-(0.868)
6/33-(1.329)
21/33-(0.785)
3/33-(0.478)

=== Evaluating Model ===
accuracy on Valid 0.6917562724014337


**** Epoch 8/20 ****
18/33-(0.817)
0/33-(0.767)
15/33-(0.692)

=== Evaluating Model ===
accuracy on Valid 0.6845878136200717


**** Epoch 9/20 ****
30/33-(0.173)
12/33-(0.540)
27/33-(0.514)
9/33-(0.492)

=== Evaluating Model ===
accuracy on Valid 0.6308243727598566


**** Epoch 10/20 ****
24/33-(0.370)
6/33-(0.712)
21/33-(0.807)

=== Evaluating Model ===
accuracy on Valid 0.6738351254480287


**** Epoch 11/20 ****
3/33-(0.463)
18/33-(0.477)
0/33-(1.341)
15/33-(0.720)

=== Evaluating Model ===
accuracy on Valid 0.6272401433691757


**** Epoch 12/20 ****
30/33-(0.842)
12/33-(0.864)
27/33-(0.381)

=== Evaluating Model ===
accuracy on Valid 0.5806451612903226


**** Epoch 13/20 ****
9/33-(0.364)
24/33-(0.231)
6/33-(0.086)
21/33-(0.137)

=== Evaluating Model ===
accuracy on Valid 0.6236559139784946


**** Epoch 14/20 ****
3/33-(0.737)
18/33-(0.103)
0/33-(0.881)

=== Evaluating Model ===
accuracy on Valid 0.6630824372759857


**** Epoch 15/20 ****
15/33-(0.580)
30/33-(0.308)
12/33-(0.092)

=== Evaluating Model ===
accuracy on Valid 0.6451612903225806


**** Epoch 16/20 ****
27/33-(0.667)
9/33-(0.153)
24/33-(0.141)
6/33-(0.216)

=== Evaluating Model ===
accuracy on Valid 0.6236559139784946


**** Epoch 17/20 ****
21/33-(0.473)
3/33-(0.626)
18/33-(0.254)

=== Evaluating Model ===
accuracy on Valid 0.6236559139784946


**** Epoch 18/20 ****
0/33-(0.361)
15/33-(0.114)
30/33-(0.064)
12/33-(0.029)

=== Evaluating Model ===
accuracy on Valid 0.6630824372759857


**** Epoch 19/20 ****
27/33-(0.132)
Best accuracy on Test 0.7992831541218638

Source domain: 3, Target domain: 3, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.437)
30/33-(1.446)
12/33-(1.532)

=== Evaluating Model ===
accuracy on Valid 0.4910394265232975

Best accuracy on Valid 0.4910394265232975
Total valid loss 1.0654491153028276
accuracy on Test 0.4444444444444444
Best accuracy on Test 0.4444444444444444

**** Epoch 0/20 ****
27/33-(0.763)
9/33-(1.021)
24/33-(0.954)

=== Evaluating Model ===
accuracy on Valid 0.6630824372759857

Best accuracy on Valid 0.6630824372759857
Total valid loss 0.6648836549785402
accuracy on Test 0.6666666666666666
Best accuracy on Test 0.6666666666666666

**** Epoch 1/20 ****
6/33-(0.808)
21/33-(0.322)
3/33-(1.400)
18/33-(0.648)

=== Evaluating Model ===
accuracy on Valid 0.7419354838709677

Best accuracy on Valid 0.7419354838709677
Total valid loss 0.7014231532812119
accuracy on Test 0.6953405017921147
Best accuracy on Test 0.6953405017921147

**** Epoch 2/20 ****
0/33-(0.627)
15/33-(1.004)
30/33-(1.644)

=== Evaluating Model ===
accuracy on Valid 0.6594982078853047


**** Epoch 3/20 ****
12/33-(0.680)
27/33-(0.839)
9/33-(0.708)
24/33-(0.858)

=== Evaluating Model ===
accuracy on Valid 0.5268817204301075


**** Epoch 4/20 ****
6/33-(0.402)
21/33-(0.792)
3/33-(0.450)

=== Evaluating Model ===
accuracy on Valid 0.7311827956989247


**** Epoch 5/20 ****
18/33-(1.080)
0/33-(1.032)
15/33-(0.482)
30/33-(0.446)

=== Evaluating Model ===
accuracy on Valid 0.7025089605734767


**** Epoch 6/20 ****
12/33-(0.798)
27/33-(0.475)
9/33-(0.464)

=== Evaluating Model ===
accuracy on Valid 0.7204301075268817


**** Epoch 7/20 ****
24/33-(0.208)
6/33-(0.363)
21/33-(0.458)
3/33-(1.108)

=== Evaluating Model ===
accuracy on Valid 0.6845878136200717


**** Epoch 8/20 ****
18/33-(0.189)
0/33-(0.289)
15/33-(0.812)

=== Evaluating Model ===
accuracy on Valid 0.6845878136200717


**** Epoch 9/20 ****
30/33-(0.388)
12/33-(0.323)
27/33-(0.193)
9/33-(0.334)

=== Evaluating Model ===
accuracy on Valid 0.7383512544802867


**** Epoch 10/20 ****
24/33-(0.527)
6/33-(0.512)
21/33-(0.517)

=== Evaluating Model ===
accuracy on Valid 0.7526881720430108

Best accuracy on Valid 0.7526881720430108
Total valid loss 1.0258307051327493
accuracy on Test 0.7240143369175627
Best accuracy on Test 0.7240143369175627

**** Epoch 11/20 ****
3/33-(0.859)
18/33-(0.761)
0/33-(0.095)
15/33-(0.991)

=== Evaluating Model ===
accuracy on Valid 0.7383512544802867


**** Epoch 12/20 ****
30/33-(0.208)
12/33-(0.100)
27/33-(1.253)

=== Evaluating Model ===
accuracy on Valid 0.7562724014336918

Best accuracy on Valid 0.7562724014336918
Total valid loss 1.137173084749116
accuracy on Test 0.6810035842293907
Best accuracy on Test 0.7240143369175627

**** Epoch 13/20 ****
9/33-(0.329)
24/33-(1.551)
6/33-(0.147)
21/33-(0.206)

=== Evaluating Model ===
accuracy on Valid 0.6953405017921147


**** Epoch 14/20 ****
3/33-(0.056)
18/33-(0.274)
0/33-(0.074)

=== Evaluating Model ===
accuracy on Valid 0.7491039426523297


**** Epoch 15/20 ****
15/33-(0.327)
30/33-(0.735)
12/33-(0.179)

=== Evaluating Model ===
accuracy on Valid 0.7706093189964157

Best accuracy on Valid 0.7706093189964157
Total valid loss 1.1494020687209234
accuracy on Test 0.7096774193548387
Best accuracy on Test 0.7240143369175627

**** Epoch 16/20 ****
27/33-(0.126)
9/33-(1.453)
24/33-(0.231)
6/33-(0.111)

=== Evaluating Model ===
accuracy on Valid 0.6917562724014337


**** Epoch 17/20 ****
21/33-(0.072)
3/33-(0.505)
18/33-(0.365)

=== Evaluating Model ===
accuracy on Valid 0.7204301075268817


**** Epoch 18/20 ****
0/33-(0.069)
15/33-(0.105)
30/33-(0.102)
12/33-(0.525)

=== Evaluating Model ===
accuracy on Valid 0.7383512544802867


**** Epoch 19/20 ****
27/33-(0.387)
Best accuracy on Test 0.7240143369175627

Source domain: 3, Target domain: 3, Cur_fold 3
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.749)
30/33-(1.248)
12/33-(1.464)

=== Evaluating Model ===
accuracy on Valid 0.6357142857142857

Best accuracy on Valid 0.6357142857142857
Total valid loss 0.7862510416242812
accuracy on Test 0.6093189964157706
Best accuracy on Test 0.6093189964157706

**** Epoch 0/20 ****
27/33-(1.104)
9/33-(1.196)
24/33-(1.087)

=== Evaluating Model ===
accuracy on Valid 0.6785714285714286

Best accuracy on Valid 0.6785714285714286
Total valid loss 0.6055653923087649
accuracy on Test 0.7634408602150538
Best accuracy on Test 0.7634408602150538

**** Epoch 1/20 ****
6/33-(0.668)
21/33-(1.665)
3/33-(0.954)
18/33-(0.762)

=== Evaluating Model ===
accuracy on Valid 0.6678571428571428


**** Epoch 2/20 ****
0/33-(1.261)
15/33-(0.975)
30/33-(0.948)

=== Evaluating Model ===
accuracy on Valid 0.43214285714285716


**** Epoch 3/20 ****
12/33-(1.414)
27/33-(0.393)
9/33-(0.498)
24/33-(0.576)

=== Evaluating Model ===
accuracy on Valid 0.7071428571428572

Best accuracy on Valid 0.7071428571428572
Total valid loss 0.567760224143664
accuracy on Test 0.7598566308243727
Best accuracy on Test 0.7634408602150538

**** Epoch 4/20 ****
6/33-(0.494)
21/33-(0.838)
3/33-(0.849)

=== Evaluating Model ===
accuracy on Valid 0.6357142857142857


**** Epoch 5/20 ****
18/33-(0.512)
0/33-(0.703)
15/33-(0.539)
30/33-(0.507)

=== Evaluating Model ===
accuracy on Valid 0.6714285714285714


**** Epoch 6/20 ****
12/33-(0.167)
27/33-(0.705)
9/33-(0.738)

=== Evaluating Model ===
accuracy on Valid 0.6571428571428571


**** Epoch 7/20 ****
24/33-(0.506)
6/33-(0.518)
21/33-(0.704)
3/33-(1.052)

=== Evaluating Model ===
accuracy on Valid 0.675


**** Epoch 8/20 ****
18/33-(0.483)
0/33-(0.517)
15/33-(0.486)

=== Evaluating Model ===
accuracy on Valid 0.6714285714285714


**** Epoch 9/20 ****
30/33-(2.103)
12/33-(0.196)
27/33-(0.426)
9/33-(0.207)

=== Evaluating Model ===
accuracy on Valid 0.6821428571428572


**** Epoch 10/20 ****
24/33-(0.255)
6/33-(0.253)
21/33-(0.384)

=== Evaluating Model ===
accuracy on Valid 0.6642857142857143


**** Epoch 11/20 ****
3/33-(1.073)
18/33-(0.754)
0/33-(0.504)
15/33-(0.249)

=== Evaluating Model ===
accuracy on Valid 0.6821428571428572


**** Epoch 12/20 ****
30/33-(0.340)
12/33-(0.107)
27/33-(0.378)

=== Evaluating Model ===
accuracy on Valid 0.6535714285714286


**** Epoch 13/20 ****
9/33-(0.098)
24/33-(0.232)
6/33-(0.326)
21/33-(0.549)

=== Evaluating Model ===
accuracy on Valid 0.6178571428571429


**** Epoch 14/20 ****
3/33-(0.492)
18/33-(1.992)
0/33-(0.199)

=== Evaluating Model ===
accuracy on Valid 0.6607142857142857


**** Epoch 15/20 ****
15/33-(0.028)
30/33-(1.568)
12/33-(0.441)

=== Evaluating Model ===
accuracy on Valid 0.6428571428571429


**** Epoch 16/20 ****
27/33-(0.324)
9/33-(0.170)
24/33-(0.845)
6/33-(0.922)

=== Evaluating Model ===
accuracy on Valid 0.675


**** Epoch 17/20 ****
21/33-(0.070)
3/33-(0.607)
18/33-(0.419)

=== Evaluating Model ===
accuracy on Valid 0.6785714285714286


**** Epoch 18/20 ****
0/33-(0.124)
15/33-(0.041)
30/33-(0.501)
12/33-(0.060)

=== Evaluating Model ===
accuracy on Valid 0.6107142857142858


**** Epoch 19/20 ****
27/33-(0.206)
Best accuracy on Test 0.7634408602150538

Source domain: 3, Target domain: 3, Cur_fold 4
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.666)
30/33-(1.243)
12/33-(0.993)

=== Evaluating Model ===
accuracy on Valid 0.5161290322580645

Best accuracy on Valid 0.5161290322580645
Total valid loss 0.9092387408018112
accuracy on Test 0.525
Best accuracy on Test 0.525

**** Epoch 0/20 ****
27/33-(2.319)
9/33-(1.002)
24/33-(0.998)

=== Evaluating Model ===
accuracy on Valid 0.6917562724014337

Best accuracy on Valid 0.6917562724014337
Total valid loss 0.7469258093171649
accuracy on Test 0.6428571428571429
Best accuracy on Test 0.6428571428571429

**** Epoch 1/20 ****
6/33-(1.069)
21/33-(1.066)
3/33-(0.628)
18/33-(0.989)

=== Evaluating Model ===
accuracy on Valid 0.7347670250896058

Best accuracy on Valid 0.7347670250896058
Total valid loss 0.6486849652396308
accuracy on Test 0.6857142857142857
Best accuracy on Test 0.6857142857142857

**** Epoch 2/20 ****
0/33-(1.117)
15/33-(0.606)
30/33-(0.661)

=== Evaluating Model ===
accuracy on Valid 0.6451612903225806


**** Epoch 3/20 ****
12/33-(0.731)
27/33-(0.557)
9/33-(0.875)
24/33-(0.594)

=== Evaluating Model ===
accuracy on Valid 0.7168458781362007


**** Epoch 4/20 ****
6/33-(0.374)
21/33-(0.742)
3/33-(0.473)

=== Evaluating Model ===
accuracy on Valid 0.6666666666666666


**** Epoch 5/20 ****
18/33-(1.020)
0/33-(0.455)
15/33-(1.001)
30/33-(0.512)

=== Evaluating Model ===
accuracy on Valid 0.6272401433691757


**** Epoch 6/20 ****
12/33-(0.732)
27/33-(0.785)
9/33-(1.006)

=== Evaluating Model ===
accuracy on Valid 0.7060931899641577


**** Epoch 7/20 ****
24/33-(0.497)
6/33-(0.395)
21/33-(0.348)
3/33-(1.175)

=== Evaluating Model ===
accuracy on Valid 0.7096774193548387


**** Epoch 8/20 ****
18/33-(0.416)
0/33-(0.461)
15/33-(0.244)

=== Evaluating Model ===
accuracy on Valid 0.7347670250896058

Best accuracy on Valid 0.7347670250896058
Total valid loss 1.1528610686461132
accuracy on Test 0.675
Best accuracy on Test 0.6857142857142857

**** Epoch 9/20 ****
30/33-(1.007)
12/33-(0.528)
27/33-(0.558)
9/33-(0.715)

=== Evaluating Model ===
accuracy on Valid 0.7562724014336918

Best accuracy on Valid 0.7562724014336918
Total valid loss 1.062137246131897
accuracy on Test 0.6892857142857143
Best accuracy on Test 0.6892857142857143

**** Epoch 10/20 ****
24/33-(0.299)
6/33-(0.172)
21/33-(0.303)

=== Evaluating Model ===
accuracy on Valid 0.7562724014336918

Best accuracy on Valid 0.7562724014336918
Total valid loss 0.9595094041691886
accuracy on Test 0.7071428571428572
Best accuracy on Test 0.7071428571428572

**** Epoch 11/20 ****
3/33-(0.272)
18/33-(0.588)
0/33-(0.107)
15/33-(0.683)

=== Evaluating Model ===
accuracy on Valid 0.5913978494623656


**** Epoch 12/20 ****
30/33-(0.878)
12/33-(0.157)
27/33-(0.725)

=== Evaluating Model ===
accuracy on Valid 0.48028673835125446


**** Epoch 13/20 ****
9/33-(0.523)
24/33-(0.436)
6/33-(0.086)
21/33-(0.050)

=== Evaluating Model ===
accuracy on Valid 0.7455197132616488


**** Epoch 14/20 ****
3/33-(0.113)
18/33-(0.335)
0/33-(0.542)

=== Evaluating Model ===
accuracy on Valid 0.7275985663082437


**** Epoch 15/20 ****
15/33-(0.323)
30/33-(0.163)
12/33-(0.706)

=== Evaluating Model ===
accuracy on Valid 0.7311827956989247


**** Epoch 16/20 ****
27/33-(0.117)
9/33-(0.527)
24/33-(0.073)
6/33-(0.239)

=== Evaluating Model ===
accuracy on Valid 0.7096774193548387


**** Epoch 17/20 ****
21/33-(0.360)
3/33-(0.117)
18/33-(0.078)

=== Evaluating Model ===
accuracy on Valid 0.6989247311827957


**** Epoch 18/20 ****
0/33-(0.062)
15/33-(0.258)
30/33-(0.514)
12/33-(0.228)

=== Evaluating Model ===
accuracy on Valid 0.7562724014336918

Best accuracy on Valid 0.7562724014336918
Total valid loss 1.3982210093074374
accuracy on Test 0.6964285714285714
Best accuracy on Test 0.7071428571428572

**** Epoch 19/20 ****
27/33-(0.059)
Best accuracy on Test 0.7071428571428572

Final k-fold valid 0.7385816692268306
[0.8064516129032258, 0.6989247311827957, 0.7526881720430108, 0.6785714285714286, 0.7562724014336918]
Final k-fold eval 0.7528981054787506
[0.7706093189964157, 0.7992831541218638, 0.7240143369175627, 0.7634408602150538, 0.7071428571428572]
