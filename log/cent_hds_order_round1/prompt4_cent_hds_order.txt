Whole k-fold eval mode
Source domain: 4, Target domain: 4, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.650)
30/33-(1.415)
12/33-(1.258)

=== Evaluating Model ===
accuracy on Valid 0.5231788079470199

Best accuracy on Valid 0.5231788079470199
Total valid loss 0.7963163382128665
accuracy on Test 0.5946843853820598
Best accuracy on Test 0.5946843853820598

**** Epoch 0/20 ****
27/33-(0.980)
9/33-(0.771)
24/33-(1.090)
6/33-(0.819)

=== Evaluating Model ===
accuracy on Valid 0.6192052980132451

Best accuracy on Valid 0.6192052980132451
Total valid loss 0.5960293694546348
accuracy on Test 0.7441860465116279
Best accuracy on Test 0.7441860465116279

**** Epoch 1/20 ****
21/33-(0.945)
3/33-(1.267)
18/33-(0.727)
0/33-(0.630)

=== Evaluating Model ===
accuracy on Valid 0.6192052980132451

Best accuracy on Valid 0.6192052980132451
Total valid loss 0.6847766073126542
accuracy on Test 0.6644518272425249
Best accuracy on Test 0.7441860465116279

**** Epoch 2/20 ****
15/33-(0.808)
30/33-(1.005)
12/33-(0.311)

=== Evaluating Model ===
accuracy on Valid 0.6688741721854304

Best accuracy on Valid 0.6688741721854304
Total valid loss 0.640298068523407
accuracy on Test 0.7275747508305648
Best accuracy on Test 0.7441860465116279

**** Epoch 3/20 ****
27/33-(0.748)
9/33-(0.505)
24/33-(0.685)
6/33-(0.622)

=== Evaluating Model ===
accuracy on Valid 0.6655629139072847


**** Epoch 4/20 ****
21/33-(1.138)
3/33-(0.988)
18/33-(0.597)
0/33-(0.638)

=== Evaluating Model ===
accuracy on Valid 0.6688741721854304

Best accuracy on Valid 0.6688741721854304
Total valid loss 0.8381222627664867
accuracy on Test 0.6445182724252492
Best accuracy on Test 0.7441860465116279

**** Epoch 5/20 ****
15/33-(0.493)
30/33-(1.037)
12/33-(0.476)
27/33-(0.646)

=== Evaluating Model ===
accuracy on Valid 0.6655629139072847


**** Epoch 6/20 ****
9/33-(0.496)
24/33-(1.158)
6/33-(0.568)

=== Evaluating Model ===
accuracy on Valid 0.6125827814569537


**** Epoch 7/20 ****
21/33-(0.866)
3/33-(0.659)
18/33-(0.607)
0/33-(0.606)

=== Evaluating Model ===
accuracy on Valid 0.6887417218543046

Best accuracy on Valid 0.6887417218543046
Total valid loss 0.5675527280882785
accuracy on Test 0.7408637873754153
Best accuracy on Test 0.7441860465116279

**** Epoch 8/20 ****
15/33-(0.842)
30/33-(0.328)
12/33-(0.392)
27/33-(0.229)

=== Evaluating Model ===
accuracy on Valid 0.6854304635761589


**** Epoch 9/20 ****
9/33-(0.819)
24/33-(0.264)
6/33-(1.232)
21/33-(0.485)

=== Evaluating Model ===
accuracy on Valid 0.6754966887417219


**** Epoch 10/20 ****
3/33-(0.500)
18/33-(0.198)
0/33-(0.441)

=== Evaluating Model ===
accuracy on Valid 0.6986754966887417

Best accuracy on Valid 0.6986754966887417
Total valid loss 0.7428431589352457
accuracy on Test 0.7408637873754153
Best accuracy on Test 0.7441860465116279

**** Epoch 11/20 ****
15/33-(0.771)
30/33-(0.918)
12/33-(0.564)
27/33-(0.098)

=== Evaluating Model ===
accuracy on Valid 0.6788079470198676


**** Epoch 12/20 ****
9/33-(0.101)
24/33-(0.094)
6/33-(0.161)
21/33-(0.051)

=== Evaluating Model ===
accuracy on Valid 0.7119205298013245

Best accuracy on Valid 0.7119205298013245
Total valid loss 1.25322574651555
accuracy on Test 0.7441860465116279
Best accuracy on Test 0.7441860465116279

**** Epoch 13/20 ****
3/33-(0.057)
18/33-(0.385)
0/33-(0.622)
15/33-(0.391)

=== Evaluating Model ===
accuracy on Valid 0.6390728476821192


**** Epoch 14/20 ****
30/33-(0.466)
12/33-(0.314)
27/33-(0.130)

=== Evaluating Model ===
accuracy on Valid 0.7119205298013245

Best accuracy on Valid 0.7119205298013245
Total valid loss 1.2107001579317607
accuracy on Test 0.7441860465116279
Best accuracy on Test 0.7441860465116279

**** Epoch 15/20 ****
9/33-(0.397)
24/33-(0.084)
6/33-(0.082)
21/33-(0.092)

=== Evaluating Model ===
accuracy on Valid 0.6920529801324503


**** Epoch 16/20 ****
3/33-(0.149)
18/33-(0.049)
0/33-(0.422)
15/33-(0.338)

=== Evaluating Model ===
accuracy on Valid 0.7218543046357616

Best accuracy on Valid 0.7218543046357616
Total valid loss 1.2385534753924923
accuracy on Test 0.7408637873754153
Best accuracy on Test 0.7441860465116279

**** Epoch 17/20 ****
30/33-(0.584)
12/33-(0.802)
27/33-(0.257)

=== Evaluating Model ===
accuracy on Valid 0.6622516556291391


**** Epoch 18/20 ****
9/33-(0.150)
24/33-(0.929)
6/33-(0.154)
21/33-(0.308)

=== Evaluating Model ===
accuracy on Valid 0.6456953642384106


**** Epoch 19/20 ****
3/33-(0.109)
18/33-(0.444)
Best accuracy on Test 0.7441860465116279

Source domain: 4, Target domain: 4, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(2.120)
30/33-(1.137)
12/33-(1.537)

=== Evaluating Model ===
accuracy on Valid 0.5298013245033113

Best accuracy on Valid 0.5298013245033113
Total valid loss 0.9583643298400076
accuracy on Test 0.5331125827814569
Best accuracy on Test 0.5331125827814569

**** Epoch 0/20 ****
27/33-(1.086)
9/33-(0.883)
24/33-(0.848)
6/33-(0.858)

=== Evaluating Model ===
accuracy on Valid 0.6059602649006622

Best accuracy on Valid 0.6059602649006622
Total valid loss 0.7703488845574228
accuracy on Test 0.6357615894039735
Best accuracy on Test 0.6357615894039735

**** Epoch 1/20 ****
21/33-(1.297)
3/33-(0.637)
18/33-(1.219)
0/33-(0.922)

=== Evaluating Model ===
accuracy on Valid 0.6920529801324503

Best accuracy on Valid 0.6920529801324503
Total valid loss 0.7313002159720973
accuracy on Test 0.6688741721854304
Best accuracy on Test 0.6688741721854304

**** Epoch 2/20 ****
15/33-(1.223)
30/33-(0.890)
12/33-(0.596)

=== Evaluating Model ===
accuracy on Valid 0.6920529801324503

Best accuracy on Valid 0.6920529801324503
Total valid loss 0.6880799939757899
accuracy on Test 0.6821192052980133
Best accuracy on Test 0.6821192052980133

**** Epoch 3/20 ****
27/33-(0.931)
9/33-(0.752)
24/33-(0.655)
6/33-(1.066)

=== Evaluating Model ===
accuracy on Valid 0.7450331125827815

Best accuracy on Valid 0.7450331125827815
Total valid loss 0.6188984576024508
accuracy on Test 0.7284768211920529
Best accuracy on Test 0.7284768211920529

**** Epoch 4/20 ****
21/33-(0.979)
3/33-(0.750)
18/33-(0.321)
0/33-(0.548)

=== Evaluating Model ===
accuracy on Valid 0.6788079470198676


**** Epoch 5/20 ****
15/33-(0.586)
30/33-(0.830)
12/33-(1.076)
27/33-(0.416)

=== Evaluating Model ===
accuracy on Valid 0.7582781456953642

Best accuracy on Valid 0.7582781456953642
Total valid loss 0.6601907077588534
accuracy on Test 0.6986754966887417
Best accuracy on Test 0.7284768211920529

**** Epoch 6/20 ****
9/33-(0.529)
24/33-(0.365)
6/33-(0.444)

=== Evaluating Model ===
accuracy on Valid 0.7549668874172185


**** Epoch 7/20 ****
21/33-(0.327)
3/33-(0.690)
18/33-(0.510)
0/33-(1.017)

=== Evaluating Model ===
accuracy on Valid 0.6556291390728477


**** Epoch 8/20 ****
15/33-(0.528)
30/33-(0.359)
12/33-(0.771)
27/33-(0.730)

=== Evaluating Model ===
accuracy on Valid 0.7450331125827815


**** Epoch 9/20 ****
9/33-(0.530)
24/33-(0.399)
6/33-(0.701)
21/33-(0.811)

=== Evaluating Model ===
accuracy on Valid 0.7516556291390728


**** Epoch 10/20 ****
3/33-(0.233)
18/33-(0.442)
0/33-(0.424)

=== Evaluating Model ===
accuracy on Valid 0.7152317880794702


**** Epoch 11/20 ****
15/33-(0.359)
30/33-(0.112)
12/33-(0.099)
27/33-(0.213)

=== Evaluating Model ===
accuracy on Valid 0.7218543046357616


**** Epoch 12/20 ****
9/33-(2.594)
24/33-(0.400)
6/33-(0.120)
21/33-(0.242)

=== Evaluating Model ===
accuracy on Valid 0.7019867549668874


**** Epoch 13/20 ****
3/33-(0.306)
18/33-(0.069)
0/33-(0.136)
15/33-(0.304)

=== Evaluating Model ===
accuracy on Valid 0.7516556291390728


**** Epoch 14/20 ****
30/33-(0.074)
12/33-(0.110)
27/33-(0.137)

=== Evaluating Model ===
accuracy on Valid 0.6423841059602649


**** Epoch 15/20 ****
9/33-(0.645)
24/33-(0.054)
6/33-(0.119)
21/33-(0.261)

=== Evaluating Model ===
accuracy on Valid 0.6854304635761589


**** Epoch 16/20 ****
3/33-(0.129)
18/33-(0.279)
0/33-(0.461)
15/33-(0.068)

=== Evaluating Model ===
accuracy on Valid 0.695364238410596


**** Epoch 17/20 ****
30/33-(0.321)
12/33-(0.203)
27/33-(0.282)

=== Evaluating Model ===
accuracy on Valid 0.7450331125827815


**** Epoch 18/20 ****
9/33-(0.126)
24/33-(0.389)
6/33-(0.193)
21/33-(0.249)

=== Evaluating Model ===
accuracy on Valid 0.7649006622516556

Best accuracy on Valid 0.7649006622516556
Total valid loss 2.2614870196894596
accuracy on Test 0.6854304635761589
Best accuracy on Test 0.7284768211920529

**** Epoch 19/20 ****
3/33-(0.184)
18/33-(1.153)
Best accuracy on Test 0.7284768211920529

Source domain: 4, Target domain: 4, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.814)
30/33-(1.447)
12/33-(0.863)

=== Evaluating Model ===
accuracy on Valid 0.5629139072847682

Best accuracy on Valid 0.5629139072847682
Total valid loss 0.7941434979438782
accuracy on Test 0.609271523178808
Best accuracy on Test 0.609271523178808

**** Epoch 0/20 ****
27/33-(1.018)
9/33-(1.460)
24/33-(1.030)
6/33-(0.816)

=== Evaluating Model ===
accuracy on Valid 0.6324503311258278

Best accuracy on Valid 0.6324503311258278
Total valid loss 0.6940640054251018
accuracy on Test 0.652317880794702
Best accuracy on Test 0.652317880794702

**** Epoch 1/20 ****
21/33-(0.792)
3/33-(0.631)
18/33-(0.532)
0/33-(0.808)

=== Evaluating Model ===
accuracy on Valid 0.6655629139072847

Best accuracy on Valid 0.6655629139072847
Total valid loss 0.6802749476934734
accuracy on Test 0.7019867549668874
Best accuracy on Test 0.7019867549668874

**** Epoch 2/20 ****
15/33-(0.537)
30/33-(0.968)
12/33-(1.061)

=== Evaluating Model ===
accuracy on Valid 0.5827814569536424


**** Epoch 3/20 ****
27/33-(0.931)
9/33-(0.448)
24/33-(0.407)
6/33-(0.732)

=== Evaluating Model ===
accuracy on Valid 0.7019867549668874

Best accuracy on Valid 0.7019867549668874
Total valid loss 0.6189011178518596
accuracy on Test 0.6986754966887417
Best accuracy on Test 0.7019867549668874

**** Epoch 4/20 ****
21/33-(0.760)
3/33-(0.585)
18/33-(1.250)
0/33-(0.680)

=== Evaluating Model ===
accuracy on Valid 0.7317880794701986

Best accuracy on Valid 0.7317880794701986
Total valid loss 0.5327632929149427
accuracy on Test 0.7649006622516556
Best accuracy on Test 0.7649006622516556

**** Epoch 5/20 ****
15/33-(1.052)
30/33-(1.034)
12/33-(0.364)
27/33-(0.205)

=== Evaluating Model ===
accuracy on Valid 0.6854304635761589


**** Epoch 6/20 ****
9/33-(0.881)
24/33-(0.480)
6/33-(0.784)

=== Evaluating Model ===
accuracy on Valid 0.7152317880794702


**** Epoch 7/20 ****
21/33-(0.568)
3/33-(0.513)
18/33-(1.147)
0/33-(0.377)

=== Evaluating Model ===
accuracy on Valid 0.6887417218543046


**** Epoch 8/20 ****
15/33-(0.596)
30/33-(0.829)
12/33-(0.574)
27/33-(0.666)

=== Evaluating Model ===
accuracy on Valid 0.7317880794701986

Best accuracy on Valid 0.7317880794701986
Total valid loss 0.6923612693422719
accuracy on Test 0.7450331125827815
Best accuracy on Test 0.7649006622516556

**** Epoch 9/20 ****
9/33-(0.650)
24/33-(0.223)
6/33-(0.550)
21/33-(0.248)

=== Evaluating Model ===
accuracy on Valid 0.6887417218543046


**** Epoch 10/20 ****
3/33-(0.344)
18/33-(0.248)
0/33-(0.181)

=== Evaluating Model ===
accuracy on Valid 0.7350993377483444

Best accuracy on Valid 0.7350993377483444
Total valid loss 0.8072716766282132
accuracy on Test 0.7649006622516556
Best accuracy on Test 0.7649006622516556

**** Epoch 11/20 ****
15/33-(0.575)
30/33-(0.107)
12/33-(0.831)
27/33-(0.228)

=== Evaluating Model ===
accuracy on Valid 0.5860927152317881


**** Epoch 12/20 ****
9/33-(0.727)
24/33-(0.145)
6/33-(0.802)
21/33-(0.578)

=== Evaluating Model ===
accuracy on Valid 0.6854304635761589


**** Epoch 13/20 ****
3/33-(0.327)
18/33-(0.157)
0/33-(0.482)
15/33-(0.121)

=== Evaluating Model ===
accuracy on Valid 0.7384105960264901

Best accuracy on Valid 0.7384105960264901
Total valid loss 0.7656204888695165
accuracy on Test 0.7549668874172185
Best accuracy on Test 0.7649006622516556

**** Epoch 14/20 ****
30/33-(0.097)
12/33-(0.161)
27/33-(0.358)

=== Evaluating Model ===
accuracy on Valid 0.7317880794701986


**** Epoch 15/20 ****
9/33-(0.212)
24/33-(0.495)
6/33-(0.356)
21/33-(0.260)

=== Evaluating Model ===
accuracy on Valid 0.695364238410596


**** Epoch 16/20 ****
3/33-(0.244)
18/33-(0.469)
0/33-(0.713)
15/33-(0.253)

=== Evaluating Model ===
accuracy on Valid 0.7350993377483444


**** Epoch 17/20 ****
30/33-(0.115)
12/33-(0.639)
27/33-(0.094)

=== Evaluating Model ===
accuracy on Valid 0.7218543046357616


**** Epoch 18/20 ****
9/33-(0.054)
24/33-(0.549)
6/33-(0.211)
21/33-(0.055)

=== Evaluating Model ===
accuracy on Valid 0.7483443708609272

Best accuracy on Valid 0.7483443708609272
Total valid loss 1.2316461460370767
accuracy on Test 0.7748344370860927
Best accuracy on Test 0.7748344370860927

**** Epoch 19/20 ****
3/33-(0.447)
18/33-(0.031)
Best accuracy on Test 0.7748344370860927

Source domain: 4, Target domain: 4, Cur_fold 3
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.790)
30/33-(1.151)
12/33-(1.159)

=== Evaluating Model ===
accuracy on Valid 0.5993377483443708

Best accuracy on Valid 0.5993377483443708
Total valid loss 0.7933467438346461
accuracy on Test 0.5695364238410596
Best accuracy on Test 0.5695364238410596

**** Epoch 0/20 ****
27/33-(0.937)
9/33-(1.408)
24/33-(0.960)
6/33-(0.835)

=== Evaluating Model ===
accuracy on Valid 0.6754966887417219

Best accuracy on Valid 0.6754966887417219
Total valid loss 0.8407396360447532
accuracy on Test 0.6556291390728477
Best accuracy on Test 0.6556291390728477

**** Epoch 1/20 ****
21/33-(0.614)
3/33-(0.684)
18/33-(0.607)
0/33-(1.371)

=== Evaluating Model ===
accuracy on Valid 0.5761589403973509


**** Epoch 2/20 ****
15/33-(0.782)
30/33-(0.389)
12/33-(0.845)

=== Evaluating Model ===
accuracy on Valid 0.7185430463576159

Best accuracy on Valid 0.7185430463576159
Total valid loss 0.6571342803929981
accuracy on Test 0.6986754966887417
Best accuracy on Test 0.6986754966887417

**** Epoch 3/20 ****
27/33-(0.584)
9/33-(1.423)
24/33-(0.676)
6/33-(0.776)

=== Evaluating Model ===
accuracy on Valid 0.7748344370860927

Best accuracy on Valid 0.7748344370860927
Total valid loss 0.563018715695331
accuracy on Test 0.7615894039735099
Best accuracy on Test 0.7615894039735099

**** Epoch 4/20 ****
21/33-(0.522)
3/33-(0.488)
18/33-(0.495)
0/33-(0.378)

=== Evaluating Model ===
accuracy on Valid 0.7218543046357616


**** Epoch 5/20 ****
15/33-(0.662)
30/33-(0.335)
12/33-(0.286)
27/33-(1.477)

=== Evaluating Model ===
accuracy on Valid 0.7549668874172185


**** Epoch 6/20 ****
9/33-(0.638)
24/33-(0.833)
6/33-(0.922)

=== Evaluating Model ===
accuracy on Valid 0.7649006622516556


**** Epoch 7/20 ****
21/33-(0.396)
3/33-(0.558)
18/33-(0.364)
0/33-(0.629)

=== Evaluating Model ===
accuracy on Valid 0.6390728476821192


**** Epoch 8/20 ****
15/33-(0.618)
30/33-(0.121)
12/33-(0.976)
27/33-(0.724)

=== Evaluating Model ===
accuracy on Valid 0.7417218543046358


**** Epoch 9/20 ****
9/33-(0.727)
24/33-(0.364)
6/33-(0.212)
21/33-(0.490)

=== Evaluating Model ===
accuracy on Valid 0.6986754966887417


**** Epoch 10/20 ****
3/33-(0.239)
18/33-(0.683)
0/33-(0.371)

=== Evaluating Model ===
accuracy on Valid 0.7384105960264901


**** Epoch 11/20 ****
15/33-(1.056)
30/33-(1.188)
12/33-(0.524)
27/33-(0.620)

=== Evaluating Model ===
accuracy on Valid 0.6788079470198676


**** Epoch 12/20 ****
9/33-(0.551)
24/33-(0.122)
6/33-(0.320)
21/33-(0.187)

=== Evaluating Model ===
accuracy on Valid 0.7715231788079471


**** Epoch 13/20 ****
3/33-(0.396)
18/33-(0.360)
0/33-(0.527)
15/33-(0.202)

=== Evaluating Model ===
accuracy on Valid 0.7152317880794702


**** Epoch 14/20 ****
30/33-(0.627)
12/33-(0.154)
27/33-(0.158)

=== Evaluating Model ===
accuracy on Valid 0.7483443708609272


**** Epoch 15/20 ****
9/33-(0.250)
24/33-(0.164)
6/33-(0.601)
21/33-(0.258)

=== Evaluating Model ===
accuracy on Valid 0.6754966887417219


**** Epoch 16/20 ****
3/33-(0.201)
18/33-(0.063)
0/33-(0.181)
15/33-(0.149)

=== Evaluating Model ===
accuracy on Valid 0.7317880794701986


**** Epoch 17/20 ****
30/33-(0.298)
12/33-(0.334)
27/33-(0.240)

=== Evaluating Model ===
accuracy on Valid 0.7450331125827815


**** Epoch 18/20 ****
9/33-(0.863)
24/33-(0.111)
6/33-(0.153)
21/33-(0.341)

=== Evaluating Model ===
accuracy on Valid 0.7052980132450332


**** Epoch 19/20 ****
3/33-(0.136)
18/33-(0.174)
Best accuracy on Test 0.7615894039735099

Source domain: 4, Target domain: 4, Cur_fold 4
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(1.805)
30/33-(1.400)
12/33-(1.003)

=== Evaluating Model ===
accuracy on Valid 0.46511627906976744

Best accuracy on Valid 0.46511627906976744
Total valid loss 0.9382936829014829
accuracy on Test 0.5231788079470199
Best accuracy on Test 0.5231788079470199

**** Epoch 0/20 ****
27/33-(1.630)
9/33-(1.052)
24/33-(0.832)
6/33-(0.800)

=== Evaluating Model ===
accuracy on Valid 0.53156146179402

Best accuracy on Valid 0.53156146179402
Total valid loss 0.7773328203904001
accuracy on Test 0.5728476821192053
Best accuracy on Test 0.5728476821192053

**** Epoch 1/20 ****
21/33-(0.984)
3/33-(0.852)
18/33-(0.944)
0/33-(0.817)

=== Evaluating Model ===
accuracy on Valid 0.6877076411960132

Best accuracy on Valid 0.6877076411960132
Total valid loss 0.69859568696273
accuracy on Test 0.7119205298013245
Best accuracy on Test 0.7119205298013245

**** Epoch 2/20 ****
15/33-(0.400)
30/33-(0.370)
12/33-(1.128)

=== Evaluating Model ===
accuracy on Valid 0.5581395348837209


**** Epoch 3/20 ****
27/33-(0.967)
9/33-(0.670)
24/33-(0.736)
6/33-(0.542)

=== Evaluating Model ===
accuracy on Valid 0.707641196013289

Best accuracy on Valid 0.707641196013289
Total valid loss 0.7361642545775363
accuracy on Test 0.6920529801324503
Best accuracy on Test 0.7119205298013245

**** Epoch 4/20 ****
21/33-(0.631)
3/33-(0.381)
18/33-(0.816)
0/33-(0.456)

=== Evaluating Model ===
accuracy on Valid 0.6744186046511628


**** Epoch 5/20 ****
15/33-(0.882)
30/33-(0.425)
12/33-(1.163)
27/33-(0.698)

=== Evaluating Model ===
accuracy on Valid 0.5980066445182725


**** Epoch 6/20 ****
9/33-(0.661)
24/33-(0.483)
6/33-(0.406)

=== Evaluating Model ===
accuracy on Valid 0.6744186046511628


**** Epoch 7/20 ****
21/33-(0.332)
3/33-(0.263)
18/33-(0.487)
0/33-(0.482)

=== Evaluating Model ===
accuracy on Valid 0.6943521594684385


**** Epoch 8/20 ****
15/33-(0.688)
30/33-(0.529)
12/33-(0.494)
27/33-(0.670)

=== Evaluating Model ===
accuracy on Valid 0.7142857142857143

Best accuracy on Valid 0.7142857142857143
Total valid loss 0.7228105036835921
accuracy on Test 0.7450331125827815
Best accuracy on Test 0.7450331125827815

**** Epoch 9/20 ****
9/33-(0.375)
24/33-(0.503)
6/33-(0.862)
21/33-(0.485)

=== Evaluating Model ===
accuracy on Valid 0.7408637873754153

Best accuracy on Valid 0.7408637873754153
Total valid loss 0.6658702147634405
accuracy on Test 0.7317880794701986
Best accuracy on Test 0.7450331125827815

**** Epoch 10/20 ****
3/33-(0.270)
18/33-(0.146)
0/33-(0.185)

=== Evaluating Model ===
accuracy on Valid 0.7009966777408638


**** Epoch 11/20 ****
15/33-(0.338)
30/33-(0.348)
12/33-(0.067)
27/33-(0.593)

=== Evaluating Model ===
accuracy on Valid 0.6910299003322259


**** Epoch 12/20 ****
9/33-(1.183)
24/33-(0.350)
6/33-(0.260)
21/33-(1.239)

=== Evaluating Model ===
accuracy on Valid 0.6744186046511628


**** Epoch 13/20 ****
3/33-(0.356)
18/33-(0.132)
0/33-(1.383)
15/33-(0.699)

=== Evaluating Model ===
accuracy on Valid 0.707641196013289


**** Epoch 14/20 ****
30/33-(0.096)
12/33-(0.152)
27/33-(1.111)

=== Evaluating Model ===
accuracy on Valid 0.7109634551495017


**** Epoch 15/20 ****
9/33-(0.461)
24/33-(0.771)
6/33-(0.590)
21/33-(0.421)

=== Evaluating Model ===
accuracy on Valid 0.717607973421927


**** Epoch 16/20 ****
3/33-(0.465)
18/33-(0.152)
0/33-(0.278)
15/33-(0.224)

=== Evaluating Model ===
accuracy on Valid 0.7242524916943521


**** Epoch 17/20 ****
30/33-(0.376)
12/33-(0.492)
27/33-(0.099)

=== Evaluating Model ===
accuracy on Valid 0.7308970099667774


**** Epoch 18/20 ****
9/33-(0.248)
24/33-(0.366)
6/33-(0.357)
21/33-(0.145)

=== Evaluating Model ===
accuracy on Valid 0.7308970099667774


**** Epoch 19/20 ****
3/33-(0.220)
18/33-(0.978)
Best accuracy on Test 0.7450331125827815

Final k-fold valid 0.7203405865657523
[0.6192052980132451, 0.7450331125827815, 0.7483443708609272, 0.7748344370860927, 0.7142857142857143]
Final k-fold eval 0.750823964269213
[0.7441860465116279, 0.7284768211920529, 0.7748344370860927, 0.7615894039735099, 0.7450331125827815]
