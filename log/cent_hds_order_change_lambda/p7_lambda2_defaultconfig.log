Whole k-fold eval mode
Source domain: 7, Target domain: 7, Cur_fold 0
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(97.674)
30/33-(101.796)
12/33-(104.699)
27/33-(98.588)

=== Evaluating Model ===
accuracy on Valid 0.5578635014836796

Best accuracy on Valid 0.5578635014836796
Total valid loss 1.0612833825024692
accuracy on Test 0.5489614243323442
Best accuracy on Test 0.5489614243323442

**** Epoch 0/20 ****
9/33-(101.002)
24/33-(100.935)
6/33-(98.506)
21/33-(106.248)

=== Evaluating Model ===
accuracy on Valid 0.5816023738872403

Best accuracy on Valid 0.5816023738872403
Total valid loss 0.9050375087694689
accuracy on Test 0.5637982195845698
Best accuracy on Test 0.5637982195845698

**** Epoch 1/20 ****
3/33-(105.254)
18/33-(98.782)
0/33-(91.256)
15/33-(89.771)

=== Evaluating Model ===
accuracy on Valid 0.6142433234421365

Best accuracy on Valid 0.6142433234421365
Total valid loss 0.8143983523954045
accuracy on Test 0.5964391691394659
Best accuracy on Test 0.5964391691394659

**** Epoch 2/20 ****
30/33-(104.772)
12/33-(102.449)
27/33-(106.377)
9/33-(107.189)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445

Best accuracy on Valid 0.7002967359050445
Total valid loss 0.7888029515743256
accuracy on Test 0.6528189910979229
Best accuracy on Test 0.6528189910979229

**** Epoch 3/20 ****
24/33-(96.366)
6/33-(99.383)
21/33-(103.677)
3/33-(102.292)
18/33-(95.826)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308

Best accuracy on Valid 0.7388724035608308
Total valid loss 0.7373217330737547
accuracy on Test 0.6765578635014837
Best accuracy on Test 0.6765578635014837

**** Epoch 4/20 ****
0/33-(103.113)
15/33-(95.753)
30/33-(107.895)
12/33-(97.843)

=== Evaluating Model ===
accuracy on Valid 0.6083086053412463


**** Epoch 5/20 ****
27/33-(105.664)
9/33-(99.454)
24/33-(92.560)
6/33-(102.118)

=== Evaluating Model ===
accuracy on Valid 0.658753709198813


**** Epoch 6/20 ****
21/33-(101.096)
3/33-(106.230)
18/33-(97.834)
0/33-(104.411)

=== Evaluating Model ===
accuracy on Valid 0.7596439169139466

Best accuracy on Valid 0.7596439169139466
Total valid loss 0.734509982846
accuracy on Test 0.6943620178041543
Best accuracy on Test 0.6943620178041543

**** Epoch 7/20 ****
15/33-(101.539)
30/33-(99.560)
12/33-(104.452)
27/33-(97.469)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543


**** Epoch 8/20 ****
9/33-(103.554)
24/33-(101.386)
6/33-(106.346)
21/33-(106.433)
3/33-(99.467)

=== Evaluating Model ===
accuracy on Valid 0.7181008902077152


**** Epoch 9/20 ****
18/33-(100.318)
0/33-(102.111)
15/33-(104.204)
30/33-(95.238)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798


**** Epoch 10/20 ****
12/33-(105.156)
27/33-(106.305)
9/33-(100.821)
24/33-(99.753)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445


**** Epoch 11/20 ****
6/33-(99.623)
21/33-(92.495)
3/33-(92.392)
18/33-(119.781)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641


**** Epoch 12/20 ****
0/33-(102.004)
15/33-(99.624)
30/33-(103.585)
12/33-(105.545)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543


**** Epoch 13/20 ****
27/33-(85.809)
9/33-(93.191)
24/33-(100.658)
6/33-(111.505)
21/33-(104.400)

=== Evaluating Model ===
accuracy on Valid 0.6735905044510386


**** Epoch 14/20 ****
3/33-(108.592)
18/33-(95.407)
0/33-(98.804)
15/33-(105.219)

=== Evaluating Model ===
accuracy on Valid 0.7240356083086054


**** Epoch 15/20 ****
30/33-(105.967)
12/33-(99.805)
27/33-(100.969)
9/33-(98.405)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701


**** Epoch 16/20 ****
24/33-(102.645)
6/33-(111.580)
21/33-(99.709)
3/33-(98.775)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798


**** Epoch 17/20 ****
18/33-(91.571)
0/33-(106.010)
15/33-(99.121)
30/33-(92.743)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641


**** Epoch 18/20 ****
12/33-(100.388)
27/33-(99.809)
9/33-(100.191)
24/33-(107.815)
6/33-(94.498)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288


**** Epoch 19/20 ****
21/33-(79.971)
Best accuracy on Test 0.6943620178041543

Source domain: 7, Target domain: 7, Cur_fold 1
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(96.907)
30/33-(94.035)
12/33-(101.926)
27/33-(98.312)

=== Evaluating Model ===
accuracy on Valid 0.543026706231454

Best accuracy on Valid 0.543026706231454
Total valid loss 0.8304533687504855
accuracy on Test 0.5548961424332344
Best accuracy on Test 0.5548961424332344

**** Epoch 0/20 ****
9/33-(92.799)
24/33-(95.266)
6/33-(101.898)
21/33-(112.423)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288

Best accuracy on Valid 0.6795252225519288
Total valid loss 0.7342338751662861
accuracy on Test 0.7091988130563798
Best accuracy on Test 0.7091988130563798

**** Epoch 1/20 ****
3/33-(97.872)
18/33-(94.916)
0/33-(105.424)
15/33-(99.733)

=== Evaluating Model ===
accuracy on Valid 0.5845697329376854


**** Epoch 2/20 ****
30/33-(110.213)
12/33-(104.893)
27/33-(104.505)
9/33-(95.998)

=== Evaluating Model ===
accuracy on Valid 0.655786350148368


**** Epoch 3/20 ****
24/33-(100.333)
6/33-(96.584)
21/33-(95.770)
3/33-(99.699)
18/33-(103.111)

=== Evaluating Model ===
accuracy on Valid 0.6706231454005934


**** Epoch 4/20 ****
0/33-(102.169)
15/33-(102.351)
30/33-(107.624)
12/33-(84.443)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641

Best accuracy on Valid 0.6884272997032641
Total valid loss 0.8395053419199857
accuracy on Test 0.7270029673590505
Best accuracy on Test 0.7270029673590505

**** Epoch 5/20 ****
27/33-(98.286)
9/33-(91.302)
24/33-(102.618)
6/33-(96.719)

=== Evaluating Model ===
accuracy on Valid 0.6023738872403561


**** Epoch 6/20 ****
21/33-(99.795)
3/33-(100.308)
18/33-(103.971)
0/33-(95.931)

=== Evaluating Model ===
accuracy on Valid 0.5816023738872403


**** Epoch 7/20 ****
15/33-(43.202)
30/33-(101.699)
12/33-(95.933)
27/33-(98.070)

=== Evaluating Model ===
accuracy on Valid 0.599406528189911


**** Epoch 8/20 ****
9/33-(111.360)
24/33-(99.091)
6/33-(47.530)
21/33-(102.071)
3/33-(102.701)

=== Evaluating Model ===
accuracy on Valid 0.5756676557863502


**** Epoch 9/20 ****
18/33-(97.037)
0/33-(109.712)
15/33-(100.255)
30/33-(96.313)

=== Evaluating Model ===
accuracy on Valid 0.5816023738872403


**** Epoch 10/20 ****
12/33-(107.230)
27/33-(96.652)
9/33-(95.675)
24/33-(108.332)

=== Evaluating Model ===
accuracy on Valid 0.5459940652818991


**** Epoch 11/20 ****
6/33-(108.640)
21/33-(105.685)
3/33-(95.898)
18/33-(95.933)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701

Best accuracy on Valid 0.7151335311572701
Total valid loss 0.6579561517997221
accuracy on Test 0.7329376854599406
Best accuracy on Test 0.7329376854599406

**** Epoch 12/20 ****
0/33-(95.072)
15/33-(102.881)
30/33-(100.373)
12/33-(92.325)

=== Evaluating Model ===
accuracy on Valid 0.6646884272997032


**** Epoch 13/20 ****
27/33-(97.641)
9/33-(98.939)
24/33-(101.152)
6/33-(95.439)
21/33-(87.901)

=== Evaluating Model ===
accuracy on Valid 0.7181008902077152

Best accuracy on Valid 0.7181008902077152
Total valid loss 0.7657462724230506
accuracy on Test 0.7299703264094956
Best accuracy on Test 0.7329376854599406

**** Epoch 14/20 ****
3/33-(95.990)
18/33-(106.602)
0/33-(106.510)
15/33-(103.330)

=== Evaluating Model ===
accuracy on Valid 0.6498516320474778


**** Epoch 15/20 ****
30/33-(102.503)
12/33-(101.900)
27/33-(96.800)
9/33-(100.919)

=== Evaluating Model ===
accuracy on Valid 0.6468842729970327


**** Epoch 16/20 ****
24/33-(94.340)
6/33-(100.169)
21/33-(103.574)
3/33-(95.111)

=== Evaluating Model ===
accuracy on Valid 0.7062314540059347


**** Epoch 17/20 ****
18/33-(104.713)
0/33-(98.937)
15/33-(86.781)
30/33-(104.699)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798


**** Epoch 18/20 ****
12/33-(103.136)
27/33-(99.360)
9/33-(86.035)
24/33-(104.740)
6/33-(106.020)

=== Evaluating Model ===
accuracy on Valid 0.6765578635014837


**** Epoch 19/20 ****
21/33-(104.732)
Best accuracy on Test 0.7329376854599406

Source domain: 7, Target domain: 7, Cur_fold 2
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(98.482)
30/33-(106.171)
12/33-(107.534)
27/33-(108.237)

=== Evaluating Model ===
accuracy on Valid 0.5578635014836796

Best accuracy on Valid 0.5578635014836796
Total valid loss 0.88030590523373
accuracy on Test 0.5400593471810089
Best accuracy on Test 0.5400593471810089

**** Epoch 0/20 ****
9/33-(103.522)
24/33-(101.946)
6/33-(97.382)
21/33-(99.511)

=== Evaluating Model ===
accuracy on Valid 0.42433234421364985


**** Epoch 1/20 ****
3/33-(96.620)
18/33-(96.004)
0/33-(99.170)
15/33-(95.200)

=== Evaluating Model ===
accuracy on Valid 0.6468842729970327

Best accuracy on Valid 0.6468842729970327
Total valid loss 0.7499549727548253
accuracy on Test 0.6795252225519288
Best accuracy on Test 0.6795252225519288

**** Epoch 2/20 ****
30/33-(106.337)
12/33-(94.519)
27/33-(103.970)
9/33-(102.178)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701

Best accuracy on Valid 0.7151335311572701
Total valid loss 0.5776409709995444
accuracy on Test 0.6913946587537092
Best accuracy on Test 0.6913946587537092

**** Epoch 3/20 ****
24/33-(97.101)
6/33-(112.418)
21/33-(98.843)
3/33-(99.125)
18/33-(95.017)

=== Evaluating Model ===
accuracy on Valid 0.6379821958456974


**** Epoch 4/20 ****
0/33-(101.144)
15/33-(102.280)
30/33-(90.301)
12/33-(99.414)

=== Evaluating Model ===
accuracy on Valid 0.7507418397626113

Best accuracy on Valid 0.7507418397626113
Total valid loss 0.5988185473463752
accuracy on Test 0.7091988130563798
Best accuracy on Test 0.7091988130563798

**** Epoch 5/20 ****
27/33-(91.985)
9/33-(103.958)
24/33-(98.936)
6/33-(102.171)

=== Evaluating Model ===
accuracy on Valid 0.7181008902077152


**** Epoch 6/20 ****
21/33-(104.767)
3/33-(104.950)
18/33-(96.810)
0/33-(94.808)

=== Evaluating Model ===
accuracy on Valid 0.7270029673590505


**** Epoch 7/20 ****
15/33-(103.266)
30/33-(99.120)
12/33-(98.533)
27/33-(102.787)

=== Evaluating Model ===
accuracy on Valid 0.712166172106825


**** Epoch 8/20 ****
9/33-(91.512)
24/33-(97.147)
6/33-(103.506)
21/33-(103.901)
3/33-(98.394)

=== Evaluating Model ===
accuracy on Valid 0.7388724035608308


**** Epoch 9/20 ****
18/33-(102.526)
0/33-(99.900)
15/33-(100.928)
30/33-(102.285)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819


**** Epoch 10/20 ****
12/33-(95.000)
27/33-(93.014)
9/33-(97.211)
24/33-(111.125)

=== Evaluating Model ===
accuracy on Valid 0.6735905044510386


**** Epoch 11/20 ****
6/33-(95.492)
21/33-(100.607)
3/33-(105.373)
18/33-(109.763)

=== Evaluating Model ===
accuracy on Valid 0.7151335311572701


**** Epoch 12/20 ****
0/33-(95.369)
15/33-(115.325)
30/33-(100.304)
12/33-(101.328)

=== Evaluating Model ===
accuracy on Valid 0.7002967359050445


**** Epoch 13/20 ****
27/33-(102.132)
9/33-(99.095)
24/33-(104.668)
6/33-(102.884)
21/33-(105.001)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229


**** Epoch 14/20 ****
3/33-(110.010)
18/33-(96.723)
0/33-(92.460)
15/33-(91.601)

=== Evaluating Model ===
accuracy on Valid 0.6913946587537092


**** Epoch 15/20 ****
30/33-(49.661)
12/33-(60.457)
27/33-(60.165)
9/33-(72.670)

=== Evaluating Model ===
accuracy on Valid 0.6172106824925816


**** Epoch 16/20 ****
24/33-(54.574)
6/33-(52.589)
21/33-(63.145)
3/33-(71.545)

=== Evaluating Model ===
accuracy on Valid 0.6528189910979229


**** Epoch 17/20 ****
18/33-(51.485)
0/33-(45.203)
15/33-(36.566)
30/33-(39.316)

=== Evaluating Model ===
accuracy on Valid 0.6023738872403561


**** Epoch 18/20 ****
12/33-(39.199)
27/33-(23.364)
9/33-(23.544)
24/33-(69.230)
6/33-(57.157)

=== Evaluating Model ===
accuracy on Valid 0.5608308605341247


**** Epoch 19/20 ****
21/33-(6.191)
Best accuracy on Test 0.7091988130563798

Source domain: 7, Target domain: 7, Cur_fold 3
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin HTTP/1.1" 200 0
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(96.509)
30/33-(101.520)
12/33-(104.142)
27/33-(99.752)

=== Evaluating Model ===
accuracy on Valid 0.5680473372781065

Best accuracy on Valid 0.5680473372781065
Total valid loss 0.9005553261800245
accuracy on Test 0.5578635014836796
Best accuracy on Test 0.5578635014836796

**** Epoch 0/20 ****
9/33-(91.754)
24/33-(105.126)
6/33-(112.766)
21/33-(104.838)

=== Evaluating Model ===
accuracy on Valid 0.6686390532544378

Best accuracy on Valid 0.6686390532544378
Total valid loss 0.7085868932984092
accuracy on Test 0.655786350148368
Best accuracy on Test 0.655786350148368

**** Epoch 1/20 ****
3/33-(102.663)
18/33-(98.610)
0/33-(99.794)
15/33-(98.088)

=== Evaluating Model ===
accuracy on Valid 0.7071005917159763

Best accuracy on Valid 0.7071005917159763
Total valid loss 0.7812461798841303
accuracy on Test 0.6913946587537092
Best accuracy on Test 0.6913946587537092

**** Epoch 2/20 ****
30/33-(103.183)
12/33-(96.993)
27/33-(102.889)
9/33-(105.182)

=== Evaluating Model ===
accuracy on Valid 0.6627218934911243


**** Epoch 3/20 ****
24/33-(105.700)
6/33-(94.975)
21/33-(102.264)
3/33-(93.612)
18/33-(96.005)

=== Evaluating Model ===
accuracy on Valid 0.7248520710059172

Best accuracy on Valid 0.7248520710059172
Total valid loss 0.7334517538547516
accuracy on Test 0.7270029673590505
Best accuracy on Test 0.7270029673590505

**** Epoch 4/20 ****
0/33-(102.735)
15/33-(101.158)
30/33-(101.507)
12/33-(100.808)

=== Evaluating Model ===
accuracy on Valid 0.6952662721893491


**** Epoch 5/20 ****
27/33-(95.423)
9/33-(97.456)
24/33-(93.984)
6/33-(108.654)

=== Evaluating Model ===
accuracy on Valid 0.6923076923076923


**** Epoch 6/20 ****
21/33-(96.687)
3/33-(102.151)
18/33-(101.279)
0/33-(99.606)

=== Evaluating Model ===
accuracy on Valid 0.7189349112426036


**** Epoch 7/20 ****
15/33-(96.752)
30/33-(97.217)
12/33-(100.108)
27/33-(98.780)

=== Evaluating Model ===
accuracy on Valid 0.7218934911242604


**** Epoch 8/20 ****
9/33-(94.705)
24/33-(103.525)
6/33-(101.369)
21/33-(94.756)
3/33-(101.651)

=== Evaluating Model ===
accuracy on Valid 0.6863905325443787


**** Epoch 9/20 ****
18/33-(98.969)
0/33-(100.806)
15/33-(105.322)
30/33-(89.498)

=== Evaluating Model ===
accuracy on Valid 0.7189349112426036


**** Epoch 10/20 ****
12/33-(94.129)
27/33-(95.147)
9/33-(90.974)
24/33-(101.774)

=== Evaluating Model ===
accuracy on Valid 0.7011834319526628


**** Epoch 11/20 ****
6/33-(101.874)
21/33-(94.311)
3/33-(94.444)
18/33-(81.826)

=== Evaluating Model ===
accuracy on Valid 0.7189349112426036


**** Epoch 12/20 ****
0/33-(76.668)
15/33-(59.202)
30/33-(97.006)
12/33-(51.573)

=== Evaluating Model ===
accuracy on Valid 0.5414201183431953


**** Epoch 13/20 ****
27/33-(79.373)
9/33-(69.973)
24/33-(35.246)
6/33-(50.202)
21/33-(27.724)

=== Evaluating Model ===
accuracy on Valid 0.5621301775147929


**** Epoch 14/20 ****
3/33-(31.528)
18/33-(61.869)
0/33-(33.177)
15/33-(42.917)

=== Evaluating Model ===
accuracy on Valid 0.5710059171597633


**** Epoch 15/20 ****
30/33-(37.542)
12/33-(38.844)
27/33-(21.169)
9/33-(158.242)

=== Evaluating Model ===
accuracy on Valid 0.5591715976331361


**** Epoch 16/20 ****
24/33-(103.471)
6/33-(101.559)
21/33-(101.429)
3/33-(97.656)

=== Evaluating Model ===
accuracy on Valid 0.6301775147928994


**** Epoch 17/20 ****
18/33-(98.087)
0/33-(106.652)
15/33-(114.075)
30/33-(107.256)

=== Evaluating Model ===
accuracy on Valid 0.6420118343195266


**** Epoch 18/20 ****
12/33-(97.270)
27/33-(108.187)
9/33-(90.609)
24/33-(51.628)
6/33-(56.467)

=== Evaluating Model ===
accuracy on Valid 0.6242603550295858


**** Epoch 19/20 ****
21/33-(77.992)
Best accuracy on Test 0.7270029673590505

Source domain: 7, Target domain: 7, Cur_fold 4
Corpus: TOEFL
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-spiece.model HTTP/1.1" 200 0
loading file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-spiece.model from cache at /home/minghongxia/.cache/torch/transformers/dad589d582573df0293448af5109cb6981ca77239ed314e15ca63b7b8a318ddd.8b10bd978b5d01c21303cc761fc9ecd464419b3bf921864a355ba807cfbfafa8
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Loading these models for language: en (English):
=======================
| Processor | Package |
-----------------------
| tokenize  | ewt     |
=======================

Use device: gpu
Loading: tokenize
Done loading processors!
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Loading embeddings from: xlnet-base-cased
Model: DIS_Simple Avg Plus Sentence Ordering
Encoder: XLNet
Starting new HTTPS connection (1): s3.amazonaws.com:443
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": true,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Starting new HTTPS connection (1): s3.amazonaws.com:443
loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-pytorch_model.bin from cache at /home/minghongxia/.cache/torch/transformers/24197ba0ce5dbfe23924431610704c88e2c0371afa49149360e4c823219ab474.7eac4fe898a021204e63c88c00ea68c60443c57f94b4bc3c02adbde6465745ac
Starting new HTTPS connection (1): s3.amazonaws.com:443
https://s3.amazonaws.com:443 "HEAD /models.huggingface.co/bert/xlnet-base-cased-config.json HTTP/1.1" 200 0
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/xlnet-base-cased-config.json from cache at /home/minghongxia/.cache/torch/transformers/c9cc6e53904f7f3679a31ec4af244f4419e25ebc8e71ebf8c558a31cbcf07fc8.69e5e35e0b798cab5e473f253752f8bf4d280ee37682281a23eed80f6e2d09c6
Model config XLNetConfig {
  "architectures": [
    "XLNetLMHeadModel"
  ],
  "attn_type": "bi",
  "bi_data": false,
  "bos_token_id": 1,
  "clamp_len": -1,
  "d_head": 64,
  "d_inner": 3072,
  "d_model": 768,
  "do_sample": false,
  "dropout": 0.1,
  "end_n_top": 5,
  "eos_token_id": 2,
  "eos_token_ids": 0,
  "ff_activation": "gelu",
  "finetuning_task": null,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "mem_len": null,
  "model_type": "xlnet",
  "n_head": 12,
  "n_layer": 12,
  "num_beams": 1,
  "num_labels": 2,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 5,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "reuse_len": null,
  "same_length": false,
  "start_n_top": 5,
  "summary_activation": "tanh",
  "summary_last_dropout": 0.1,
  "summary_type": "last",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 250
    }
  },
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "untie_r": true,
  "use_bfloat16": false,
  "vocab_size": 32000
}

Optimizer: adam
**** Training Begins ****
**** Epoch 0/20 ****
Use CrossEntropyLoss
15/33-(101.704)
30/33-(104.678)
12/33-(101.424)
27/33-(96.540)

=== Evaluating Model ===
accuracy on Valid 0.4896142433234421

Best accuracy on Valid 0.4896142433234421
Total valid loss 0.9681721925735474
accuracy on Test 0.4822485207100592
Best accuracy on Test 0.4822485207100592

**** Epoch 0/20 ****
9/33-(102.350)
24/33-(90.188)
6/33-(100.616)
21/33-(92.925)

=== Evaluating Model ===
accuracy on Valid 0.5756676557863502

Best accuracy on Valid 0.5756676557863502
Total valid loss 0.882008048621091
accuracy on Test 0.5384615384615384
Best accuracy on Test 0.5384615384615384

**** Epoch 1/20 ****
3/33-(111.319)
18/33-(100.324)
0/33-(105.873)
15/33-(98.569)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641

Best accuracy on Valid 0.6884272997032641
Total valid loss 0.6253282563252882
accuracy on Test 0.7130177514792899
Best accuracy on Test 0.7130177514792899

**** Epoch 2/20 ****
30/33-(98.680)
12/33-(98.278)
27/33-(102.312)
9/33-(97.588)

=== Evaluating Model ===
accuracy on Valid 0.6795252225519288


**** Epoch 3/20 ****
24/33-(103.916)
6/33-(100.011)
21/33-(96.115)
3/33-(102.912)
18/33-(102.826)

=== Evaluating Model ===
accuracy on Valid 0.6439169139465876


**** Epoch 4/20 ****
0/33-(94.273)
15/33-(96.723)
30/33-(99.959)
12/33-(100.643)

=== Evaluating Model ===
accuracy on Valid 0.7032640949554896

Best accuracy on Valid 0.7032640949554896
Total valid loss 0.6993086378682744
accuracy on Test 0.6686390532544378
Best accuracy on Test 0.7130177514792899

**** Epoch 5/20 ****
27/33-(101.404)
9/33-(104.750)
24/33-(107.468)
6/33-(97.571)

=== Evaluating Model ===
accuracy on Valid 0.655786350148368


**** Epoch 6/20 ****
21/33-(111.063)
3/33-(91.717)
18/33-(97.054)
0/33-(97.963)

=== Evaluating Model ===
accuracy on Valid 0.7091988130563798

Best accuracy on Valid 0.7091988130563798
Total valid loss 0.7563130273060366
accuracy on Test 0.7159763313609467
Best accuracy on Test 0.7159763313609467

**** Epoch 7/20 ****
15/33-(108.182)
30/33-(98.434)
12/33-(102.849)
27/33-(99.673)

=== Evaluating Model ===
accuracy on Valid 0.658753709198813


**** Epoch 8/20 ****
9/33-(98.806)
24/33-(107.319)
6/33-(96.214)
21/33-(96.144)
3/33-(101.599)

=== Evaluating Model ===
accuracy on Valid 0.6943620178041543


**** Epoch 9/20 ****
18/33-(102.706)
0/33-(101.469)
15/33-(108.510)
30/33-(92.936)

=== Evaluating Model ===
accuracy on Valid 0.6884272997032641


**** Epoch 10/20 ****
12/33-(101.440)
27/33-(94.389)
9/33-(98.236)
24/33-(99.968)

=== Evaluating Model ===
accuracy on Valid 0.5578635014836796


**** Epoch 11/20 ****
6/33-(99.638)
21/33-(103.032)
3/33-(103.682)
18/33-(107.205)

=== Evaluating Model ===
accuracy on Valid 0.685459940652819


**** Epoch 12/20 ****
0/33-(103.917)
15/33-(80.604)
30/33-(102.799)
12/33-(69.645)

=== Evaluating Model ===
accuracy on Valid 0.5133531157270029


**** Epoch 13/20 ****
27/33-(42.054)
9/33-(54.995)
24/33-(51.778)
6/33-(56.537)
21/33-(55.669)

=== Evaluating Model ===
accuracy on Valid 0.5370919881305638


**** Epoch 14/20 ****
3/33-(47.951)
18/33-(51.965)
0/33-(59.936)
15/33-(44.560)

=== Evaluating Model ===
accuracy on Valid 0.5578635014836796


**** Epoch 15/20 ****
30/33-(74.357)
12/33-(72.861)
27/33-(77.828)
9/33-(54.719)

=== Evaluating Model ===
accuracy on Valid 0.5370919881305638


**** Epoch 16/20 ****
24/33-(54.817)
6/33-(54.880)
21/33-(88.880)
3/33-(88.950)

=== Evaluating Model ===
accuracy on Valid 0.5459940652818991


**** Epoch 17/20 ****
18/33-(94.996)
0/33-(74.219)
15/33-(53.664)
30/33-(53.053)

=== Evaluating Model ===
accuracy on Valid 0.5756676557863502


**** Epoch 18/20 ****
12/33-(53.083)
27/33-(34.340)
9/33-(50.394)
24/33-(46.766)
6/33-(46.916)

=== Evaluating Model ===
accuracy on Valid 0.6083086053412463


**** Epoch 19/20 ****
21/33-(48.842)
Best accuracy on Test 0.7159763313609467

Final k-fold valid 0.731914034379225
[0.7596439169139466, 0.7151335311572701, 0.7507418397626113, 0.7248520710059172, 0.7091988130563798]
Final k-fold eval 0.7158955630080943
[0.6943620178041543, 0.7329376854599406, 0.7091988130563798, 0.7270029673590505, 0.7159763313609467]
